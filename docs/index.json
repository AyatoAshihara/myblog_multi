[{"authors":null,"categories":null,"content":"å¥ˆè‰¯çœŒå‡ºèº«ã®é™¢å’4å¹´ç›®ã®28æ­³ã€‚å°‚æ”»ã¯ãƒã‚¯ãƒ­çµŒæ¸ˆï¼ˆä¸»ã«Dynamic Stochastic General Equilibruim modelï¼‰ã€æ™‚ç³»åˆ—è§£æã‚„ãƒ†ã‚­ã‚¹ãƒˆãƒã‚¤ãƒ‹ãƒ³ã‚°ã«ã‚‚æ‰‹ã‚’å‡ºã—ã¦ã„ã¾ã—ãŸã€‚2018å¹´ã«æ–°å’ã§æ±äº¬ã®è³‡ç”£é‹ç”¨ä¼šç¤¾ã«å°±è·ã—ã€ä¸»ã«ä¼ç”»æ¥­å‹™ã«å¾“äº‹ã€‚2022å¹´3æœˆã‚ˆã‚Šè»¢è·ã—ã€äº¬éƒ½ã®é›»å­éƒ¨å“ãƒ¡ãƒ¼ã‚«ãƒ¼ã§ãƒ‡ãƒ¼ã‚¿ã‚³ãƒ³ã‚µãƒ«ã‚¿ãƒ³ãƒˆã¨ã—ã¦ã®ã‚­ãƒ£ãƒªã‚¢ãƒ‘ã‚¹ã‚’ã‚¹ã‚¿ãƒ¼ãƒˆã—ã¾ã—ãŸã€‚åºƒç€¬ã™ãšã‚ˆã‚Šæœ‰æ‘æ¶ç´”ã‚ˆã‚ŠãŠå§‰ã¡ã‚ƒã‚“ã®ã»ã†ãŒã‚¿ã‚¤ãƒ—ã€‚\n","date":1522454400,"expirydate":-62135596800,"kind":"term","lang":"ja","lastmod":1522454400,"objectID":"2525497d367e79493fd32b198b28f040","permalink":"/author/ayato-ashihara/","publishdate":"0001-01-01T00:00:00Z","relpermalink":"/author/ayato-ashihara/","section":"authors","summary":"å¥ˆè‰¯çœŒå‡ºèº«ã®é™¢å’4å¹´ç›®ã®28æ­³ã€‚å°‚æ”»ã¯ãƒã‚¯ãƒ­çµŒæ¸ˆï¼ˆä¸»ã«Dyn","tags":null,"title":"Ayato Ashihara","type":"authors"},{"authors":null,"categories":null,"content":"Flexibility This feature can be used for publishing content such as:\n Online courses Project or software documentation Tutorials  The courses folder may be renamed. For example, we can rename it to docs for software/project documentation or tutorials for creating an online course.\nDelete tutorials To remove these pages, delete the courses folder and see below to delete the associated menu link.\nUpdate site menu After renaming or deleting the courses folder, you may wish to update any [[main]] menu links to it by editing your menu configuration at config/_default/menus.toml.\nFor example, if you delete this folder, you can remove the following from your menu configuration:\n[[main]] name = \u0026#34;Courses\u0026#34; url = \u0026#34;courses/\u0026#34; weight = 50 Or, if you are creating a software documentation site, you can rename the courses folder to docs and update the associated Courses menu configuration to:\n[[main]] name = \u0026#34;Docs\u0026#34; url = \u0026#34;docs/\u0026#34; weight = 50 Update the docs menu If you use the docs layout, note that the name of the menu in the front matter should be in the form [menu.X] where X is the folder name. Hence, if you rename the courses/example/ folder, you should also rename the menu definitions in the front matter of files within courses/example/ from [menu.example] to [menu.\u0026lt;NewFolderName\u0026gt;].\n","date":1536451200,"expirydate":-62135596800,"kind":"section","lang":"ja","lastmod":1536451200,"objectID":"59c3ce8e202293146a8a934d37a4070b","permalink":"/courses/example/","publishdate":"2018-09-09T00:00:00Z","relpermalink":"/courses/example/","section":"courses","summary":"Learn how to use Academic's docs layout for publishing online courses, software documentation, and tutorials.","tags":null,"title":"Overview","type":"docs"},{"authors":null,"categories":null,"content":"In this tutorial, I\u0026rsquo;ll share my top 10 tips for getting started with Academic:\nTip 1 Lorem ipsum dolor sit amet, consectetur adipiscing elit. Duis posuere tellus ac convallis placerat. Proin tincidunt magna sed ex sollicitudin condimentum. Sed ac faucibus dolor, scelerisque sollicitudin nisi. Cras purus urna, suscipit quis sapien eu, pulvinar tempor diam. Quisque risus orci, mollis id ante sit amet, gravida egestas nisl. Sed ac tempus magna. Proin in dui enim. Donec condimentum, sem id dapibus fringilla, tellus enim condimentum arcu, nec volutpat est felis vel metus. Vestibulum sit amet erat at nulla eleifend gravida.\nNullam vel molestie justo. Curabitur vitae efficitur leo. In hac habitasse platea dictumst. Sed pulvinar mauris dui, eget varius purus congue ac. Nulla euismod, lorem vel elementum dapibus, nunc justo porta mi, sed tempus est est vel tellus. Nam et enim eleifend, laoreet sem sit amet, elementum sem. Morbi ut leo congue, maximus velit ut, finibus arcu. In et libero cursus, rutrum risus non, molestie leo. Nullam congue quam et volutpat malesuada. Sed risus tortor, pulvinar et dictum nec, sodales non mi. Phasellus lacinia commodo laoreet. Nam mollis, erat in feugiat consectetur, purus eros egestas tellus, in auctor urna odio at nibh. Mauris imperdiet nisi ac magna convallis, at rhoncus ligula cursus.\nCras aliquam rhoncus ipsum, in hendrerit nunc mattis vitae. Duis vitae efficitur metus, ac tempus leo. Cras nec fringilla lacus. Quisque sit amet risus at ipsum pharetra commodo. Sed aliquam mauris at consequat eleifend. Praesent porta, augue sed viverra bibendum, neque ante euismod ante, in vehicula justo lorem ac eros. Suspendisse augue libero, venenatis eget tincidunt ut, malesuada at lorem. Donec vitae bibendum arcu. Aenean maximus nulla non pretium iaculis. Quisque imperdiet, nulla in pulvinar aliquet, velit quam ultrices quam, sit amet fringilla leo sem vel nunc. Mauris in lacinia lacus.\nSuspendisse a tincidunt lacus. Curabitur at urna sagittis, dictum ante sit amet, euismod magna. Sed rutrum massa id tortor commodo, vitae elementum turpis tempus. Lorem ipsum dolor sit amet, consectetur adipiscing elit. Aenean purus turpis, venenatis a ullamcorper nec, tincidunt et massa. Integer posuere quam rutrum arcu vehicula imperdiet. Mauris ullamcorper quam vitae purus congue, quis euismod magna eleifend. Vestibulum semper vel augue eget tincidunt. Fusce eget justo sodales, dapibus odio eu, ultrices lorem. Duis condimentum lorem id eros commodo, in facilisis mauris scelerisque. Morbi sed auctor leo. Nullam volutpat a lacus quis pharetra. Nulla congue rutrum magna a ornare.\nAliquam in turpis accumsan, malesuada nibh ut, hendrerit justo. Cum sociis natoque penatibus et magnis dis parturient montes, nascetur ridiculus mus. Quisque sed erat nec justo posuere suscipit. Donec ut efficitur arcu, in malesuada neque. Nunc dignissim nisl massa, id vulputate nunc pretium nec. Quisque eget urna in risus suscipit ultricies. Pellentesque odio odio, tincidunt in eleifend sed, posuere a diam. Nam gravida nisl convallis semper elementum. Morbi vitae felis faucibus, vulputate orci placerat, aliquet nisi. Aliquam erat volutpat. Maecenas sagittis pulvinar purus, sed porta quam laoreet at.\nTip 2 Lorem ipsum dolor sit amet, consectetur adipiscing elit. Duis posuere tellus ac convallis placerat. Proin tincidunt magna sed ex sollicitudin condimentum. Sed ac faucibus dolor, scelerisque sollicitudin nisi. Cras purus urna, suscipit quis sapien eu, pulvinar tempor diam. Quisque risus orci, mollis id ante sit amet, gravida egestas nisl. Sed ac tempus magna. Proin in dui enim. Donec condimentum, sem id dapibus fringilla, tellus enim condimentum arcu, nec volutpat est felis vel metus. Vestibulum sit amet erat at nulla eleifend gravida.\nNullam vel molestie justo. Curabitur vitae efficitur leo. In hac habitasse platea dictumst. Sed pulvinar mauris dui, eget varius purus congue ac. Nulla euismod, lorem vel elementum dapibus, nunc justo porta mi, sed tempus est est vel tellus. Nam et enim eleifend, laoreet sem sit amet, elementum sem. Morbi ut leo congue, maximus velit ut, finibus arcu. In et libero cursus, rutrum risus non, molestie leo. Nullam congue quam et volutpat malesuada. Sed risus tortor, pulvinar et dictum nec, sodales non mi. Phasellus lacinia commodo laoreet. Nam mollis, erat in feugiat consectetur, purus eros egestas tellus, in auctor urna odio at nibh. Mauris imperdiet nisi ac magna convallis, at rhoncus ligula cursus.\nCras aliquam rhoncus ipsum, in hendrerit nunc mattis vitae. Duis vitae efficitur metus, ac tempus leo. Cras nec fringilla lacus. Quisque sit amet risus at ipsum pharetra commodo. Sed aliquam mauris at consequat eleifend. Praesent porta, augue sed viverra bibendum, neque ante euismod ante, in vehicula justo lorem ac eros. Suspendisse augue libero, venenatis eget tincidunt ut, malesuada at lorem. Donec vitae bibendum arcu. Aenean maximus nulla non pretium iaculis. Quisque imperdiet, nulla in pulvinar aliquet, velit quam ultrices quam, sit amet fringilla leo sem vel nunc. Mauris in lacinia lacus.\nSuspendisse a tincidunt lacus. Curabitur at urna sagittis, dictum ante sit amet, euismod magna. Sed rutrum massa id tortor commodo, vitae elementum turpis tempus. Lorem ipsum dolor sit amet, consectetur adipiscing elit. Aenean purus turpis, venenatis a ullamcorper nec, tincidunt et massa. Integer posuere quam rutrum arcu vehicula imperdiet. Mauris ullamcorper quam vitae purus congue, quis euismod magna eleifend. Vestibulum semper vel augue eget tincidunt. Fusce eget justo sodales, dapibus odio eu, ultrices lorem. Duis condimentum lorem id eros commodo, in facilisis mauris scelerisque. Morbi sed auctor leo. Nullam volutpat a lacus quis pharetra. Nulla congue rutrum magna a ornare.\nAliquam in turpis accumsan, malesuada nibh ut, hendrerit justo. Cum sociis natoque penatibus et magnis dis parturient montes, nascetur ridiculus mus. Quisque sed erat nec justo posuere suscipit. Donec ut efficitur arcu, in malesuada neque. Nunc dignissim nisl massa, id vulputate nunc pretium nec. Quisque eget urna in risus suscipit ultricies. Pellentesque odio odio, tincidunt in eleifend sed, posuere a diam. Nam gravida nisl convallis semper elementum. Morbi vitae felis faucibus, vulputate orci placerat, aliquet nisi. Aliquam erat volutpat. Maecenas sagittis pulvinar purus, sed porta quam laoreet at.\n","date":1557010800,"expirydate":-62135596800,"kind":"page","lang":"ja","lastmod":1557010800,"objectID":"74533bae41439377bd30f645c4677a27","permalink":"/courses/example/example1/","publishdate":"2019-05-05T00:00:00+01:00","relpermalink":"/courses/example/example1/","section":"courses","summary":"In this tutorial, I\u0026rsquo;ll share my top 10 tips for getting started with Academic:\nTip 1 Lorem ipsum dolor sit amet, consectetur adipiscing elit. Duis posuere tellus ac convallis placerat. Proin tincidunt magna sed ex sollicitudin condimentum.","tags":null,"title":"Example Page 1","type":"docs"},{"authors":null,"categories":null,"content":"Here are some more tips for getting started with Academic:\nTip 3 Lorem ipsum dolor sit amet, consectetur adipiscing elit. Duis posuere tellus ac convallis placerat. Proin tincidunt magna sed ex sollicitudin condimentum. Sed ac faucibus dolor, scelerisque sollicitudin nisi. Cras purus urna, suscipit quis sapien eu, pulvinar tempor diam. Quisque risus orci, mollis id ante sit amet, gravida egestas nisl. Sed ac tempus magna. Proin in dui enim. Donec condimentum, sem id dapibus fringilla, tellus enim condimentum arcu, nec volutpat est felis vel metus. Vestibulum sit amet erat at nulla eleifend gravida.\nNullam vel molestie justo. Curabitur vitae efficitur leo. In hac habitasse platea dictumst. Sed pulvinar mauris dui, eget varius purus congue ac. Nulla euismod, lorem vel elementum dapibus, nunc justo porta mi, sed tempus est est vel tellus. Nam et enim eleifend, laoreet sem sit amet, elementum sem. Morbi ut leo congue, maximus velit ut, finibus arcu. In et libero cursus, rutrum risus non, molestie leo. Nullam congue quam et volutpat malesuada. Sed risus tortor, pulvinar et dictum nec, sodales non mi. Phasellus lacinia commodo laoreet. Nam mollis, erat in feugiat consectetur, purus eros egestas tellus, in auctor urna odio at nibh. Mauris imperdiet nisi ac magna convallis, at rhoncus ligula cursus.\nCras aliquam rhoncus ipsum, in hendrerit nunc mattis vitae. Duis vitae efficitur metus, ac tempus leo. Cras nec fringilla lacus. Quisque sit amet risus at ipsum pharetra commodo. Sed aliquam mauris at consequat eleifend. Praesent porta, augue sed viverra bibendum, neque ante euismod ante, in vehicula justo lorem ac eros. Suspendisse augue libero, venenatis eget tincidunt ut, malesuada at lorem. Donec vitae bibendum arcu. Aenean maximus nulla non pretium iaculis. Quisque imperdiet, nulla in pulvinar aliquet, velit quam ultrices quam, sit amet fringilla leo sem vel nunc. Mauris in lacinia lacus.\nSuspendisse a tincidunt lacus. Curabitur at urna sagittis, dictum ante sit amet, euismod magna. Sed rutrum massa id tortor commodo, vitae elementum turpis tempus. Lorem ipsum dolor sit amet, consectetur adipiscing elit. Aenean purus turpis, venenatis a ullamcorper nec, tincidunt et massa. Integer posuere quam rutrum arcu vehicula imperdiet. Mauris ullamcorper quam vitae purus congue, quis euismod magna eleifend. Vestibulum semper vel augue eget tincidunt. Fusce eget justo sodales, dapibus odio eu, ultrices lorem. Duis condimentum lorem id eros commodo, in facilisis mauris scelerisque. Morbi sed auctor leo. Nullam volutpat a lacus quis pharetra. Nulla congue rutrum magna a ornare.\nAliquam in turpis accumsan, malesuada nibh ut, hendrerit justo. Cum sociis natoque penatibus et magnis dis parturient montes, nascetur ridiculus mus. Quisque sed erat nec justo posuere suscipit. Donec ut efficitur arcu, in malesuada neque. Nunc dignissim nisl massa, id vulputate nunc pretium nec. Quisque eget urna in risus suscipit ultricies. Pellentesque odio odio, tincidunt in eleifend sed, posuere a diam. Nam gravida nisl convallis semper elementum. Morbi vitae felis faucibus, vulputate orci placerat, aliquet nisi. Aliquam erat volutpat. Maecenas sagittis pulvinar purus, sed porta quam laoreet at.\nTip 4 Lorem ipsum dolor sit amet, consectetur adipiscing elit. Duis posuere tellus ac convallis placerat. Proin tincidunt magna sed ex sollicitudin condimentum. Sed ac faucibus dolor, scelerisque sollicitudin nisi. Cras purus urna, suscipit quis sapien eu, pulvinar tempor diam. Quisque risus orci, mollis id ante sit amet, gravida egestas nisl. Sed ac tempus magna. Proin in dui enim. Donec condimentum, sem id dapibus fringilla, tellus enim condimentum arcu, nec volutpat est felis vel metus. Vestibulum sit amet erat at nulla eleifend gravida.\nNullam vel molestie justo. Curabitur vitae efficitur leo. In hac habitasse platea dictumst. Sed pulvinar mauris dui, eget varius purus congue ac. Nulla euismod, lorem vel elementum dapibus, nunc justo porta mi, sed tempus est est vel tellus. Nam et enim eleifend, laoreet sem sit amet, elementum sem. Morbi ut leo congue, maximus velit ut, finibus arcu. In et libero cursus, rutrum risus non, molestie leo. Nullam congue quam et volutpat malesuada. Sed risus tortor, pulvinar et dictum nec, sodales non mi. Phasellus lacinia commodo laoreet. Nam mollis, erat in feugiat consectetur, purus eros egestas tellus, in auctor urna odio at nibh. Mauris imperdiet nisi ac magna convallis, at rhoncus ligula cursus.\nCras aliquam rhoncus ipsum, in hendrerit nunc mattis vitae. Duis vitae efficitur metus, ac tempus leo. Cras nec fringilla lacus. Quisque sit amet risus at ipsum pharetra commodo. Sed aliquam mauris at consequat eleifend. Praesent porta, augue sed viverra bibendum, neque ante euismod ante, in vehicula justo lorem ac eros. Suspendisse augue libero, venenatis eget tincidunt ut, malesuada at lorem. Donec vitae bibendum arcu. Aenean maximus nulla non pretium iaculis. Quisque imperdiet, nulla in pulvinar aliquet, velit quam ultrices quam, sit amet fringilla leo sem vel nunc. Mauris in lacinia lacus.\nSuspendisse a tincidunt lacus. Curabitur at urna sagittis, dictum ante sit amet, euismod magna. Sed rutrum massa id tortor commodo, vitae elementum turpis tempus. Lorem ipsum dolor sit amet, consectetur adipiscing elit. Aenean purus turpis, venenatis a ullamcorper nec, tincidunt et massa. Integer posuere quam rutrum arcu vehicula imperdiet. Mauris ullamcorper quam vitae purus congue, quis euismod magna eleifend. Vestibulum semper vel augue eget tincidunt. Fusce eget justo sodales, dapibus odio eu, ultrices lorem. Duis condimentum lorem id eros commodo, in facilisis mauris scelerisque. Morbi sed auctor leo. Nullam volutpat a lacus quis pharetra. Nulla congue rutrum magna a ornare.\nAliquam in turpis accumsan, malesuada nibh ut, hendrerit justo. Cum sociis natoque penatibus et magnis dis parturient montes, nascetur ridiculus mus. Quisque sed erat nec justo posuere suscipit. Donec ut efficitur arcu, in malesuada neque. Nunc dignissim nisl massa, id vulputate nunc pretium nec. Quisque eget urna in risus suscipit ultricies. Pellentesque odio odio, tincidunt in eleifend sed, posuere a diam. Nam gravida nisl convallis semper elementum. Morbi vitae felis faucibus, vulputate orci placerat, aliquet nisi. Aliquam erat volutpat. Maecenas sagittis pulvinar purus, sed porta quam laoreet at.\n","date":1557010800,"expirydate":-62135596800,"kind":"page","lang":"ja","lastmod":1557010800,"objectID":"1c2b5a11257c768c90d5050637d77d6a","permalink":"/courses/example/example2/","publishdate":"2019-05-05T00:00:00+01:00","relpermalink":"/courses/example/example2/","section":"courses","summary":"Here are some more tips for getting started with Academic:\nTip 3 Lorem ipsum dolor sit amet, consectetur adipiscing elit. Duis posuere tellus ac convallis placerat. Proin tincidunt magna sed ex sollicitudin condimentum.","tags":null,"title":"Example Page 2","type":"docs"},{"authors":[],"categories":null,"content":"\rClick on the Slides button above to view the built-in slides feature.\r\r\rSlides can be added in a few ways:\n Create slides using Academic\u0026rsquo;s Slides feature and link using slides parameter in the front matter of the talk file Upload an existing slide deck to static/ and link using url_slides parameter in the front matter of the talk file Embed your slides (e.g. Google Slides) or presentation video on this page using shortcodes.  Further talk details can easily be added to this page using Markdown and $\\rm \\LaTeX$ math code.\n","date":1906549200,"expirydate":-62135596800,"kind":"page","lang":"ja","lastmod":1906549200,"objectID":"96344c08df50a1b693cc40432115cbe3","permalink":"/talk/example/","publishdate":"2017-01-01T00:00:00Z","relpermalink":"/talk/example/","section":"talk","summary":"An example talk using Academic's Markdown slides feature.","tags":[],"title":"Example Talk","type":"talk"},{"authors":null,"categories":["å˜ç™º"],"content":"ãŠã¯ã“ã‚“ã°ã‚“ã«ã¡ã¯ã€‚ã‚»ãƒ³ãƒãƒ¡ãƒ³ãƒˆã‚¹ã‚³ã‚¢ç®—å‡ºä¼ç”»ã®ç¬¬3å¼¾ã§ã™ã€‚ ä»Šå›ã¯ãƒŠã‚¤ãƒ¼ãƒ–ãƒ™ã‚¤ã‚ºåˆ†é¡å™¨ã®ã‚»ãƒ³ãƒãƒ¡ãƒ³ãƒˆã‚¹ã‚³ã‚¢ç®—å‡ºæ–¹æ³•ã‚’å®Ÿè·µã—ã¾ã™ã€‚\n1. åˆ†ææ‰‹æ³•ã®èª¬æ˜ ãƒŠã‚¤ãƒ¼ãƒ–ãƒ™ã‚¤ã‚ºåˆ†é¡å™¨ã¨ã¯ ãƒŠã‚¤ãƒ¼ãƒ–ãƒ™ã‚¤ã‚ºåˆ†é¡å™¨ã€ã¾ãŸã¯å˜ç´”ãƒ™ã‚¤ã‚ºåˆ†é¡å™¨ã¨å‘¼ã°ã‚Œã‚‹æ‰‹æ³•ã§ã™ã€‚åˆ†é¡å•é¡Œã‚’ãƒ™ã‚¤ã‚ºã®å®šç†ã‚’ç”¨ã„ã¦è§£ãæ‰‹æ³•ã‚’æŒ‡ã—ã¾ã™ã€‚ã¾ãšã€ãƒ™ã‚¤ã‚ºã®å®šç†ã‹ã‚‰èª¬æ˜ã—ã¾ã™ã€‚å…¥åŠ›æƒ…å ±$X$ãŒä¸ãˆã‚‰ã‚ŒãŸæ™‚ã«ã€å‡ºåŠ›$Y$ãŒå¾—ã‚‰ã‚Œã‚‹ç¢ºç‡ã¯ä»¥ä¸‹ã§è¡¨ã™ã“ã¨ãŒã§ãã¾ã™ã€‚\n$$ P(Y|X) = \\frac{P(X|Y)P(Y)}{P(X)} $$\nã“ã‚ŒãŒãƒ™ã‚¤ã‚ºã®å®šç†ã§ã€$P(Y)$ã¯äº‹å‰ç¢ºç‡ã€$P(Y|X)$ã¯äº‹å¾Œç¢ºç‡ã€$P(X|Y)$ã¯å°¤åº¦ã¨å‘¼ã°ã‚Œã¾ã™ã€‚ãƒŠã‚¤ãƒ¼ãƒ–ãƒ™ã‚¤ã‚ºåˆ†é¡å™¨ãŒåˆ©ç”¨ã•ã‚Œã‚‹å…¸å‹çš„ãªå•é¡Œã«è¿·æƒ‘ãƒ¡ãƒ¼ãƒ«ã®åˆ†é¡å•é¡ŒãŒã‚ã‚Šã¾ã™ã€‚ã“ã®å•é¡Œã ã¨ã€$X$ã¯å—ä¿¡ãƒ¡ãƒ¼ãƒ«ã«å«ã¾ã‚Œã¦ã„ã‚‹å˜èªã€$Y$ã¯è¿·æƒ‘ãƒ¡ãƒ¼ãƒ«ã‹ã©ã†ã‹ã‚’è¡¨ã™2å€¤(0,1)ã®ãƒ‡ãƒ¼ã‚¿ã¨ãªã‚Šã¾ã™ã€‚å—ä¿¡ãƒ¡ãƒ¼ãƒ«ã«$\\hat{X}$ã¨ã„ã†å˜èªãŒå«ã¾ã‚Œã¦ã„ã‚‹éš›ã«ã€ãã®ãƒ¡ãƒ¼ãƒ«ãŒè¿·æƒ‘ãƒ¡ãƒ¼ãƒ«($Y=1$)ã§ã‚ã‚‹ç¢ºç‡ã¯$P(Y=1|X=\\hat{X})$ã§ã‚ã‚Šã€ãã‚Œã¯ä»¥ä¸‹ã®3ã¤ã§æ±‚ã‚ã‚‰ã‚Œã¾ã™ã€‚\n è¿·æƒ‘ãƒ¡ãƒ¼ãƒ«ãŒç™ºç”Ÿã™ã‚‹ç¢ºç‡$P(Y=1)$ ãã®ãƒ¡ãƒ¼ãƒ«ãŒè¿·æƒ‘ãƒ¡ãƒ¼ãƒ«ã ã£ãŸéš›ã«å˜èª$\\hat{X}$ãŒå«ã¾ã‚Œã¦ã„ã‚‹ç¢ºç‡$P(X=\\hat{X}|Y=1)$ å˜èª$\\hat{X}$ãŒç™ºç”Ÿã™ã‚‹ç¢ºç‡$P(X=\\hat{X})$  ãŸã ã—ã€äº‹å¾Œç¢ºç‡ã«ã‚ˆã£ã¦æ–‡æ›¸åˆ†é¡ã‚’è¡Œã†éš›ã«ã¯ã€ä¸Šå¼ã®ç¢ºç‡ã‚’è¨ˆç®—ã™ã‚‹å¿…è¦ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚çŸ¥ã‚ŠãŸã„ã®ã¯ç¢ºç‡ã®å€¤ã§ã¯ãªãã€ã‚ã‚‹$X$ãŒä¸ãˆã‚‰ã‚ŒãŸæ™‚ã«$P(Y=1|X)$ã¨$P(Y=0|X)$ã®ã©ã¡ã‚‰ãŒå¤§ãã„ã‹ã§ã™ã®ã§ã€å…±é€šã—ã¦ã„ã‚‹åˆ†æ¯ã¯è¨ˆç®—ã‹ã‚‰é™¤å¤–ã™ã‚‹ã“ã¨ãŒã§ãã€åˆ†å­$P(X|Y)P(Y)$ã‚’ãã‚Œãã‚Œè¨ˆç®—ã—ã€ãã®å¤§å°é–¢ä¿‚ã«ã‚ˆã£ã¦è¿·æƒ‘ãƒ¡ãƒ¼ãƒ«ã‹ã©ã†ã‹ã‚’å‰²ã‚ŠæŒ¯ã‚Œã°ã‚ˆã„ã“ã¨ã«ãªã‚Šã¾ã™ã€‚\nã¾ãŸã€ä¸Šè¨˜ã¯è¿·æƒ‘ãƒ¡ãƒ¼ãƒ«ã®åˆ†é¡ã«é™ã‚‰ãšã€ä»Šå›è¡ŒãŠã†ã¨ã—ã¦ã„ã‚‹ã‚»ãƒ³ãƒãƒ¡ãƒ³ãƒˆæƒ…å ±ã€ã¤ã¾ã‚Šãã®æ–‡æ›¸å†…å®¹ãŒãƒã‚¸ãƒ†ã‚£ãƒ–ã‹ãƒã‚¬ãƒ†ã‚£ãƒ–ã‹ã‚’åˆ†é¡ã™ã‚‹å•é¡Œã«å¯¾ã—ã¦ã‚‚ä½¿ãˆã‚‹ã“ã¨ãŒã‚ã‹ã‚‹ã¨æ€ã„ã¾ã™ã€‚\näº‹å¾Œç¢ºç‡ã®æ¨å®šæ–¹æ³• æ±‚ã‚ãŸã„äº‹å¾Œç¢ºç‡ã®åˆ†å­ã‚’æ±‚ã‚ã‚‹æ–¹æ³•ã«ã¤ã„ã¦èª¬æ˜ã—ã¾ã™ã€‚ãã®è¨ˆç®—ã®ãŸã‚ã«ã¯äº‹å‰ç¢ºç‡$P(Y)$ã¨å°¤åº¦$P(Y|X)$ã‚’æ±‚ã‚ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ãŒã€åŸºæœ¬çš„ã«ãã‚Œãã‚Œã«ãƒ‘ãƒ©ãƒ¡ãƒˆãƒªãƒƒã‚¯ãªç¢ºç‡åˆ†å¸ƒã‚’ä»®å®šã™ã‚‹ãŸã‚ã€ç¢ºç‡åˆ†å¸ƒã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’æ¨å®šã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚ãªãŠã€äº‹å‰ç¢ºç‡ãŒå¾“ã†ç¢ºç‡åˆ†å¸ƒã‚’äº‹å‰åˆ†å¸ƒã¨å‘¼ã³ã¾ã™ã€‚\nå…¥åŠ›å˜èªãƒ™ã‚¯ãƒˆãƒ«ã‚’$X={x_1,x_2,\u0026hellip;,x_N}$ã¨ã—ã¾ã™ã€‚ã“ã“ã§ã€å„$x_n$ã¯$n$ç•ªç›®ã®å˜èªã‚’è¡¨ã—ã¾ã™ã€‚å„$x_n$ãŒç”Ÿèµ·ã™ã‚‹æ¡ä»¶ä»˜ç¢ºç‡ã¯èªé †ã‚„å‘¨è¾ºã®å˜èªã«ä¾å­˜ã—ãªã„ã¨ä»®å®šã™ã‚‹ã¨ã€$P(X|Y)$ã¯ä»¥ä¸‹ã®ã‚ˆã†ã«æ›¸ãæ›¿ãˆã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚\n$$ P(X|Y) = \\Pi_{i=1}^N P(x_i|Y) $$\nã§ã¯ã€ä¸Šè¨˜ã®æ¡ä»¶ä»˜ç¢ºç‡ã‚’ã©ã®ã‚ˆã†ã«æ±‚ã‚ã‚‹ã‹ã«è©±ã‚’ç§»ã—ã¾ã—ã‚‡ã†ã€‚ä»Šã€å­¦ç¿’ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã¨ã—ã¦ã€\n$$ {(S,T)} = (Y=S_1,X=T_1), (Y=S_2,X=T_2), \u0026hellip;,(Y=S_D,X=T_D) $$\nãŒå¾—ã‚‰ã‚Œã¦ã„ã‚‹ã¨ã—ã¾ã™ã€‚ã“ã“ã§ã€$D$ã¯ã‚µãƒ³ãƒ—ãƒ«ã‚µã‚¤ã‚ºã§ã™ã€‚ã¾ãŸã€$Y$ã¯$1$ã®æ™‚ã«ãƒã‚¸ãƒ†ã‚£ãƒ–ã€$0$ã®æ™‚ã«ãƒã‚¬ãƒ†ã‚£ãƒ–ã¨ã—ã€ç‹¬ç«‹ã‚’ä»®å®šã—ã¾ã™(ã¤ã¾ã‚Š$S$ã¯0,1ã®2å€¤ã‚’å–ã‚‹)ã€‚ä»Šã€$P(ãƒ»)$ã«ã¨ã‚ã‚‹ç¢ºç‡åˆ†å¸ƒã‚’ä»®å®šã™ã‚‹ã¨ã€${(S,T)}$ãŒå¾—ã‚‰ã‚ŒãŸã‚‚ã¨ã§ã®äº‹å¾Œåˆ†å¸ƒã¯\n$$ M(\\Theta,\\Phi) = \\Pi_{j=1}^{D}P(T_j;\\Phi,\\Theta|S_j)P(S_j;\\Theta) $$\nã«æ¯”ä¾‹ã—ã¾ã™(ãƒ™ã‚¤ã‚ºã®å®šç†ã®åˆ†å­ã‚’å–ã‚Šå‡ºã—ãŸ)ã€‚ã“ã“ã§ã€$\\Theta={\\theta_1,\\theta2,\u0026hellip;,\\theta_M}, \\Phi={\\phi_1,\\phi_2,\u0026hellip;,\\phi_L}$ã¯äº‹å‰åˆ†å¸ƒã¨å°¤åº¦ã®ç¢ºç‡åˆ†å¸ƒã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã§ã™ã€‚$M(\\Theta,\\Phi)$ã¯ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã«ã‚ˆã£ã¦ã•ã¾ã–ã¾ãªå€¤ã‚’å–ã‚Šã€æœ€ã‚‚æœ›ã¾ã—ã„ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã®å€¤ã‚’ç‰¹å®šã—ã¦ã‚„ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚ã“ã“ã§ã¯ã€$\\Phi$ã¯å­¦ç¿’ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã®äº‹å¾Œåˆ†å¸ƒã‚’æœ€å¤§ã«ã™ã‚‹ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’æ¨å®šå€¤ã¨ã—ã¦é¸æŠã™ã‚‹ã“ã¨ã«ã—ã€$\\Theta$ã¯äº‹å‰ã«ã‚ã‹ã£ã¦ã„ã‚‹çŸ¥è­˜ã‚’ç”¨ã„ã¦ä½•ã‚‰ã‹ã®å€¤ã‚’å®šã‚ã¾ã™ã€‚$M(\\Theta,\\Phi)$ã¯ä»¥ä¸‹ã®ã‚ˆã†ã«å¤‰å½¢ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚\n\r$$\r\\begin{eqnarray*}\rM(\\Theta,\\Phi) \u0026=\u0026 P(T_1;\\Theta|0)P(0;\\Theta,\\Phi)Ã—P(T_2;\\Theta|0)P(0;\\Theta,\\Phi)Ã—...\\\\\r\u0026\u0026Ã—P(T_Q;\\Theta|0)P(0;\\Theta,\\Phi)Ã—P(T_{Q+1};\\Theta|1)P(1;\\Theta,\\Phi) \\\\\r\u0026=\u0026 \\Pi_{k=0}^1P(k;\\Theta,\\Phi)\\Pi_{i=1}^{Q_k}P(T_{Q_i};\\Theta|k)\r\\end{eqnarray*}\r$$\r\rã“ã“ã§ã€$Q_k$ã¯$Y=k$ã¨ãªã‚‹å­¦ç¿’ãƒ‡ãƒ¼ã‚¿ã®å€‹æ•°ã‚’è¡¨ã—ã¦ã„ã¾ã™ã€‚\n\\(\\Theta,\\Phi\\)ãŒæ—¢çŸ¥ã§ã€å­¦ä¿®ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆ${(S,T)}$ãŒæ‰‹å…ƒã«ã‚ã‚Œã°ã€ä¸Šè¨˜ã«ã‚ˆã£ã¦äº‹å¾Œç¢ºç‡ã®åˆ†å­ã‚’è¨ˆç®—ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚\nç¢ºç‡åˆ†å¸ƒã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã®æ¨å®šæ–¹æ³• æ¬¡ã«æ°—ã«ãªã‚‹ã®ã¯$\\Theta, \\Phi$ã‚’ã©ã®ã‚ˆã†ã«ã—ã¦è¨ˆç®—ã™ã‚‹ã‹ã§ã™ã€‚ã“ã‚Œã¯ç¢ºç‡åˆ†å¸ƒã‚’ç‰¹å®šã—ãªã„ã¨é€²ã‚ãªã„ãŸã‚ã€å°¤åº¦ã«ã¯å¤šé …åˆ†å¸ƒã€äº‹å‰åˆ†å¸ƒã«ã¯ãƒ‡ã‚£ãƒªã‚¯ãƒ¬åˆ†å¸ƒã‚’ä»®å®šã—ã¾ã™ã€‚ä¸€èˆ¬çš„ãªä»®å®šã ã¨æ€ã„ã¾ã™ã€‚å¤šé …åˆ†å¸ƒã¨ã¯åŒæ™‚ç¢ºç‡é–¢æ•°ãŒä»¥ä¸‹ã®ã‚ˆã†ãªç¢ºç‡åˆ†å¸ƒã§ã™ã€‚\n$$ P(n_1,\u0026hellip;,n_k) = \\frac{n!}{n_1!\u0026hellip;n_k!}p_1^{n_1}\u0026hellip;p_k^{n_k} $$\nã“ã“ã§ã€$n_i$ã¯éè² ã§$n=n_1+\u0026hellip;+n_k$ã§ã™ã€‚ã¾ãŸã€$p_1+\u0026hellip;p_k=1$ã‚’æº€ãŸã—ã¾ã™ã€‚å¤šé …åˆ†å¸ƒã¯åå‰ã‹ã‚‰åˆ†ã‹ã‚‹ã¨ãŠã‚Šã€äºŒé …åˆ†å¸ƒã®æ‹¡å¼µç‰ˆã§ã™ã€‚äºŒé …åˆ†å¸ƒã¯ã‚³ã‚¤ãƒ³æŠ•ã’ãŒä¾‹ã¨ã—ã¦ä½¿ã‚ã‚Œã¾ã™ãŒã€å¤šé …åˆ†å¸ƒã¯ã‚µã‚¤ã‚³ãƒ­æŠ•ã’ãŒå¾“ã†åˆ†å¸ƒã§ã™($n=6, p_i=1/6$)ã€‚ãƒ†ã‚­ã‚¹ãƒˆè§£æã®æ–‡è„ˆã§ã¯ã€$n_i$ã¯æ–‡ç« ã«å«ã¾ã‚Œã‚‹å˜èª$i$ã®å‡ºç¾å›æ•°ã«ãªã‚Šã¾ã™ã€‚\nãƒ‡ã‚£ãƒªã‚¯ãƒ¬åˆ†å¸ƒã¯åŒæ™‚ç¢ºç‡å¯†åº¦é–¢æ•°ãŒä»¥ä¸‹ã®ã‚ˆã†ãªç¢ºç‡åˆ†å¸ƒã§ã™ã€‚\n$$ f(x_1,\u0026hellip;,x_n) = \\frac{\\Gamma(\\alpha)}{\\Gamma(\\alpha_1)\u0026hellip;\\Gamma(\\alpha_n)}x_1^{\\alpha_1-1}\u0026hellip;x_n^{\\alpha_n-1} $$\nã“ã“ã§ã€$x_i$ã¯éè² ã§$x_1+\u0026hellip;+x_n=1$ã€$\\alpha_1+\u0026hellip;+\\alpha_n=\\alpha$ã¯ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã§ã™ã€‚ä»Šã€$\\alpha_i$ã‚’æ­£ã®æ•´æ•°ã¨ã™ã‚‹ã¨$\\Gamma(\\alpha_i)=(\\alpha_{i-1})!$ã‚ˆã‚Šã€\n$$ f(x_1,\u0026hellip;,x_n) = \\frac{(\\alpha-1)!}{(\\alpha_{1}-1)!\u0026hellip;(\\alpha_n-1)!}x_1^{\\alpha_1-1}\u0026hellip;x_n^{\\alpha_n-1} $$\nã¨ãªã‚Šã¾ã™ã€‚å¤šé …åˆ†å¸ƒã¨ãƒ‡ã‚£ãƒªã‚¯ãƒ¬åˆ†å¸ƒã®ç¢ºç‡åˆ†å¸ƒã‚’è¦‹æ¯”ã¹ã‚‹ã¨ã€ã¨ã¦ã‚‚ä¼¼ãŸå½¢ã§ã‚ã‚‹ã“ã¨ãŒã‚ã‹ã‚Šã¾ã™ã€‚ä¸¡è€…ã¯å½¢ã¯ä¼¼ã¦ã„ã¾ã™ãŒã€é–¢æ•°ã®å…¥åŠ›ãŒç•°ãªã‚Šã¾ã™ã€‚å¤šé …åˆ†å¸ƒã¯å„å˜èªã®ç”Ÿèµ·ç¢ºç‡ãŒãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã€æŒ‡æ•°éƒ¨åˆ†ã®å‡ºç¾å›æ•°ãŒå…¥åŠ›ã§ã‚ã‚‹ä¸€æ–¹ã€ãƒ‡ã‚£ãƒªã‚¯ãƒ¬åˆ†å¸ƒã¯ç”Ÿèµ·ç¢ºç‡ãŒå…¥åŠ›ã€å‡ºç¾å›æ•°ãŒãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã«ãªã‚Šã¾ã™ã€‚ã¾ãŸã€ãƒ‡ã‚£ãƒªã‚¯ãƒ¬åˆ†å¸ƒã¯å¤šé …åˆ†å¸ƒã®å…±å½¹äº‹å‰åˆ†å¸ƒã¨ãªã£ã¦ã„ã¾ã™ã€‚ ã“ã‚Œã‚‰ã®ç¢ºç‡åˆ†å¸ƒã‚’ä»®å®šã™ã‚‹ã¨ã€$M(\\Theta,\\Phi)$ã¯ä»¥ä¸‹ã®ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚\n\r$$\r\\begin{eqnarray*}\rM(\\vec{\\alpha};\\vec{p}) \u0026\\propto\u0026 \\frac{1}{Z(\\vec{\\alpha})}\\Pi_{k=0}^1\\Pi_{i=1}^Vp_{ki}^{\\alpha_{i}-1}\\Pi_{j=1}^V p_{k_{j}}^{\\tau_{k_{j}}} \\\\\r\u0026=\u0026 \\frac{1}{Z(\\vec{\\alpha})}\\Pi_{k=0}^1 \\Pi_{j=1}^V p_{k_{j}}^{\\tau_{k_{j}}+\\alpha_j-1}\r\\end{eqnarray*}\r$$\r\rã“ã“ã§ã€$p_{k_j}$ã¯ãƒã‚¸ãƒ†ã‚£ãƒ–(ã¾ãŸã¯ãƒã‚¬ãƒ†ã‚£ãƒ–)ã§ã‚ã‚‹æ–‡æ›¸ã§å˜èª$j$ãŒå‡ºç¾ã™ã‚‹ç¢ºç‡ã€$\\tau_{k_j}=\\sum_{i=1}^{Q_k}c_{kij}$ã¯ãƒã‚¸ãƒ†ã‚£ãƒ–(ã¾ãŸã¯ãƒã‚¬ãƒ†ã‚£ãƒ–)ã§ã‚ã‚‹æ•™å¸«ãƒ‡ãƒ¼ã‚¿ã«å«ã¾ã‚Œã‚‹å˜èª$j$ã®ç·æ•°ã€$\\alpha_j$ã¯å˜èª$j$ã®ãƒ‡ã‚£ãƒªã‚¯ãƒ¬åˆ†å¸ƒã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã€$V$ã¯å˜èªæ•°ã®ä¸Šé™ã‚’è¡¨ã—ã¦ã„ã¾ã™ã€‚$Z(\\vec{\\alpha})$ã¯ç¢ºç‡ã®ç·å’Œã‚’1ã¨ã™ã‚‹ãŸã‚ã®æ­£è¦åŒ–å®šæ•°ã§ã€ãƒ™ã‚¤ã‚ºçµ±è¨ˆå­¦ã§ã¯åˆ†é…é–¢æ•°ã¨å‘¼ã°ã‚Œã¾ã™ã€‚ã“ã“ã‹ã‚‰ã€ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿$p_{k_{j}}$ã®å€¤ã‚’å­¦ç¿’ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã®äº‹å¾Œåˆ†å¸ƒã‚’æœ€å¤§ã«ã™ã‚‹ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’æ¨å®šå€¤ã¨ã—ã¦æ±‚ã‚ã¾ã™ã€‚ãŸã ã—ã€ä»¥ä¸‹ã®åˆ¶ç´„æ¡ä»¶ãŒã‚ã‚Šã¾ã™ã€‚\n$$ \\sum_{j=1}^V p_{k_{j}}=1 $$\nã“ã®åˆ¶ç´„ã®ä¸‹ã§$M(\\vec{p};\\vec{\\alpha})$ã‚’æœ€å¤§åŒ–ã™ã‚‹ãŸã‚ã«ãƒ©ã‚°ãƒ©ãƒ³ã‚¸ãƒ¥æœªå®šä¹—æ•°æ³•ã‚’ä½¿ç”¨ã—ã¾ã™ã€‚\n\r$$\r\\begin{eqnarray*}\rL \u0026=\u0026 (\\frac{1}{Z(\\vec{\\alpha})}\\Pi_{k=0}^1 \\Pi_{j=1}^V p_{k_{j}}^{\\tau_{k_{j}}+\\alpha_j-1}-\\lambda(1-\\sum_{k=1}^V p_{k_{j}})) \\\\\r\\frac{\\partial L}{\\partial p_{l_m}}\r\u0026=\u0026 (\\tau_{l_m}+\\alpha_m-1)p_{l_m}^{\\tau_{l_m}+\\alpha_m-2}\\frac{1}{Z(\\vec{\\alpha})}\\Pi_{k\\neq l}^1 \\Pi_{j\\neq m}^V p_{k_{j}}^{\\tau_{k_{j}}+\\alpha_j-1}-\\lambda \\\\\r\u0026=\u0026 (\\tau_{l_m}+\\alpha_m-1)p_{l_m}^{-1}\\frac{1}{Z(\\vec{\\alpha})}\\Pi_{k=0}^1 \\Pi_{j=1}^V p_{k_{j}}^{\\tau_{k_{j}}+\\alpha_j-1}-\\lambda \\\\\rp_{l_m} \u0026=\u0026 \\frac{(\\tau_{l_m}+\\alpha_m-1)}{\\lambda}\\frac{1}{Z(\\vec{\\alpha})}\\Pi_{k=0}^1 \\Pi_{j=1}^V p_{k_{j}}^{\\tau_{k_{j}}+\\alpha_j-1} \\tag{1}\r\\end{eqnarray*}\r$$\r\rä¸Šè¨˜ã®ã‚ˆã†ã«è§£ã‘ã¾ã™ã€‚ã“ã“ã§ã€åˆ¶ç´„æ¡ä»¶ã‚’ç”¨ã„ã¦ä¸Šå¼ã®ä¸¡è¾ºã§ç·å’Œã‚’å–ã‚‹ã¨ã€\r\r$$\r\\begin{eqnarray*}\r1 \u0026=\u0026 \\sum_{m=1}^V \\frac{(\\tau_{l_m}+\\alpha_m-1)}{\\lambda}\\frac{1}{Z(\\vec{\\alpha})}\\Pi_{k=0}^1 \\Pi_{j=1}^V p_{k_{j}}^{\\tau_{k_{j}}+\\alpha_j-1} \\\\\r\\lambda \u0026=\u0026 \\sum_{m=1}^V (\\tau_{l_m}+\\alpha_m-1)\\frac{1}{Z(\\vec{\\alpha})}\\Pi_{k=0}^1 \\Pi_{j=1}^V p_{k_{j}}^{\\tau_{k_{j}}+\\alpha_j-1}\r\\end{eqnarray*}\r$$\r\rã¨ãªã‚‹ã®ã§ã€$\\lambda$ã‚’(1)å¼ã«ä»£å…¥ã™ã‚‹ã¨ã€\n$$ p_{l_m} = \\frac{(\\tau_{l_m}+\\alpha_m-1)}{\\sum_{m=1}^V (\\tau_{l_m}+\\alpha_m-1)} \\tag{2} $$\nã¨ã€äº‹å¾Œåˆ†å¸ƒã‚’æœ€å¤§ã«ã™ã‚‹ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’æ±‚ã‚ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚$p_{l_m}$ã®ç›´æ„Ÿçš„ãªè§£é‡ˆã¯ã€ãƒã‚¸ãƒ†ã‚£ãƒ–(ãƒã‚¬ãƒ†ã‚£ãƒ–)ãªæ–‡è„ˆã§ã®å˜èª$m$ã®å‡ºç¾é »åº¦ãŒå…¨ã¦ã®å˜èªã®å‡ºç¾é »åº¦ã«å ã‚ã‚‹å‰²åˆã§ã™ã€‚ãŸã ã€ãã‚Œã ã‘ã ã¨å­¦ç¿’ãƒ‡ãƒ¼ã‚¿ã«å«ã¾ã‚Œãªã„å˜èªã®$p_{l_m}$ãŒï¼ã¨ãªã£ã¦ã—ã¾ã„ã€äº‹å¾Œç¢ºç‡ã‚‚0ã¨ãªã£ã¦ã—ã¾ã„ã¾ã™ã€‚ä¸Šè¨˜ã§ã¯ã€äº‹å‰åˆ†å¸ƒã«ãƒ‡ã‚£ãƒªã‚¯ãƒ¬åˆ†å¸ƒã‚’ä½¿ç”¨ã—ã¦ã„ã‚‹ãŸã‚ã€$p_{l_m}$ãŒ0ã«ãªã‚‰ãªã„ã“ã¨ãŒã‚ã‹ã‚Šã¾ã™($+\\alpha_m$ã®éƒ¨åˆ†)ã€‚æ‰€è¬‚ã€é »åº¦ã‚¼ãƒ­å•é¡Œã‚’è§£æ±ºã—ã¦ã„ã¾ã™ã€‚\nã¨ã“ã‚ã§ã€ãƒ‡ã‚£ãƒªã‚¯ãƒ¬åˆ†å¸ƒã®$\\alpha_m$ã¯äº‹å‰ã«ã‚ã‹ã£ã¦ã„ã‚‹çŸ¥è­˜ã‚’ç”¨ã„ã¦ä½•ã‚‰ã‹ã®å€¤ã‚’å®šã‚ã‚‹ã¨è¨€ã£ã¦ã„ã¾ã—ãŸãŒã€ã©ã®ã‚ˆã†ã«ã—ã¦æ±‚ã‚ã‚‹ã®ã§ã—ã‚‡ã†ã‹ï¼Ÿæ¨å®šå€¤ã‚’è¦‹ã‚Œã°ã‚ã‹ã‚‹é€šã‚Šã€$\\alpha_m$ã¯æ–‡æ›¸å†…ã«ãŠã‘ã‚‹å˜èª$m$ã®ä¸»è¦³çš„ãªå‡ºç¾é »åº¦ã‚’è¡¨ã—ã¦ã„ã‚‹ã¨è§£é‡ˆã§ãã¾ã™ã€‚ã§ã™ãŒã€æ­£ç›´$\\alpha_m$ã«æ„å‘³ã‚’æŒãŸã›ã¦ã„ã‚‹äººã¯å°‘ãªãã€å…ˆè¿°ã—ãŸé »åº¦ã‚¼ãƒ­å•é¡Œã‚’è§£æ±ºã§ãã‚Œã°ã‚ˆã„ã¨è€ƒãˆã¦ã„ã‚‹äººãŒå¤§åŠã§ã¯ãªã„ã§ã—ã‚‡ã†ã‹ã€‚ã¤ã¾ã‚Šã€$\\alpha_m=\\alpha+1$($\\alpha$ã¯å®šæ•°ã€ä¾‹ãˆã°1ã¨ã‹)ã¨ã—ã¦ã—ã¾ã†ã¨ã„ã†ã“ã¨ã§ã™ã€‚ã“ã‚Œã¯åŠ ç®—ã‚¹ã‚¯ãƒªãƒ¼ãƒ‹ãƒ³ã‚°ã¨å‘¼ã°ã‚Œã¾ã™ã€‚\nã•ã¦ã€ã“ã®ã‚ˆã†ã«ã—ã¦æ±‚ã‚ãŸåˆ†é¡å™¨ã§åˆ†é¡ã‚’è¡Œã„ã¾ã™ã€‚æ€è€ƒå®Ÿé¨“ã¨ã—ã¦ã€1ã¤ã®å˜èªã‚’é™¤ã„ã¦ä»–ã®å˜èªãŒãƒ‹ãƒ¥ãƒ¼ãƒˆãƒ©ãƒ«ã‹ã¤å„å˜èªã®å‡ºç¾é »åº¦ãŒå…¨ã¦åŒã˜æ–‡æ›¸ã‚’è€ƒãˆã¾ã™ã€‚ã“ã®å ´åˆã€ãã®1ã¤ã®å˜èªãŒä¸¡æ–‡è„ˆ(ãƒã‚¸ãƒ†ã‚£ãƒ–/ãƒã‚¬ãƒ†ã‚£ãƒ–)ã®ã†ã¡ç›¸å¯¾çš„ã«é »å‡ºã§ã‚ã‚‹æ–‡è„ˆã¸åˆ†é¡ã•ã‚Œã‚‹ã“ã¨ã«ãªã‚Šã¾ã™ã€‚\nãƒŠã‚¤ãƒ¼ãƒ–ãƒ™ã‚¤ã‚ºåˆ†é¡å™¨ã¯æ•™å¸«ã‚ã‚Šå­¦ç¿’ã§ã™ã€‚ã¤ã¾ã‚Šã€æ­£è§£ãƒ©ãƒ™ãƒ«ãƒ‡ãƒ¼ã‚¿ã‚’ç”¨æ„ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚ã“ã‚ŒãŒãƒŠã‚¤ãƒ¼ãƒ–ãƒ™ã‚¤ã‚ºåˆ†é¡å™¨ã®æ¬ ç‚¹ã§ã™ãŒã€ä¸€æ–¹ã§ãƒ‡ãƒ¼ã‚¿ãŒã‚ã‚‹å ´åˆã«ã¯ç‰¹æ®Šãªæ–‡è„ˆã§ã‚‚åˆ†é¡ãŒå¯èƒ½ã§ã™ã€‚\nãƒŠã‚¤ãƒ¼ãƒ–ãƒ™ã‚¤ã‚ºåˆ†é¡å™¨ã®åˆ©ç‚¹ãƒ»æ¬ ç‚¹ ãƒŠã‚¤ãƒ¼ãƒ–ãƒ™ã‚¤ã‚ºåˆ†é¡å™¨ã®åˆ©ç‚¹ãƒ»æ¬ ç‚¹ã¯ä»¥ä¸‹ã®ã‚ˆã†ãªã‚‚ã®ã ã¨æ€ã„ã¾ã™ã€‚\n\u0026lt;åˆ©ç‚¹ğŸ‘\u0026gt;\n è¾æ›¸ãŒä¸è¦ æœªçŸ¥èªãŒå‡ºç¾ã—ã¦ã‚‚åˆ†é¡ã§ãã‚‹ åˆ†é¡éç¨‹ãŒã‚ã‹ã‚Šã‚„ã™ã„  \u0026lt;æ¬ ç‚¹ğŸ‘\u0026gt;\n å­¦ç¿’ã®ãŸã‚ã®æ•™å¸«ã‚ã‚Šãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆãŒå¿…è¦ æ–‡ç« ã®èªé †ã‚’è€ƒæ…®ã§ããªã„(bag of words)  æ¬ ç‚¹ã®æ–‡ç« ã®èªé †ã‚’è€ƒæ…®ã§ããªã„ã¨ã„ã†ç‚¹ã¯è¾æ›¸ãƒ™ãƒ¼ã‚¹æ‰‹æ³•ã«ã‚‚å½“ã¦ã¯ã¾ã‚Šã¾ã™ãŒã€æ–‡ç« ä¸­ã®å˜èªã®ç™ºç”Ÿå›æ•°ã‚’ä½¿ç”¨ã—ã¦ã„ã‚‹ãŸã‚ã€èªé †ã®é–¢ä¿‚æ€§ã‚„ä¿‚ã‚Šå—ã‘ã¨ã„ã£ãŸæƒ…å ±ã‚’æ´»ç”¨ã™ã‚‹ã“ã¨ãŒã§ãã¾ã›ã‚“ã€‚ãã®ãŸã‚ã€ä¾‹ãˆã°ã€Œè‰¯ããªã„ã€ã®ã‚ˆã†ãªè‚¯å®šèªã‚’å¦å®šã™ã‚‹ã‚ˆã†ãªè¨€ã„å›ã—ã¯ã€ãƒã‚¸ãƒ†ã‚£ãƒ–ã¨åˆ†é¡ã•ã‚Œã‚„ã™ã„å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚\n2. ãƒŠã‚¤ãƒ¼ãƒ–ãƒ™ã‚¤ã‚ºåˆ†é¡å™¨ã®å®Ÿè·µ ","date":1648166400,"expirydate":-62135596800,"kind":"page","lang":"ja","lastmod":1648166400,"objectID":"85e9818128d6ca566d054b79c5c25eca","permalink":"/post/post28/","publishdate":"2022-03-25T00:00:00Z","relpermalink":"/post/post28/","section":"post","summary":"ãƒŠã‚¤ãƒ¼ãƒ–ãƒ™ã‚¤ã‚ºåˆ†é¡å™¨ã‚’ç”¨ã„ãŸã‚»ãƒ³ãƒãƒ¡ãƒ³ãƒˆã‚¹ã‚³ã‚¢ã®ç®—å‡ºã‚’å®Ÿè·µã—ã¾ã™ï¼","tags":["Python","å‰å‡¦ç†","æ©Ÿæ¢°å­¦ç¿’","ãƒ†ã‚­ã‚¹ãƒˆè§£æ"],"title":"ã€å¾¹åº•æ¯”è¼ƒã€‘ã‚»ãƒ³ãƒãƒ¡ãƒ³ãƒˆã‚¹ã‚³ã‚¢ç®—å‡ºæ‰‹æ³•ï¼ï¼ - ç¬¬3å›","type":"post"},{"authors":null,"categories":["å˜ç™º"],"content":"\r\r\r\r\r\rãŠã¯ã“ã‚“ã°ã‚“ã«ã¡ã¯ã€‚ã‚»ãƒ³ãƒãƒ¡ãƒ³ãƒˆã‚¹ã‚³ã‚¢ç®—å‡ºä¼ç”»ã®ç¬¬2å¼¾ã§ã™ã€‚ ä»Šå›ã¯è¾æ›¸ãƒ™ãƒ¼ã‚¹ã®ã‚»ãƒ³ãƒãƒ¡ãƒ³ãƒˆã‚¹ã‚³ã‚¢ç®—å‡ºæ–¹æ³•ã‚’å®Ÿè·µã—ã¾ã™ã€‚\n1. åˆ†ææ‰‹æ³•ã®èª¬æ˜ è¾æ›¸ãƒ™ãƒ¼ã‚¹æ‰‹æ³•ã¨ã¯ è¾æ›¸ãƒ™ãƒ¼ã‚¹æ‰‹æ³•ã¯ãã®åã®é€šã‚Šã€è¾æ›¸ã‚’ç”¨ã„ã¦ã‚»ãƒ³ãƒãƒ¡ãƒ³ãƒˆã‚¹ã‚³ã‚¢ã‚’ç®—å‡ºã™ã‚‹æ‰‹æ³•ã§ã™ã€‚å„å˜èªãŒæŒã¤æ„Ÿæƒ…æ¥µæ€§(ã“ã“ã§ã¯ã€ãƒã‚¸ãƒ†ã‚£ãƒ–ãªæ„å‘³ã‹ãƒã‚¬ãƒ†ã‚£ãƒ–ãªæ„å‘³ã‹ã‚’è¡¨ã™)ã‚’ã‚¹ã‚³ã‚¢åŒ–ã—ãŸã‚‚ã®ã‚’ã‚ã‚‰ã‹ã˜ã‚è¾æ›¸ã¨ã—ã¦ä¿å­˜ã—ã€æ–‡æ›¸å†…ã§å‡ºç¾ã—ãŸå˜èªã¨ãã‚Œãã‚Œã®è¾æ›¸ã‚¹ã‚³ã‚¢ã‚’ç´ä»˜ã‘ã€(ä½•ã‚‰ã‹ã®æ–¹æ³•ã§)é›†è¨ˆã™ã‚‹ã“ã¨ã§ã€ãã®æ–‡æ›¸å…¨ä½“ã®ã‚»ãƒ³ãƒãƒ¡ãƒ³ãƒˆã‚¹ã‚³ã‚¢ã‚’ç®—å‡ºã—ã¾ã™ã€‚\nã‚»ãƒ³ãƒãƒ¡ãƒ³ãƒˆã‚¹ã‚³ã‚¢ã‚’å‚ç…§ã™ã‚‹è¾æ›¸ ä¸Šè¨˜ã«ãŠã„ã¦ã¯ã€ã‚¹ã‚³ã‚¢ã‚’ã©ã®ã‚ˆã†ã«ç®—å‡ºã™ã‚‹ã®ã‹ãŒé‡è¦ã«ãªã‚Šã¾ã™ã€‚ç¾åœ¨å…¬é–‹ã•ã‚Œã¦ã„ã‚‹æ—¥æœ¬èªè¾æ›¸ã®ä¸­ã§æœ‰åãªæ±äº¬å·¥æ¥­å¤§å­¦ã®é«˜æ‘ç ”ç©¶å®¤ãŒä½œæˆã—ãŸè¾æ›¸(Takamura, Inui, and Okumura 2005)ã§ã¯ä»¥ä¸‹ã®ã‚ˆã†ãªæ–¹æ³•ã§ç®—å‡ºã‚’è¡Œã£ã¦ã„ã‚‹ã‚ˆã†ã§ã™(åŸå…¸ã¯ã“ã¡ã‚‰)ã€‚\n ã¾ãšï¼Œè¾æ›¸ï¼Œã‚·ã‚½ãƒ¼ãƒ©ã‚¹ï¼ˆé¡ç¾©èªè¾å…¸ï¼‰ï¼Œã‚³ãƒ¼ãƒ‘ã‚¹ãƒ‡ãƒ¼ã‚¿ã‚’ç”¨ã„ã¦ï¼Œæ¥µæ€§ãŒåŒã˜ã«ãªã‚Šã‚„ã™ã„å˜èªãƒšã‚¢ã‚’æŠ½å‡ºã—ï¼Œãã—ã¦ãã‚Œã‚‰ã®ãƒšã‚¢ã‚’é€£çµã™ã‚‹ã“ã¨ã«ã‚ˆã‚Šå·¨å¤§ãªèªå½™ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚’æ§‹ç¯‰ã—ã¾ã™ï¼ãŸã¨ãˆã°ï¼Œã€Œè‰¯ã„ã€ã¨ã€Œè‰¯å¥½ã€ãŒé¡ç¾©èªé–¢ä¿‚ã«ã‚ã‚‹ã®ã§ï¼Œã“ã®äºŒå˜èªã‚’çµã¶ãªã©ã®ä½œæ¥­ã‚’è¡Œã„ã¾ã™ï¼ã“ã“ã§ï¼Œå˜èªã®æ„Ÿæƒ…æ¥µæ€§ã‚’é›»å­ã‚¹ãƒ”ãƒ³ã®æ–¹å‘ã¨ã¿ãªã—ï¼Œèªå½™ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚’ã‚¹ãƒ”ãƒ³ç³»ã¨ã¿ãªã—ã¦ï¼Œèªå½™ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã®çŠ¶æ…‹ï¼ˆå„ã‚¹ãƒ”ãƒ³ãŒã©ã®æ–¹å‘ã‚’å‘ã„ã¦ã„ã‚‹ã‹ï¼‰ã‚’è¨ˆç®—ã—ã¾ã™ï¼ã“ã®è¨ˆç®—çµæœã‚’è¦‹ã‚‹ã“ã¨ã«ã‚ˆã‚Šï¼Œå˜èªã®æ„Ÿæƒ…æ¥µæ€§ãŒã‚ã‹ã‚‹ã®ã§ã™ï¼\n ã“ã¡ã‚‰ã®è¾æ›¸ã¯HPã§å…¬é–‹ã•ã‚Œã¦ãŠã‚Šã€éå–¶åˆ©ç›®çš„ã§ã‚ã‚Œã°åˆ©ç”¨ãŒå¯èƒ½ã®ã‚ˆã†ã§ã™ã€‚ã¡ã‚‡ã£ã¨è¦—ã„ã¦ã¿ã¾ã—ã‚‡ã†ã€‚\n## å˜èª èª­ã¿ä»®å å“è© æ„Ÿæƒ…æ¥µæ€§ã‚¹ã‚³ã‚¢\r## 1 å„ªã‚Œã‚‹ ã™ãã‚Œã‚‹ å‹•è© 1.000000\r## 2 è‰¯ã„ ã‚ˆã„ å½¢å®¹è© 0.999995\r## 3 å–œã¶ ã‚ˆã‚ã“ã¶ å‹•è© 0.999979\r## 4 è¤’ã‚ã‚‹ ã»ã‚ã‚‹ å‹•è© 0.999979\r## 5 ã‚ã§ãŸã„ ã‚ã§ãŸã„ å½¢å®¹è© 0.999645\r## 6 è³¢ã„ ã‹ã—ã“ã„ å½¢å®¹è© 0.999486\r ã‚»ãƒ³ãƒãƒ¡ãƒ³ãƒˆã‚¹ã‚³ã‚¢ã¯1ã‹ã‚‰-1ã¾ã§ã‚’å–ã‚Šã€1ã«è¿‘ã„ã»ã©ãƒã‚¸ãƒ†ã‚£ãƒ–ã‚’è¡¨ã—ã¾ã™ã€‚æœ€ã‚‚ãƒã‚¸ãƒ†ã‚£ãƒ–ãªå˜èªã¯ã€Œå„ªã‚Œã‚‹ã€ã¨ãªã£ã¦ã„ã‚‹ã“ã¨ãŒã‚ã‹ã‚Šã¾ã™ã€‚\nè¾æ›¸ãƒ™ãƒ¼ã‚¹æ‰‹æ³•ã®åˆ©ç‚¹ãƒ»æ¬ ç‚¹ \u0026lt;åˆ©ç‚¹\u0026gt;æ‰‹æ³•ã®ã‚ã‹ã‚Šã‚„ã™ã•/æ•™å¸«ãƒ‡ãƒ¼ã‚¿ãŒä¸è¦ğŸ‘\nè¾æ›¸ã‚’åˆ©ç”¨ã™ã‚‹è‰¯ã„ç‚¹ã¯ã€æ‰‹æ³•ã®ã‚ã‹ã‚Šã‚„ã™ã•ã¨æ•™å¸«ãƒ‡ãƒ¼ã‚¿ã‚’å¿…è¦ã¨ã—ãªã„ç‚¹ã§ã™ã€‚ç‰¹ã«å¾Œè€…ã¯è¾æ›¸ãƒ™ãƒ¼ã‚¹ãªã‚‰ã§ã¯ã®é•·æ‰€ã§ã™ã€‚é€šå¸¸ã€æ–‡æ›¸åˆ†é¡å™¨ã‚’ä½œæˆã™ã‚‹ãŸã‚ã«ã¯ã€ãã®æ–‡æ›¸ãŒãƒã‚¸ãƒ†ã‚£ãƒ–ãƒ»ãƒã‚¬ãƒ†ã‚£ãƒ–ã®ã©ã¡ã‚‰ã§ã‚ã‚‹ã‹ã¨ã„ã†æ­£è§£ãƒ©ãƒ™ãƒ«ã®ä»˜ã„ãŸæ•™å¸«ãƒ‡ãƒ¼ã‚¿ãŒå¿…è¦ã§ã™ã€‚å¿…è¦ãªãƒ‡ãƒ¼ã‚¿ã¯æ–‡è„ˆã«ã‚‚ã‚ˆã‚‹ã¨æ€ã„ã¾ã™ãŒã€å°‘ãªãã¨ã‚‚100ä»¶ã¯å¿…è¦ã§ã—ã‚‡ã†ã€‚ã“ã‚Œã¯åˆ†æè€…ãŒå°‘ãªãã¨ã‚‚100ä»¶ä»¥ä¸Šã®æ–‡æ›¸ã‚’èª­ã‚“ã§ã€æ‰‹ä½œæ¥­ã§ãƒ©ãƒ™ãƒ«ã‚’ä»˜ä¸ã—ãªã‘ã‚Œã°ãªã‚‰ãªã„ã“ã¨ã‚’æ„å‘³ã—ã¾ã™ã€‚\n\u0026lt;æ¬ ç‚¹\u0026gt;è¾æ›¸ã®æ€§èƒ½ã«çµæœãŒå¤§ããä¾å­˜ã™ã‚‹ğŸ‘\nçŸ­æ‰€ã¨ã—ã¦ã¯ã€ç‰¹æ®Šãªæ–‡è„ˆã«ãŠã‘ã‚‹ã‚»ãƒ³ãƒãƒ¡ãƒ³ãƒˆã‚¹ã‚³ã‚¢ã‚’å‚é›†ã™ã‚‹å ´åˆã¯å°‚ç”¨ã®è¾æ›¸ãŒå¿…è¦ã«ãªã‚‹ã¨ã„ã†ç‚¹ã§ã™ã€‚è¾æ›¸ãƒ™ãƒ¼ã‚¹ã®åˆ†é¡æ³•ã®å ´åˆã€è¾æ›¸ã«å«ã¾ã‚Œãªã„å˜èªã¯ã‚»ãƒ³ãƒãƒ¡ãƒ³ãƒˆã‚¹ã‚³ã‚¢ã¸å½±éŸ¿ã‚’å…¨ãä¸ãˆã¾ã›ã‚“ã€‚ã¾ãŸã€ä¸€èˆ¬ã«å…¬é–‹ã•ã‚Œã¦ã„ã‚‹è¾æ›¸ã¯wikipediaç­‰ã®ã‚ªãƒ¼ãƒ«ã‚¸ãƒ£ãƒ³ãƒ«ã®æ–‡æ›¸ã‚’å­¦ç¿’ã™ã‚‹ã“ã¨ã«ã‚ˆã£ã¦é–‹ç™ºã•ã‚Œã¦ã„ã‚‹ã“ã¨ãŒå¤šã„ãŸã‚ã€æ„Ÿæƒ…æ¥µæ€§ãŒæ–‡è„ˆã«å¯¾ã—ã¦ãƒ‹ãƒ¥ãƒ¼ãƒˆãƒ©ãƒ«ã«ãªã£ã¦ã„ã¾ã™ã€‚ã‚ˆã£ã¦ã€ä¾‹ãˆã°é‡‘èç­‰ã®æ–‡è„ˆã«ãŠã‘ã‚‹ã‚»ãƒ³ãƒãƒ¡ãƒ³ãƒˆã‚¹ã‚³ã‚¢ã‚’ç®—å‡ºã™ã‚‹å ´åˆã€å°‚é–€ç”¨èªã®æ„Ÿæ€§æ¥µæ€§ãŒ0ã¨ãªã£ãŸã‚Šã€æ–‡è„ˆã‚’è€ƒæ…®ã—ãŸæ„Ÿæ€§æ¥µæ€§ãŒå¾—ã‚‰ã‚Œãªã„ã“ã¨ã‹ã‚‰ã€ç›´æ„Ÿã¨ç•°ãªã‚‹çµæœãŒå‡ºã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚\n2. è¾æ›¸ãƒ™ãƒ¼ã‚¹æ‰‹æ³•ã®å®Ÿè·µ ä½¿ç”¨ãƒ‡ãƒ¼ã‚¿ ã§ã¯ã€å®Ÿéš›ã«è¾æ›¸ãƒ™ãƒ¼ã‚¹æ‰‹æ³•ã‚’ç”¨ã„ã¦ã€æ™¯æ°—ã‚¦ã‚©ãƒƒãƒãƒ£ãƒ¼èª¿æŸ»ã®æ–‡ç« ã‹ã‚‰ã‚»ãƒ³ãƒãƒ¡ãƒ³ãƒˆã‚¹ã‚³ã‚¢ã®æŠ½å‡ºã‚’è©¦ã¿ã¾ã™ã€‚æ™¯æ°—ã‚¦ã‚ªãƒƒãƒãƒ£ãƒ¼èª¿æŸ»ã§ã¯ã€ã‚¿ã‚¯ã‚·ãƒ¼é‹è»¢æ‰‹ã‚„å°å£²åº—ã®åº—ä¸»ã€æ—…é¤¨ã®çµŒå–¶è€…ãªã©æ™¯æ°—ã«æ•æ„Ÿãªæ–¹ã€…(æ™¯æ°—ã‚¦ã‚ªãƒƒãƒãƒ£ãƒ¼)ã«å¯¾ã—ã¦ã€5æ®µéšã®æ™¯æ³æ„Ÿã¨ãã®ç†ç”±ã‚’æ¯æœˆã‚¢ãƒ³ã‚±ãƒ¼ãƒˆã—ã¦ã„ã¾ã™ã€‚5æ®µéšã¯ã€ã€Œè‰¯ã„(â—)ã€ã€ã€Œã‚„ã‚„è‰¯ã„(â—‹)ã€ã€ã€Œå¤‰ã‚ã‚‰ãªã„(â– )ã€ã€ã€Œã‚„ã‚„æ‚ªã„(â–²)ã€ã€ã€Œæ‚ªã„(Ã—)ã€ã¨ãªã£ã¦ã„ã¾ã™ã€‚\nãƒ‡ãƒ¼ã‚¿ã‚’è¦—ã„ã¦ã¿ã‚‹ã¨ã€ä»¥ä¸‹ã®ã‚ˆã†ã«ãªã£ã¦ã„ã¾ã™ã€‚\n\r\råŸºæº–å¹´\r\råŸºæº–æ—¥\r\ræ™¯æ°—ã®ç¾çŠ¶åˆ¤æ–­\r\ræ¥­ç¨®ãƒ»è·ç¨®\r\råˆ¤æ–­ã®ç†ç”±\r\rè¿½åŠ èª¬æ˜åŠã³å…·ä½“çš„çŠ¶æ³ã®èª¬æ˜\r\r\r\r\r\r2016\r\r1æœˆ31æ—¥\r\râ—\r\ræ—…è¡Œä»£ç†åº—ï¼ˆå¾“æ¥­å“¡ï¼‰\r\rè²©å£²é‡ã®å‹•ã\r\rãƒ»åº—é ­ã®å–æ‰±é¡ãŒå‰å¹´æ¯”ç´„120ï¼…ã¨å¥½èª¿ã§ã‚ã£ãŸã€‚\r\r\r\r2016\r\r1æœˆ31æ—¥\r\râ—\r\rè¦³å…‰åæ‰€ï¼ˆå¾“æ¥­å“¡ï¼‰\r\ræ¥å®¢æ•°ã®å‹•ã\r\rãƒ»å½“æ–½è¨­ã®åˆ©ç”¨ä¹—é™å®¢æ•°ã¯ï¼‘æœˆ26æ—¥æ™‚ç‚¹ã§å‰å¹´æ¯”130.1ï¼…ã¨ãªã£ã¦ãŠã‚Šã€ï¼‘æœˆã¨ã—ã¦ã¯éå»æœ€é«˜ã®åˆ©ç”¨ä¹—é™å®¢æ•°ã«ãªã‚‹ã“ã¨ãŒç¢ºå®šã—ãŸã»ã©ã®å…¥è¾¼çŠ¶æ³ã«ã‚ã‚‹ã€‚\r\r\r\r2016\r\r1æœˆ31æ—¥\r\râ—‹\r\rä¸€èˆ¬å°å£²åº—ï¼»é…’ï¼½ï¼ˆçµŒå–¶è€…ï¼‰\r\rå˜ä¾¡ã®å‹•ã\r\rãƒ»å¹´æœ«ã®æ¶ˆè²»ã®åå‹•ã‚‚ã‚ã£ã¦ã‹ã€å®¢ã®å‹•ããŒã‚„ã‚„éˆã„ã€‚ãŸã ã€ç›¸å¤‰ã‚ã‚‰ãšé«˜é¡å•†æãŒå£²ã‚Œã¦ã„ã‚‹ã¨ã„ã†ã“ã¨ã‚‚ã‚ã‚Šã€å£²ä¸Šã¯ãã‚Œãªã‚Šã®é‡‘é¡ã‚’ã‚­ãƒ¼ãƒ—ã—ã¦ã„ã‚‹ã€‚\r\r\r\r2016\r\r1æœˆ31æ—¥\r\râ—‹\r\rç™¾è²¨åº—ï¼ˆå£²å ´ä¸»ä»»ï¼‰\r\rãŠå®¢æ§˜ã®æ§˜å­\r\rãƒ»å¤–å›½äººè¦³å…‰å®¢ã«ã‚ˆã‚‹å£²ä¸ŠãŒå‰å¹´æ¯”152ï¼…ã¨å¥½èª¿ã‚’ç¶™ç¶šã—ã¦ã„ã‚‹ã»ã‹ã€æ¥å®¢æ•°ãŒå‰å¹´æ¯”102ï¼…ã¨å¥½èª¿ã‚’ç¶­æŒã—ã¦ã„ã‚‹ã€‚æœˆåŠã°ã«åœæ»ã—ãŸå£²ä¸Šã‚‚ä¸‹æ—¬ã«å…¥ã£ã¦ã‹ã‚‰å›å¾©å‚¾å‘ã«ã‚ã‚Šã€å®šä¾¡å“ã€ãƒãƒ¼ã‚²ãƒ³å“ã¨ã‚‚å‰å¹´ã‚’ä¸Šå›ã£ã¦ã„ã‚‹ã€‚\r\r\r\r2016\r\r1æœˆ31æ—¥\r\râ—‹\r\rç™¾è²¨åº—ï¼ˆæ‹…å½“è€…ï¼‰\r\ræ¥å®¢æ•°ã®å‹•ã\r\rãƒ»ç©æ¥µçš„ã«æ™¯æ°—ãŒä¸Šå‘ãã«ã‚ã‚‹ã¨ã¾ã§ã¯ã„ã„ã¥ã‚‰ã„ã‚‚ã®ã®ã€ï¼“ã‹æœˆå‰ã¨ã®æ¯”è¼ƒã§ã¯æ”¹å–„ã—ã¦ã„ã‚‹ã€‚\r\r\r\r2016\r\r1æœˆ31æ—¥\r\râ—‹\r\rç™¾è²¨åº—ï¼ˆè²©å£²ä¿ƒé€²æ‹…å½“ï¼‰\r\rãã‚Œä»¥å¤–\r\rãƒ»æ°—æ¸©ãŒå¹³å¹´ä¸¦ã¿ã¨ãªã‚Šã€ã“ã‚Œã¾ã§ã®æ¸©æš–ã€å°‘é›ªã®çŠ¶æ…‹ãŒã¿ã‚‰ã‚Œãªããªã£ã¦ããŸã“ã¨ã§ã€é˜²å¯’è¡£æ–™ã€é›‘è²¨å•†æã‚’ä¸­å¿ƒã«å¤šå°‘æ”¹å–„ã®å‚¾å‘ãŒã¿ã‚‰ã‚Œã‚‹ã€‚\r\r\r\r\rã€Œæ™¯æ°—ã®ç¾çŠ¶åˆ¤æ–­ã€ãŒæ™¯æ³æ„Ÿã‚’è¡¨ã—ã¦ãŠã‚Šã€ãã®åˆ¤æ–­ã®ç†ç”±ãŒã€Œè¿½åŠ èª¬æ˜åŠã³å…·ä½“çš„çŠ¶æ³ã®èª¬æ˜ã€ã«ã‚ã‚‹å½¢ã§ã™ã€‚ã‚ˆã£ã¦ã€å‰è€…ã‚’æ•™å¸«ãƒ‡ãƒ¼ã‚¿ã€å¾Œè€…ã‚’èª¬æ˜ãƒ‡ãƒ¼ã‚¿ã¨ã™ã‚‹æ•™å¸«ã‚ã‚Šå­¦ç¿’ãƒ‡ãƒ¼ã‚¿ã¨ã—ã¦åˆ©ç”¨ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚\nã‚»ãƒ³ãƒãƒ¡ãƒ³ãƒˆã‚¹ã‚³ã‚¢ã®æŠ½å‡º ã§ã¯ã€å®Ÿè·µã§ã™ã€‚quantedaã¨ã„ã†ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’ç”¨ã„ã‚‹ãŸã‚ã€Rã§è¡Œã£ã¦ã„ãã¾ã™ã€‚\nã¾ãšã€å‰å‡¦ç†ã§ã™ã€‚ã‚µãƒ³ãƒ—ãƒ«ãƒ‡ãƒ¼ã‚¿ã‚’èª­ã¿è¾¼ã¿ã¾ã™ã€‚\nfilepath \u0026lt;- r\u0026#34;(C:\\Users\\hogehoge\\Watcher\\RawData)\u0026#34; library(magrittr) files \u0026lt;- stringr::str_c(filepath, list.files(filepath, pattern = \u0026#34;*.csv\u0026#34;)) sample \u0026lt;- readr::read_csv(files,locale=readr::locale(encoding=\u0026#34;Shift-JIS\u0026#34;),show_col_types = FALSE) sample \u0026lt;- sample[sample$è¿½åŠ èª¬æ˜åŠã³å…·ä½“çš„çŠ¶æ³ã®èª¬æ˜!=\u0026#34;-\u0026#34;|sample$è¿½åŠ èª¬æ˜åŠã³å…·ä½“çš„çŠ¶æ³ã®èª¬æ˜!=\u0026#34;*\u0026#34;,] sample$æ™¯æ°—ã®ç¾çŠ¶åˆ¤æ–­ \u0026lt;- factor(sample$æ™¯æ°—ã®ç¾çŠ¶åˆ¤æ–­, levels=c(\u0026#34;â—\u0026#34;,\u0026#34;â—‹\u0026#34;,\u0026#34;â–¡\u0026#34;,\u0026#34;â–²\u0026#34;,\u0026#34;Ã—\u0026#34;)) æ¬¡ã«ã€sudachiã‚’ç”¨ã„ã¦ãƒ†ã‚­ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ã®TokenåŒ–ã‚’è¡Œã„ã¾ã™ã€‚Rã«ã¯sudachiã‚’ä½¿ãˆã‚‹ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ãŒå­˜åœ¨ã—ãªã„ã®ã§ã€Pythonãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®sudachipyã‚’reticulateã§å‘¼ã³å‡ºã—ã¦ä½¿ç”¨ã—ã¾ã™ã€‚\nstopwords_path \u0026lt;- r\u0026#34;(C:\\Users\\hogehoge\\Watcher\\marimo-master\\yaml\\stopwords_ja.yml)\u0026#34; # sudachiã«ã‚ˆã‚‹å½¢æ…‹ç´ è§£æâ†’TokenåŒ– # stopwordsã¯marimoã‚’ä½¿ç”¨ ja_stopwords \u0026lt;- quanteda::dictionary(yaml::read_yaml(stopwords_path)) # ã‚³ãƒ¼ãƒ‘ã‚¹ç”Ÿæˆ corp \u0026lt;- quanteda::corpus(sample,text_field=\u0026#34;è¿½åŠ èª¬æ˜åŠã³å…·ä½“çš„çŠ¶æ³ã®èª¬æ˜\u0026#34;) # sudachipyå‘¼ã³å‡ºã—â†’ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹åŒ– sudachipy \u0026lt;- reticulate::import(\u0026#34;sudachipy\u0026#34;) # æ­£è¦åŒ–é–¢æ•°å®šç¾© sudachi_normalize \u0026lt;- function(tokens){ res \u0026lt;- c() for(i in 0:(length(tokens)-1)){ res \u0026lt;- append(res,tokens[i]$normalized_form()) } return(res) } # tokenizeé–¢æ•°å®šç¾© sudachi_tokenize \u0026lt;- function(sentence, mode = \u0026#34;A\u0026#34;){ tokenizer_obj \u0026lt;- sudachipy$dictionary$Dictionary()$create() mode \u0026lt;- switch(mode, \u0026#34;A\u0026#34; = sudachipy$tokenizer$Tokenizer$SplitMode$A, \u0026#34;B\u0026#34; = sudachipy$tokenizer$Tokenizer$SplitMode$B, \u0026#34;C\u0026#34; = sudachipy$tokenizer$Tokenizer$SplitMode$C, stop(\u0026#34;Only Can Use A, B, C\u0026#34;)) res \u0026lt;- purrr::map(sentence, ~sudachi_normalize(tokenizer_obj$tokenize(., mode))) return(res) } # TokenåŒ–å®Ÿè¡Œ toks_sent \u0026lt;- corp %\u0026gt;% sudachi_tokenize() %\u0026gt;% quanteda::as.tokens() %\u0026gt;% quanteda::tokens_remove(ja_stopwords, padding = TRUE) # ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ã‚’Tokenã«å†ä»˜ä¸ quanteda::docvars(toks_sent) \u0026lt;- quanteda::docvars(corp) ã“ã®toks_sentã‹ã‚‰æ–‡æ›¸è¡Œåˆ—ã‚’ç”Ÿæˆã—ã¾ã™ã€‚æ–‡æ›¸è¡Œåˆ—ã¨ã¯ã€å˜èªã¨æ–‡æ›¸ã®é–¢ä¿‚ã‚’è¡¨ã™è¡Œåˆ—ã§ã€å„è¡ŒãŒå˜èª(token)ã€å„åˆ—ãŒæ–‡æ›¸ã‚’è¡¨ã—ã€å„è¦ç´ ã¯æ–‡æ›¸ä¸­ã®å˜èªã®å‡ºç¾å›æ•°ã¨ãªã£ã¦ã„ã¾ã™ã€‚\n# æ–‡æ›¸è¡Œåˆ—ã®ç”Ÿæˆ dfmt_sent \u0026lt;- toks_sent %\u0026gt;% quanteda::dfm() %\u0026gt;% quanteda::dfm_remove(pattern=\u0026#34;\u0026#34;) %\u0026gt;% quanteda::dfm_trim(min_termfreq = 10) æ–‡æ›¸è¡Œåˆ—dfmt_sentã¨å„å˜èªã®ã‚¹ã‚³ã‚¢ãƒ™ã‚¯ãƒˆãƒ«ã®å†…ç©ã‚’å–ã‚Šã€æ–‡æ›¸ã®ã‚»ãƒ³ãƒãƒ¡ãƒ³ãƒˆã‚¹ã‚³ã‚¢ã‚’ç®—å‡ºã—ã¾ã™ã€‚\n# å˜èªæ„Ÿæƒ…æ¥µæ€§å¯¾å¿œè¡¨ PNdict \u0026lt;- read.delim(\u0026#34;http://www.lr.pi.titech.ac.jp/~takamura/pubs/pn_ja.dic\u0026#34;,header=FALSE,sep=\u0026#34;:\u0026#34;) # è¾æ›¸ã®ä¸¦ã³ã«åˆã‚ã›ã¦æ–‡æ›¸è¡Œåˆ—ã®åˆ—ã‚’å…¥ã‚Œæ›¿ãˆã‚‹ã€‚ dfmt_sent_arranged \u0026lt;- quanteda::dfm_match(dfmt_sent, PNdict$V1) # æ–‡æ›¸ã®ã‚»ãƒ³ãƒãƒ¡ãƒ³ãƒˆã‚¹ã‚³ã‚¢ç®—å‡º n \u0026lt;- unname(quanteda::rowSums(dfmt_sent_arranged)) score_dict \u0026lt;- scale(ifelse(n\u0026gt;0, quanteda::rowSums(dfmt_sent_arranged %*% PNdict$V4)/n, NA)) sample_with_score_dict \u0026lt;- sample %\u0026gt;% cbind(score_dict) ã‚µãƒ³ãƒ—ãƒ«ãƒ‡ãƒ¼ã‚¿ã‚’æŠœãå‡ºã—ã¦ã€ã‚»ãƒ³ãƒãƒ¡ãƒ³ãƒˆã‚¹ã‚³ã‚¢ã‚’è¦³å¯Ÿã—ã¦ã¿ã¾ã—ã‚‡ã†ã€‚\nsample_with_score_dict %\u0026gt;% head() %\u0026gt;% knitr::kable() %\u0026gt;% kableExtra::kable_styling(bootstrap_options = c(\u0026#34;striped\u0026#34;)) \r\råŸºæº–å¹´\r\råŸºæº–æ—¥\r\ræ™¯æ°—ã®ç¾çŠ¶åˆ¤æ–­\r\ræ¥­ç¨®ãƒ»è·ç¨®\r\råˆ¤æ–­ã®ç†ç”±\r\rè¿½åŠ èª¬æ˜åŠã³å…·ä½“çš„çŠ¶æ³ã®èª¬æ˜\r\rscore_dict\r\r\r\r\r\r2016\r\r1æœˆ31æ—¥\r\râ—\r\ræ—…è¡Œä»£ç†åº—ï¼ˆå¾“æ¥­å“¡ï¼‰\r\rè²©å£²é‡ã®å‹•ã\r\rãƒ»åº—é ­ã®å–æ‰±é¡ãŒå‰å¹´æ¯”ç´„120ï¼…ã¨å¥½èª¿ã§ã‚ã£ãŸã€‚\r\r1.0918056\r\r\r\r2016\r\r1æœˆ31æ—¥\r\râ—\r\rè¦³å…‰åæ‰€ï¼ˆå¾“æ¥­å“¡ï¼‰\r\ræ¥å®¢æ•°ã®å‹•ã\r\rãƒ»å½“æ–½è¨­ã®åˆ©ç”¨ä¹—é™å®¢æ•°ã¯ï¼‘æœˆ26æ—¥æ™‚ç‚¹ã§å‰å¹´æ¯”130.1ï¼…ã¨ãªã£ã¦ãŠã‚Šã€ï¼‘æœˆã¨ã—ã¦ã¯éå»æœ€é«˜ã®åˆ©ç”¨ä¹—é™å®¢æ•°ã«ãªã‚‹ã“ã¨ãŒç¢ºå®šã—ãŸã»ã©ã®å…¥è¾¼çŠ¶æ³ã«ã‚ã‚‹ã€‚\r\r-0.7191220\r\r\r\r2016\r\r1æœˆ31æ—¥\r\râ—‹\r\rä¸€èˆ¬å°å£²åº—ï¼»é…’ï¼½ï¼ˆçµŒå–¶è€…ï¼‰\r\rå˜ä¾¡ã®å‹•ã\r\rãƒ»å¹´æœ«ã®æ¶ˆè²»ã®åå‹•ã‚‚ã‚ã£ã¦ã‹ã€å®¢ã®å‹•ããŒã‚„ã‚„éˆã„ã€‚ãŸã ã€ç›¸å¤‰ã‚ã‚‰ãšé«˜é¡å•†æãŒå£²ã‚Œã¦ã„ã‚‹ã¨ã„ã†ã“ã¨ã‚‚ã‚ã‚Šã€å£²ä¸Šã¯ãã‚Œãªã‚Šã®é‡‘é¡ã‚’ã‚­ãƒ¼ãƒ—ã—ã¦ã„ã‚‹ã€‚\r\r-0.9872586\r\r\r\r2016\r\r1æœˆ31æ—¥\r\râ—‹\r\rç™¾è²¨åº—ï¼ˆå£²å ´ä¸»ä»»ï¼‰\r\rãŠå®¢æ§˜ã®æ§˜å­\r\rãƒ»å¤–å›½äººè¦³å…‰å®¢ã«ã‚ˆã‚‹å£²ä¸ŠãŒå‰å¹´æ¯”152ï¼…ã¨å¥½èª¿ã‚’ç¶™ç¶šã—ã¦ã„ã‚‹ã»ã‹ã€æ¥å®¢æ•°ãŒå‰å¹´æ¯”102ï¼…ã¨å¥½èª¿ã‚’ç¶­æŒã—ã¦ã„ã‚‹ã€‚æœˆåŠã°ã«åœæ»ã—ãŸå£²ä¸Šã‚‚ä¸‹æ—¬ã«å…¥ã£ã¦ã‹ã‚‰å›å¾©å‚¾å‘ã«ã‚ã‚Šã€å®šä¾¡å“ã€ãƒãƒ¼ã‚²ãƒ³å“ã¨ã‚‚å‰å¹´ã‚’ä¸Šå›ã£ã¦ã„ã‚‹ã€‚\r\r1.0711102\r\r\r\r2016\r\r1æœˆ31æ—¥\r\râ—‹\r\rç™¾è²¨åº—ï¼ˆæ‹…å½“è€…ï¼‰\r\ræ¥å®¢æ•°ã®å‹•ã\r\rãƒ»ç©æ¥µçš„ã«æ™¯æ°—ãŒä¸Šå‘ãã«ã‚ã‚‹ã¨ã¾ã§ã¯ã„ã„ã¥ã‚‰ã„ã‚‚ã®ã®ã€ï¼“ã‹æœˆå‰ã¨ã®æ¯”è¼ƒã§ã¯æ”¹å–„ã—ã¦ã„ã‚‹ã€‚\r\r3.1257848\r\r\r\r2016\r\r1æœˆ31æ—¥\r\râ—‹\r\rç™¾è²¨åº—ï¼ˆè²©å£²ä¿ƒé€²æ‹…å½“ï¼‰\r\rãã‚Œä»¥å¤–\r\rãƒ»æ°—æ¸©ãŒå¹³å¹´ä¸¦ã¿ã¨ãªã‚Šã€ã“ã‚Œã¾ã§ã®æ¸©æš–ã€å°‘é›ªã®çŠ¶æ…‹ãŒã¿ã‚‰ã‚Œãªããªã£ã¦ããŸã“ã¨ã§ã€é˜²å¯’è¡£æ–™ã€é›‘è²¨å•†æã‚’ä¸­å¿ƒã«å¤šå°‘æ”¹å–„ã®å‚¾å‘ãŒã¿ã‚‰ã‚Œã‚‹ã€‚\r\r0.0254686\r\r\r\r\r2è¡Œç›®ã®æ–‡ç« ã¯æ˜ã‚‰ã‹ã«ãƒã‚¸ãƒ†ã‚£ãƒ–ã§ã™ãŒã€ãªã«ãŒå½±éŸ¿ã—ãŸã®ã‹ãƒã‚¬ãƒ†ã‚£ãƒ–å¯„ã‚Šã®åˆ¤å®šã«ãªã£ã¦ã„ã¾ã™ã­ã€‚ã¾ãŸã€é¡•è‘—ãªã®ãŒ3è¡Œç›®ã§ã€Œéˆã„ã€ã¨ã„ã†å˜èªã«å¼•ã£å¼µã‚‰ã‚Œã€ãƒã‚¬ãƒ†ã‚£ãƒ–ãªã‚»ãƒ³ãƒãƒ¡ãƒ³ãƒˆã‚’æŠ½å‡ºã—ã‚„ã™ããªã£ã¦ã„ã¾ã™ã€‚ã“ã®æ–‡ç« ã®æœ¬æ„ã¯ã€ŒãŸã ãƒ»ãƒ»ãƒ»ã€ã¨ã„ã†é€†æ¥ä»¥é™ã®æ–‡ç« ã§ã™ãŒã€æ–‡è„ˆã‚„èªé †ãŒæ‰ãˆã‚‰ã‚Œãªã„ãŸã‚ã«æ­£ã—ã„æƒ…å ±ã‚’å¼•ãå‡ºã™ã“ã¨ãŒã§ãã¦ã„ã¾ã›ã‚“ã€‚5è¡Œç›®ã¯ã€Œç©æ¥µçš„ã€ã€ã€Œä¸Šå‘ãã€ã€ã€Œæ”¹å–„ã€ã¨ã„ã£ãŸå˜èªã‚’æ¤œçŸ¥ã—ã€ã‹ãªã‚Šãƒã‚¸ãƒ†ã‚£ãƒ–ãªã‚»ãƒ³ãƒãƒ¡ãƒ³ãƒˆãŒã‚ã‚‹ã¨ã„ã†åˆ¤å®šã‚’ã—ã¦ã„ã¾ã™ãŒã€ã€Œç©æ¥µçš„ã«æ™¯æ°—ãŒä¸Šå‘ãã¨ã¯ã„ã„ã¥ã‚‰ã„*ã€ã¨ã„ã†ãƒã‚¬ãƒ†ã‚£ãƒ–ãªæ–‡è„ˆã‚’æ‰ãˆåˆ‡ã‚Œã¦ãŠã‚‰ãšã€éå¤§è©•ä¾¡ã¨ãªã£ã¦ã„ã¾ã™ã€‚\n# çµæœã®å¯è¦–åŒ– library(ggplot2) ggplot(sample_with_score_dict, aes(x=æ™¯æ°—ã®ç¾çŠ¶åˆ¤æ–­,y=score_dict)) + geom_boxplot() ã€Œæ™¯æ°—ã®ç¾çŠ¶åˆ¤æ–­ã€æ¯ã«boxplotã‚’æ›¸ã„ã¦ã¿ã¾ã—ãŸãŒã€ã±ã£ã¨è¦‹ã¯ã‚ã¾ã‚Šå¤‰ã‚ã‚‰ãªã„çµæœã«ãªã‚Šã¾ã—ãŸã€‚ ã»ã‚“ã®å°‘ã—ç·©ã‚„ã‹ã«å³ä¸‹ãŒã‚Šã®ã‚ˆã†ãªæ°—ã‚‚ã—ã¾ã™ãŒã€æ–‡æ›¸åˆ†é¡å¯èƒ½ãªçµæœã§ã¯ãªã„ã“ã¨ãŒã‚ã‹ã‚Šã¾ã™ã€‚\n(è¿½åŠ æ¤œè¨¼)tf-idfã‚’ç”¨ã„ãŸç®—å‡º ä¸Šè¨˜ã®åˆ†æã§ã¯å˜èªã®å‡ºç¾å›æ•°ã‚’åˆ©ç”¨ã—ã¦ã„ã¾ã—ãŸãŒã€tf-idfã‚’ç”¨ã„ãŸåˆ†æã‚‚è¡Œã†ã“ã¨ã«ã—ã¾ã™ã€‚tf-idfã¨ã¯ã€term frequency-inverse document frequencyã®ç•¥ã§ã€æƒ…å ±æ¤œç´¢ã‚„ãƒ†ã‚­ã‚¹ãƒˆãƒã‚¤ãƒ‹ãƒ³ã‚°ã§ã‚ˆãä½¿ã‚ã‚Œã‚‹é‡ã¿ã®ã“ã¨ã§ã™ã€‚ã“ã®é‡ã¿ã¯ã€ã‚ã‚‹å˜èªãŒã‚³ãƒ¼ãƒ‘ã‚¹1ã®ä¸­ã®æ–‡æ›¸ã«ã¨ã£ã¦ã©ã‚Œã ã‘é‡è¦ã‹ã‚’è©•ä¾¡ã™ã‚‹ãŸã‚ã«ä½¿ã‚ã‚Œã‚‹çµ±è¨ˆçš„å°ºåº¦ã§ã€ãã®ç‰¹å¾´é‡ã¯æ–‡æ›¸ä¸­ã®å˜èªã®å‡ºç¾å›æ•°ãŒå¢—åŠ ã™ã‚‹ã»ã©ä¸Šæ˜‡ã—ã¾ã™ãŒã€ã‚³ãƒ¼ãƒ‘ã‚¹ä¸­ã®å˜èªã®é »åº¦ã«ã‚ˆã£ã¦ç›¸æ®ºã•ã‚Œã¾ã™ã€‚ä¾‹ãˆã°ã€è¿·æƒ‘ãƒ¡ãƒ¼ãƒ«ã‚’åˆ†é¡ã™ã‚‹ã“ã¨ã‚’æ„å›³ã—ãŸé›»å­ãƒ¡ãƒ¼ãƒ«ã®ã‚³ãƒ¼ãƒ‘ã‚¹ã«ãŠã„ã¦ã€ã€ŒãŠçŸ¥ã‚‰ã›ã€ã‚„ã€Œãƒ‹ãƒ¥ãƒ¼ã‚¹ã€ãªã©ã¯å‡ºç¾é »åº¦ãŒé«˜ã„ä¸€æ–¹ã§ã©ã®æ–‡æ›¸ã«ã‚‚å‡ºç¾ã™ã‚‹ãŸã‚ã€è¿·æƒ‘ãƒ¡ãƒ¼ãƒ«ã‚’ç‰¹å®šã™ã‚‹ã¨ã„ã†ç‚¹ã«ãŠã„ã¦ã¯é‡è¦åº¦ã¯é«˜ãã‚ã‚Šã¾ã›ã‚“ã€‚ä¸€æ–¹ã§ã€ã€Œå½“é¸ã€ã‚„ã€Œä»Šã ã‘ï¼ã€ãªã©ã¯ã‚³ãƒ¼ãƒ‘ã‚¹ä¸Šã«ã¯ãã“ã¾ã§å‡ºç¾é »åº¦ãŒé«˜ããªã„å˜èªã§ã‚ã‚‹ã‚‚ã®ã®ã€è¿·æƒ‘ãƒ¡ãƒ¼ãƒ«ã®æ–‡ç« ä¸­ã«ã¯é »åº¦ãŒé«˜ãå‡ºç¾ã™ã‚‹ã¨è€ƒãˆã‚‰ã‚Œã¾ã™ã€‚tf-idfã§ã¯å¾Œè€…ã®å˜èªã®ç‰¹å¾´é‡ãŒé«˜ããªã‚‹ã‚ˆã†ã«å®šç¾©ã•ã‚Œã¦ã„ã¾ã™ã€‚\ntf-idfã®è¨ˆç®—æ–¹æ³•ã¯tfã¨idfã«åˆ†ã‹ã‚Œã¾ã™ã€‚\n tf: Term frequency å˜èªãŒæ–‡æ›¸ä¸­ã«ã©ã‚Œã ã‘é »ç¹ã«å‡ºç¾ã—ã¦ã„ã‚‹ã‹ã‚’æ¸¬å®šã™ã‚‹ã‚‚ã®ã€‚æ–‡æ›¸ã®é•·ã•ã¯ãã‚Œãã‚Œç•°ãªã‚‹ãŸã‚ã€é•·ã„æ–‡æ›¸ã§ã¯çŸ­ã„æ–‡æ›¸ã‚ˆã‚Šã¯ã‚‹ã‹ã«å¤šãã®ç”¨èªãŒå‡ºç¾ã™ã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚ãã®ãŸã‚ã€æ­£è¦åŒ–ã®æ–¹æ³•ã¨ã—ã¦ã€å˜èªé »åº¦ã‚’æ–‡æ›¸ã®é•·ã•ï¼ˆæ–‡æ›¸å†…ã®å˜èªç·æ•°ï¼‰ã§å‰²ã‚‹ã“ã¨ãŒã‚ˆãã‚ã‚Šã¾ã™ã€‚  $$ tf(t) = \\frac{æ–‡ç« å†…ã®å˜èªtã®å‡ºç¾å›æ•°}{æ–‡ç« å†…ã®å˜èªç·æ•°} $$\n-idf: Inverse Document Frequency ã‚ã‚‹å˜èªãŒã‚³ãƒ¼ãƒ‘ã‚¹å†…ã§ã©ã®ç¨‹åº¦å¸Œå°‘ã§ã‚ã‚‹ã‹ã‚’æ¸¬å®šã™ã‚‹ã‚‚ã®ã€‚ã€Œã§ã™ã€ã€ã€Œã¯ã€ã€ã€ŒãŒã€ãªã©ã®é »å‡ºèªã‚’æ¸›ã‚‰ã—ã¦ã€å¸Œå°‘èªã‚’å¢—ã‚„ã™æ„å›³ãŒã‚ã‚Šã¾ã™ã€‚\n$$ idf(t) = \\log(\\frac{ã‚³ãƒ¼ãƒ‘ã‚¹å†…ã®æ–‡æ›¸ç·æ•°}{å˜èªtã‚’å«ã‚€æ–‡æ›¸æ•°}) $$\nrã§å®Ÿè£…ã—ã¦ã¿ã¾ã™ã€‚tf-idfã¯quanteda::dfm_tfidf()ã§è¨ˆç®—ã§ãã¾ã™ã€‚å¼•æ•°ã«ã¯ã€æ–‡æ›¸è¡Œåˆ—ã‚’æ¸¡ã—ã¾ã™ã€‚ãã®ã»ã‹ã¯ä¸Šè¨˜ã®åˆ†æã¨åŒã˜ã§ã™ã€‚\n# tf-idfç‰ˆæ–‡æ›¸è¡Œåˆ—ã®ç”Ÿæˆ dfmt_tfidf_sent \u0026lt;- dfmt_sent %\u0026gt;% quanteda::dfm_tfidf() # è¾æ›¸ã®ä¸¦ã³ã«åˆã‚ã›ã¦æ–‡æ›¸è¡Œåˆ—ã®åˆ—ã‚’å…¥ã‚Œæ›¿ãˆã‚‹ã€‚ dfmt_tfidf_sent_arranged \u0026lt;- quanteda::dfm_match(dfmt_tfidf_sent, PNdict$V1) # æ–‡æ›¸ã®ã‚»ãƒ³ãƒãƒ¡ãƒ³ãƒˆã‚¹ã‚³ã‚¢ç®—å‡º n \u0026lt;- unname(quanteda::rowSums(dfmt_tfidf_sent_arranged)) score_dict \u0026lt;- scale(ifelse(n\u0026gt;0, quanteda::rowSums(dfmt_tfidf_sent_arranged %*% PNdict$V4)/n, NA)) sample_with_score_dict \u0026lt;- sample %\u0026gt;% cbind(score_dict) å…ˆã»ã©ã¨åŒã˜ã‚ˆã†ã«ã‚µãƒ³ãƒ—ãƒ«ã‚’æŠœãå‡ºã—ã¦ã¿ã¾ã™ã€‚\nsample_with_score_dict %\u0026gt;% head() %\u0026gt;% knitr::kable() %\u0026gt;% kableExtra::kable_styling(bootstrap_options = c(\u0026#34;striped\u0026#34;)) \r\råŸºæº–å¹´\r\råŸºæº–æ—¥\r\ræ™¯æ°—ã®ç¾çŠ¶åˆ¤æ–­\r\ræ¥­ç¨®ãƒ»è·ç¨®\r\råˆ¤æ–­ã®ç†ç”±\r\rè¿½åŠ èª¬æ˜åŠã³å…·ä½“çš„çŠ¶æ³ã®èª¬æ˜\r\rscore_dict\r\r\r\r\r\r2016\r\r1æœˆ31æ—¥\r\râ—\r\ræ—…è¡Œä»£ç†åº—ï¼ˆå¾“æ¥­å“¡ï¼‰\r\rè²©å£²é‡ã®å‹•ã\r\rãƒ»åº—é ­ã®å–æ‰±é¡ãŒå‰å¹´æ¯”ç´„120ï¼…ã¨å¥½èª¿ã§ã‚ã£ãŸã€‚\r\r0.1052126\r\r\r\r2016\r\r1æœˆ31æ—¥\r\râ—\r\rè¦³å…‰åæ‰€ï¼ˆå¾“æ¥­å“¡ï¼‰\r\ræ¥å®¢æ•°ã®å‹•ã\r\rãƒ»å½“æ–½è¨­ã®åˆ©ç”¨ä¹—é™å®¢æ•°ã¯ï¼‘æœˆ26æ—¥æ™‚ç‚¹ã§å‰å¹´æ¯”130.1ï¼…ã¨ãªã£ã¦ãŠã‚Šã€ï¼‘æœˆã¨ã—ã¦ã¯éå»æœ€é«˜ã®åˆ©ç”¨ä¹—é™å®¢æ•°ã«ãªã‚‹ã“ã¨ãŒç¢ºå®šã—ãŸã»ã©ã®å…¥è¾¼çŠ¶æ³ã«ã‚ã‚‹ã€‚\r\r-0.1025889\r\r\r\r2016\r\r1æœˆ31æ—¥\r\râ—‹\r\rä¸€èˆ¬å°å£²åº—ï¼»é…’ï¼½ï¼ˆçµŒå–¶è€…ï¼‰\r\rå˜ä¾¡ã®å‹•ã\r\rãƒ»å¹´æœ«ã®æ¶ˆè²»ã®åå‹•ã‚‚ã‚ã£ã¦ã‹ã€å®¢ã®å‹•ããŒã‚„ã‚„éˆã„ã€‚ãŸã ã€ç›¸å¤‰ã‚ã‚‰ãšé«˜é¡å•†æãŒå£²ã‚Œã¦ã„ã‚‹ã¨ã„ã†ã“ã¨ã‚‚ã‚ã‚Šã€å£²ä¸Šã¯ãã‚Œãªã‚Šã®é‡‘é¡ã‚’ã‚­ãƒ¼ãƒ—ã—ã¦ã„ã‚‹ã€‚\r\r-0.8938789\r\r\r\r2016\r\r1æœˆ31æ—¥\r\râ—‹\r\rç™¾è²¨åº—ï¼ˆå£²å ´ä¸»ä»»ï¼‰\r\rãŠå®¢æ§˜ã®æ§˜å­\r\rãƒ»å¤–å›½äººè¦³å…‰å®¢ã«ã‚ˆã‚‹å£²ä¸ŠãŒå‰å¹´æ¯”152ï¼…ã¨å¥½èª¿ã‚’ç¶™ç¶šã—ã¦ã„ã‚‹ã»ã‹ã€æ¥å®¢æ•°ãŒå‰å¹´æ¯”102ï¼…ã¨å¥½èª¿ã‚’ç¶­æŒã—ã¦ã„ã‚‹ã€‚æœˆåŠã°ã«åœæ»ã—ãŸå£²ä¸Šã‚‚ä¸‹æ—¬ã«å…¥ã£ã¦ã‹ã‚‰å›å¾©å‚¾å‘ã«ã‚ã‚Šã€å®šä¾¡å“ã€ãƒãƒ¼ã‚²ãƒ³å“ã¨ã‚‚å‰å¹´ã‚’ä¸Šå›ã£ã¦ã„ã‚‹ã€‚\r\r1.0201638\r\r\r\r2016\r\r1æœˆ31æ—¥\r\râ—‹\r\rç™¾è²¨åº—ï¼ˆæ‹…å½“è€…ï¼‰\r\ræ¥å®¢æ•°ã®å‹•ã\r\rãƒ»ç©æ¥µçš„ã«æ™¯æ°—ãŒä¸Šå‘ãã«ã‚ã‚‹ã¨ã¾ã§ã¯ã„ã„ã¥ã‚‰ã„ã‚‚ã®ã®ã€ï¼“ã‹æœˆå‰ã¨ã®æ¯”è¼ƒã§ã¯æ”¹å–„ã—ã¦ã„ã‚‹ã€‚\r\r2.4385447\r\r\r\r2016\r\r1æœˆ31æ—¥\r\râ—‹\r\rç™¾è²¨åº—ï¼ˆè²©å£²ä¿ƒé€²æ‹…å½“ï¼‰\r\rãã‚Œä»¥å¤–\r\rãƒ»æ°—æ¸©ãŒå¹³å¹´ä¸¦ã¿ã¨ãªã‚Šã€ã“ã‚Œã¾ã§ã®æ¸©æš–ã€å°‘é›ªã®çŠ¶æ…‹ãŒã¿ã‚‰ã‚Œãªããªã£ã¦ããŸã“ã¨ã§ã€é˜²å¯’è¡£æ–™ã€é›‘è²¨å•†æã‚’ä¸­å¿ƒã«å¤šå°‘æ”¹å–„ã®å‚¾å‘ãŒã¿ã‚‰ã‚Œã‚‹ã€‚\r\r0.7675009\r\r\r\r\rå‚¾å‘ã¯å…ˆã»ã©ã®åˆ†æã¨ã•ã»ã©å¤‰ã‚ã‚‰ãªã„ã‚ˆã†ã«è¦‹å—ã‘ã‚‰ã‚Œã¾ã™ã€‚ boxplotã®çµæœã‚‚è¦‹ã¦ã¿ã¾ã—ã‚‡ã†ã€‚\n# çµæœã®å¯è¦–åŒ– library(ggplot2) ggplot(sample_with_score_dict, aes(x=æ™¯æ°—ã®ç¾çŠ¶åˆ¤æ–­,y=score_dict)) + geom_boxplot() å³ä¸‹ãŒã‚Šã®å‚¾å‘ãŒå¼·ããªã£ãŸã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ã€‚ãŸã ã€ä¾ç„¶ã¨ã—ã¦æ™¯æ°—åˆ¤æ–­åˆ¥ã«è¦‹ãŸã‚¹ã‚³ã‚¢ã®åˆ†å¸ƒã¯å·®ãŒãªãã€æ–‡æ›¸åˆ†é¡ãŒã§ãã‚‹ç²¾åº¦ã§ã¯ãªã„ã“ã¨ãŒã‚ã‹ã‚Šã¾ã™ã€‚\n3. çµ‚ã‚ã‚Šã« æœ€ã‚‚ç°¡æ˜“ãªæ‰‹æ³•ã¨ã„ã†ã“ã¨ã§äºˆæƒ³ã¯ã—ã¦ã„ã¾ã—ãŸãŒã€è¾æ›¸ãƒ™ãƒ¼ã‚¹æ‰‹æ³•ã§ã¯ã‚»ãƒ³ãƒãƒ¡ãƒ³ãƒˆã‚¹ã‚³ã‚¢ã®æŠ½å‡ºã¯ã§ãã¾ã›ã‚“ã§ã—ãŸã€‚ã‚‚ã¡ã‚ã‚“ã€ç§ã®ã‚„ã‚Šæ–¹ãŒæ‚ªã„ã®ãŒç†ç”±ã§ä¸Šæ‰‹ãã‚„ã‚Œã°æ–‡æ›¸ã®åˆ†é¡ã¯å¯èƒ½ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ã€‚ãŸã ã€çµŒæ¸ˆã«ç‰¹åŒ–ã—ãŸæ¥µæ€§è¾æ›¸ã‚’æº–å‚™ã—ãªã‘ã‚Œã°é›£ã—ã„ã®ã§ã¯ãªã„ã‹ã¨ã„ã†ã®ãŒã€ç§ã®æ„Ÿæƒ³ã§ã™ã€‚ æ¬¡ã¯ãƒŠã‚¤ãƒ¼ãƒ–ãƒ™ã‚¤ã‚ºåˆ†é¡å™¨ã‚’ç”¨ã„ãŸæ–‡æ›¸åˆ†é¡ã«å–ã‚Šçµ„ã¿ã¾ã™ã€‚ ã“ã“ã¾ã§ã€èª­ã¿é€²ã‚ã¦é ‚ãã¾ã—ã¦ã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã—ãŸã€‚æ¬¡å›ã®è¨˜äº‹ã‚‚æœŸå¾…ã—ã¦ã„ã¦ãã ã•ã„ã€‚\nTakamura, Hiroya, Takashi Inui, and Manabu Okumura. 2005. â€œThe 43rd Annual Meeting.â€ In. Association for Computational Linguistics. https://doi.org/10.3115/1219840.1219857.\n\r\r  æ–‡ç« ã‚’æ§‹é€ åŒ–ã—å¤§è¦æ¨¡ã«é›†ç©ã—ãŸã‚‚ã® \u0026#x21a9;\u0026#xfe0e;\n   ","date":1648080000,"expirydate":-62135596800,"kind":"page","lang":"ja","lastmod":1648080000,"objectID":"33a9e17152e4b9767e936af3103bf76b","permalink":"/post/post27/","publishdate":"2022-03-24T00:00:00Z","relpermalink":"/post/post27/","section":"post","summary":"è¾æ›¸ãƒ™ãƒ¼ã‚¹æ‰‹æ³•ã‚’ç”¨ã„ãŸã‚»ãƒ³ãƒãƒ¡ãƒ³ãƒˆã‚¹ã‚³ã‚¢ã®ç®—å‡ºã‚’å®Ÿè·µã—ã¾ã™ã€‚","tags":["Python","å‰å‡¦ç†","æ©Ÿæ¢°å­¦ç¿’","ãƒ†ã‚­ã‚¹ãƒˆè§£æ"],"title":"ã€å¾¹åº•æ¯”è¼ƒã€‘ã‚»ãƒ³ãƒãƒ¡ãƒ³ãƒˆã‚¹ã‚³ã‚¢ç®—å‡ºæ‰‹æ³•ï¼ï¼ - ç¬¬2å›","type":"post"},{"authors":null,"categories":["å˜ç™º"],"content":"\r\r\r\r\r\r\r\r\r\r\r\r\r\rãŠã¯ã“ã‚“ã°ã‚“ã«ã¡ã¯ã€‚ãƒ†ã‚­ã‚¹ãƒˆè§£æã¯ãƒ‡ãƒ¼ã‚¿åˆ†æç•Œéšˆã§ã¯ã‚‚ã†ã‹ãªã‚Šå½“ãŸã‚Šå‰ã«ãªã£ã¦ãã¦ã„ã¾ã™ã€‚ãƒ†ã‚­ã‚¹ãƒˆã®æ„Ÿæ€§æƒ…å ±(ã‚»ãƒ³ãƒãƒ¡ãƒ³ãƒˆ)ã‚’æŠ½å‡ºã™ã‚‹æ‰‹æ³•ã«ã¯ã€ã©ã®ã‚ˆã†ãªã‚‚ã®ãŒã‚ã‚‹ã‹ã‚ã‚‹ã®ã‹èª¿ã¹ãŸã¨ã“ã‚ã‹ãªã‚Šæ™‚ä»£ã¯é€²ã‚“ã§ã„ã‚‹ã¨å®Ÿæ„Ÿã—ã¾ã—ãŸã€‚ã“ã‚Œã‚‰æ•°å›ã«ã‚ãŸã£ã¦ã€å®Ÿéš›ã«Rã‚„Pythonã§ä½œæˆã—ãŸæ©Ÿæ¢°å­¦ç¿’ãƒ¢ãƒ‡ãƒ«ã®ç²¾åº¦ã‚’æ¯”è¼ƒã—ã¦ã¿ãŸã„ã¨æ€ã„ã¾ã™ã€‚ ä»Šå›ã¯ãã®ç¬¬ï¼‘å›ç›®ã¨ã„ã†ã“ã¨ã§ã€ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã‚„å…¨ä½“æ„Ÿã®ãŠè©±ã§ã™ã€‚\n1. è§£ããŸã„å•é¡Œ ä»Šå›è§£ããŸã„å•é¡Œã¯ã€Œæ™¯æ³æ„Ÿã‚’è¡¨ã™æ–‡æ›¸è¡¨ç¾ã‚’å­¦ç¿’ã—ã€å®Ÿéš›ã®æ™¯æ°—åˆ¤æ–­ã‚’äºˆæ¸¬ã™ã‚‹ã€ã¨ã„ã†ã‚¿ã‚¹ã‚¯ã§ã™ã€‚ ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã«ã¯ã€å†…é–£åºœãŒå‡ºã—ã¦ã„ã‚‹æ™¯æ°—ã‚¦ã‚ªãƒƒãƒãƒ£ãƒ¼èª¿æŸ»ã‚’ä½¿ç”¨ã—ã¾ã™ã€‚\næ™¯æ°—ã‚¦ã‚ªãƒƒãƒãƒ£ãƒ¼èª¿æŸ»ã¨ã¯ æ™¯æ°—ã‚¦ã‚ªãƒƒãƒãƒ£ãƒ¼èª¿æŸ»ã¨ã¯ã€å†…é–£åºœãŒæœˆæ¬¡ã§å…¬è¡¨ã—ã¦ã„ã‚‹æ™¯æ°—å‹•å‘åˆ¤æ–­ã®ãŸã‚ã®çµ±è¨ˆæƒ…å ±ã§ã™ã€‚èª¿æŸ»ã®ç›®çš„ã¯ä»¥ä¸‹ã®é€šã‚Šã§ã™(å†…é–£åºœWebã‚µã‚¤ãƒˆã‚ˆã‚Š)ã€‚\n \u0026lt;èª¿æŸ»ã®ç›®çš„\u0026gt;  åœ°åŸŸã®æ™¯æ°—ã«é–¢é€£ã®æ·±ã„å‹•ãã‚’è¦³å¯Ÿã§ãã‚‹ç«‹å ´ã«ã‚ã‚‹äººã€…ã®å”åŠ›ã‚’å¾—ã¦ã€åœ°åŸŸã”ã¨ã®æ™¯æ°—å‹•å‘ã‚’çš„ç¢ºã‹ã¤è¿…é€Ÿã«æŠŠæ¡ã—ã€æ™¯æ°—å‹•å‘åˆ¤æ–­ã®åŸºç¤è³‡æ–™ã¨ã™ã‚‹ã“ã¨ã‚’ç›®çš„ã¨ã™ã‚‹ã€‚\n  ã§ã¯ã€ã“ã®ã€Œåœ°åŸŸã®æ™¯æ°—ã«é–¢é€£ã®æ·±ã„å‹•ãã‚’è¦³å¯Ÿã§ãã‚‹ç«‹å ´ã«ã‚ã‚‹äººã€…ã€ã€ã€Œåœ°åŸŸã”ã¨ã®æ™¯æ°—å‹•å‘ã€ã€ã€Œçš„ç¢ºã‹ã¤è¿…é€Ÿã«ã€ã¨ã„ã†éƒ¨åˆ†ã«ã¤ã„ã¦å°‘ã—æ·±æ˜ã£ã¦ã¿ã¾ã™ã€‚\nèª¿æŸ»ã®å¯¾è±¡ç¯„å›² èª¿æŸ»ã®å¯¾è±¡ç¯„å›²ã¯47éƒ½é“åºœçœŒã¨ãªã£ã¦ã„ã¾ã™ã€‚ã¾ãŸã€èª¿æŸ»å¯¾è±¡è€…ã¯ã€Œå®¶è¨ˆå‹•å‘ã€ä¼æ¥­å‹•å‘ã€é›‡ç”¨ç­‰ã€ä»£è¡¨çš„ãªçµŒæ¸ˆæ´»å‹•é …ç›®ã®å‹•å‘ã‚’æ•æ„Ÿã«åæ˜ ã™ã‚‹ç¾è±¡ã‚’è¦³å¯Ÿã§ãã‚‹æ¥­ç¨®ã®é©å½“ãªè·ç¨®ã®ä¸­ã‹ã‚‰é¸å®šã—ãŸ2,050äººã€ã¨ãªã£ã¦ãŠã‚Šã€ä¾‹ãˆã°å°å£²åº—ã‚„é£²é£Ÿåº—ã®åº—å“¡ãƒ»åº—é•·ã€ã‚¿ã‚¯ã‚·ãƒ¼é‹è»¢æ‰‹ã€è£½é€ æ¥­ãƒ»éè£½é€ æ¥­ä¼æ¥­ã®çµŒå–¶è€…ãƒ»å¾“æ¥­å“¡ã€äººææ´¾é£ä¼šç¤¾ç¤¾å“¡ãªã©ã‚’å¯¾è±¡ã«è¡Œã‚ã‚Œã¦ã„ã¾ã™ã€‚\nèª¿æŸ»æœŸæ—¥ãŠã‚ˆã³æœŸé–“ èª¿æŸ»ã¯æœˆæ¬¡ã§è¡Œã‚ã‚Œã€æ¯æœˆ25æ—¥ã‹ã‚‰æœˆæœ«ã«ã‹ã‘ã¦å®Ÿæ–½ã•ã‚Œã¾ã™ã€‚å½“æœˆã®æ™¯æ³æ„Ÿã«ã¤ã„ã¦èª¿æŸ»ãŒè¡Œã‚ã‚Œã€ç¿Œæœˆã«å…¬è¡¨ã•ã‚Œã¾ã™ã€‚\nèª¿æŸ»ã®å®Ÿæ–½æ–¹æ³• ã‚¢ãƒ³ã‚±ãƒ¼ãƒˆèª¿æŸ»ã‚’é›»è©±ãƒ»Webã‚µã‚¤ãƒˆãƒ»é›»å­ãƒ¡ãƒ¼ãƒ«ã®ã„ãšã‚Œã‹ã§å›ç­”ã™ã‚‹ã“ã¨ã«ãªã£ã¦ã„ã¾ã™ã€‚è³ªå•é …ç›®ã¯ä»¥ä¸‹ã®é€šã‚Šã§ã™(èª¿æŸ»ç¥¨)ã€‚\n  æ™¯æ°—ã®ç¾çŠ¶ã«å¯¾ã™ã‚‹åˆ¤æ–­ï¼ˆæ–¹å‘æ€§ï¼‰\n  1.ã®ç†ç”±\n  2.ã®è¿½åŠ èª¬æ˜åŠã³å…·ä½“çš„çŠ¶æ³ã®èª¬æ˜(è‡ªç”±è¨˜è¿°)\n  æ™¯æ°—ã®å…ˆè¡Œãã«å¯¾ã™ã‚‹åˆ¤æ–­(æ–¹å‘æ€§)\n  (4)ã®ç†ç”±\n  (å‚è€ƒ)æ™¯æ°—ã®ç¾çŠ¶ã«å¯¾ã™ã‚‹åˆ¤æ–­(æ°´æº–)\n  ã”å‚è€ƒã¾ã§ã«2016å¹´1æœˆèª¿æŸ»ã®ã‚µãƒ³ãƒ—ãƒ«ãƒ‡ãƒ¼ã‚¿ã‚’ãŠè¦‹ã›ã—ã¾ã™ã€‚\nlibrary(magrittr) sample \u0026lt;- readr::read_csv(r\u0026#34;(C:\\Users\\aashi\\Desktop\\TextMining\\æ™¯æ°—ã‚¦ã‚ªãƒƒãƒãƒ£ãƒ¼\\ç”Ÿãƒ‡ãƒ¼ã‚¿\\watcher_2016.csv)\u0026#34;,locale=readr::locale(encoding=\u0026#34;SHIFT-JIS\u0026#34;), show_col_types=FALSE) options(kableExtra.html.bsTable = TRUE) knitr::kable(head(sample)) %\u0026gt;% kableExtra::kable_styling(bootstrap_options = c(\u0026#34;striped\u0026#34;)) \r\råŸºæº–å¹´ \råŸºæº–æ—¥ \ræ™¯æ°—ã®ç¾çŠ¶åˆ¤æ–­ \ræ¥­ç¨®ãƒ»è·ç¨® \råˆ¤æ–­ã®ç†ç”± \rè¿½åŠ èª¬æ˜åŠã³å…·ä½“çš„çŠ¶æ³ã®èª¬æ˜ \r\r\r\r\r2016 \r1æœˆ31æ—¥ \râ— \ræ—…è¡Œä»£ç†åº—ï¼ˆå¾“æ¥­å“¡ï¼‰ \rè²©å£²é‡ã®å‹•ã \rãƒ»åº—é ­ã®å–æ‰±é¡ãŒå‰å¹´æ¯”ç´„120ï¼…ã¨å¥½èª¿ã§ã‚ã£ãŸã€‚ \r\r\r2016 \r1æœˆ31æ—¥ \râ— \rè¦³å…‰åæ‰€ï¼ˆå¾“æ¥­å“¡ï¼‰ \ræ¥å®¢æ•°ã®å‹•ã \rãƒ»å½“æ–½è¨­ã®åˆ©ç”¨ä¹—é™å®¢æ•°ã¯ï¼‘æœˆ26æ—¥æ™‚ç‚¹ã§å‰å¹´æ¯”130.1ï¼…ã¨ãªã£ã¦ãŠã‚Šã€ï¼‘æœˆã¨ã—ã¦ã¯éå»æœ€é«˜ã®åˆ©ç”¨ä¹—é™å®¢æ•°ã«ãªã‚‹ã“ã¨ãŒç¢ºå®šã—ãŸã»ã©ã®å…¥è¾¼çŠ¶æ³ã«ã‚ã‚‹ã€‚ \r\r\r2016 \r1æœˆ31æ—¥ \râ—‹ \rä¸€èˆ¬å°å£²åº—ï¼»é…’ï¼½ï¼ˆçµŒå–¶è€…ï¼‰ \rå˜ä¾¡ã®å‹•ã \rãƒ»å¹´æœ«ã®æ¶ˆè²»ã®åå‹•ã‚‚ã‚ã£ã¦ã‹ã€å®¢ã®å‹•ããŒã‚„ã‚„éˆã„ã€‚ãŸã ã€ç›¸å¤‰ã‚ã‚‰ãšé«˜é¡å•†æãŒå£²ã‚Œã¦ã„ã‚‹ã¨ã„ã†ã“ã¨ã‚‚ã‚ã‚Šã€å£²ä¸Šã¯ãã‚Œãªã‚Šã®é‡‘é¡ã‚’ã‚­ãƒ¼ãƒ—ã—ã¦ã„ã‚‹ã€‚ \r\r\r2016 \r1æœˆ31æ—¥ \râ—‹ \rç™¾è²¨åº—ï¼ˆå£²å ´ä¸»ä»»ï¼‰ \rãŠå®¢æ§˜ã®æ§˜å­ \rãƒ»å¤–å›½äººè¦³å…‰å®¢ã«ã‚ˆã‚‹å£²ä¸ŠãŒå‰å¹´æ¯”152ï¼…ã¨å¥½èª¿ã‚’ç¶™ç¶šã—ã¦ã„ã‚‹ã»ã‹ã€æ¥å®¢æ•°ãŒå‰å¹´æ¯”102ï¼…ã¨å¥½èª¿ã‚’ç¶­æŒã—ã¦ã„ã‚‹ã€‚æœˆåŠã°ã«åœæ»ã—ãŸå£²ä¸Šã‚‚ä¸‹æ—¬ã«å…¥ã£ã¦ã‹ã‚‰å›å¾©å‚¾å‘ã«ã‚ã‚Šã€å®šä¾¡å“ã€ãƒãƒ¼ã‚²ãƒ³å“ã¨ã‚‚å‰å¹´ã‚’ä¸Šå›ã£ã¦ã„ã‚‹ã€‚ \r\r\r2016 \r1æœˆ31æ—¥ \râ—‹ \rç™¾è²¨åº—ï¼ˆæ‹…å½“è€…ï¼‰ \ræ¥å®¢æ•°ã®å‹•ã \rãƒ»ç©æ¥µçš„ã«æ™¯æ°—ãŒä¸Šå‘ãã«ã‚ã‚‹ã¨ã¾ã§ã¯ã„ã„ã¥ã‚‰ã„ã‚‚ã®ã®ã€ï¼“ã‹æœˆå‰ã¨ã®æ¯”è¼ƒã§ã¯æ”¹å–„ã—ã¦ã„ã‚‹ã€‚ \r\r\r2016 \r1æœˆ31æ—¥ \râ—‹ \rç™¾è²¨åº—ï¼ˆè²©å£²ä¿ƒé€²æ‹…å½“ï¼‰ \rãã‚Œä»¥å¤– \rãƒ»æ°—æ¸©ãŒå¹³å¹´ä¸¦ã¿ã¨ãªã‚Šã€ã“ã‚Œã¾ã§ã®æ¸©æš–ã€å°‘é›ªã®çŠ¶æ…‹ãŒã¿ã‚‰ã‚Œãªããªã£ã¦ããŸã“ã¨ã§ã€é˜²å¯’è¡£æ–™ã€é›‘è²¨å•†æã‚’ä¸­å¿ƒã«å¤šå°‘æ”¹å–„ã®å‚¾å‘ãŒã¿ã‚‰ã‚Œã‚‹ã€‚ \r\r\r\rå•é¡Œè¨­å®š ä»Šå›ã®å•é¡Œè¨­å®šã¯ã€ã€Œè¿½åŠ èª¬æ˜åŠã³å…·ä½“çš„çŠ¶æ³ã®èª¬æ˜ã€ã«è¨˜è¼‰ã•ã‚Œã¦ã„ã‚‹ãƒ†ã‚­ã‚¹ãƒˆæƒ…å ±ã‚’ã‚‚ã¨ã«ã€ã€Œæ™¯æ°—ã®ç¾çŠ¶åˆ¤æ–­ã€ã‚’äºˆæ¸¬ã™ã‚‹ã‚¿ã‚¹ã‚¯ã«ãªã‚Šã¾ã™ã€‚ ã€Œæ™¯æ°—ã®ç¾çŠ¶åˆ¤æ–­ã€ã¯ã€Œè‰¯ã„ã€ã€ã€Œã‚„ã‚„è‰¯ã„ã€ã€ã€Œã©ã¡ã‚‰ã¨ã‚‚è¨€ãˆãªã„ã€ã€ã€Œã‚„ã‚„æ‚ªã„ã€ã€ã€Œæ‚ªã„ã€ã¨ãªã£ã¦ãŠã‚Šã€ã“ã‚Œã‚’2å€¤åˆ†é¡å•é¡Œã«ã—ã¦å­¦ç¿’ã‚’è¡Œã„ã¾ã™(ã©ã¡ã‚‰ã¨ã‚‚è¨€ãˆãªã„ã¯ãƒã‚¬ãƒ†ã‚£ãƒ–ã«åˆ†é¡)ã€‚\n2. ãƒ†ã‚­ã‚¹ãƒˆè§£ææ‰‹æ³•ã®é€²åŒ–ã®è­œç³» ä¸Šè¨˜å•é¡Œè¨­å®šã‚’è§£ããŸã‚ã«ã¯ã€ãƒ†ã‚­ã‚¹ãƒˆæƒ…å ±ã‹ã‚‰æ„Ÿæ€§æƒ…å ±(ã‚»ãƒ³ãƒãƒ¡ãƒ³ãƒˆ)ã‚’æŠ½å‡ºã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚ç§ãŒèª¿ã¹ãŸæµ…ã„çŸ¥è­˜ã«ã‚ˆã‚‹ã¨ã€æ„Ÿæ€§æƒ…å ±ã®æŠ½å‡ºæ–¹æ³•ã«ã¯ä»¥ä¸‹ã®ã‚ˆã†ãªæ‰‹æ³•ãŒã‚ã‚Šã¾ã™ã€‚\n è¾æ›¸ãƒ™ãƒ¼ã‚¹ ãƒŠã‚¤ãƒ¼ãƒ–ãƒ™ã‚¤ã‚ºåˆ†é¡å™¨ å˜èªåŸ‹ã‚è¾¼ã¿(Word Embedding)ã‚’ç”¨ã„ãŸæ–¹æ³• Recurrent neural network(RNN) Transformer  ãŠãã‚‰ãã€ä¸‹ã«è¡Œãã«ã¤ã‚Œã¦ã‚ˆã‚Šæœ€æ–°ã®æ‰‹æ³•ã«ãªã£ã¦ãŠã‚Šã€ç²¾åº¦ã‚‚é«˜ã„ã®ã§ã¯ãªã„ã‹ã¨æ¨å¯Ÿã•ã‚Œã¾ã™ã€‚ ã¾ãŸã€1,2,3ã¯ã‚„ã‚Šæ–¹ã«ã‚‚ã‚ˆã‚‹ã‚“ã§ã—ã‚‡ã†ãŒæ–‡ç« ãŒä¸ãˆã‚‰ã‚ŒãŸéš›ã«ãã®èªé †é–¢ä¿‚ã‚’è€ƒæ…®ã—ã¾ã›ã‚“ã€‚ ä»Šå¾Œã€å„æ‰‹æ³•ã«ã¤ã„ã¦è§£æçµæœã®è¨˜äº‹ã‚’æŠ•ç¨¿ã™ã‚‹äºˆå®šã§ã™ã®ã§ã€è©³ã—ã„ä¸­èº«ã«ã¤ã„ã¦ã¯ãã‚Œãã‚Œã®å›ã§è§¦ã‚ŒãŸã„ã¨æ€ã„ã¾ã™ã€‚\n3. ã‚µãƒ³ãƒ—ãƒ«ãƒ‡ãƒ¼ã‚¿æ¦‚è¦³ ã‚µãƒ³ãƒ—ãƒ«ãƒ‡ãƒ¼ã‚¿ã®èª­ã¿è¾¼ã¿ ä»Šå›ä½¿ç”¨ã™ã‚‹æ™¯æ°—ã‚¦ã‚ªãƒƒãƒãƒ£ãƒ¼èª¿æŸ»ã®ã‚µãƒ³ãƒ—ãƒ«ã¯2016å¹´~2020å¹´ã®ã‚‚ã®ã¨ãªã£ã¦ã„ã¾ã™ã€‚ç¾çŠ¶åˆ¤æ–­ã®èª¿æŸ»çµæœã‚’æ ¼ã®ã—ãŸcsvãƒ•ã‚¡ã‚¤ãƒ«(æ™¯æ°—åˆ¤æ–­ç†ç”±é›†)ã‚’æœˆã”ã¨ã«å†…é–£åºœã®Webãƒšãƒ¼ã‚¸ã‹ã‚‰ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ã€æ•´å½¢ã—ãŸã‚‚ã®ã‚’å¹´ã”ã¨ã«é€£çµã—ã¦ã„ã¾ã™ã€‚\nfilepath = r\u0026#34;(C:\\Users\\hogehoge\\Watcher\\RawData)\u0026#34; files \u0026lt;- stringr::str_c(filepath, \u0026#34;\\\\\u0026#34;,list.files(filepath, pattern = \u0026#34;*.csv\u0026#34;)) sample \u0026lt;- readr::read_csv(files, locale=readr::locale(encoding=\u0026#34;SHIFT-JIS\u0026#34;), show_col_types = FALSE) # ã€Œï¼ã€ã¯å›ç­”ãŒå­˜åœ¨ã—ãªã„ã€ã€Œï¼Šã€ã¯ä¸»ã ã£ãŸå›ç­”ç­‰ãŒå­˜åœ¨ã—ãªã„ãŸã‚ã€é™¤å¤– sample \u0026lt;- sample[sample$è¿½åŠ èª¬æ˜åŠã³å…·ä½“çš„çŠ¶æ³ã®èª¬æ˜ != \u0026#34;ï¼\u0026#34;,] sample \u0026lt;- sample[sample$è¿½åŠ èª¬æ˜åŠã³å…·ä½“çš„çŠ¶æ³ã®èª¬æ˜ != \u0026#34;ï¼Š\u0026#34;,] çŸ¥ã‚‰ãªã‹ã£ãŸã‚“ã§ã™ãŒã€readr::read_csvã£ã¦2.0.0ã‹ã‚‰ãƒ•ã‚¡ã‚¤ãƒ«ãƒ‘ã‚¹ã®ãƒªã‚¹ãƒˆã‚’å¼•æ•°ã¨ã—ã¦csvã‚’èª­ã¿è¾¼ã¿ã€ãã®çµæœã‚’é€£çµã—ã¦ãã‚Œã‚‹ã‚ˆã†ã«ãªã£ãŸã‚“ã§ã™ã­ã€‚åœ°å‘³ã«ä¾¿åˆ©ã§ã™ã€‚\nã‚µãƒ³ãƒ—ãƒ«ã‚µã‚¤ã‚º ã‚µãƒ³ãƒ—ãƒ«ã‚µã‚¤ã‚ºã¯76800ã§ã—ãŸã€‚ã‚µãƒ³ãƒ—ãƒ«ã‚µã‚¤ã‚ºã¨ã—ã¦ã¯ç”³ã—åˆ†ãªã„ã‹ã¨æ€ã„ã¾ã™ã€‚\nNROW(sample) ## [1] 76800\rå¿µã®ãŸã‚ã€å„å¹´ã”ã¨ã«ã‚‚è¦‹ã¦ã¿ã¾ã™ã€‚\nlibrary(magrittr) sample %\u0026gt;% dplyr::group_by(åŸºæº–å¹´) %\u0026gt;% dplyr::summarise(ã‚µãƒ³ãƒ—ãƒ«ã‚µã‚¤ã‚º=dplyr::n()) %\u0026gt;% dplyr::mutate(`å‰²åˆ(%)`=round(ã‚µãƒ³ãƒ—ãƒ«ã‚µã‚¤ã‚º/sum(ã‚µãƒ³ãƒ—ãƒ«ã‚µã‚¤ã‚º)*100, digits=1)) %\u0026gt;% knitr::kable() %\u0026gt;% kableExtra::kable_styling(bootstrap_options = c(\u0026#34;striped\u0026#34;)) \r\råŸºæº–å¹´ \rã‚µãƒ³ãƒ—ãƒ«ã‚µã‚¤ã‚º \rå‰²åˆ(%) \r\r\r\r\r2016 \r15168 \r19.8 \r\r\r2017 \r16724 \r21.8 \r\r\r2018 \r14756 \r19.2 \r\r\r2019 \r14588 \r19.0 \r\r\r2020 \r15564 \r20.3 \r\r\r\rå„å¹´ãŠã‚ˆã14,000~16,000ã‚µãƒ³ãƒ—ãƒ«ã»ã©å­˜åœ¨ã™ã‚‹ã‚ˆã†ã§ã™ã€‚å¤§ããªãƒãƒ©ãƒ„ã‚­ã‚‚ã‚ã‚Šã¾ã›ã‚“ã€‚\næ™¯æ°—ã®ç¾çŠ¶åˆ¤æ–­ã®åˆ†å¸ƒ ã“ã‚Œã‹ã‚‰äºˆæ¸¬ã‚’è¡Œã†æ™¯æ°—ã®ç¾çŠ¶åˆ¤æ–­ã¯ã©ã®ã‚ˆã†ãªåˆ†å¸ƒã«ãªã£ã¦ã„ã‚‹ã§ã—ã‚‡ã†ã‹ã€‚\nsample$æ™¯æ°—ã®ç¾çŠ¶åˆ¤æ–­ \u0026lt;- factor(sample$æ™¯æ°—ã®ç¾çŠ¶åˆ¤æ–­, levels=c(\u0026#34;â—\u0026#34;,\u0026#34;â—‹\u0026#34;,\u0026#34;â–¡\u0026#34;,\u0026#34;â–²\u0026#34;,\u0026#34;Ã—\u0026#34;)) sample %\u0026gt;% dplyr::group_by(æ™¯æ°—ã®ç¾çŠ¶åˆ¤æ–­) %\u0026gt;% dplyr::summarise(ã‚µãƒ³ãƒ—ãƒ«ã‚µã‚¤ã‚º=dplyr::n()) %\u0026gt;% dplyr::mutate(`å‰²åˆ(%)`=round(ã‚µãƒ³ãƒ—ãƒ«ã‚µã‚¤ã‚º/sum(ã‚µãƒ³ãƒ—ãƒ«ã‚µã‚¤ã‚º)*100, digits=1)) %\u0026gt;% knitr::kable() %\u0026gt;% kableExtra::kable_styling(bootstrap_options = c(\u0026#34;striped\u0026#34;)) \r\ræ™¯æ°—ã®ç¾çŠ¶åˆ¤æ–­ \rã‚µãƒ³ãƒ—ãƒ«ã‚µã‚¤ã‚º \rå‰²åˆ(%) \r\r\r\r\râ— \r1569 \r2.0 \r\r\râ—‹ \r14370 \r18.7 \r\r\râ–¡ \r34438 \r44.8 \r\r\râ–² \r18642 \r24.3 \r\r\rÃ— \r7781 \r10.1 \r\r\r\ræ€ã£ãŸã‚ˆã‚Šã‚­ãƒ¬ã‚¤ãªåˆ†å¸ƒã‚’ã—ã¦ã„ã‚‹å°è±¡ã§ã™ã€‚ã“ã®ã‚µãƒ³ãƒ—ãƒ«æœŸé–“ã§ã¯ã€ã€Œã©ã¡ã‚‰ã¨ã‚‚è¨€ãˆãªã„ã€ãŒæœ€ã‚‚å¤šãã€ã¾ãŸã€æ¯”è¼ƒçš„ã€Œã‚„ã‚„æ‚ªã„ã€ã‚„ã€Œæ‚ªã„ã€ãŒå¤šã„ã“ã¨ãŒã‚ã‹ã‚Šã¾ã™ã€‚ã“ã®ã‚ãŸã‚Šã¯2019å¹´åº¦ä»¥é™ã®ã‚³ãƒ­ãƒŠç¦ã®å½±éŸ¿ã‚’åæ˜ ã—ã¦ã„ã‚‹å¯èƒ½æ€§ãŒã‚ã‚‹ã®ã§ã€æ–°ãŸã«æ™‚é–“è»¸ã‚’è¿½åŠ ã—ã€ã‚¯ãƒ­ã‚¹é›†è¨ˆã‚’ã—ã¦ã¿ã¾ã—ã‚‡ã†ã€‚\nsample %\u0026gt;% dplyr::group_by(åŸºæº–å¹´, æ™¯æ°—ã®ç¾çŠ¶åˆ¤æ–­) %\u0026gt;% dplyr::tally() %\u0026gt;% tidyr::spread(æ™¯æ°—ã®ç¾çŠ¶åˆ¤æ–­, n) %\u0026gt;% knitr::kable() %\u0026gt;% kableExtra::kable_styling(bootstrap_options = c(\u0026#34;striped\u0026#34;)) \r\råŸºæº–å¹´ \râ— \râ—‹ \râ–¡ \râ–² \rÃ— \r\r\r\r\r2016 \r235 \r2455 \r7546 \r4129 \r803 \r\r\r2017 \r375 \r4031 \r8681 \r3053 \r584 \r\r\r2018 \r349 \r3105 \r7340 \r3336 \r626 \r\r\r2019 \r237 \r2050 \r6743 \r4516 \r1042 \r\r\r2020 \r373 \r2729 \r4128 \r3608 \r4726 \r\r\r\rã‚„ã¯ã‚Šã€2019å¹´ä»¥é™ã€Œæ‚ªã„ã€ãŒå¤šãå‡ºç¾ã—ã¦ã„ã‚‹ã“ã¨ãŒã‚ã‹ã‚Šã¾ã™ã€‚ä¸€æ–¹ã§ã€ã€Œã‚„ã‚„æ‚ªã„ã€ã¯ãã‚Œä»¥å‰ã®å¹´ã§ã‚‚æ’å¸¸çš„ã«å¤šã„ã‚ˆã†ã§ã™ã€‚\nå›ç­”è€…ã®å±æ€§ æ¬¡ã«å›ç­”è€…ã®å±æ€§ã‚’ç¢ºèªã—ã¾ã—ã‚‡ã†ã€‚å›ç­”è€…ã®å±æ€§ã¯æ¥­ç¨®ãƒ»è·ç¨®ã‹ã‚‰å–å¾—ã§ãã¾ã™ã€‚ã¾ãšã€ã©ã†ã„ã£ãŸæ¥­ç¨®ãŒå¤šãå›ç­”ã—ã¦ã„ã‚‹ã®ã‹ç¢ºèªã—ã¦ã¿ã¾ã™ã€‚å›ç­”æ•°ä¸Šä½10ç•ªç›®ã¾ã§ã®æ¥­ç¨®ã‚’è¡¨ç¤ºã•ã›ã¾ã™ã€‚\nsample %\u0026gt;% dplyr::mutate(æ¥­ç¨® = stringr::str_remove(sample$`æ¥­ç¨®ãƒ»è·ç¨®`, \u0026#34;ï¼ˆ.+ï¼‰\u0026#34;) %\u0026gt;% stringr::str_remove(\u0026#34;ï¼».+ï¼½\u0026#34;)) %\u0026gt;% dplyr::group_by(æ¥­ç¨®) %\u0026gt;% dplyr::summarise(ã‚µãƒ³ãƒ—ãƒ«ã‚µã‚¤ã‚º=dplyr::n()) %\u0026gt;% dplyr::arrange(desc(ã‚µãƒ³ãƒ—ãƒ«ã‚µã‚¤ã‚º)) %\u0026gt;% dplyr::top_n(10, ã‚µãƒ³ãƒ—ãƒ«ã‚µã‚¤ã‚º) %\u0026gt;% dplyr::mutate(`å‰²åˆ(%)`=round(ã‚µãƒ³ãƒ—ãƒ«ã‚µã‚¤ã‚º/sum(ã‚µãƒ³ãƒ—ãƒ«ã‚µã‚¤ã‚º)*100, digits=1)) %\u0026gt;% knitr::kable() %\u0026gt;% kableExtra::kable_styling(bootstrap_options = c(\u0026#34;striped\u0026#34;)) \r\ræ¥­ç¨® \rã‚µãƒ³ãƒ—ãƒ«ã‚µã‚¤ã‚º \rå‰²åˆ(%) \r\r\r\r\rç™¾è²¨åº— \r4959 \r15.1 \r\r\rã‚¹ãƒ¼ãƒ‘ãƒ¼ \r4738 \r14.4 \r\r\rä¸€èˆ¬å°å£²åº— \r3851 \r11.7 \r\r\rã‚³ãƒ³ãƒ“ãƒ‹ \r3772 \r11.5 \r\r\rä¹—ç”¨è»Šè²©å£²åº— \r2967 \r9.0 \r\r\ré€šä¿¡ä¼šç¤¾ \r2866 \r8.7 \r\r\rå•†åº—è¡— \r2734 \r8.3 \r\r\räººææ´¾é£ä¼šç¤¾ \r2700 \r8.2 \r\r\rè¡£æ–™å“å°‚é–€åº— \r2128 \r6.5 \r\r\rè·æ¥­å®‰å®šæ‰€ \r2088 \r6.4 \r\r\r\rå›ç­”æ•°ä¸Šä½ã«ã¯ã€ç™¾è²¨åº—ã‚„ã‚¹ãƒ¼ãƒ‘ãƒ¼ãªã©å°å£²åº—ãŒç›®ç«‹ã¡ã¾ã™ã€‚ã¾ãŸã€è»Šã®ãƒ‡ã‚£ãƒ¼ãƒ©ãƒ¼ã®æ–¹ã‚„äººææ´¾é£ä¼šç¤¾ãªã©ç”Ÿç”£ãƒ»é›‡ç”¨ã«é–¢é€£ã™ã‚‹æ¥­ç¨®ã®å›ç­”è€…ã‚‚å¤šã„ã‚ˆã†ã§ã™ã€‚\næ¬¡ã«ã€çµŒå–¶è€…ã‚„è·å“¡ãªã©è·ç¨®ã®åˆ†å¸ƒã‚’ç¢ºèªã—ã¾ã™ã€‚ã“ã¡ã‚‰ã‚‚ä¸Šä½10ä½ã¾ã§ã‚’è¡¨ç¤ºã—ã¾ã™ã€‚\nsample %\u0026gt;% dplyr::mutate(è·ç¨® = stringr::str_extract(sample$`æ¥­ç¨®ãƒ»è·ç¨®`, \u0026#34;ï¼ˆ.+ï¼‰\u0026#34;) %\u0026gt;% stringr::str_remove(\u0026#34;ï¼ˆ\u0026#34;) %\u0026gt;% stringr::str_remove(\u0026#34;ï¼‰\u0026#34;)) %\u0026gt;% dplyr::group_by(è·ç¨®) %\u0026gt;% dplyr::summarise(ã‚µãƒ³ãƒ—ãƒ«ã‚µã‚¤ã‚º=dplyr::n()) %\u0026gt;% dplyr::arrange(desc(ã‚µãƒ³ãƒ—ãƒ«ã‚µã‚¤ã‚º)) %\u0026gt;% dplyr::top_n(10, ã‚µãƒ³ãƒ—ãƒ«ã‚µã‚¤ã‚º) %\u0026gt;% dplyr::mutate(`å‰²åˆ(%)`=round(ã‚µãƒ³ãƒ—ãƒ«ã‚µã‚¤ã‚º/sum(ã‚µãƒ³ãƒ—ãƒ«ã‚µã‚¤ã‚º)*100, digits=1)) %\u0026gt;% knitr::kable() %\u0026gt;% kableExtra::kable_styling(bootstrap_options = c(\u0026#34;striped\u0026#34;)) \r\rè·ç¨® \rã‚µãƒ³ãƒ—ãƒ«ã‚µã‚¤ã‚º \rå‰²åˆ(%) \r\r\r\r\rçµŒå–¶è€… \r20612 \r40.0 \r\r\rå–¶æ¥­æ‹…å½“ \r7057 \r13.7 \r\r\rå¾“æ¥­å“¡ \r4371 \r8.5 \r\r\råº—é•· \r4343 \r8.4 \r\r\rNA \r3145 \r6.1 \r\r\rè·å“¡ \r3118 \r6.1 \r\r\rç·å‹™æ‹…å½“ \r2930 \r5.7 \r\r\rä»£è¡¨è€… \r2615 \r5.1 \r\r\rç¤¾å“¡ \r1796 \r3.5 \r\r\rå½¹å“¡ \r1518 \r2.9 \r\r\r\rè·ç¨®åˆ¥ã§ã¯çµŒå–¶è€…ãŒãƒ€ãƒ³ãƒˆãƒ„ã§å¤šã„çµæœã¨ãªã‚Šã¾ã—ãŸã€‚ä»£è¡¨è€…ãªã©è¡¨è¨˜æºã‚Œã‚‚ã‚ã‚Šã¾ã™ã®ã§ã€å®Ÿæ…‹ã¯ã‚‚ã†å°‘ã—å¤šã„ã¨æ€ã„ã¾ã™ã€‚æƒ³åƒã§ã¯ã€ç¾å ´ã®è·å“¡ã®æ–¹ã®å›ç­”ãŒå¤šã„ã¨æ€ã£ã¦ã„ã¾ã—ãŸãŒäºˆæƒ³ã¨ã¯ç•°ãªã‚‹çµæœã¨ãªã‚Šã¾ã—ãŸã€‚\n(æ™¯æ°—)åˆ¤æ–­ã®ç†ç”±ã®åˆ†å¸ƒ æ¬¡ã«(æ™¯æ°—)åˆ¤æ–­ã®ç†ç”±ã®åˆ†å¸ƒã‚’è¦‹ã¾ã™ã€‚\nresults \u0026lt;- sample %\u0026gt;% dplyr::group_by(åˆ¤æ–­ã®ç†ç”±) %\u0026gt;% dplyr::summarise(ã‚µãƒ³ãƒ—ãƒ«ã‚µã‚¤ã‚º=dplyr::n()) %\u0026gt;% dplyr::arrange(desc(ã‚µãƒ³ãƒ—ãƒ«ã‚µã‚¤ã‚º)) %\u0026gt;% dplyr::mutate(`å‰²åˆ(%)`=round(ã‚µãƒ³ãƒ—ãƒ«ã‚µã‚¤ã‚º/sum(ã‚µãƒ³ãƒ—ãƒ«ã‚µã‚¤ã‚º)*100, digits=1)) results %\u0026gt;% knitr::kable() %\u0026gt;% kableExtra::kable_styling(bootstrap_options = c(\u0026#34;striped\u0026#34;)) \r\råˆ¤æ–­ã®ç†ç”± \rã‚µãƒ³ãƒ—ãƒ«ã‚µã‚¤ã‚º \rå‰²åˆ(%) \r\r\r\r\ræ¥å®¢æ•°ã®å‹•ã \r17432 \r22.7 \r\r\rè²©å£²é‡ã®å‹•ã \r16153 \r21.0 \r\r\rãŠå®¢æ§˜ã®æ§˜å­ \r11511 \r15.0 \r\r\rå—æ³¨é‡ã‚„è²©å£²é‡ã®å‹•ã \r9033 \r11.8 \r\r\rå–å¼•å…ˆã®æ§˜å­ \r5034 \r6.6 \r\r\ræ±‚äººæ•°ã®å‹•ã \r4155 \r5.4 \r\r\rãã‚Œä»¥å¤– \r4007 \r5.2 \r\r\rå˜ä¾¡ã®å‹•ã \r3654 \r4.8 \r\r\rç«¶äº‰ç›¸æ‰‹ã®æ§˜å­ \r1603 \r2.1 \r\r\rå‘¨è¾ºä¼æ¥­ã®æ§˜å­ \r1161 \r1.5 \r\r\rå—æ³¨ä¾¡æ ¼ã‚„è²©å£²ä¾¡æ ¼ã®å‹•ã \r1099 \r1.4 \r\r\ræ±‚è·è€…æ•°ã®å‹•ã \r930 \r1.2 \r\r\ræ¡ç”¨è€…æ•°ã®å‹•ã \r666 \r0.9 \r\r\ré›‡ç”¨å½¢æ…‹ã®æ§˜å­ \r361 \r0.5 \r\r\rè²©å£²é‡ã®å‹•ã \r1 \r0.0 \r\r\r\rã€Œæ¥å®¢æ•°ã®å‹•ãã€ã¨ã€Œè²©å£²é‡ã®å‹•ãã€ãŒå¤šãã€ã€ŒãŠå®¢æ§˜ã®æ§˜å­ã€ã‚„ã€Œå—æ³¨é‡ã‚„è²©å£²é‡ã®å‹•ãã€ã¾ã§å«ã‚ã‚‹ã¨7å‰²ã‚’å ã‚ã¾ã™ã€‚å›ç­”æ¥­ç¨®ã«å°å£²åº—ãŒå¤šã„ã“ã¨ã‹ã‚‰ã€ã“ã®ã‚ˆã†ãªé …ç›®ãŒä¸Šä½ã«ãã¦ã„ã‚‹ã®ã ã¨æ¨å¯Ÿã•ã‚Œã¾ã™ã€‚\næ™¯æ°—åˆ¤æ–­ã®ç†ç”±ã«é–¢ã™ã‚‹ãƒ†ã‚­ã‚¹ãƒˆãƒã‚¤ãƒ‹ãƒ³ã‚° æ™¯æ°—ã®ç¾çŠ¶åˆ¤æ–­ã«å¯¾ã™ã‚‹ç†ç”±ã®è¿½åŠ èª¬æ˜åŠã³å…·ä½“çš„çŠ¶æ³ã®èª¬æ˜ã‚’è§£æã—ã€ã©ã®ã‚ˆã†ãªå˜èªãŒé »ç¹ã«ä½¿ç”¨ã•ã‚Œã¦ã„ã‚‹ã‹ã‚’WordCloudã‚’ç”¨ã„ã¦ç¢ºèªã—ã¾ã™ã€‚\nã¾ãšã€æ–‡æ›¸ã®ãƒˆãƒ¼ã‚¯ãƒ³åŒ–ã‚’è¡Œã„ã¾ã™ã€‚æ—¥æœ¬èªã®ã‚ˆã†ãªè¨€èªã§ã¯è‹±èªãªã©ã¨ç•°ãªã‚Šå˜èªã”ã¨ã®é–“ã«ã‚¹ãƒšãƒ¼ã‚¹ãŒãªã„ãŸã‚ã€åˆ¥é€”åŒºåˆ‡ã‚Šã‚’å…¥ã‚Œã¦ã‚„ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚åŒºåˆ‡ã‚‰ã‚ŒãŸå„èªã¯å½¢æ…‹ç´ ã¨å‘¼ã°ã‚Œã€è¨€è‘‰ãŒæ„å‘³ã‚’æŒã¤ã¾ã¨ã¾ã‚Šã®å˜èªã®æœ€å°å˜ä½ã‚’æŒ‡ã—ã¾ã™ã€‚ã¾ãŸã€æ–‡ç« ã‚’å½¢æ…‹ç´ ã¸åˆ†å‰²ã™ã‚‹ã“ã¨ã‚’å½¢æ…‹ç´ è§£æã¨è¨€ã„ã¾ã™(è‹±èªã®ã‚ˆã†ãªå ´åˆå˜ã«Tokenizationã¨è¨€ã£ãŸã‚Šã—ã¾ã™)ã€‚\nå½¢æ…‹ç´ è§£æã‚’è¡Œã†ãƒ„ãƒ¼ãƒ«ã¯ä»¥ä¸‹ã®ã‚ˆã†ãªã‚‚ã®ãŒå­˜åœ¨ã—ã¾ã™ã€‚\n MeCab JUMAN JANOME Ginza Sudachi  ãŠãã‚‰ãæœ€ã‚‚ä½¿ç”¨ã•ã‚Œã¦ã„ã‚‹ã‚‚ã®ã¯Mecabã§ã¯ãªã„ã‹ã¨æ€ã„ã¾ã™ãŒã€æ¨™æº–è£…å‚™ã•ã‚Œã¦ã„ã‚‹è¾æ›¸(ipadic)ã®æ›´æ–°ãŒã‚¹ãƒˆãƒƒãƒ—ã—ã¦ãŠã‚Šã€æœ€è¿‘ã®æ–°èªã«å¯¾å¿œã§ããªã„ã¨ã„ã†å•é¡ŒãŒã‚ã‚Šã¾ã™ã€‚ã“ã®ç‚¹ã«ã¤ã„ã¦ã¯æ–°èªã«å¼·ã„NEologdè¾æ›¸ã‚’åŠ ãˆã‚‹ã“ã¨ã§ã€å¯¾å‡¦å¯èƒ½ã§ã‚ã‚‹ã“ã¨ã‚’åˆ¥è¨˜äº‹ã§ç´¹ä»‹ã—ã¦ã„ã¾ã™ãŒã€ä»Šå›ã¯ãƒ¯ãƒ¼ã‚¯ã‚¹ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚ºãŒæä¾›ã—ã¦ã„ã‚‹Sudachi[@TAKAOKA18.8884]ã‚’ä½¿ç”¨ã™ã‚‹ã“ã¨ã«ã—ãŸã„ã¨æ€ã„ã¾ã™ã€‚å…¬å¼Githubã‹ã‚‰Sudachiã®ç‰¹é•·ã‚’å¼•ç”¨ã—ã¾ã™ã€‚\n  è¤‡æ•°ã®åˆ†å‰²å˜ä½ã®ä½µç”¨\n å¿…è¦ã«å¿œã˜ã¦åˆ‡ã‚Šæ›¿ãˆ å½¢æ…‹ç´ è§£æã¨å›ºæœ‰è¡¨ç¾æŠ½å‡ºã®èåˆ    å¤šæ•°ã®åéŒ²èªå½™\n UniDic ã¨ NEologd ã‚’ãƒ™ãƒ¼ã‚¹ã«èª¿æ•´    æ©Ÿèƒ½ã®ãƒ—ãƒ©ã‚°ã‚¤ãƒ³åŒ–\n æ–‡å­—æ­£è¦åŒ–ã‚„æœªçŸ¥èªå‡¦ç†ã«æ©Ÿèƒ½è¿½åŠ ãŒå¯èƒ½    åŒç¾©èªè¾æ›¸ã¨ã®é€£æº\n å¾Œæ—¥å…¬é–‹äºˆå®š    ç‰¹è³ªã™ã¹ãã¯ã€Œè¤‡æ•°ã®åˆ†å‰²å˜ä½ã®ä½µç”¨ã€ã§ã—ã‚‡ã†ã€‚Sudachiã§ã¯çŸ­ã„æ–¹ã‹ã‚‰ A, B, Cã®3ã¤ã®åˆ†å‰²ãƒ¢ãƒ¼ãƒ‰ã‚’æä¾›ã—ã¦ã„ã¾ã™ã€‚Aã¯UniDicçŸ­å˜ä½ç›¸å½“ã€Cã¯å›ºæœ‰è¡¨ç¾ç›¸å½“ã€Bã¯A, Cã®ä¸­é–“çš„ãªå˜ä½ã¨ãªã£ã¦ãŠã‚Šã€ä»¥ä¸‹ã®ã‚ˆã†ã«åŒã˜ã€Œé¸æŒ™ç®¡ç†å§”å“¡ä¼šã€ã¨ã„ã†å˜èªã§ã‚‚å½¢æ…‹ç´ ãŒç•°ãªã‚‹ã“ã¨ãŒç¢ºèªã§ãã¾ã™ã€‚ã“ã‚Œã¯Sudachiç‰¹æœ‰ã®ç‰¹é•·ã«ãªã‚Šã¾ã™ã€‚\nfrom sudachipy import tokenizer from sudachipy import dictionary tokenizer_obj = dictionary.Dictionary().create() mode = tokenizer.Tokenizer.SplitMode.A [m.normalized_form() for m in tokenizer_obj.tokenize(\u0026#34;é¸æŒ™ç®¡ç†å§”å“¡ä¼š\u0026#34;, mode)] ## ['é¸æŒ™', 'ç®¡ç†', 'å§”å“¡', 'ä¼š']\rmode = tokenizer.Tokenizer.SplitMode.B [m.normalized_form() for m in tokenizer_obj.tokenize(\u0026#34;é¸æŒ™ç®¡ç†å§”å“¡ä¼š\u0026#34;, mode)] ## ['é¸æŒ™', 'ç®¡ç†', 'å§”å“¡ä¼š']\rmode = tokenizer.Tokenizer.SplitMode.C [m.normalized_form() for m in tokenizer_obj.tokenize(\u0026#34;é¸æŒ™ç®¡ç†å§”å“¡ä¼š\u0026#34;, mode)] ## ['é¸æŒ™ç®¡ç†å§”å“¡ä¼š']\rã¾ãŸã€è¾æ›¸ã«ã¤ã„ã¦ã‚‚UniDicã¨NEologdã‚’ãƒ™ãƒ¼ã‚¹ã¨ã—ã¦æ›´æ–°ãŒç¶šã‘ã‚‰ã‚Œã¦ãŠã‚Šã€æ–°èªã«ã‚‚å¯¾å¿œã§ãã¾ã™ã€‚\nmode = tokenizer.Tokenizer.SplitMode.C [m.normalized_form() for m in tokenizer_obj.tokenize(\u0026#34;æ–°å‹ã‚³ãƒ­ãƒŠã‚¦ã‚¤ãƒ«ã‚¹\u0026#34;, mode)] ## ['æ–°å‹ã‚³ãƒ­ãƒŠã‚¦ã‚¤ãƒ«ã‚¹']\rå€‹äººçš„ã«ç´ æ™´ã‚‰ã—ã„ã¨æ€ã†ãƒã‚¤ãƒ³ãƒˆã¯è¡¨è¨˜æ­£è¦åŒ–ã‚„æ–‡å­—æ­£è¦åŒ–ãŒã§ãã‚‹ã¨è¨€ã†ã“ã¨ã§ã™ã€‚ä»¥ä¸‹ã®ã‚ˆã†ã«æ—§å­—ç­‰ã§åŒã˜æ„å‘³ã ãŒè¡¨è¨˜ãŒç•°ãªã‚‹å˜èªã‚„è‹±èª/æ—¥æœ¬èªã€æ›¸ãé–“é•ãˆç­‰ã‚’æ­£è¦åŒ–ã™ã‚‹æ©Ÿèƒ½ãŒã‚ã‚Šã¾ã™ã€‚\ntokenizer_obj.tokenize(\u0026#34;é™„å±\u0026#34;, mode)[0].normalized_form() ## 'ä»˜å±'\rtokenizer_obj.tokenize(\u0026#34;SUMMER\u0026#34;, mode)[0].normalized_form() ## 'ã‚µãƒãƒ¼'\rtokenizer_obj.tokenize(\u0026#34;ã‚·ãƒ¥ãƒŸãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³\u0026#34;, mode)[0].normalized_form() ## 'ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³'\rã“ã®ã‚ˆã†ãªé«˜æ€§èƒ½ãªå½¢æ…‹ç´ è§£æãƒ„ãƒ¼ãƒ«ãŒç„¡å„Ÿã§ã—ã‹ã‚‚å•†ç”¨åˆ©ç”¨ã‚‚å¯ã¨ã„ã†ã¨ã“ã‚ã«é©šãã‚’éš ã›ã¾ã›ã‚“ã€‚æ¬¡å›ä»¥é™ã§èª¬æ˜ã—ã¾ã™ãŒã€ã“ã®Sudachiã§å½¢æ…‹ç´ è§£æã‚’è¡Œã£ãŸWord2vecãƒ¢ãƒ‡ãƒ«ã§ã‚ã‚‹Chiveã‚‚æä¾›ã•ã‚Œã¦ã„ã¾ã™ã€‚\nèª¬æ˜ãŒé•·ããªã‚Šã¾ã—ãŸãŒSudachiã§Tokenizationã‚’è¡Œã„ã¾ã—ã‚‡ã†ã€‚Sudachiã¯Pythonã§ä½¿ç”¨ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚èª¬æ˜ãŒå‰å¾Œã—ã¦ã„ã¾ã™ãŒã€ä¸Šè¨˜ã‚³ãƒ¼ãƒ‰ã§è¡Œã£ã¦ã„ã‚‹ã‚ˆã†ã«tokenizerã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’ä½œæˆã—ã€tokenize()ãƒ¡ã‚½ãƒƒãƒ‰ã§æ–‡ç« ã‚’Tokenizeã—ã¾ã™ã€‚Tokenizeã•ã‚ŒãŸçµæœã¯MorphemeListã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã«æ ¼ç´ã•ã‚Œã¾ã™ã€‚MorphemeListã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®å„è¦ç´ ã«å¯¾ã—ã¦normalized_form()ãƒ¡ã‚½ãƒƒãƒ‰ã‚’å®Ÿè¡Œã™ã‚‹ã“ã¨ã§æ­£è¦åŒ–ã•ã‚ŒãŸå½¢æ…‹ç´ ã‚’å–å¾—ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚ã“ã“ã¾ã§ã‚’ã‚„ã£ã¦ã¿ã¾ã™ã€‚\nã¾ãšã€ã‚µãƒ³ãƒ—ãƒ«ãƒ‡ãƒ¼ã‚¿ã‚’èª­ã¿è¾¼ã¿ã¾ã™ã€‚\nfrom sudachipy import tokenizer from sudachipy import dictionary from sklearn.preprocessing import LabelEncoder import pandas as pd sample = pd.read_csv(r\u0026#34;C:\\Users\\hogehoge\\æ™¯æ°—ã‚¦ã‚ªãƒƒãƒãƒ£ãƒ¼\\ç”Ÿãƒ‡ãƒ¼ã‚¿\\watcher_2016.csv\u0026#34;,encoding=\u0026#34;shift-jis\u0026#34;) sample = sample[(sample.è¿½åŠ èª¬æ˜åŠã³å…·ä½“çš„çŠ¶æ³ã®èª¬æ˜==\u0026#39;âˆ’\u0026#39;)|(sample.è¿½åŠ èª¬æ˜åŠã³å…·ä½“çš„çŠ¶æ³ã®èª¬æ˜==\u0026#39;ï¼Š\u0026#39;)==False|(sample.æ™¯æ°—ã®ç¾çŠ¶åˆ¤æ–­==\u0026#39;â–¡\u0026#39;)] èª­ã¿è¾¼ã‚“ã sampleã‚’tokenizerã§TokenåŒ–ã—ã¦ã„ãã¾ã™ã€‚\ntokenizer_obj = dictionary.Dictionary().create() mode = tokenizer.Tokenizer.SplitMode.C tokenizer_sudachi = lambda t: [m.normalized_form() for m in tokenizer_obj.tokenize(t, mode)] tokens = sample.è¿½åŠ èª¬æ˜åŠã³å…·ä½“çš„çŠ¶æ³ã®èª¬æ˜.map(tokenizer_sudachi) tokens.head() ## 0 [ãƒ», åº—é ­, ã®, å–ã‚Šæ‰±ã„, é¡, ãŒ, å‰å¹´, æ¯”, ç´„, 120, %, ã¨, å¥½èª¿...\r## 1 [ãƒ», å½“, æ–½è¨­, ã®, åˆ©ç”¨, ä¹—é™, å®¢æ•°, ã¯, 1, æœˆ, 26, æ—¥, æ™‚ç‚¹, ...\r## 2 [ãƒ», å¹´, æœ«, ã®, æ¶ˆè²», ã®, åå‹•, ã‚‚, æœ‰ã‚‹, ã¦, ã‹, ã€, å®¢, ã®, ...\r## 3 [ãƒ», å¤–å›½äºº, è¦³å…‰å®¢, ã«, ã‚ˆã‚‹, å£²ã‚Šä¸Šã’, ãŒ, å‰å¹´, æ¯”, 152, %, ã¨...\r## 4 [ãƒ», ç©æ¥µçš„, ã , æ™¯æ°—, ãŒ, ä¸Šå‘ã, ã«, æœ‰ã‚‹, ã¨, ã¾ã§, ã¯, è¨€ã†, è¾›...\r## Name: è¿½åŠ èª¬æ˜åŠã³å…·ä½“çš„çŠ¶æ³ã®èª¬æ˜, dtype: object\rTokenizeã™ã‚‹ã“ã¨ãŒã§ãã¾ã—ãŸã€‚ WordCloudã‚’ä½œæˆã™ã‚‹ãŸã‚ã«Pythonã®wordcloudã‚’ç”¨ã„ã¾ã™ã€‚ã“ã‚Œã¯å¼•æ•°ã«Tokenã‚’ã‚¹ãƒšãƒ¼ã‚¹ã§åŒºåˆ‡ã£ãŸæ–‡å­—åˆ—ã‚’ä¸ãˆã‚‹å¿…è¦ãŒã‚ã‚‹ãŸã‚ã€ãã®æ•´å½¢ã‚’è¡Œã„ã¾ã™ã€‚\nword_lists = [] for token in tokens: for word in token: word_lists.append(word) word_chain = \u0026#39; \u0026#39;.join(word_lists) ã§ã¯ã€wordcloudã‚’ä½œæˆã—ã¦ã„ãã¾ã™ã€‚æ—¥æœ¬èªè¡¨ç¤ºã§ã¯æ–‡å­—åŒ–ã‘ãŒç™ºç”Ÿã™ã‚‹ãŸã‚ã€ã“ã¡ã‚‰ã§ãƒ•ã‚©ãƒ³ãƒˆã€ŒIPAexã‚´ã‚·ãƒƒã‚¯ã€ã‚’äºˆã‚ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ã€ãƒ•ã‚©ãƒ«ãƒ€ã«ä¿å­˜ã—ãŸã‚‚ã®ã‚’èª­ã¿è¾¼ã‚“ã§ã„ã¾ã™ã€‚\nfont_path = r\u0026#39;C:\\Users\\hogehoge\\Watcher\\ipaexg.ttf\u0026#39; wordcloud.WordCloud.genetate()ã§WordCloudã‚’ä½œæˆã—ã¾ã™ã€‚\nfrom wordcloud import WordCloud import matplotlib.pyplot as plt wc = WordCloud(background_color=\u0026#34;white\u0026#34;, font_path=font_path, max_words=100, max_font_size=100, contour_width=1, contour_color=\u0026#39;steelblue\u0026#39;) wc.generate(word_chain) plt.figure(figsize=(12,10)) plt.imshow(wc, cmap=plt.cm.gray, interpolation=\u0026#34;bilinear\u0026#34;) plt.axis(\u0026#34;off\u0026#34;) plt.show() åŠ©è©ã‚„ã€Œç‚ºã‚‹ã€ã€ã€Œæœ‰ã‚‹ã€ã€ã€Œå±…ã‚‹ã€ã€ã€Œæˆã‚‹ã€ãªã©ç‰¹å¾´ã®ãªã„èªå¥ãŒé »å‡ºã—ã¦ãŠã‚Šã€æ„å‘³ã®ã‚ã‚‹å¯è¦–åŒ–ã«ãªã£ã¦ã„ã¾ã›ã‚“ã€‚ã“ã‚Œã‚‰ã‚’word_chainã‹ã‚‰é™¤ãã€ã‚‚ã†ä¸€åº¦å®Ÿè¡Œã—ã¦ã¿ã¾ã™ã€‚\nstopwords = [\u0026#34;è¦‹ã‚‹\u0026#34;,\u0026#34;ç‚ºã‚‹\u0026#34;,\u0026#34;æœ‰ã‚‹\u0026#34;,\u0026#34;å±…ã‚‹\u0026#34;,\u0026#34;æˆã‚‹\u0026#34;,\u0026#34;ã¯\u0026#34;,\u0026#34;ã«\u0026#34;,\u0026#34;ã‚ˆã‚‹\u0026#34;,\u0026#34;ãŸ\u0026#34;,\u0026#34;ãŒ\u0026#34;,\u0026#34;ã¦\u0026#34;,\u0026#34;ã \u0026#34;,\u0026#34;ãªã©\u0026#34;,\u0026#34;ã¨\u0026#34;,\u0026#34;ã‚‚\u0026#34;,\u0026#34;ã®\u0026#34;,\u0026#34;ã‚„\u0026#34;,\u0026#34;ã§\u0026#34;,\u0026#34;ã‹ã‚‰\u0026#34;,\u0026#34;ã‚’\u0026#34;,\u0026#34;ãŠã‚‹\u0026#34;,\u0026#34;ã‚ˆã‚Š\u0026#34;,\u0026#34;ç­‰\u0026#34;] for stopword in stopwords: word_chain = word_chain.replace(stopword, \u0026#34;\u0026#34;) wc.generate(word_chain) plt.figure(figsize=(12,10)) plt.imshow(wc, cmap=plt.cm.gray, interpolation=\u0026#34;bilinear\u0026#34;) plt.axis(\u0026#34;off\u0026#34;) plt.show() å…ˆã»ã©ã‚ˆã‚Šã¯æ„å‘³ã®ã‚ã‚‹å¯è¦–åŒ–ã«ãªã£ã¦ã„ã¾ã™ã€‚ã€Œæ¥å®¢æ•°ã€ã€ã€Œå£²ã‚Šä¸Šã’ã€ã€ã€Œè²©å£²é‡ã€ãªã©ã‚„ã¯ã‚Šå°å£²åº—é–¢é€£ã®ãƒ¯ãƒ¼ãƒ‰ãŒé »å‡ºã—ã¦ã„ã‚‹ã‚ˆã†ã§ã™ã€‚ã“ã‚Œã¯å›ç­”è€…å±æ€§ã¨ã‚‚æ•´åˆçš„ã§ã™ã€‚\n4. çµ‚ã‚ã‚Šã« ã“ã‚Œã‹ã‚‰å„å›ã§ä»¥ä¸‹ã®æ‰‹æ³•ã‚’ç”¨ã„ãŸäºˆæ¸¬ãƒ¢ãƒ‡ãƒ«ã®æ§‹ç¯‰ã‚’è¡Œã£ã¦ã„ãã¾ã™ã€‚æ¬¡å›ã¯ã€è¾æ›¸ãƒ™ãƒ¼ã‚¹ã«åŸºã¥ãã‚»ãƒ³ãƒãƒ¡ãƒ³ãƒˆã®æŠ½å‡ºã‚’è¡Œã„ã€æ–‡æ›¸ã®ãƒã‚¸ãƒã‚¬åˆ†é¡ã‚’è¡Œã„ã¾ã™ã€‚\n è¾æ›¸ãƒ™ãƒ¼ã‚¹ ãƒŠã‚¤ãƒ¼ãƒ–ãƒ™ã‚¤ã‚ºåˆ†é¡å™¨ å˜èªåŸ‹ã‚è¾¼ã¿(Word Embedding)ã‚’ç”¨ã„ãŸæ–¹æ³• Recurrent neural network(RNN) Transformer  å®Ÿã¯ã€è§£æè‡ªä½“ã¯å…¨ã¦å®Œäº†ã—ã¦ãŠã‚Šã€æ–‡æ›¸ã‚’æ›¸ãã ã‘ã®ãƒ•ã‚§ãƒ¼ã‚ºã«ãªã£ã¦ã„ã¾ã™ã€‚ã¡ã‚ƒã‚“ã¨çµæœã‚‚å‡ºã¦ã„ã¾ã™ã®ã§ã€ä¹ã†ã”æœŸå¾…ã§ã™ï¼\n","date":1647820800,"expirydate":-62135596800,"kind":"page","lang":"ja","lastmod":1647820800,"objectID":"a0f5d68fe530347abecf8979041ce8c6","permalink":"/post/post25/","publishdate":"2022-03-21T00:00:00Z","relpermalink":"/post/post25/","section":"post","summary":"ãƒ†ã‚­ã‚¹ãƒˆã‹ã‚‰ã‚»ãƒ³ãƒãƒ¡ãƒ³ãƒˆæƒ…å ±ã‚’æŠ½å‡ºã™ã‚‹æ‰‹æ³•ã‚’æ•°å›ã«ã‚ãŸã£ã¦ç´¹ä»‹ã—ã¾ã™ã€‚","tags":["Python","å‰å‡¦ç†","æ©Ÿæ¢°å­¦ç¿’","ãƒ†ã‚­ã‚¹ãƒˆè§£æ"],"title":"ã€å¾¹åº•æ¯”è¼ƒã€‘ã‚»ãƒ³ãƒãƒ¡ãƒ³ãƒˆã‚¹ã‚³ã‚¢ç®—å‡ºæ‰‹æ³•ï¼ï¼ - ç¬¬1å›","type":"post"},{"authors":null,"categories":["ã‚­ãƒ£ãƒªã‚¢"],"content":"1. é€€è·ã—ã¾ã—ãŸ ãŠã¯ã“ã‚“ã°ã‚“ã«ã¡ã¯ã€‚ã‹ãªã‚Šä¹…ã—ã¶ã‚Šã®æ›´æ–°ã«ãªã£ã¦ã—ã¾ã„ã¾ã—ãŸã€‚ã“ã®é–“ã€2021å¹´7æœˆ7æ—¥ã«çµå©šã—ã€æ—¢å©šè€…ã«ãªã‚Šã¾ã—ãŸã€‚ã¾ãŸã€2021å¹´4æœˆã«åŒã˜éƒ¨ç½²å†…ã®ãƒãƒ¼ãƒ ã‚’ç§»å‹•ã—ã€BPRãƒ»æ¥­å‹™ã‚¤ãƒ³ãƒ•ãƒ©æ•´å‚™ãƒ»é‡‘èè¦åˆ¶å¯¾å¿œãªã©ãƒ­ã‚¸å‘¨ã‚Šã®ä¼ç”»ã«å½¹å‰²ãŒå¤‰ã‚ã‚Šã¾ã—ãŸã€‚ãã—ã¦ã€2022å¹´2æœˆ28æ—¥ã«ç¾è·ã‚’é€€ç¤¾ã—(æœ€çµ‚å‡ºç¤¾ã¯1æœˆ28æ—¥)ã€3æœˆ1æ—¥ã‹ã‚‰é–¢è¥¿ã®é›»å­éƒ¨å“ãƒ¡ãƒ¼ã‚«ãƒ¼ã§åƒãã“ã¨ã«ãªã‚Šã¾ã—ãŸã€‚\n2. è»¢è·ç†ç”± å…¥ç¤¾ã—ã¦ã‚¨ã‚³ãƒãƒŸã‚¹ãƒˆãŒæ±‚ã‚ã‚‰ã‚Œã¦ã„ãªã„ã“ã¨ã«æ°—ã¥ã„ãŸ ãã‚‚ãã‚‚ã€ç¾è·ã®è³‡ç”£é‹ç”¨ä¼šç¤¾ã«ã¯ã‚¨ã‚³ãƒãƒŸã‚¹ãƒˆã‚’å¿—æœ›ã—ã¦å…¥ç¤¾ã—ã¾ã—ãŸã€‚é‡‘éŠ­çš„å•é¡Œã‹ã‚‰åšå£«èª²ç¨‹å¾ŒæœŸã®é€²å­¦ã‚’æ–­å¿µã—ã€å¤§å­¦é™¢æ™‚ä»£ã®ç ”ç©¶å†…å®¹ã«è¿‘ã„è·ç¨®ã«å°±ããŸã‹ã£ãŸãŸã‚ã§ã™ã€‚ãƒã‚¤ã‚µã‚¤ãƒ‰ã®ã‚¨ã‚³ãƒãƒŸã‚¹ãƒˆã‚’å¿—æœ›ã—ãŸã®ã¯ã€å˜ã«ãƒ•ã‚¡ãƒ³ãƒ‰ãƒãƒãƒ¼ã‚¸ãƒ£ãƒ¼ç›¸æ‰‹ã®æ–¹ãŒé«˜åº¦ãªåˆ†æã‚’ã—ã¦ã‚‚è¨±ã•ã‚Œã‚‹ã‚“ã˜ã‚ƒãªã„ã‹ã¨ã„ã†çŸ­çµ¡çš„ãªç†ç”±ã‹ã‚‰ã§ã—ãŸã€‚\nã—ã‹ã—ã€å…¥ç¤¾ã—ã¦ã¿ã‚‹ã¨ã€å¸Œæœ›ã®éƒ¨ç½²ã«é…å±ã«ãªã‚‹ã“ã¨ã¯å‡ºæ¥ã¾ã›ã‚“ã§ã—ãŸã€‚æœ€åˆã¯æ©Ÿé–¢æŠ•è³‡å®¶å–¶æ¥­ã«é…å±ã«ãªã‚Šã€æ©Ÿé–¢æŠ•è³‡å®¶å‘ã‘(å¹´é‡‘åŸºé‡‘ã‚„é‡‘èæ³•äºº)ã®é¡§å®¢å ±å‘Šæ›¸ã‚’ã²ãŸã™ã‚‰ä½œæˆã—ã¦ã„ã¾ã—ãŸã€‚ç¤¾å†…DBã‹ã‚‰å–å¾—ã—ãŸãƒ•ã‚¡ãƒ³ãƒ‰ã®ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ã‚„æ®‹é«˜ã‚’å®šã‚ã‚‰ã‚ŒãŸãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã«è»¢è¨˜ã—ã€ãƒ•ã‚¡ãƒ³ãƒ‰ãƒãƒãƒ¼ã‚¸ãƒ£ãƒ¼ã«ã‚³ãƒ¡ãƒ³ãƒˆã‚’ã‚‚ã‚‰ã†ä»•äº‹ã§ã™ã€‚2éƒ¨ç½²ç›®(3å¹´ç›®)ã§é‹ç”¨ä¼ç”»ã«ç•°å‹•ã«ãªã‚Šã¾ã—ãŸãŒã€ã“ã¡ã‚‰ã§ã‚‚(ç¤¾å†…)è³‡æ–™ã‚’ä½œæˆã—ã¦ã„ã¾ã—ãŸã€‚ä¼ç”»ã®è­°è«–ã¯ç§˜åŒ¿æ€§ãŒé«˜ãåŸºæœ¬çš„ã«ã‚·ãƒ‹ã‚¢å±¤ã®ã¿ã§è¡Œã‚ã‚Œã‚‹ãŸã‚ã€è‹¥æ‰‹ã¯ç›®çš„ã‚‚ã¯ã£ãã‚Šã¨ã—ãªã„ã¾ã¾(ã–ã£ãã‚Šã¨ã—ãŸèª¬æ˜ã¯ã‚ã‚Šã¾ã™ãŒè©³ç´°ã¯èã‘ãªã„)ã€æ‰‹ã‚’å‹•ã‹ã™ã“ã¨ãŒæ±‚ã‚ã‚‰ã‚Œã¦ã„ã¾ã—ãŸã€‚ã“ã®ã‚ˆã†ã«ã€è³‡æ–™ä½œæˆè¦å“¡ã¨ã—ã¦3å¹´ã»ã©éã”ã—ã€è‡ªåˆ†ã®æˆé•·ã¨ã—ã¦æ„Ÿã˜ã‚‰ã‚ŒãŸã®ã¯ã€Excelã‚„PowerPointã«ç¿’ç†Ÿã—ã¦ã„ãã“ã¨ã®ã¿ã§ã—ãŸã€‚æ¬¡ç¬¬ã«ã€Œå¸‚å ´ä¾¡å€¤ãªã©å…¨ããªã„äººæã«ãªã£ã¦ã‚‹ãªã€ã¨å±æ©Ÿæ„Ÿã‚’è¦šãˆã¾ã—ãŸãŒã€ä¸Šå¸ã‹ã‚‰ã¯ã€Œã¾ã è‹¥ã„ã‚“ã ã‹ã‚‰ã€ã¨çœŸé¢ç›®ã«å—ã‘æ­¢ã‚ã¦ã‚‚ã‚‰ãˆã¾ã›ã‚“ã§ã—ãŸã€‚\nåŒæ™‚ã«ã€ã‚¨ã‚³ãƒãƒŸã‚¹ãƒˆã®è¨€å‹•ã‚’å‚è€ƒã«ã—ã¦ã„ã‚‹ãƒ•ã‚¡ãƒ³ãƒ‰ãƒãƒãƒ¼ã‚¸ãƒ£ãƒ¼ãªã©ã»ã¼å­˜åœ¨ã—ãªã„ã“ã¨ã‚‚åˆ†ã‹ã‚Šã¾ã—ãŸã€‚ã‚¨ã‚³ãƒãƒŸã‚¹ãƒˆã®ä»˜åŠ ä¾¡å€¤ã¯ã‚»ãƒŸãƒŠãƒ¼ã§ã®è¬›æ¼”ã§ã€ãã®è¬›æ¼”ã§ã‚‚è‡ªåˆ†ã§åˆ†æã—ãŸå†…å®¹ã‚’è©±ã™ã¨è¨€ã†ã‚ˆã‚Šã¯ã‚·ãƒ³ã‚¯ã‚¿ãƒ³ã‚¯ãªã©ã®ãƒ¬ãƒãƒ¼ãƒˆã‚’è¦ç´„ã—ã¦è³‡æ–™ã‚’å†æ§‹æˆã—ã€èª¬æ˜ã™ã‚‹ã¨ã„ã†éç”Ÿç”£çš„ãªä»•äº‹ã‚’ã—ã¦ã„ã‚‹ã‚ˆã†ã§ã—ãŸã€‚è‡ªåˆ†ã®å°±è·æ´»å‹•æ™‚ã®çŸ­çµ¡çš„ãªç™ºæƒ³ã‚’åçœã—ã¤ã¤ã€ã€Œã‚„ã¯ã‚Šãƒã‚¯ãƒ­çµŒæ¸ˆå­¦ã§ã¯ãŠé‡‘ã«ãªã‚‰ãªã„ã‚“ã ãªã€ã¨ã„ã†ã“ã¨ã‚’å†ç¢ºèªã—ã¾ã—ãŸã€‚\nè»¢è·ç†ç”±ã®åŠåˆ†ã¯çµå©š å…ˆè¿°ã®é€šã‚Šã€2021å¹´7æœˆ7æ—¥ã«çµå©šã—ã¾ã—ãŸã€‚å¦»ã¨ã¯å¤§å­¦ç”Ÿä»¥æ¥ã®ä»˜ãåˆã„ã§ã‚ã‚Šã€7å¹´ã®äº¤éš›æœŸé–“ãŒã‚ã‚Šã¾ã—ãŸã€‚ã©ã¡ã‚‰ã‚‚åœ°å…ƒãŒé–¢è¥¿ã§ã‚ã‚Šã€å­ä¾›ã«ã¯é–¢è¥¿å¼ã‚’ã—ã‚ƒã¹ã‚‰ã›ãŸã„ã¨ã„ã†æœ€å¤§ã®ç›®çš„ã‹ã‚‰ä»Šå¾Œã‚’è€ƒãˆã¦ç”Ÿæ´»æ‹ ç‚¹ã‚’æ±äº¬ã‹ã‚‰é–¢è¥¿ã«ç§»ã—ãŸã„ã¨æ€ã†ã‚ˆã†ã«ãªã‚Šã¾ã—ãŸ(ä»–ã«ã‚‚ãŠäº’ã„ã®èº«å¯„ã‚ŠãŒã„ã‚‹ã¨ã‹ç†ç”±ã¯ã‚ã‚Šã¾ã™)ã€‚ãã®æ™‚ç‚¹ã§ã¯ã€ã‚¨ã‚³ãƒãƒŸã‚¹ãƒˆå¿—æœ›ã§ã‚‚ãªã‹ã£ãŸã®ã§ã€ã€Œã‚‚ã¯ã‚„æ±äº¬ã«ã„ã‚‹æ„å‘³ã‚‚ãªã„ãªã€ã¨æ„Ÿã˜ã¦ã„ã¾ã—ãŸã€‚\n2021å¹´4æœˆã‹ã‚‰é…å±ã«ãªã£ãŸæ–°ã—ã„éƒ¨ç½²ã§ã¯ã€ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒãƒã‚¸ãƒ¡ãƒ³ãƒˆã‚’è¡Œã†ç«‹å ´ã«ãªã‚Šã€ãƒã‚¦ãƒã‚¦ã‚‚ãªã„ä¸­ã§æ¥­å‹™ã‚³ãƒ³ã‚µãƒ«ã®ã‚ˆã†ãªæ¥­å‹™ã‚’è¡Œã£ã¦ã„ã¾ã—ãŸã€‚ã‚³ãƒ³ã‚µãƒ«ä¼šç¤¾ã§ã‚ã‚‹ã‚±ãƒ³ãƒ–ãƒªãƒƒã‚¸ã®æ›¸ç±ãªã©ã‚’èª­ã¿ã‚ã•ã‚Šã€ãƒˆãƒ©ã‚¤ã‚¢ãƒ³ãƒ‰ã‚¨ãƒ©ãƒ¼ã‚’ç¹°ã‚Šè¿”ã™ä¸­ã§ã€ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãŒå‰é€²ã™ã‚‹ã“ã¨ã«é”æˆæ„Ÿã‚’æ„Ÿã˜ã€ç¾å ´ã®æ–¹ã‹ã‚‰ã®ä¿¡é ¼ã‚‚æ¬¡ç¬¬ã«å¾—ã‚‹ã“ã¨ãŒã§ãã¾ã—ãŸã€‚è‡ªåˆ†ãŸã¡ã®è€ƒãˆãŸä¼ç”»æ¡ˆãŒå…·ç¾åŒ–ã—ã¦ã„ãã“ã¨ã«ã‚„ã‚ŠãŒã„ã‚’æ„Ÿã˜ã€ã€Œã“ã®ä»•äº‹ã ã£ãŸã‚‰æ¥­ç¨®ã‚‚é¸ã°ãªã„ã—ã€é–¢è¥¿ã§ã‚‚åƒã‘ã‚‹ãªã€ã¨è»¢è·ã‚’è€ƒãˆå‡ºã—ãŸã®ãŒ8æœˆé ƒã§ã—ãŸã€‚\næ®‹ã‚Šã®åŠåˆ†ã¯ç¾è·ã§ã®ã‚­ãƒ£ãƒªã‚¢ãƒ‘ã‚¹ãŒæƒ³åƒã§ããªã‹ã£ãŸã‹ã‚‰ ç”Ÿæ´»æ‹ ç‚¹ã‚’é–¢è¥¿ã«ç§»ã—ã€ãƒ—ãƒ­ãƒãƒã¨ã—ã¦åƒãã®ã¯ã€ç¾è·ã§ã‚‚é éš”åœ°å‹¤å‹™ã¨ã„ã†å‹¤å‹™å½¢æ…‹ã‚’åˆ©ç”¨ã™ã‚Œã°å¯èƒ½ã§ã—ãŸã€‚ç¾ã«ã€åŒã˜éƒ¨ç½²ã«ãã®åˆ¶åº¦ã‚’åˆ©ç”¨ã—ã¦ã„ã‚‹æ–¹ãŒã„ãŸã—ã€å°‘ãªãã¨ã‚‚2å¹´ã¯ã»ã¼ãƒªãƒ¢ãƒ¼ãƒˆãƒ¯ãƒ¼ã‚¯ã ã£ãŸã®ã§ã€ã†ã¡ã®éƒ¨ç½²ãªã‚‰å¯èƒ½ã ã‚ã†ãªã¨ã„ã†ã‚¤ãƒ¡ãƒ¼ã‚¸ã‚‚æ¹§ã„ã¦ã„ã¾ã—ãŸã€‚ãã®é¸æŠã‚’ã—ãªã‹ã£ãŸã®ã¯ã€ç¾è·ã§ã¯ã“ã®è·ç¨®ã§ã‚­ãƒ£ãƒªã‚¢ãƒ‘ã‚¹ã‚’æ­©ã‚“ã§ã„ãäº‹ãŒæƒ³åƒã§ããªã‹ã£ãŸã‹ã‚‰ã§ã™ã€‚\nè³‡ç”£é‹ç”¨ä¼šç¤¾ã®èŠ±å½¢ã¯ãƒ•ã‚¡ãƒ³ãƒ‰ãƒãƒãƒ¼ã‚¸ãƒ£ãƒ¼ã§ã™ã€‚æ–°å’å…¥ç¤¾ã®å¤§åŠãŒãƒ•ã‚¡ãƒ³ãƒ‰ãƒãƒãƒ¼ã‚¸ãƒ£ãƒ¼å¿—æœ›ã§å…¥ç¤¾ã—ã¾ã™ã€‚æ¥­ç•Œå†…ã§æœ‰åãªæ–¹ã‚‚è¤‡æ•°å­˜åœ¨ã—ã€é‹ç”¨è€…ã®ã‚­ãƒ£ãƒªã‚¢ãƒ‘ã‚¹ã¯ãã‚Œãªã‚Šã«ã‚¤ãƒ¡ãƒ¼ã‚¸ã§ãã‚‹ã¨æ€ã„ã¾ã™1ã€‚ä¸€æ–¹ã§ã€é‹ç”¨è€…ä»¥å¤–ã®ã‚­ãƒ£ãƒªã‚¢ãƒ‘ã‚¹ã¨ãªã‚‹ã¨ã€ã‹ãªã‚Šä¸æ˜ç­ã§å„åˆ†é‡ã§ãƒ—ãƒ­ãƒ•ã‚§ãƒƒã‚·ãƒ§ãƒŠãƒ«ã¨ã—ã¦ä»•äº‹ã‚’ã—ã¦ã„ã‚‹æ–¹ã¯é™å®šçš„ã§ã‚ã‚‹å°è±¡ã‚’å—ã‘ã¾ã—ãŸã€‚ç§ãŒæ‰€å±ã—ã¦ã„ãŸéƒ¨ç½²ã¯ã€è‹¥æ‰‹ã«ã¨ã£ã¦ã¯é‹ç”¨ã¸ã®é€šéç‚¹ã¨ã„ã†ä½ç½®ã¥ã‘ã§ã€ã“ã®éƒ¨ç½²ã§ã®ã‚­ãƒ£ãƒªã‚¢ãƒ‘ã‚¹ã‚’ã‚¤ãƒ¡ãƒ¼ã‚¸å‡ºæ¥ã‚‹äººã¯ä¸Šå¸å«ã‚ã¦å­˜åœ¨ã—ã¦ã„ãªã‹ã£ãŸã¨æ€ã„ã¾ã™ã€‚éƒ¨ç½²ã«ãƒã‚¦ãƒã‚¦ã®è“„ç©ãŒã•ã‚Œã¦ãŠã‚‰ãšã€ã‚·ãƒ‹ã‚¢ã®ä»•äº‹ã®é€²ã‚æ–¹ã«ç–‘å•ã‚’æŠ±ãã“ã¨ã‚‚ã—ã°ã—ã°ã‚ã‚Šã€ç›®æŒ‡ã—ãŸã„ã¨æ€ãˆã‚‹äººç‰©ã‚‚å­˜åœ¨ã—ã¾ã›ã‚“ã§ã—ãŸ2ã€‚éƒ¨ç½²æŸ„ã€ä»–ã®éƒ¨ç½²ã®æ–¹ã¨ä»•äº‹ã‚’ã™ã‚‹æ©Ÿä¼šã‚‚å¤šã‹ã£ãŸã§ã™ãŒã€çŠ¶æ³ã¯ä»–ã®éƒ¨ç½²ã§ã‚‚åŒã˜ã‚ˆã†ã§ã€é‹ç”¨è€…å¿—æœ›ã§ã¯ãªãç¤¾å†…ã‚³ãƒ³ã‚µãƒ«æ¥­ã‚’å¿—æœ›ã™ã‚‹è‡ªåˆ†ã«ã¨ã£ã¦ã¯ã€å‘¨ã‚Šã®æ”¯æ´ãƒ»ç†è§£ãªã1äººå‰ã«ãªã‚‹æƒ³åƒãŒã§ããšã€ã€Œè»¢è·ã™ã‚‹ãªã‚‰æ—©ã„ã»ã†ãŒã‚ˆã„ãªã€ã¨æ€ã„ã¾ã—ãŸ[^3]ã€‚\né‹ç”¨è€…å¿—æœ›ã®å¸Œæœ›ãŒå…¨å“¡å¶ã†ã‚ã‘ã§ã¯ãªãã€è‹¥æ‰‹ã®æ—©æœŸé€€è·è€…ã«æ‚©ã‚€äººäº‹ã¯å¤šã„ã¨æ€ã„ã¾ã™ãŒã€ä¸€æ–¹ã§é‹ç”¨è€…ä»¥å¤–ã®å—ã‘çš¿ãŒç”¨æ„ã•ã‚Œã¦ã„ã‚‹ã¨ã¯è¨€ã„é›£ã„ã¨æ€ã„ã¾ã™ã€‚å°‘ãªãã¨ã‚‚ã€ãƒ•ãƒ­ãƒ³ãƒˆã¨ãã‚Œä»¥å¤–ã§ã¯æ¸©åº¦æ„ŸãŒå…¨ãé•ã„ã¾ã™(å¾Œè€…ã¯ã‚·ãƒ‹ã‚¢ã¾ã§ã»ã¼ã‚ªãƒšãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³æ‹…å½“ã®å°è±¡ã§ã—ãŸ)ã€‚é‹ç”¨ä¼šç¤¾ã«ã¯é‡‘èå°‚é–€è·(ãƒ•ã‚¡ãƒ³ãƒ‰ãƒãƒãƒ¼ã‚¸ãƒ£ãƒ¼ã€ã‚¨ã‚³ãƒãƒŸã‚¹ãƒˆã€ã‚¢ãƒŠãƒªã‚¹ãƒˆ)ã¯ã„ã¦ã‚‚ã€ãƒ“ã‚¸ãƒã‚¹ãƒ‘ãƒ¼ã‚½ãƒ³ã¯ã„ãªã„ã€‚ã“ã®å•é¡Œã¯æ ¹ãŒæ·±ã„ã§ã™ã­ã€‚\n3. æ¬¡ã®ä¼šç¤¾ãƒ»ä»•äº‹ ä¸Šè¨˜ã®ã‚ˆã†ãªç†ç”±ã‹ã‚‰ã€9æœˆé ƒã«è»¢è·æ´»å‹•ã‚’ã¯ã˜ã‚ã¾ã—ãŸã€‚è¤‡æ•°ã®ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã‚µãƒ¼ãƒ“ã‚¹ã‚’åˆ©ç”¨ã—ã€æ›¸é¡å¯©æŸ»ã‚’æœ¬æ ¼çš„ã«å‡ºã—å§‹ã‚ãŸã®ãŒ10æœˆåˆæ—¬ã”ã‚ã€é¢æ¥ã‚’å—ã‘å‡ºã—ãŸã®ãŒ10æœˆåŠã°ã§ã—ãŸã€‚ãã—ã¦ã€11æœˆã«å†…å®šã‚’é ‚ãã€æ¬¡ã®ä¼šç¤¾ã¸å…¥ç¤¾ã‚’æ±ºã‚ã¾ã—ãŸã€‚ã“ã®ä¼šç¤¾ã§ã¯ã€è‡ªéƒ¨ç½²ã§ã®ã‚­ãƒ£ãƒªã‚¢ã‚¹ãƒ†ãƒƒãƒ—ã®å…¸å‹ä¾‹ã‚’ç¤ºã—ã¦ãã ã•ã‚Šã€ãã®ä¸­ã«è‡ªåˆ†ã®ç›®æŒ‡ã—ãŸã„ã‚‚ã®ãŒã‚ã£ãŸã®ã§å…¥ç¤¾ã‚’æ±ºã‚ã¾ã—ãŸã€‚\næ¬¡ã®ä¼šç¤¾ã¯é–¢è¥¿ã®é›»å­éƒ¨å“ãƒ¡ãƒ¼ã‚«ãƒ¼ã§ã™ã€‚æ¥­å‹™å†…å®¹ã¯ç¾è·ã§è¡Œã£ã¦ã„ã‚‹æ¥­å‹™ã¨ã•ã»ã©å¤‰ã‚ã‚‰ãªã„ã‚‚ã®ã¨èªè­˜ã—ã¦ã„ã¾ã™ã€‚ãŸã ã€ç¾è·ã‚ˆã‚Šã‚‚ãƒ‡ãƒ¼ã‚¿ã‚’èµ·ç‚¹ã«ã—ãŸä¼ç”»ã‚’è¡Œã†ã¨ã„ã†ã“ã¨ã§ã€BIãƒ„ãƒ¼ãƒ«ã‚„çµ±è¨ˆå‡¦ç†ãªã©ã‚‚å®ˆå‚™ç¯„å›²ã«å…¥ã£ã¦ããã†ã§ã™ã€‚ã“ã‚Œã¾ã§ã¯å¿…è¦ãªææ–™ã¯ç¾å ´ã¸ã®ãƒ’ã‚¢ãƒªãƒ³ã‚°ã®ã¿ã‚’ãƒ™ãƒ¼ã‚¹ã¨ã—ã¦ãŠã‚Šã€Excelã‚’ã“ã­ãã‚Šå›ã—ã¦å‡ºãŸä¿¡é ¼æ€§ãŒã‚ã‹ã‚‰ãªã„çµæœã‚’PowerPointã‚¹ãƒ©ã‚¤ãƒ‰ã«ã™ã‚‹ã¨ã„ã†ã‚„ã‚Šæ–¹ã ã£ãŸã®ã§ã€ã²ã¨ã¤ã‚¹ãƒ†ãƒƒãƒ—ã‚¢ãƒƒãƒ—ã‹ãªã¨æ€ã„ã¾ã™ã€‚ã¾ãŸã€æ‰±ã†ãƒ‡ãƒ¼ã‚¿ã‚‚å£²ä¸Šæƒ…å ±ã‚„å—æ³¨æƒ…å ±ãªã©ã“ã‚Œã¾ã§ã®é‡‘èæ™‚ç³»åˆ—ãƒ‡ãƒ¼ã‚¿ã¨ã¯ç•°ãªã£ã¦ããã†ã§ã™ã€‚ãŸã ã€ãƒ“ã‚¸ãƒã‚¹ã¸ã®æ·±ã„ç†è§£ãŒå¿…è¦ã¨ã„ã†ç‚¹ã¯å¤‰ã‚ã‚‰ãªã„ã¨æ€ã†ã®ã§ã€ãã®ç‚¹ã¯æ—©ãã‚­ãƒ£ãƒƒãƒã‚¢ãƒƒãƒ—ã§ãã‚‹ã‚ˆã†ã«é ‘å¼µã‚ŠãŸã„ã¨æ€ã„ã¾ã™ã€‚\n4. ä»Šå¾Œã®ãƒ–ãƒ­ã‚°æ›´æ–°ã«ã¤ã„ã¦ ã“ã‚Œã¾ã§ã®æŠ•ç¨¿ã¯é‡‘èãƒ»çµŒæ¸ˆã«é–¢é€£ã™ã‚‹ã‚‚ã®ã§ã—ãŸãŒã€ä»Šå¾Œã¯å¯è¦–åŒ–ãƒ»ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒãƒã‚¸ãƒ¡ãƒ³ãƒˆãªã©ã«å†…å®¹ãŒç§»ã£ã¦ããã†ã§ã™ã€‚ã“ã‚Œã¾ã§ã‚ˆã‚Šã‚‚ã€æ°—è»½ã«æŠ•ç¨¿ã™ã‚‹ã“ã¨ã¯å¢—ãˆã¦ãã‚‹ã¨æ€ã†ã®ã§ã€æ›´æ–°é »åº¦ã‚’ä¸Šã’ã¦ã„ããŸã„ã¨æ€ã„ã¾ã™ï¼\n  ã‚¢ã‚·ã‚¹ã‚¿ãƒ³ãƒˆâ†’ã‚¢ãƒŠãƒªã‚¹ãƒˆâ†’FMã‚„ã‚ªãƒšãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³æ‹…å½“â†’æŠ•è³‡åˆ¤æ–­è€…ãªã©ã§ã—ã‚‡ã†ã‹ \u0026#x21a9;\u0026#xfe0e;\n ä¼šè­°ã®ãƒ•ã‚¡ã‚·ãƒªãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ã«ã¯ã‹ãªã‚Šæ‚©ã‚“ã§ã„ã¾ã—ãŸã€‚æœ¬å½“ã§ã‚ã‚Œã°ã€ä¼šè­°ãŒçµ‚ã‚ã£ãŸå¾Œã«ç´°ã‹ã„ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ã‚’é ‚ããŸã‹ã£ãŸã—ã€è‡ªåˆ†ã®èª²é¡Œã¯ã©ã“ã«ã‚ã‚‹ã®ã‹æŒ‡æ‘˜ã—ã¦é ‚ããŸã‹ã£ãŸã§ã™ãŒã€ãã®ã‚ˆã†ãªã“ã¨ãŒå‡ºæ¥ã‚‹äººãŒã„ã¾ã›ã‚“ã§ã—ãŸã€‚ã€Œä»Šã®ã‚„ã‚Šæ–¹ã®ã¾ã¾ä»•äº‹ã‚’é€²ã‚ã¦ãã‚ŒãŸã‚‰ã„ã„ã‹ã‚‰ã€ã—ã‹è¨€ã‚ã‚Œãªã‹ã£ãŸã€‚ \u0026#x21a9;\u0026#xfe0e;\n   ","date":1643673600,"expirydate":-62135596800,"kind":"page","lang":"ja","lastmod":1643673600,"objectID":"bb4f9ea995b516ba867dd3fb189d9773","permalink":"/post/post26/","publishdate":"2022-02-01T00:00:00Z","relpermalink":"/post/post26/","section":"post","summary":"ä»Šå¾Œã«é–¢ã™ã‚‹ã”å ±å‘Šã§ã™ã€‚","tags":[],"title":"è»¢è·ã—ã¾ã™","type":"post"},{"authors":null,"categories":["å˜ç™º"],"content":"ãŠã¯ã“ã‚“ã°ã‚“ã«ã¡ã¯ã€‚æœ€è¿‘ä¼šç¤¾ã®PCã«Anacondaã‚’å…¥ã‚Œã¦ã‚‚ã‚‰ã„ã¾ã—ãŸã€‚æ¥­å‹™ã§ä½¿ç”¨ã™ã‚‹ã“ã¨ã¯ãªã„ã®ã§ã™ãŒã€ãƒ¯ãƒ¼ã‚¯ã‚·ãƒ§ãƒƒãƒ—ã§ä½¿ç”¨ã™ã‚‹ã®ã§è‰²ã€…å‹‰å¼·ã—ã¦ã„ã¾ã™ã€‚ä»¥å‰ã€GoogleãŒæä¾›ã—ã¦ã„ã‚‹Earth Engineã‹ã‚‰è¡›æ˜Ÿç”»åƒã‚’å–å¾—ã—ã¦è§£æã—ãŸéš›ã«Pythonã‚’ä½¿ç”¨ã—ã¾ã—ãŸãŒã€ä»Šå›ã¯Pythonã‹ã‚‰æ§˜ã€…ãªãƒ‡ãƒ¼ã‚¿ãŒå–å¾—ã§ãã‚‹pandas_datareaderã‚’ä½¿ç”¨ã—ãŸã„ã¨æ€ã„ã¾ã™ã€‚pandas_datareaderã§ã¯ä»¥ä¸‹ã®ã‚ˆã†ãªãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹ã‹ã‚‰ãƒ‡ãƒ¼ã‚¿ãŒå–å¾—ã§ãã¾ã™ã€‚\n  Tiingo\n  IEX\n  Alpha Vantage\n  Enigma\n  Quandl\n  St.Louis FED\n  Kenneth French\u0026rsquo;s data library\n  World Bank\n  OECD\n  Eurostat\n  Thrift Saving Plan\n  Nasdaq Trader symbol definitions\n  Stooq\n  MOEX\n  Naver Finance\n  ãªãŠã€ã“ã®ãƒ–ãƒ­ã‚°ã§ã¯Rstuioã¨blogdownãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã€gitã‚’çµ„ã¿åˆã‚ã›ã¦githubä¸Šã«è¨˜äº‹ã‚’æŠ•ç¨¿ã—ã¦ã„ã¾ã™ã€‚ã§ã™ãŒã€Rstudioã¨reticulateãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®ãŠã‹ã’ã§ã€pythonã‚’ä½¿ç”¨ã—ãŸè¨˜äº‹ã‚‚rmdã§ä½œæˆã—ã€htmlã¨ã—ã¦å‡ºåŠ›ã§ãã¦ã„ã¾ã™ã€‚ã“ã“ã§ã¾ãšã€reticulateãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’ç”¨ã„ã¦condaä»®æƒ³ç’°å¢ƒã¸æ¥ç¶šã™ã‚‹æ–¹æ³•ã‚’ç´¹ä»‹ã—ã¦ãŠãã¾ã™ã€‚\nlibrary(reticulate) conda_path \u0026lt;- \u0026#34;C:\\\\Users\\\\hoge\\\\Anaconda3\\\\envs\\\\ç’°å¢ƒå\u0026#34; use_condaenv(conda_path) ã“ã‚Œã§æ¥ç¶šã§ãã¾ã™ã€‚conda_pathã«ã¯ä»®æƒ³ç’°å¢ƒã¸ã®ãƒ‘ã‚¹ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚\nimport sys sys.version ## '3.7.7 (default, May 6 2020, 11:45:54) [MSC v.1916 64 bit (AMD64)]'\r1. ECONDBã‹ã‚‰ã®ãƒ‡ãƒ¼ã‚¿å–å¾— pandas_datareaderã§ã¯ã€ECOMDBã‹ã‚‰ãƒã‚¯ãƒ­çµŒæ¸ˆé–¢é€£ã®ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚\nECONDBã¨ã¯ï¼Ÿ ECONDBã¯å„å›½ã®ä¸»è¦ãƒã‚¯ãƒ­çµŒæ¸ˆãƒ‡ãƒ¼ã‚¿ã‚’dashboardå½¢å¼ã§æä¾›ã—ã¦ãã‚Œã‚‹Webã‚µã‚¤ãƒˆã§ã€ã¾ãŸAPIã‚’ã‚µãƒãƒ¼ãƒˆã—ã¦ãŠã‚Šã€Pythonã‚„Excelã«ã‚·ãƒ¼ãƒ ãƒ¬ã‚¹ã«ãƒ‡ãƒ¼ã‚¿ã‚’é€£ä¿‚ã—ã¦ãã‚Œã¾ã™ã€‚\nãƒ‡ãƒ¼ã‚¿å–å¾—æ–¹æ³• pandas_datareaderã‚’ç”¨ã„ãŸä½¿ç”¨æ–¹æ³•ã¯ä»¥ä¸‹ã®é€šã‚Šã§ã™ã€‚\nåŸºæœ¬çš„ãªä½¿ç”¨æ–¹æ³• pandas_datareaderã‹ã‚‰ãƒ‡ãƒ¼ã‚¿ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚’ã‚¤ãƒ³ãƒãƒ¼ãƒˆã™ã‚‹ã“ã¨ã‹ã‚‰å§‹ã‚ã¾ã™ã€‚\nimport pandas_datareader.data as web ## C:\\Users\\aashi\\Documents\\R\\win-library\\4.1\\reticulate\\python\\rpytools\\loader.py:44: FutureWarning: pandas.util.testing is deprecated. Use the functions in the public API at pandas.testing instead.\r## level=level\rEconDBã‹ã‚‰ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—ã™ã‚‹ã«ã¯ã€DataReaderãƒ¡ã‚½ãƒƒãƒ‰ã‚’å‘¼ã³å‡ºã—ã€ä»¥ä¸‹ã®ã‚ˆã†ã«data_sourceå¼•æ•°ã«'econdb'ã¨é©å½“ãªqueryã‚’æ¸¡ã›ã°ã‚ˆã„ã§ã™ã€‚\ndf = web.DataReader(query, data_source=\u0026#39;econdb\u0026#39;, **kwargs) ã‚¯ã‚¨ãƒªãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã®å½¢å¼ã¯ã€å–å¾—ã™ã‚‹ãƒ‡ãƒ¼ã‚¿ã®ç¨®é¡ã«ã‚ˆã£ã¦ç•°ãªã‚Šã¾ã™ã€‚\nã‚¯ã‚¨ãƒªæŒ‡å®šæ–¹æ³• ãƒ‡ãƒ¼ã‚¿ã¯ã„ãã¤ã‹ã®ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã«åˆ†å‰²ã•ã‚Œã¾ã™ã€‚ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã«ã¯ã€ãƒˆãƒ”ãƒƒã‚¯ã€é »åº¦ã€èª¿æŸ»æ–¹æ³•ãªã©ã®å…±é€šã®ç‰¹å¾´ã‚’æŠ½å‡ºã§ãã‚‹ãƒ†ã‚£ãƒƒã‚«ãƒ¼ãŒä»˜ä¸ã•ã‚Œã¦ã„ã¾ã™ã€‚ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¯æ¤œç´¢æ©Ÿèƒ½ã‚’ä½¿ç”¨ã—ã¦ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã‚’æ¢ã™ã“ã¨ãŒã§ãã¾ã™ã€‚UST_MSPDãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã‚’ä¾‹ã«ã—ã¦ã¿ã¾ã™ã€‚\nãƒšãƒ¼ã‚¸ã«å…¥ã‚‹ã¨ã€ã„ãã¤ã‹ã®ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ãŒã‚ã‚Šã€ç‰¹å®šã®ã‚·ãƒªãƒ¼ã‚ºã¨ç‰¹å®šã®ã‚¿ã‚¤ãƒ ãƒ•ãƒ¬ãƒ¼ãƒ ã«é¸æŠã‚’çµã‚Šè¾¼ã‚€ã“ã¨ãŒã§ãã¾ã™ã€‚é©åˆ‡ãªãƒ•ã‚£ãƒ«ã‚¿ãŒè¨­å®šã•ã‚ŒãŸçŠ¶æ…‹ã§ã€Exportãƒ‰ãƒ­ãƒƒãƒ—ãƒ€ã‚¦ãƒ³ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯ã™ã‚‹ã¨ã€é¸æŠã—ãŸãƒ‡ãƒ¼ã‚¿ã‚’ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆã™ã‚‹ãŸã‚ã®å¤šãã®ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã¨ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆãŒè¡¨ç¤ºã•ã‚Œã¾ã™ã€‚ãã®ä¸­ã§ã‚‚ã€Export to Pythonã¯ã€äº‹å‰ã«ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã•ã‚ŒãŸãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’æŒã¤ã‚³ãƒ¼ãƒ‰ã®é‡è¦ãªéƒ¨åˆ†ã‚’è¡¨ç¤ºã—ã¾ã™ã€‚ã“ã‚Œã‚’ãã®ã¾ã¾è²¼ã‚Šä»˜ã‘ã¦ã—ã¾ãˆã°ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—ã§ãã¾ã™ã€‚\nquery = \u0026#34;\u0026amp;\u0026#34;.join([ \u0026#34;dataset=UST_MSPD\u0026#34;, \u0026#34;v=Category\u0026#34;, \u0026#34;h=TIME\u0026#34;, \u0026#34;from=2018-01-01\u0026#34;, \u0026#34;to=2019-12-31\u0026#34; ]) df = web.DataReader(query, \u0026#39;econdb\u0026#39;) df.head() ## Category Bills ... United States Savings Securities\r## Holder Intragovernmental Holdings ... Totals\r## TIME_PERIOD ... ## 2018-01-01 3830.0 ... 159902\r## 2018-02-01 3748.0 ... 159475\r## 2018-03-01 4552.0 ... 159040\r## 2018-04-01 2641.0 ... 158606\r## 2018-05-01 577.0 ... 158233\r## ## [5 rows x 51 columns]\rå®Ÿè·µçš„ãªå–å¾—ã‚³ãƒ¼ãƒ‰ ã“ã‚“ãªã“ã¨ã‚‚ã§ãã¾ã™ã€‚\nimport pandas as pd from matplotlib import pyplot as plt import pandas_datareader.data as web from datetime import datetime import seaborn as sns start = datetime(1980,1,1) end = datetime(2019,12,31) # parameters for data from econdb country = [\u0026#39;US\u0026#39;,\u0026#39;UK\u0026#39;,\u0026#39;JP\u0026#39;,\u0026#39;EU\u0026#39;] indicator = [\u0026#39;RGDP\u0026#39;,\u0026#39;CPI\u0026#39;,\u0026#39;URATE\u0026#39;,\u0026#39;CA\u0026#39;,\u0026#39;HOU\u0026#39;,\u0026#39;POP\u0026#39;,\u0026#39;RETA\u0026#39;,\u0026#39;IP\u0026#39;] # Parse API from econdb econ = pd.DataFrame() for cnty in country: temp2 = pd.DataFrame() for idctr in indicator: temp = web.DataReader(\u0026#39;ticker=\u0026#39; + idctr + cnty,\u0026#39;econdb\u0026#39;,start,end) temp.columns = [idctr] temp2 = pd.concat([temp2,temp],join=\u0026#39;outer\u0026#39;,axis=1) temp2 = temp2.assign(kuni=cnty,kijyundate=temp2.index) econ = pd.concat([econ,temp2],join=\u0026#39;outer\u0026#39;) econ = econ.reset_index(drop=True) econ.head() # Plot CPI for example ## RGDP CPI URATE CA HOU POP RETA IP kuni kijyundate\r## 0 6842024.0 78.0 6.3 -10666.0 NaN 226554.0 NaN 52.17 US 1980-01-01\r## 1 NaN 79.0 6.3 NaN NaN 226753.0 NaN 52.20 US 1980-02-01\r## 2 NaN 80.1 6.3 NaN NaN 226955.0 NaN 51.98 US 1980-03-01\r## 3 6701046.0 80.9 6.9 9844.0 NaN 227156.0 NaN 50.97 US 1980-04-01\r## 4 NaN 81.7 7.5 NaN NaN 227387.0 NaN 49.71 US 1980-05-01\rsns.set ## \u0026lt;function set at 0x0000000031ED0B88\u0026gt;\rsns.relplot(data=econ,x=\u0026#39;kijyundate\u0026#39;,y=\u0026#39;CPI\u0026#39;,hue=\u0026#39;kuni\u0026#39;,kind=\u0026#39;line\u0026#39;) plt.show() 2. World Bankã‹ã‚‰ã®ãƒ‡ãƒ¼ã‚¿å–å¾—æ–¹æ³• ä¸–ç•ŒéŠ€è¡Œã‹ã‚‰å–å¾—ã§ãã‚‹ãƒ‡ãƒ¼ã‚¿ã¨ã¯ï¼Ÿ ä¸–ç•ŒéŠ€è¡Œã¯å‰èº«ãŒå›½éš›å¾©èˆˆé–‹ç™ºéŠ€è¡Œ(IBRD)ã€å›½éš›é–‹ç™ºå”ä¼š(IDA)ã§ã‚ã‚‹ã“ã¨ã‹ã‚‰ã‚‚ã‚ã‹ã‚‹ã‚ˆã†ã«é–‹ç™ºç³»ã®ãƒ‡ãƒ¼ã‚¿ãŒå–å¾—ã§ãã¾ã™ã€‚æœ€è¿‘ã§ã¯COVID-19é–¢é€£ã®ãƒ‡ãƒ¼ã‚¿ã‚‚å–å¾—ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚ pandas_datareaderã§ã¯ã€wbé–¢æ•°ã‚’ä½¿ç”¨ã™ã‚‹ã“ã¨ã§ã€World Bank\u0026rsquo;s World Development Indicatorsã¨å‘¼ã°ã‚Œã‚‹ä¸–ç•ŒéŠ€è¡Œã®æ•°åƒã‚‚ã®ãƒ‘ãƒãƒ«ãƒ‡ãƒ¼ã‚¿ã«ç°¡å˜ã«ã‚¢ã‚¯ã‚»ã‚¹ã§ãã¾ã™ã€‚\nãƒ‡ãƒ¼ã‚¿ã®æ¤œç´¢æ–¹æ³• ä¾‹ãˆã°ã€åŒ—ç±³åœ°åŸŸã®å›½ã€…ã®ä¸€äººå½“ãŸã‚Šã®å›½å†…ç·ç”Ÿç”£ã‚’ãƒ‰ãƒ«ãƒ™ãƒ¼ã‚¹ã§æ¯”è¼ƒã—ãŸã„å ´åˆã¯ã€searché–¢æ•°ã‚’ä½¿ç”¨ã—ã¾ã™ã€‚\nfrom pandas_datareader import wb matches = wb.search(\u0026#39;gdp.*capita.*const\u0026#39;) print(matches.loc[:,[\u0026#39;id\u0026#39;,\u0026#39;name\u0026#39;]]) ## id name\r## 716 6.0.GDPpc_constant GDP per capita, PPP (constant 2011 internation...\r## 10411 NY.GDP.PCAP.KD GDP per capita (constant 2015 US$)\r## 10413 NY.GDP.PCAP.KN GDP per capita (constant LCU)\r## 10415 NY.GDP.PCAP.PP.KD GDP per capita, PPP (constant 2017 internation...\r## 10416 NY.GDP.PCAP.PP.KD.87 GDP per capita, PPP (constant 1987 internation...\rNY.GDP.PCAP.KDãŒãã‚Œã«å½“ãŸã‚‹ã“ã¨ãŒã‚ã‹ã‚Šã¾ã™ã€‚2010å¹´ã®USãƒ‰ãƒ«ãƒ™ãƒ¼ã‚¹ã§å®Ÿè³ªåŒ–ã•ã‚Œã¦ã„ã‚‹ã‚ˆã†ã§ã™ã€‚\nãƒ‡ãƒ¼ã‚¿ã®å–å¾—æ–¹æ³• downloadé–¢æ•°ã§ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—ã—ã¾ã™ã€‚\ndat = wb.download(indicator=\u0026#39;NY.GDP.PCAP.KD\u0026#39;, country=[\u0026#39;US\u0026#39;, \u0026#39;CA\u0026#39;, \u0026#39;MX\u0026#39;], start=2010, end=2018) print(dat) ## NY.GDP.PCAP.KD\r## country year ## Canada 2018 44917.369814\r## 2017 44325.416776\r## 2016 43536.913403\r## 2015 43596.135537\r## 2014 43635.095481\r## 2013 42846.284196\r## 2012 42315.807389\r## 2011 42036.997844\r## 2010 41155.323638\r## Mexico 2018 9945.776845\r## 2017 9842.400712\r## 2016 9751.569083\r## 2015 9616.645558\r## 2014 9426.324588\r## 2013 9282.991933\r## 2012 9280.258638\r## 2011 9076.301453\r## 2010 8878.561377\r## United States 2018 59821.592274\r## 2017 58387.775808\r## 2016 57418.933846\r## 2015 56863.371496\r## 2014 55574.356825\r## 2013 54604.130054\r## 2012 53989.248340\r## 2011 53190.231121\r## 2010 52759.998081\rpandasã®dataframeå½¢å¼ã§ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—ã§ãã¦ã„ã‚‹ã“ã¨ãŒåˆ†ã‹ã‚Šã¾ã™ã€‚å¹´ã¨å›½ãŒindexã«ãªã£ã¦ã„ã¾ã™ã­ã€‚\n3. Fama/French Data Libraryã‹ã‚‰ã®ãƒ‡ãƒ¼ã‚¿å–å¾—æ–¹æ³• Fama/French Data Libraryã§å–ã‚Œã‚‹ãƒ‡ãƒ¼ã‚¿ã¨ã¯ é‡‘èé–¢é€£ãƒ‡ãƒ¼ã‚¿ã«ãªã‚Šã¾ã™ãŒã€æœ‰åãªFama/Frechã®3 Factor modelã®ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆãŒFama/French Data Libraryã‹ã‚‰å–å¾—ã§ãã¾ã™ã€‚get_available_datasetsé–¢æ•°ã¯ã€åˆ©ç”¨å¯èƒ½ãªã™ã¹ã¦ã®ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã®ãƒªã‚¹ãƒˆã‚’è¿”ã—ã¾ã™ã€‚\nãƒ‡ãƒ¼ã‚¿å–å¾—æ–¹æ³• from pandas_datareader.famafrench import get_available_datasets len(get_available_datasets()) ## 297\råˆ©ç”¨å¯èƒ½ãªãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã¯297ã§ã™ã€‚ ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã«ã©ã‚“ãªã‚‚ã®ãŒã‚ã‚‹ã‹ã€20å€‹ã»ã©ã‚µãƒ³ãƒ—ãƒªãƒ³ã‚°ã—ã¦ã¿ã¾ã™ã€‚\nimport random print(random.sample(get_available_datasets(),20)) ## ['Japan_3_Factors_Daily', 'Developed_ex_US_Mom_Factor_Daily', 'Portfolios_Formed_on_ME', '25_Portfolios_OP_INV_5x5', 'North_America_6_Portfolios_ME_OP', 'Europe_6_Portfolios_ME_Prior_250_20_daily', 'Portfolios_Formed_on_INV', '10_Industry_Portfolios_Wout_Div', '5_Industry_Portfolios', '32_Portfolios_ME_OP_INV_2x4x4', 'Europe_32_Portfolios_ME_INV(TA)_OP_2x4x4', 'North_America_6_Portfolios_ME_Prior_12_2', 'Europe_25_Portfolios_ME_Prior_12_2', 'Developed_ex_US_25_Portfolios_ME_OP_Daily', 'Europe_3_Factors', 'Portfolios_Formed_on_E-P', 'Asia_Pacific_ex_Japan_25_Portfolios_ME_Prior_12_2', 'Europe_25_Portfolios_ME_OP', 'Developed_25_Portfolios_ME_BE-ME', '38_Industry_Portfolios']\ræ—¥æœ¬æ ªã®ãƒãƒ¼ãƒˆãƒ•ã‚©ãƒªã‚ªã‚‚å­˜åœ¨ã—ã¾ã™ã€‚\nds = web.DataReader(\u0026#39;5_Industry_Portfolios\u0026#39;, \u0026#39;famafrench\u0026#39;) print(ds[\u0026#39;DESCR\u0026#39;]) ## 5 Industry Portfolios\r## ---------------------\r## ## This file was created by CMPT_IND_RETS using the 202201 CRSP database. It contains value- and equal-weighted returns for 5 industry portfolios. The portfolios are constructed at the end of June. The annual returns are from January to December. Missing data are indicated by -99.99 or -999. Copyright 2022 Kenneth R. French\r## ## 0 : Average Value Weighted Returns -- Monthly (59 rows x 5 cols)\r## 1 : Average Equal Weighted Returns -- Monthly (59 rows x 5 cols)\r## 2 : Average Value Weighted Returns -- Annual (5 rows x 5 cols)\r## 3 : Average Equal Weighted Returns -- Annual (5 rows x 5 cols)\r## 4 : Number of Firms in Portfolios (59 rows x 5 cols)\r## 5 : Average Firm Size (59 rows x 5 cols)\r## 6 : Sum of BE / Sum of ME (5 rows x 5 cols)\r## 7 : Value-Weighted Average of BE/ME (5 rows x 5 cols)\r5ã¤ç›®ãŒãƒãƒ¼ãƒˆãƒ•ã‚©ãƒªã‚ªã«å«ã¾ã‚Œã‚‹éŠ˜æŸ„æ•°ã€1ã¤ç›®ãŒvalue weightedãƒãƒ¼ãƒˆãƒ•ã‚©ãƒªã‚ªã®æœˆæ¬¡ãƒªã‚¿ãƒ¼ãƒ³ã§ã™ã€‚\nds[4].head() ## Cnsmr Manuf HiTec Hlth Other\r## Date ## 2017-03 519 592 663 577 1025\r## 2017-04 517 586 658 574 1018\r## 2017-05 515 583 655 572 1009\r## 2017-06 511 580 651 570 1000\r## 2017-07 525 615 684 613 1056\rds[0].head() ## Cnsmr Manuf HiTec Hlth Other\r## Date ## 2017-03 0.79 -0.20 1.91 0.03 -1.69\r## 2017-04 1.82 0.36 2.19 0.91 0.23\r## 2017-05 2.02 0.35 3.12 -0.25 -0.45\r## 2017-06 -1.19 0.32 -2.12 5.54 4.22\r## 2017-07 -0.07 2.31 4.02 0.70 1.49\r4. FERDã‹ã‚‰ã®ãƒ‡ãƒ¼ã‚¿å–å¾—æ–¹æ³• FREDã§å–å¾—ã§ãã‚‹ãƒ‡ãƒ¼ã‚¿ã¨ã¯ FREDã§ã¯å¤šç¨®å¤šæ§˜ãªçµŒæ¸ˆçµ±è¨ˆãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚ã‚µã‚¤ãƒˆã¸è¡Œãã¨ã€ä»¥ä¸‹ã®ã‚ˆã†ã«çµ±è¨ˆæ¯ã«ãƒšãƒ¼ã‚¸ãŒå­˜åœ¨ã—ã¾ã™ã€‚ã“ã®çµ±è¨ˆåã®æ¨ªã«ã¤ã„ã¦ã„ã‚‹CPIAUCSLãŒTickerã«ãªã£ã¦ãŠã‚Šã€ã“ã‚Œã‚’æ¸¡ã™ã“ã¨ã§ã€ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚\nãƒ‡ãƒ¼ã‚¿å–å¾—æ–¹æ³• å…ˆã»ã©è¦‹ãŸTickerã‚’DataReaderé–¢æ•°ã«æ¸¡ã—ã€ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹ã‚’fredã¨ã™ã‚‹ã“ã¨ã§ã€ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚\nimport datetime start = datetime.datetime(2010, 1, 1) end = datetime.datetime(2013, 1, 27) gdp = web.DataReader(\u0026#39;GDP\u0026#39;, \u0026#39;fred\u0026#39;, start, end) inflation = web.DataReader([\u0026#39;CPIAUCSL\u0026#39;, \u0026#39;CPILFESL\u0026#39;], \u0026#39;fred\u0026#39;, start, end) gdp.head() ## GDP\r## DATE ## 2010-01-01 14764.611\r## 2010-04-01 14980.193\r## 2010-07-01 15141.605\r## 2010-10-01 15309.471\r## 2011-01-01 15351.444\rinflation.head() ## CPIAUCSL CPILFESL\r## DATE ## 2010-01-01 217.488 220.633\r## 2010-02-01 217.281 220.731\r## 2010-03-01 217.353 220.783\r## 2010-04-01 217.403 220.822\r## 2010-05-01 217.290 220.962\r5. OECDã‹ã‚‰ã®ãƒ‡ãƒ¼ã‚¿å–å¾—æ–¹æ³• OECDã¯ä»¥å‰ä»¥ä¸‹ã®è¨˜äº‹ã§ç´¹ä»‹ã—ã¾ã—ãŸãŒã€pandas_datareaderã§ã‚‚å–å¾—ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚\nOECD.orgã‹ã‚‰ãƒã‚¯ãƒ­ãƒ‘ãƒãƒ«ãƒ‡ãƒ¼ã‚¿ã‚’APIã§å–å¾—ã™ã‚‹\nãŸã ã€OECD dataset codeã‚’æŒ‡å®šã™ã‚‹ã ã‘1ãªã®ã§ã€pandasdmxã‚ˆã‚Šã¯è‡ªç”±åº¦ãŒä½ã„ã§ã™ã€‚ ã‚ã¨ã€å‰å›å–å¾—ã—ãŸMEI_ARCHIVEã¨ã‹æŒ‡å®šã™ã‚‹ã¨ãƒ‡ãƒ¼ã‚¿ãŒå¤šã™ãã¦ã€ã‚¨ãƒ©ãƒ¼ãŒå‡ºã¾ã™ã€‚OECDãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—ã™ã‚‹ã¨ãã«ã¯ã€å›½ã‚„æœŸé–“ãªã©ç´°ã‹ã„æŒ‡å®šã®ã§ãã‚‹pandasdmxã®ã»ã†ãŒè‰¯ã„ã¨å€‹äººçš„ã«æ€ã„ã¾ã™ã€‚\nãªãŠã€ä½¿ç”¨æ–¹æ³•ã¯FREDã¨åŒæ§˜ã§ã€ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹ã«oecdã‚’æŒ‡å®šã—ã¾ã™ã€‚\ndf = web.DataReader(\u0026#39;TUD\u0026#39;, \u0026#39;oecd\u0026#39;) df.head() ## Country Australia ... Slovenia\r## Frequency Annual ... Annual\r## Measure Percentage of employees ... Percentage of employees\r## Time ... ## 2018-01-01 NaN ... NaN\r## 2019-01-01 NaN ... NaN\r## 2020-01-01 NaN ... NaN\r## ## [3 rows x 39 columns]\r6. Eurostatã‹ã‚‰ã®ãƒ‡ãƒ¼ã‚¿å–å¾—æ–¹æ³• Eurostatã‹ã‚‰å–å¾—ã§ãã‚‹ãƒ‡ãƒ¼ã‚¿ã¨ã¯ Eurostatã¯æ¬§å·é€£åˆã®çµ±è¨ˆå±€ã§ã€ä¸»ã«EUåœ°åŸŸã®ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚ãƒ‡ãƒ¼ã‚¿ã¯ä»¥ä¸‹ã®ã‚ˆã†ã«å¤šå²ã«ã‚ãŸã£ã¦ãŠã‚Šã€çµŒæ¸ˆé‡‘èã ã‘ã§ãªãè¾²æ¥­ã‚„äººå£å‹•æ…‹ã€è¼¸é€ã€ç’°å¢ƒç­‰ã€…å¤šç¨®å¤šæ§˜ãªãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚\nIDã‚’ã©ã®ã‚ˆã†ã«å–å¾—ã™ã‚Œã°ã‚ˆã„ã®ã‹ã§ã™ãŒã€ä»¥ä¸‹ã®ãƒšãƒ¼ã‚¸ã«ã¦ã€å–å¾—ã—ãŸã„ãƒ‡ãƒ¼ã‚¿ã‚’é †ã€…ã«æ˜ã‚Šé€²ã‚ã¦ã„ãã¨é»„è‰²ã§è‰²ã‚’ä»˜ã‘ãŸã‚ˆã†ãªIDã‚³ãƒ¼ãƒ‰ãŒå‡ºã¦ãã¾ã™ã€‚ã“ã‚Œã§å–å¾—ãƒ‡ãƒ¼ã‚¿ã®IDã‚’ç‰¹å®šã—ã¾ã™ã€‚\nãŸã ã€eurostatã‚‚OECDã¨åŒã˜ãsdmxã«å¯¾å¿œã—ã¦ã„ã‚‹ãŸã‚ã€pandasdmxã®ã»ã†ãŒä½¿ã„ã‚„ã™ã„ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ã€‚\nãƒ‡ãƒ¼ã‚¿å–å¾—æ–¹æ³• ä¸€ä¾‹ã¨ã—ã¦ã€ å…ˆã»ã©è¦‹ãŸEmployment and activity by sex and age - annual dataã‚’å–å¾—ã—ã¦ã¿ã¾ã™ã€‚\ndf = web.DataReader(\u0026#39;lfsi_emp_a\u0026#39;,\u0026#39;eurostat\u0026#39;).unstack() df.head() ## UNIT INDIC_EM SEX AGE GEO FREQ TIME_PERIOD\r## Percentage of total population Persons in the labour force (former name: active persons) Females From 15 to 24 years Austria Annual 2018-01-01 54.0\r## 2019-01-01 52.7\r## 2020-01-01 52.7\r## Belgium Annual 2018-01-01 27.8\r## 2019-01-01 29.5\r## dtype: float64\ræœ€å¾Œã« pandas_datareaderã‚’ä½¿ç”¨ã—ã¦ã€æ§˜ã€…ãªã‚½ãƒ¼ã‚¹ã‹ã‚‰å¤šç¨®å¤šæ§˜ãªãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—ã—ã¾ã—ãŸã€‚è³‡ç”£é‹ç”¨ä¼šç¤¾ãªã©ã§åƒã„ã¦ã„ã‚‹æ–¹ã¯bloombergã‚„EIKONã‹ã‚‰ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—ã§ãã‚‹ãŸã‚ã€ã‚ã¾ã‚Šé­…åŠ›çš„ã«æ„Ÿã˜ãªã„ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ãŒã€å€‹äººã§åˆ†æã‚’ã—ã¦ã„ã‚‹æ–¹ã‚„å®šæœŸçš„ã«ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—ã—ãŸã„æ–¹ã¯éå¸¸ã«ã‚ˆã„ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã ã¨æ€ã„ã¾ã™ã€‚è‡ªåˆ†è‡ªèº«ã€ã“ã®æ–°ã—ã„Webã‚µã‚¤ãƒˆã«ãƒªãƒ‹ãƒ¥ãƒ¼ã‚¢ãƒ«ã—ã¦ã‹ã‚‰ã€é€±æ¬¡ã‚„æœˆæ¬¡å˜ä½ã§çµŒæ¸ˆåˆ†æã‚’ä¸Šã’ã‚ˆã†ã‹ãªã¨æ€ã£ã¦ãŠã‚Šã€ã“ã‚Œã‚‰ã‚’ä½¿ç”¨ã—ã¦çµŒæ¸ˆã®å®šç‚¹è¦³æ¸¬ã‚’ã—ãŸã„ãªã¨æ€ã£ã¦ã„ã‚‹ã¨ã“ã‚ã§ã™ã€‚çš†ã•ã‚“ã‚‚èˆˆå‘³ã‚ã‚‹ãƒ‡ãƒ¼ã‚¿ã‚’pandas_datareaderã§è‡ªå‹•åé›†ã—ã¦ã¿ã¦ãã ã•ã„ï¼\n  ã‚µã‚¤ãƒˆã§çµ±è¨ˆã‚’é¸ã³ã€export \u0026gt;- SDMX Queryã¨ã™ã‚‹ã¨ãã®çµ±è¨ˆã®ã‚³ãƒ¼ãƒ‰ãŒè¦‹ã‚Œã¾ã™ã€‚ \u0026#x21a9;\u0026#xfe0e;\n   ","date":1604361600,"expirydate":-62135596800,"kind":"page","lang":"ja","lastmod":1604361600,"objectID":"a65e93e58ebc8f614f34b02e0a573c06","permalink":"/post/post15/","publishdate":"2020-11-03T00:00:00Z","relpermalink":"/post/post15/","section":"post","summary":"pandas_datareaderã‚’ä½¿ã£ã¦è‰²ã€…ãªãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—ã—ã¦ã¿ã¾ã—ãŸã€‚","tags":["Python","å‰å‡¦ç†"],"title":"Pythonã®pandas_datareaderã‹ã‚‰è‰²ã€…ãªãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—ã—ã¦ã¿ã‚‹","type":"post"},{"authors":null,"categories":["ãƒã‚¯ãƒ­çµŒæ¸ˆå­¦","å˜ç™º"],"content":"ãŠã¯ã“ã‚“ã°ã‚“ã«ã¡ã¯ã€‚ãƒã‚¯ãƒ­çµŒæ¸ˆãƒ‡ãƒ¼ã‚¿ã‚’é›†ã‚ã‚‹æ–¹æ³•ã¯ã„ãã¤ã‹ã‚ã‚Šã¾ã™ãŒã€å„å›½ã®ãƒ‡ãƒ¼ã‚¿ã‚’é›†ã‚ã‚‹ã¨ãªã‚‹ã¨ä¸€è‹¦åŠ´ã§ã™ã€‚ã§ã™ãŒã€OECDã‹ã‚‰APIçµŒç”±ã§ãƒ‡ãƒ¼ã‚¿å–å¾—ã™ã‚Œã°é¢å€’ãªå‡¦ç†ã‚’è‡ªå‹•åŒ–ã§ãã¾ã™ã€‚ä»Šæ—¥ã¯ãã®æ–¹æ³•ã‚’ã”ç´¹ä»‹ã—ã¾ã™ã€‚\n1.OECD.Stat Web API OECD.orgã§ã¯OECD.Statã¨ã„ã†ã‚µãƒ¼ãƒ“ã‚¹ã‚’æä¾›ã—ã¦ãŠã‚Šã€OECDåŠ ç›Ÿå›½ã¨ç‰¹å®šã®éåŠ ç›Ÿå›½ã®æ§˜ã€…ãªçµŒæ¸ˆãƒ‡ãƒ¼ã‚¿ãŒæä¾›ã•ã‚Œã¦ã„ã¾ã™ã€‚WEBã‚µã‚¤ãƒˆã«è¡Œã‘ã°æ‰‹å‹•ã§csvãƒ‡ãƒ¼ã‚¿ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã™ã‚‹ã“ã¨ã‚‚ã§ãã¾ã™ãŒã€å®šæœŸçš„ã«ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—ã—ã€åˆ†æã™ã‚‹å¿…è¦ãŒã‚ã‚‹ãªã‚‰ã°ãƒ‡ãƒ¼ã‚¿å–å¾—å‡¦ç†ã‚’è‡ªå‹•åŒ–ã—ãŸã„è¡å‹•ã«é§†ã‚‰ã‚Œã¾ã™ã€‚OECDã¯Web APIã‚’æä¾›ã—ã¦ã„ã‚‹ã®ã§ã€Pythonã‚„Rã•ãˆä½¿ãˆã‚Œã°ã“ã‚Œã‚’å®Ÿç¾ã§ãã¾ã™ã€‚\n\u0026lt;OECDå®Ÿæ–½ã®å…·ä½“çš„ãªå†…å®¹\u0026gt;\nä»¥ä¸‹ã¯ã€ç¾æ™‚ç‚¹ã§ã®ç‰¹å®šã®OECD REST SDMXã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã®å®Ÿè£…è©³ç´°ã®ãƒªã‚¹ãƒˆã§ã™ã€‚\n  åŒ¿åã‚¯ã‚¨ãƒªã®ã¿ãŒã‚µãƒãƒ¼ãƒˆã•ã‚Œã€èªè¨¼ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚\n  å„ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã¯1,000,000ä»¶ã®ã‚ªãƒ–ã‚¶ãƒ™ãƒ¼ã‚·ãƒ§ãƒ³ã«åˆ¶é™ã•ã‚Œã¦ã„ã¾ã™ã€‚\n  ãƒªã‚¯ã‚¨ã‚¹ãƒˆURLã®æœ€å¤§é•·ã¯1000æ–‡å­—ã§ã™ã€‚\n  ã‚¯ãƒ­ã‚¹ã‚ªãƒªã‚¸ãƒ³ãƒªã‚¯ã‚¨ã‚¹ãƒˆã¯ã€CORS ãƒ˜ãƒƒãƒ€ã§ã‚µãƒãƒ¼ãƒˆã•ã‚Œã¦ã„ã¾ã™ (CORS ã«ã¤ã„ã¦ã®è©³ç´°ã¯ ã“ã¡ã‚‰ã‚’å‚ç…§)ã€‚\n  ã‚¨ãƒ©ãƒ¼ã¯çµæœã«ã¯è¿”ã•ã‚Œã¾ã›ã‚“ãŒã€HTTP ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚³ãƒ¼ãƒ‰ã¨ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã¯ Web ã‚µãƒ¼ãƒ“ã‚¹ã‚¬ã‚¤ãƒ‰ãƒ©ã‚¤ãƒ³ã«å¾“ã£ã¦è¨­å®šã•ã‚Œã¾ã™ã€‚\n  å­˜åœ¨ã—ãªã„ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆãŒè¦æ±‚ã•ã‚ŒãŸå ´åˆã¯ã€401 UnauthorizedãŒè¿”ã•ã‚Œã¾ã™ã€‚\n  REST ã‚¯ã‚¨ãƒªã® source (ã¾ãŸã¯ Agency ID) ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã¯å¿…é ˆã§ã™ãŒã€ã€ŒALLã€ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã¯ã‚µãƒãƒ¼ãƒˆã•ã‚Œã¦ã„ã¾ã™ã€‚\n  ãƒãƒ¼ã‚¸ãƒ§ãƒ‹ãƒ³ã‚°ã¯ã‚µãƒãƒ¼ãƒˆã•ã‚Œã¦ã„ã¾ã›ã‚“: å¸¸ã«æœ€æ–°ã®å®Ÿè£…ãƒãƒ¼ã‚¸ãƒ§ãƒ³ãŒä½¿ç”¨ã•ã‚Œã¾ã™ã€‚\n  ãƒ‡ãƒ¼ã‚¿ã®ä¸¦ã¹æ›¿ãˆã¯ã‚µãƒãƒ¼ãƒˆã•ã‚Œã¦ã„ã¾ã›ã‚“ã€‚\n  lastNObservationsãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã¯ã‚µãƒãƒ¼ãƒˆã•ã‚Œã¦ã„ã¾ã›ã‚“ã€‚\n  dimensionAtObservation=AllDimensions ãŒä½¿ç”¨ã•ã‚Œã¦ã„ã‚‹å ´åˆã§ã‚‚ã€è¦³æ¸¬ã¯æ™‚ç³»åˆ— (ã¾ãŸã¯ã‚¤ãƒ³ãƒãƒ¼ãƒˆå›ºæœ‰) ã®é †åºã«å¾“ã„ã¾ã™ã€‚\n  ç¾æ™‚ç‚¹ã§ã¯ã€å‚ç…§ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ã®æ¤œç´¢ã¯ã‚µãƒãƒ¼ãƒˆã•ã‚Œã¦ã„ã¾ã›ã‚“ã€‚\n  2.pandasdmx Web APIã¯sdmx-jsonã¨ã„ã†å½¢å¼ã§æä¾›ã•ã‚Œã¾ã™ã€‚Pythonã§ã¯ã“ã‚Œã‚’ä½¿ç”¨ã™ã‚‹ãŸã‚ã®ä¾¿åˆ©ãªãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ãŒå­˜åœ¨ã—ã¾ã™ã€‚ãã‚ŒãŒ**pandasdmx**ã§ã™ã€‚ãƒ‡ãƒ¼ã‚¿ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã™ã‚‹æ–¹æ³•ã¯ä»¥ä¸‹ã®é€šã‚Šã§ã™ã€‚\n pandasdmxã‚’importã—ã€Requestãƒ¡ã‚½ãƒƒãƒ‰ã«å¼•æ•°ã¨ã—ã¦\u0026rsquo;OECD\u0026rsquo;ã‚’æ¸¡ã—ã€api.Requestã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’ä½œæˆã™ã‚‹ã€‚ ä½œæˆã—ãŸapi.Requestã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®dataãƒ¡ã‚½ãƒƒãƒ‰ã«ã‚¯ã‚¨ãƒªæ¡ä»¶ã‚’æ¸¡ã—ã€OECD.orgã‹ã‚‰sdmx-jsonå½¢å¼ã®ãƒ‡ãƒ¼ã‚¿ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã™ã‚‹ã€‚ ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ãŸãƒ‡ãƒ¼ã‚¿ã‚’to_pandas()ãƒ¡ã‚½ãƒƒãƒ‰ã§pandasãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ¬ãƒ¼ãƒ ã¸æ•´å½¢ã™ã‚‹ã€‚  3.å®Ÿè£… ã§ã¯ã€å®Ÿéš›ã«ã‚„ã£ã¦ã¿ã¾ã—ã‚‡ã†ã€‚å–å¾—ã™ã‚‹ã®ã¯ã€ã€Œ**Revisions Analysis Dataset -- Infra-annual Economic Indicators**ã€ã¨ã„ã†ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã§ã™ã€‚OECDã®ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã®ä¸€ã¤ã§ã‚ã‚‹Monthly Ecnomic Indicator(MEI)ã®ä¿®æ­£ã‚’å«ã‚€å…¨ã¦ã®ãƒ‡ãƒ¼ã‚¿ã«ã‚¢ã‚¯ã‚»ã‚¹ã—ã¦ã„ã‚‹ã®ã§ã€ä¸»è¦ãªçµŒæ¸ˆå¤‰æ•°(å›½å†…ç·ç”Ÿç”£ã¨ãã®æ”¯å‡ºé …ç›®ã€é‰±å·¥æ¥­ç”Ÿç”£ã¨å»ºè¨­ç”Ÿç”£æŒ‡æ•°ã€å›½éš›åæ”¯ã€è¤‡åˆä¸»è¦æŒ‡æ¨™ã€æ¶ˆè²»è€…ç‰©ä¾¡æŒ‡æ•°ã€å°å£²å–å¼•é«˜ã€å¤±æ¥­ç‡ã€å°±æ¥­è€…æ•°ã€æ™‚é–“å½“ãŸã‚Šè³ƒé‡‘ã€è²¨ãƒãƒãƒ¼ã‚µãƒ—ãƒ©ã‚¤ã€è²¿æ˜“çµ±è¨ˆãªã©)ã«ã¤ã„ã¦ã€åˆå‡ºæ™‚ã®é€Ÿå ±ãƒ‡ãƒ¼ã‚¿ã‹ã‚‰ä¿®æ­£ãŒåŠ ãˆã‚‰ã‚ŒãŸç¢ºå ±ãƒ‡ãƒ¼ã‚¿ã¾ã§ç¢ºèªã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚ã“ã®ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã§ã¯ã€1999å¹´2æœˆã‹ã‚‰æ¯æœˆã®é–“éš”ã§ã€éå»ã«ä¸»è¦çµŒæ¸ˆæŒ‡æ¨™ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã§åˆ†æå¯èƒ½ã ã£ãŸãƒ‡ãƒ¼ã‚¿ã®ã‚¹ãƒŠãƒƒãƒ—ã‚·ãƒ§ãƒƒãƒˆãŒæä¾›ã•ã‚Œã¦ã„ã¾ã™ã€‚ã¤ã¾ã‚Šã€å„æ™‚ç‚¹ã§å…¥æ‰‹å¯èƒ½ãªãƒ‡ãƒ¼ã‚¿ã«åŸºã¥ãã€äºˆæ¸¬ãƒ¢ãƒ‡ãƒ«ã®æ§‹ç¯‰ãŒã§ãã‚‹ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã«ãªã£ã¦ã„ã¾ã™ã€‚æœ€æ–°ã®ãƒ‡ãƒ¼ã‚¿ã¯æœ‰ç”¨ã§ã™ãŒé€Ÿå ±å€¤ãªã®ã§ä¸ç¢ºå®Ÿæ€§ãŒã¤ãã¾ã¨ã„ã¾ã™ã€‚ãƒãƒƒã‚¯ãƒ†ã‚¹ãƒˆã‚’è¡Œã†éš›ã«ã¯ã“ã®çŠ¶æ³ãŒå†ç¾ã§ããšå®Ÿéš›ã®é‹ç”¨ã‚ˆã‚Šã‚‚è‰¯ã„ç’°å¢ƒã§åˆ†æã—ã¦ã—ã¾ã†ã“ã¨ãŒå•é¡Œã«ãªã£ãŸã‚Šã—ã¾ã™ã€‚ã„ã‚ã‚†ã‚‹Jagged edgeå•é¡Œã§ã™ã€‚ã“ã®ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã§ã¯å®Ÿé‹ç”¨ã®çŠ¶æ³ãŒå†ç¾ã§ãã‚‹ãŸã‚éå¸¸ã«æœ‰ç”¨ã§ã‚ã‚‹ã¨æ€ã„ã¾ã™ã€‚ä»Šå›ã¯ä»¥ä¸‹ã®ãƒ‡ãƒ¼ã‚¿é …ç›®ã‚’å–å¾—ã—ã¾ã™ã€‚\n   çµ±è¨ˆæ¦‚è¦ çµ±è¨ˆID é »åº¦     GDP 101 å››åŠæœŸ   é‰±å·¥æ¥­ç”Ÿç”£æŒ‡æ•° 201 æœˆæ¬¡   å°å£²æ¥­å–å¼•é«˜ 202 æœˆæ¬¡   ãƒãƒãƒ¼ã‚µãƒ—ãƒ©ã‚¤ - åºƒç¾©æµå‹•æ€§ 601 æœˆæ¬¡   è²¿æ˜“çµ±è¨ˆ 702+703 æœˆæ¬¡   çµŒå¸¸åæ”¯ 701 å››åŠæœŸ   å°±æ¥­è€…æ•° 502 æœˆæ¬¡   å¤±æ¥­ç‡ 501 æœˆæ¬¡   æ™‚é–“å½“ãŸã‚Šè³ƒé‡‘ï¼ˆè£½é€ æ¥­ï¼‰ 503 æœˆæ¬¡   å˜ä½ã‚ãŸã‚ŠåŠ´åƒã‚³ã‚¹ãƒˆ 504 å››åŠæœŸ   å»ºç¯‰ç”Ÿç”£æŒ‡æ•° 203 æœˆæ¬¡    ã¾ãšã€é–¢æ•°ã‚’å®šç¾©ã—ã¾ã™ã€‚å¼•æ•°ã¯ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹IDã€ãã®ä»–ID(å›½IDã‚„çµ±è¨ˆID)ã€é–‹å§‹åœ°ç‚¹ã€çµ‚äº†åœ°ç‚¹ã§ã™ã€‚\nimport pandasdmx as sdmx ## C:\\Users\\aashi\\ANACON~1\\lib\\site-packages\\pandasdmx\\remote.py:13: RuntimeWarning: optional dependency requests_cache is not installed; cache options to Session() have no effect\r## RuntimeWarning,\roecd = sdmx.Request(\u0026#39;OECD\u0026#39;) def resp_OECD(dsname,dimensions,start,end): dim_args = [\u0026#39;+\u0026#39;.join(d) for d in dimensions] dim_str = \u0026#39;.\u0026#39;.join(dim_args) resp = oecd.data(resource_id=dsname, key=dim_str + \u0026#34;/all?startTime=\u0026#34; + start + \u0026#34;\u0026amp;endTime=\u0026#34; + end) df = resp.to_pandas().reset_index() return(df) ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—ã™ã‚‹æ¬¡å…ƒã‚’æŒ‡å®šã—ã¾ã™ã€‚ä»¥ä¸‹ã§ã¯ã€â‘ å›½ã€â‘¡çµ±è¨ˆé …ç›®ã€â‘¢å…¥æ‰‹æ™‚ç‚¹ã€â‘£é »åº¦ã‚’ã‚¿ãƒ—ãƒ«ã§æŒ‡å®šã—ã¦ã„ã¾ã™ã€‚\ndimensions = ((\u0026#39;USA\u0026#39;,\u0026#39;JPN\u0026#39;,\u0026#39;GBR\u0026#39;,\u0026#39;FRA\u0026#39;,\u0026#39;DEU\u0026#39;,\u0026#39;ITA\u0026#39;,\u0026#39;CAN\u0026#39;,\u0026#39;NLD\u0026#39;,\u0026#39;BEL\u0026#39;,\u0026#39;SWE\u0026#39;,\u0026#39;CHE\u0026#39;),(\u0026#39;201\u0026#39;,\u0026#39;202\u0026#39;,\u0026#39;601\u0026#39;,\u0026#39;702\u0026#39;,\u0026#39;703\u0026#39;,\u0026#39;701\u0026#39;,\u0026#39;502\u0026#39;,\u0026#39;503\u0026#39;,\u0026#39;504\u0026#39;,\u0026#39;203\u0026#39;),(\u0026#34;202001\u0026#34;,\u0026#34;202002\u0026#34;,\u0026#34;202003\u0026#34;,\u0026#34;202004\u0026#34;,\u0026#34;202005\u0026#34;,\u0026#34;202006\u0026#34;,\u0026#34;202007\u0026#34;,\u0026#34;202008\u0026#34;),(\u0026#34;M\u0026#34;,\u0026#34;Q\u0026#34;)) é–¢æ•°ã‚’å®Ÿè¡Œã—ã¾ã™ã€‚\nresult = resp_OECD(\u0026#39;MEI_ARCHIVE\u0026#39;,dimensions,\u0026#39;2019-Q1\u0026#39;,\u0026#39;2020-Q2\u0026#39;) result.count() ## LOCATION 8266\r## VAR 8266\r## EDI 8266\r## FREQUENCY 8266\r## TIME_PERIOD 8266\r## value 8266\r## dtype: int64\rãƒ‡ãƒ¼ã‚¿ã®æœ€åˆæ•°ä»¶ã‚’è¦‹ã¦ã¿ã¾ã™ã€‚\nresult.head() ## LOCATION VAR EDI FREQUENCY TIME_PERIOD value\r## 0 BEL 201 202001 M 2019-01 112.5\r## 1 BEL 201 202001 M 2019-02 111.8\r## 2 BEL 201 202001 M 2019-03 109.9\r## 3 BEL 201 202001 M 2019-04 113.5\r## 4 BEL 201 202001 M 2019-05 112.1\rãƒ‡ãƒ¼ã‚¿ãŒTidyãªå½¢(Longå‹)ã§å…¥ã£ã¦ã„ã‚‹ã®ãŒã‚ã‹ã‚Šã¾ã™ã€‚ä¸€ç•ªå³å´ã®valueãŒå€¤ã¨ã—ã¦æ ¼ç´ã•ã‚Œã¦ãŠã‚Šã€ãã®ä»–ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã¯\n  LOCATION - å›½\n  VAR - çµ±è¨ˆé …ç›®\n  EDI - å…¥æ‰‹æ™‚ç‚¹(MEI_ARCHIVEã®å ´åˆ)\n  FREQUENCY - é »åº¦(æœˆæ¬¡ã€å››åŠæœŸç­‰)\n  TIME_PERIOD - çµ±è¨ˆã®åŸºæº–æ™‚ç‚¹\n  ã¨ãªã£ã¦ã„ã¾ã™ã€‚ã‚ˆã£ã¦ã€EDIãŒç•°ãªã‚‹è¡Œã§åŒã˜TIME_PERIODãŒå­˜åœ¨ã—ã¾ã™ã€‚ä¾‹ãˆã°ã€ä¸Šã§ã¯ãƒ™ãƒ«ã‚®ãƒ¼(BEL)ã®é‰±å·¥æ¥­ç”Ÿç”£æŒ‡æ•°(201)ã®2020/01æ™‚ç‚¹ã§åˆ©ç”¨å¯èƒ½ãª2019-01~2019-05ã®ãƒ‡ãƒ¼ã‚¿ãŒè¡¨ç¤ºã•ã‚Œã¦ã„ã¾ã™ã€‚å¯è¦–åŒ–ã‚„å›å¸°ã‚‚è¡Œã„ã‚„ã™ã„Longãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã§ã®æä¾›ãªã®ã§éå¸¸ã«ã‚ã‚ŠãŒãŸã„ã§ã™ã­ã€‚é‰±å·¥æ¥­ç”Ÿç”£æŒ‡æ•°ãŒã‚¢ãƒƒãƒ—ãƒ‡ãƒ¼ãƒˆã•ã‚Œã¦ã„ãæ§˜å­ã‚’å¯è¦–åŒ–ã—ã¦ã¿ã¾ã—ãŸã€‚\nimport seaborn as sns import matplotlib.pyplot as plt import pandas as pd result = result[result[\u0026#39;FREQUENCY\u0026#39;]==\u0026#39;M\u0026#39;] result[\u0026#39;TIME_PERIOD\u0026#39;] = pd.to_datetime(result[\u0026#39;TIME_PERIOD\u0026#39;],format=\u0026#39;%Y-%m\u0026#39;) sns.relplot(data=result[lambda df: (df.VAR==\u0026#39;201\u0026#39;) \u0026amp; (pd.to_numeric(df.EDI) \u0026gt; 202004)],x=\u0026#39;TIME_PERIOD\u0026#39;,y=\u0026#39;value\u0026#39;,hue=\u0026#39;LOCATION\u0026#39;,kind=\u0026#39;line\u0026#39;,col=\u0026#39;EDI\u0026#39;) plt.show() ã‚³ãƒ­ãƒŠã®çµŒæ¸ˆçš„ãªè¢«å®³ãŒå¤§ãããªã‚‹ã«ã¤ã‚Œã¦æŠ˜ã‚Œç·šã‚°ãƒ©ãƒ•ãŒè½ã¡è¾¼ã‚“ã§ã„ãæ§˜å­ãŒè¦‹ã¦å–ã‚Œã‚‹ä¸€æ–¹ã€å¾®å¦™ã«ã§ã™ãŒéå»å€¤ã«ã¤ã„ã¦ã‚‚é€Ÿå ±å€¤â†’ç¢ºå ±å€¤ã¸ã¨ä¿®æ­£ãŒè¡Œã‚ã‚Œã¦ã„ã¾ã™ã€‚ã¾ãŸã€å›½ã«ã‚ˆã£ã¦çµ±è¨ˆãƒ‡ãƒ¼ã‚¿ã®å…¬è¡¨ã«ãƒ©ã‚°ãŒã‚ã‚‹ã“ã¨ã‚‚åˆ†ã‹ã‚Šã¾ã™ã€‚ãƒ™ãƒ«ã‚®ãƒ¼ã¯æœ€ã‚‚å…¬è¡¨ãŒé…ã„ã‚ˆã†ã§ã™ã€‚æ™‚é–“ãŒã‚ã‚‹ã¨ãã«ã€ã“ã®ãƒ‡ãƒ¼ã‚¿ã‚’ä½¿ã£ãŸç°¡å˜ãªäºˆæ¸¬ãƒ¢ãƒ‡ãƒ«ã®åˆ†æã‚’è¿½è¨˜ã—ãŸã„ã¨æ€ã„ã¾ã™ã€‚\n4.åˆ¥ä»¶ã§ã™ãŒã€‚ã€‚ã€‚ Python 3 ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢èªå®šãƒ‡ãƒ¼ã‚¿åˆ†æè©¦é¨“ã«åˆæ ¼ã—ã¾ã—ãŸã€‚åˆæ ¼ç‡70%ã ã‘ã‚ã£ã¦ã€ã‹ãªã‚Šç°¡å˜ã§ã—ãŸãŒPythonã‚’åŸºç¤ã‹ã‚‰è¦‹è¿”ã™ã„ã„æ©Ÿä¼šã«ãªã‚Šã¾ã—ãŸã€‚ä»Šã‚„ã£ã¦ã„ã‚‹æ¥­å‹™ã§ã¯ãƒ‡ãƒ¼ã‚¿åˆ†æã¯ãŠã‚ã‹Pythonã‚„Rã‚’ä½¿ã†æ©Ÿä¼šã™ã‚‰ãªã„ã®ã§ã€è»¢è·ã‚‚å«ã‚ãŸå¯èƒ½æ€§ã‚’è€ƒãˆã¦ã„ã¾ã™ã€‚ã¨ã‚Šã‚ãˆãšã€ä»¥ä¸‹ã®è³‡æ ¼ã‚’ä»Šå¹´åº¦ä¸­ã«å–å¾—ã™ã‚‹äºˆå®šã§ã€é‡‘èã«ã“ã ã‚ã‚‰ãšã«ã‚¹ã‚­ãƒ«ã‚’æ´»ã‹ã›ã‚‹ãƒã‚¹ãƒˆã‚’æ¢ã—ã¦ã„ã“ã†ã¨æ€ã„ã¾ã™ã€‚ãƒ€ã‚¤ã‚¨ãƒƒãƒˆã¨åŒã˜ã§å®£è¨€ã—ã¦è‡ªåˆ†ã‚’è¿½ã„è¾¼ã¾ãªã„ã¨ã€‚ã€‚ã€‚\n Gæ¤œå®š Oracle Database Master Silver SQL Linuc ãƒ¬ãƒ™ãƒ« 1 åŸºæœ¬æƒ…å ±æŠ€è¡“è€… AWS èªå®šã‚½ãƒªãƒ¥ãƒ¼ã‚·ãƒ§ãƒ³ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒˆ - ã‚¢ã‚½ã‚·ã‚¨ã‚¤ãƒˆ  åˆæ ¼çŠ¶æ³ã¯éƒ½åº¦ãƒ–ãƒ­ã‚°ã§å ±å‘Šã—ã¦ã„ããŸã„ã¨æ€ã„ã¾ã™ã€‚\n","date":1603065600,"expirydate":-62135596800,"kind":"page","lang":"ja","lastmod":1603065600,"objectID":"c0bed9051b28d59784db7575607fe5fe","permalink":"/post/post22/","publishdate":"2020-10-19T00:00:00Z","relpermalink":"/post/post22/","section":"post","summary":"OECD.orgã®APIã‚’ä½¿ã£ã¦ã€å„å›½ã®ãƒã‚¯ãƒ­çµŒæ¸ˆãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—ã—ã¦ã¿ã¾ã—ãŸã€‚","tags":["Python","ã‚¬ã‚¦ã‚¹éç¨‹","å‰å‡¦ç†","Webã‚¹ã‚¯ãƒ¬ã‚¤ãƒ”ãƒ³ã‚°","API"],"title":"OECD.orgã‹ã‚‰ãƒã‚¯ãƒ­ãƒ‘ãƒãƒ«ãƒ‡ãƒ¼ã‚¿ã‚’APIã§å–å¾—ã™ã‚‹","type":"post"},{"authors":null,"categories":["å˜ç™º","çµ±è¨ˆ","ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°"],"content":"0. ã‚„ã‚ŠãŸã„ã“ã¨ ä»Šå›ãŠè¦‹ã›ã™ã‚‹ã®ã¯å‰è¿°ã®é€šã‚Šã€ç‚ºæ›¿ã®Tickãƒ‡ãƒ¼ã‚¿ã‚’ä½¿ã£ãŸå‰å‡¦ç†(ã¨è§£æ)ã«ãªã‚Šã¾ã™ã€‚ä¸»çœ¼ã‚’Rcppã‚’ç”¨ã„ãŸåŠ¹ç‡åŒ–ã«ç½®ã„ã¦ã„ã¾ã™ã®ã§è©³ã—ãã¯è¸ã¿å…¥ã‚Šã¾ã›ã‚“ãŒã€ã‚„ã‚ŠãŸã„ã“ã¨ã‚’ã–ã£ãã‚Šã¨å…ˆã«ç¤ºã—ã¦ãŠãã¾ã™ã€‚\nã‚„ã‚ŠãŸã„ã®ã¯ã€JPY/USDãƒ¬ãƒ¼ãƒˆã®5åˆ†åˆ»ã¿ãƒªã‚¿ãƒ¼ãƒ³ã‹ã‚‰Jumpã‚’æ¤œçŸ¥ã™ã‚‹ã“ã¨ã§ã™ã€‚ã“ã“ã§ã®Jumpã¨ã¯ãã‚Œã¾ã§ã¨æ¯”ã¹ã¦ç‚ºæ›¿ãƒ¬ãƒ¼ãƒˆãŒã‚¬ã‚¯ãƒƒã¨ä¸Šæ˜‡(ä¸‹è½)ã—ãŸç‚¹ã§ã™ã€‚æ—¥ä¸­ç‚ºæ›¿ãƒ¬ãƒ¼ãƒˆã¯å°åˆ»ã¿ã«å‹•ãã¾ã™ãŒã€ãªã«ã‹ã‚¤ãƒ™ãƒ³ãƒˆãŒã‚ã‚‹ã¨å¤§ããä¸Šæ˜‡(ä¸‹è½)ã—ã¾ã™ã€‚ã©ã‚“ãªã‚¤ãƒ™ãƒ³ãƒˆãŒJumpã‚’å¼•ãèµ·ã“ã™ã®ã‹ã¯éå¸¸ã«èˆˆå‘³æ·±ã„ç‚¹ã§ã™ã€‚ã“ã‚Œã‚’æ¤œè¨¼ã™ã‚‹ã«ã¯ã¾ãšJumpã‚’æ¤œçŸ¥ã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã®ã§ã™ã€‚ å‚è€ƒã¨ã™ã‚‹ã®ã¯ä»¥ä¸‹ã®è«–æ–‡ã§ã™ã€‚\nSuzanne S. Lee \u0026amp; Per A. Mykland, 2008. \u0026ldquo;Jumps in Financial Markets: A New Nonparametric Test and Jump Dynamics,\u0026rdquo; Review of Financial Studies, Society for Financial Studies, vol. 21(6), pages 2535-2563, November.\nCitationãŒ204ã‚‚ã‚ã‚‹éå¸¸ã«è©•ä¾¡ã•ã‚Œã¦ã„ã‚‹è«–æ–‡ã§ã™ã€‚æ¨å®šæ–¹æ³•ã‚’æ»ã„æ‘˜ã‚“ã§èª¬æ˜ã—ã¾ã™ã€‚ã¾ãšã€é€£ç¶šè¤‡åˆ©ãƒªã‚¿ãƒ¼ãƒ³ã‚’$d\\log S(t)$ for $t\u0026gt;0$ã¨ã—ã¾ã™ã€‚ã“ã“ã§ã€$S(t)$ã¯$t$æ™‚ç‚¹ã§ã®è³‡ç”£ä¾¡æ ¼ã§ã™ã€‚å¸‚å ´ã«JumpãŒãªã„å ´åˆã€$S(t)$ã¯ä»¥ä¸‹ã®ç¢ºç‡éç¨‹ã«å¾“ã†ã¨ä»®å®šã—ã¾ã™ã€‚ $$ d\\log S(t) = \\mu(t)dt + \\sigma(t)dW(t) \\tag{1} $$ ã“ã“ã§ã€$W(t)$ã¯æ¨™æº–ãƒ–ãƒ©ã‚¦ãƒ³é‹å‹•ã€$\\mu(t)$ã¯ãƒ‰ãƒªãƒ•ãƒˆé …ã€$\\sigma(t)$ã¯ã‚¹ãƒãƒƒãƒˆãƒœãƒ©ãƒ†ã‚£ãƒªãƒ†ã‚£ã§ã™ã€‚ã¾ãŸã€JumpãŒã‚ã‚‹ã¨ãã€$S(t)$ã¯ $$ d\\log S(t) = \\mu(t)dt + \\sigma(t)dW(t) + Y(t)dJ(t) \\tag{2} $$ ã«å¾“ã†ã¨ä»®å®šã—ã¾ã™ã€‚ã“ã“ã§ã€$J(t)$ã¯$W(t)$ã¨ã¯ç‹¬ç«‹ã—ãŸã‚«ã‚¦ãƒ³ãƒˆéç¨‹ã§ã™ã€‚1$Y(t)$ã¯ã‚¸ãƒ£ãƒ³ãƒ—ã®ã‚µã‚¤ã‚ºã‚’è¡¨ç¾ã—ã¦ãŠã‚Šã€äºˆæ¸¬å¯èƒ½ãªéç¨‹ã§ã‚ã‚‹ã¨ã—ã¾ã™ã€‚\næ¬¡ã«ã€$S(t)$ã®å¯¾æ•°ãƒªã‚¿ãƒ¼ãƒ³ã‚’è€ƒãˆã¾ã™ã€‚ãã‚Œã¯ã¤ã¾ã‚Š$\\log S(t_i)/S(t_{i-1})$ã§ã™ãŒã€ã“ã‚Œã¯æ­£è¦åˆ†å¸ƒ$N(0,\\sigma(t_i))$ã«å¾“ã„ã¾ã™ã€‚2ã“ã“ã§ã€$t_{i-1}$ã‹ã‚‰$t_{i}$ã«JumpãŒã‚ã£ãŸéš›ã®$t_i$æ™‚ç‚¹ã®çµ±è¨ˆé‡$\\mathcal{L(i)}$ã‚’ä»¥ä¸‹ã§å®šç¾©ã—ã¾ã™ã€‚\n$$ \\mathcal{L(i)} \\equiv \\frac{|\\log S(t_i)/S(t_{i-1})|}{\\hat{\\sigma}_{t_i}} \\tag{3} $$ ä¸Šè¨˜ã¯å¯¾æ•°ãƒªã‚¿ãƒ¼ãƒ³ã®çµ¶å¯¾å€¤ã‚’å˜ç´”ã«æ¨™æº–åŒ–ã—ãŸã‚‚ã®ã§ã™ãŒã€æ¨™æº–åå·®ã®æ¨å®šé‡ã«ã¯ä»¥ä¸‹ã§å®šç¾©ã•ã‚Œã‚‹\u0026quot;Realized Bipower Variation\u0026quot;ã‚’ä½¿ç”¨ã—ã¦ã„ã¾ã™ã€‚ $$ \\hat{\\sigma}_{t_i} = \\frac{1}{K-2}\\sum_{j=i-K+2}^{i-2}|\\log S(t_j)/\\log S(t_{j-1})||\\log S(t_{j-1})/\\log S(t_{j-2})| \\tag{4} $$ $K$ã¯Windowã«å«ã¾ã‚Œã‚‹ã‚µãƒ³ãƒ—ãƒ«ã‚µã‚¤ã‚ºã®æ•°ã§ã™ã€‚ä»®ã«5minåˆ»ã¿ãƒªã‚¿ãƒ¼ãƒ³ã‚’ç”¨ã„ã€2020/9/10 10:00ã«JumpãŒç™ºç”Ÿã—ãŸå ´åˆã€$K=270$ã¨ã—ã¦ã„ã‚‹å ´åˆã¯å‰æ—¥2020/9/9 11:30ã‹ã‚‰2020/9/11 09:55ã¾ã§ã®ã‚µãƒ³ãƒ—ãƒ«ã‚’ç”¨ã„ã¦è¨ˆç®—ã™ã‚‹ã“ã¨ã«ãªã‚Šã¾ã™ã€‚ã‚„ã£ã¦ã„ã‚‹ã“ã¨ã¯ã€ãƒªã‚¿ãƒ¼ãƒ³ã®çµ¶å¯¾å€¤ã‚’ã‹ã‘ãŸã‚‚ã®ã‚’è¶³ã—åˆã‚ã›ã‚‹ã¨ã„ã†ã“ã¨ã§ã™ãŒã€ã“ã‚Œã§JumpãŒç”Ÿã˜ãŸæ¬¡ã®ç¬é–“(ã¤ã¾ã‚Š$t_{i+1}$ã¨ã‹ï¼‰ã®æ¨å®šå€¤ãŒJumpã«å½±éŸ¿ã•ã‚Œã«ãã„ã‚ˆã†ã§ã™ã€‚ã¡ãªã¿ã«$K=270$ã¯5minåˆ»ã¿ãƒªã‚¿ãƒ¼ãƒ³ã®å ´åˆã®æ¨å¥¨å€¤ã¨åˆ¥ã®æ–‡çŒ®ã§ç´¹ä»‹ã•ã‚Œã¦ã„ã¾ã™ã€‚\nã“ã†ã—ã¦è¨ˆç®—ã•ã‚ŒãŸJumpçµ±è¨ˆé‡$\\mathcal{L(i)}$ã‚’ã©ã®ã‚ˆã†ã«çµ±è¨ˆçš„æ¤œå®šã«ç”¨ã„ã¦Jumpã‚’æ¤œå‡ºã™ã‚‹ã‹ã«è©±ã‚’ç§»ã—ã¾ã—ã‚‡ã†ã€‚ã“ã‚Œã¯ç¢ºç‡å¤‰æ•°ã§ã‚ã‚‹$\\mathcal{L(i)}$ã®æœ€å¤§å€¤(ã“ã¡ã‚‰ã‚‚ç¢ºç‡å¤‰æ•°)ã‚’è€ƒãˆã€ãã®åˆ†å¸ƒã‹ã‚‰å¤§ããé€¸è„±ã—ãŸå€¤ã‚’å–ã£ãŸå ´åˆ(95%ç‚¹ã¨ã‹)ã€ãã®ãƒªã‚¿ãƒ¼ãƒ³ã‚’Jumpã¨ã—ã¾ã™ã€‚ æœŸé–“$[t_{i-1},t_{i}]$ã«JumpãŒãªã„ã¨ã—ãŸå ´åˆã€ã“ã®æœŸé–“ã®é•·ã•$\\Delta=t_{i}-t_{i-1}$ã‚’$0$ã«è¿‘ã¥ã‘ã‚‹ã¨ã€ã¤ã¾ã‚Š$\\Delta\\rightarrow0$ã¨ã™ã‚‹ã¨ã€æ¨™æº–æ­£è¦å¤‰æ•°ã®çµ¶å¯¾å€¤ã®æœ€å¤§å€¤ã¯ã€ã‚¬ãƒ³ãƒ™ãƒ«åˆ†å¸ƒã«åæŸã—ã¾ã™ã€‚çš†ã•ã‚“å¤§å¥½ãæ¥µå€¤çµ±è¨ˆã§ã™ã­ã€‚ã‚ˆã£ã¦ã€Jumpã¯ä»¥ä¸‹ã®æ¡ä»¶ãŒæº€ãŸã•ã‚ŒãŸéš›ã«å¸°ç„¡ä»®èª¬ãŒæ£„å´ã•ã‚Œã€æ¤œå‡ºã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚ $$ \\mathcal{L(i)} \u0026gt; G^{-1}(1-\\alpha)S_{n} + C_{n} \\tag{5} $$ ã“ã“ã§ã€$G^{-1}(1-\\alpha)$ã¯æ¨™æº–ã‚¬ãƒ³ãƒ™ãƒ«åˆ†å¸ƒã®$(1-\\alpha)$åˆ†ä½é–¢æ•°ã§ã™ã€‚$\\alpha=10%$ã ã¨2.25ã«ãªã‚Šã¾ã™ã€‚ã¾ãŸã€ $$ S_{n} = \\frac{1}{c(2\\log n)^{0.5}},~ \\\nC_{n} = \\frac{(2\\log n)^{0.5}}{c}-\\frac{\\log \\pi+\\log(\\log n)}{2c(2\\log n)^{0.5}} $$ ã§ã™(å°å‡ºã¯ã—ã¾ã›ã‚“ãŒã€1å¼ã¨2å¼ã‚’ä½¿ã£ã¦è¨¼æ˜ã§ãã¾ã™)ã€‚ã“ã“ã§ã€$c=(2/\\pi)^{0.5}$ã§ã€$n$ã¯æ¨å®šã«ä½¿ç”¨ã™ã‚‹ç·ã‚µãƒ³ãƒ—ãƒ«ã‚µã‚¤ã‚ºã§ã™ã€‚ æœ€çµ‚çš„ã«ã€$Jump_{t_i}$ã¯ $$ Jump_{t_i} = \\log\\frac{S(t_i)}{S(t_{i-1})}Ã—I(\\mathcal{L(i)} - G^{-1}(1-\\alpha)S_{n} + C_{n})\\tag{6} $$ ã§æ±‚ã‚ã‚‰ã‚Œã‚‹ã“ã¨ã«ãªã‚Šã¾ã™ã€‚ã“ã“ã§ã€$I(ãƒ»)$ã¯ä¸­èº«ãŒ0ã‚ˆã‚Šå¤§ãã„ã¨1ã€ãã‚Œä»¥å¤–ã¯0ã‚’è¿”ã™Indicatoré–¢æ•°ã§ã™ã€‚\n1. ãƒ‡ãƒ¼ã‚¿ã®èª­ã¿è¾¼ã¿ ã§ã¯ã€æ¨å®šæ–¹æ³•ãŒã‚ã‹ã£ãŸã®ã§ã¾ãšTickãƒ‡ãƒ¼ã‚¿ã®èª­ã¿è¾¼ã¿ã‚’ã—ã¾ã—ã‚‡ã†ã€‚ãƒ‡ãƒ¼ã‚¿ã¯QuantDataManagerã‹ã‚‰csvã‚’å–å¾—ã—ã€ãã‚Œã‚’ä½œæ¥­ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«ä¿å­˜ã—ã¦ã„ã¾ã™ã€‚\nlibrary(magrittr) # Tick dataã®èª­ã¿è¾¼ã¿ strPath \u0026lt;- r\u0026#34;(C:\\Users\\hogehoge\\JPYUSD_Tick_2011.csv)\u0026#34; JPYUSD \u0026lt;- readr::read_csv(strPath) é–¢ä¿‚ãªã„ã‚“ã§ã™ãŒã€æœ€è¿‘Rã‚’4.0.2ã¸ä¸Šã’ã¾ã—ãŸã€‚4.0ä»¥ä¸Šã§ã¯Pythonã§ã§ããŸæ–‡å­—åˆ—ã®EscapeãŒã§ãã‚‹ã¨ã†ã“ã¨ã§ä»Šã¾ã§ã®ã‚¹ãƒˆãƒ¬ã‚¹ãŒè§£æ¶ˆã•ã‚Œã¦ã‹ãªã‚Šã†ã‚Œã—ã„ã§ã™ã€‚ ãƒ‡ãƒ¼ã‚¿ã¯ä»¥ä¸‹ã®ã‚ˆã†ãªæ„Ÿã˜ã§ã€æ—¥ä»˜ã®ä»–ã«Bidå€¤ã€Askå€¤ã¨å–å¼•é‡ãŒæ ¼ç´ã•ã‚Œã¦ã„ã¾ã™ã€‚ãªãŠã€ã“ã“ã§ã¯2011å¹´ã®Tickã‚’ä½¿ç”¨ã—ã¦ã„ã¾ã™ã€‚æ±æ—¥æœ¬å¤§éœ‡ç½ã®æ™‚ã®ãƒ‰ãƒ«å††ã‚’å¯¾è±¡ã¨ã™ã‚‹ãŸã‚ã§ã™ã€‚\nsummary(JPYUSD) ## DateTime Bid Ask Volume ## Min. :2011-01-03 07:00:00 Min. :75.57 Min. :75.58 Min. : 1.00 ## 1st Qu.:2011-03-30 15:09:23 1st Qu.:77.43 1st Qu.:77.44 1st Qu.: 2.00 ## Median :2011-06-15 14:00:09 Median :80.40 Median :80.42 Median : 2.00 ## Mean :2011-06-22 05:43:11 Mean :79.91 Mean :79.92 Mean : 2.55 ## 3rd Qu.:2011-09-09 13:54:51 3rd Qu.:81.93 3rd Qu.:81.94 3rd Qu.: 3.00 ## Max. :2011-12-30 06:59:59 Max. :85.52 Max. :85.54 Max. :90.00\rã¡ãªã¿ã«ã€DateTimeã¯UTCåŸºæº–ã§æ—¥æœ¬æ™‚é–“ã ã¨2011/1/3 07:00:00ã‹ã‚‰2011-12-30 06:59::59(ç±³å›½æ™‚é–“2011-12-30 16:59:59)ã¾ã§ã‚’å«ã‚“ã§ã„ã¾ã™ã€‚ã‚µãƒ³ãƒ—ãƒ«ã‚µã‚¤ã‚ºã¯ç´„1200ä¸‡ä»¶ã§ã™ã€‚\nNROW(JPYUSD) ## [1] 11946621\r2. å‰å‡¦ç† ã§ã¯æ¬¡ã«Bidã¨Askã‹ã‚‰ä»²å€¤ã‚’è¨ˆç®—ã—ã€å¾Œã§ãƒªã‚¿ãƒ¼ãƒ³ã‚’ç®—å‡ºã™ã‚‹ãŸã‚ã«å¯¾æ•°ã‚’å–ã£ã¦ãŠãã¾ã™ã€‚\n# Askã¨Bidã®ä»²å€¤ã‚’è¨ˆç®—ã—ã€å¯¾æ•°åŒ–(å¯¾æ•°ãƒªã‚¿ãƒ¼ãƒ³ç®—å‡ºç”¨) JPYUSD \u0026lt;- JPYUSD %\u0026gt;% dplyr::mutate(Mid = (Ask+Bid)/2) %\u0026gt;% dplyr::mutate(logMid = log(Mid)) ç¾çŠ¶ä¸è¦å‰‡ã«ä¸¦ã‚“ã§ã„ã‚‹å–å¼•ãƒ‡ãƒ¼ã‚¿ã‚’5minåˆ»ã¿ã®ãƒªã‚¿ãƒ¼ãƒ³ã«æ•´å½¢ã—ã¾ã™ã€‚ã‚„ã‚Šæ–¹ã¯ã€\n 1å¹´é–“ã‚’5minæ¯ã«åˆ»ã‚“ã POSIXctãƒ™ã‚¯ãƒˆãƒ«ã‚’ä½œã‚‹ã€‚ 1.ã‚’å¼•æ•°ã¨ã—ã¦æ¸¡ã™ã¨ã€ãã®5minã®Windowã®ã†ã¡ã€æœ€åˆã¨æœ€å¾Œã®ã‚µãƒ³ãƒ—ãƒ«ã‹ã‚‰å¯¾æ•°ãƒªã‚¿ãƒ¼ãƒ³ã‚’é †ã€…ã«è¨ˆç®—ã™ã‚‹é–¢æ•°ã‚’ä½œæˆã™ã‚‹ã€‚ å®Ÿè¡Œã€‚ ã¨ã„ã†è¨ˆç”»ã§ã™ã€‚ã¾ãšã€1.ã®ãƒ™ã‚¯ãƒˆãƒ«ã‚’ä½œæˆã—ã¾ã™ã€‚  # 5minåˆ»ã¿ã§ã®ãƒªã‚¿ãƒ¼ãƒ³ã‚’ç®—å‡ºã™ã‚‹ãŸã‚ã®POSIXãƒ™ã‚¯ãƒˆãƒ«ã‚’ä½œæˆ(288Ã—æ—¥æ•°) start \u0026lt;- as.POSIXct(\u0026#34;2011-01-02 22:00:00\u0026#34;,tz=\u0026#34;UTC\u0026#34;) end \u0026lt;- as.POSIXct(\u0026#34;2011-12-31 21:55:00\u0026#34;,tz=\u0026#34;UTC\u0026#34;) from \u0026lt;- seq(from=start,to=end,by=5*60) ã§ã¯ã€2.ã«ç§»ã‚ã†ã¨ã„ã†ã“ã¨ãªã‚“ã§ã™ãŒã€ãƒ‡ãƒ¼ã‚¿ãŒ1200ä¸‡ä»¶ã‚‚ã‚ã‚‹ã¨Rã§purrr::mapã¨ã‹applyå±ã‚’ä½¿ç”¨ã—ãŸã¨ã—ã¦ã‚‚ã€é–¢æ•°å‘¼ã³å‡ºã—ã«æ™‚é–“ãŒã‹ã‹ã£ã¦çµæ§‹éåŠ¹ç‡ã ã£ãŸã‚Šã—ã¾ã™ã€‚ã€‚ã€‚sapplyã§ã‚„ã£ã¦ã¿ã¾ã—ãŸãŒãªã‹ãªã‹å‡¦ç†ãŒå®Œäº†ã›ãšã€å¼·åˆ¶çµ‚äº†ã—ã¾ã—ãŸã€‚ã“ã†ã„ã†ã¨ãã«ã¯ã€RccpãŒä¾¿åˆ©ã§ã™ã€‚Rã¯ã‚°ãƒ©ãƒ•ã‚„çµ±è¨ˆå‡¦ç†ã®ãŸã‚ã®éå¸¸ã«ä¾¿åˆ©ãªé–¢æ•°ãŒå¤šæ•°ã‚ã‚Šã¾ã™ãŒã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ã§å®šç¾©ã—ãŸé–¢æ•°ã®å‘¼ã³å‡ºã—ã‚’å«ã‚€ã€å¤§é‡ã®ç¹°ã‚Šè¿”ã—å‡¦ç†ã‚’è‹¦æ‰‹ã¨ã—ã¾ã™(ã‚¹ã‚¯ãƒªãƒ—ãƒˆè¨€èªãªã®ã§ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«è¨€èªã‚ˆã‚Šã¯ã¨ã„ã†æ„å‘³ã§ã™)ã€‚ãªã®ã§ã€ç¹°ã‚Šè¿”ã—å‡¦ç†ã®éƒ¨åˆ†ã ã‘ã€C++ã§æ›¸ã„ã¦ã—ã¾ã£ã¦ã€ãã‚Œã‚’Rcppã‚’ã¤ã‹ã£ã¦Rã®é–¢æ•°ã¨ã—ã¦ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã—ã€å®Ÿè¡Œã€‚çµæœã®é›†è¨ˆã‚„å¯è¦–åŒ–ã€åŸ·ç­†ã¯Rã§è¡Œã†ã¨ã„ã†ãƒ•ãƒ­ãƒ¼ãŒéå¸¸ã«åŠ¹ç‡çš„ã§ã™ã€‚ ã¾ãŸã€Rccpã¯Rã«ä¼¼ãŸé•å’Œæ„Ÿã®å°‘ãªã„è¨˜è¿°æ–¹æ³•ã§C++ã‚’è¨˜è¿°ã™ã‚‹ã®ã‚’åŠ©ã‘ã¦ãã‚Œã¾ã™ã€‚è©³ã—ã„ã“ã¨ã¯ä»¥ä¸‹ã‚’è¦‹ã‚Œã°å•é¡Œãªã„ã¨æ€ã„ã¾ã™ã€‚ã‹ãªã‚Šã¾ã¨ã¾ã£ã¦ã„ã¦æ§ãˆã‚ã«è¨€ã£ã¦ç¥ã§ã™ã€‚\nã¿ã‚“ãªã®Rcpp\nã§ã¯ã€2.ã«ã‚ãŸã‚‹ã‚³ãƒ¼ãƒ‰ã‚’æ›¸ã„ã¦ã„ãã¾ã™ã€‚ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã«å½“ãŸã£ã¦ã¯ãƒãƒƒãƒˆä¸Šã®è¨˜äº‹ã‚’å‚è€ƒã«ã—ã¾ã—ãŸã€‚C++ã¯Rã‚ˆã‚Šã‚‚æ­´å²ãŒã‚ã‚‹ã—ã€ä½¿ç”¨è€…ã‚‚å¤šã„ã®ã§çŸ¥ã‚ŠãŸã„æƒ…å ±ã¯ã™ãè¦‹ã¤ã‘ã‚‰ã‚Œã¾ã™ã€‚\n#include \u0026lt;Rcpp.h\u0026gt;#include \u0026lt;algorithm\u0026gt; using namespace Rcpp; //[[Rcpp::plugins(cpp11)]]  // [[Rcpp::export]] DataFrame Rolling_r_cpp( DataFrame input, //ï¼ˆè¨ˆæ¸¬æ™‚åˆ»time, è¨ˆæ¸¬å€¤dataï¼‰ã®ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ¬ãƒ¼ãƒ   newDatetimeVector from, //è¨ˆç®—ã™ã‚‹ã‚¿ã‚¤ãƒŸãƒ³ã‚°ã®å§‹ç‚¹ãƒ™ã‚¯ãƒˆãƒ«  double time_window = 5*60) //è¨ˆç®—ã™ã‚‹windowå¹…ï¼ˆç§’ï¼‰ { // è¨ˆæ¸¬æ™‚åˆ»ã¨è¨ˆæ¸¬å€¤ã‚’ãƒ™ã‚¯ãƒˆãƒ«ã¨ã—ã¦å–ã‚Šå‡ºã™  newDatetimeVector time = input[\u0026#34;DateTime\u0026#34;]; // ä»Šå›ã¯ time ã¯æ˜‡é †ã«ã‚½ãƒ¼ãƒˆã•ã‚Œã¦ã„ã‚‹ã®ãŒå‰æã§ã™ã€‚  NumericVector data = input[\u0026#34;logMid\u0026#34;]; // è¨ˆç®—ã™ã‚‹ã‚¿ã‚¤ãƒŸãƒ³ã‚°ã®çµ‚ç‚¹ãƒ™ã‚¯ãƒˆãƒ«  newDatetimeVector to = from + time_window; // è¨ˆç®—ã™ã‚‹æ•°  R_xlen_t N = from.length(); // æ ¼ç´ã™ã‚‹ãƒ™ã‚¯ãƒˆãƒ«  NumericVector value(N); // ãƒ™ã‚¯ãƒˆãƒ«è¦ç´ ã®ä½ç½®ã‚’ã‚ã‚‰ã‚ã™ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ  newDatetimeVector::iterator begin = time.begin(); newDatetimeVector::iterator end = time.end(); newDatetimeVector::iterator p1 = begin; newDatetimeVector::iterator p2 = begin; // window i ã«ã¤ã„ã¦ãƒ«ãƒ¼ãƒ—  for(R_xlen_t i = 0; i \u0026lt; N; ++i){ // Rcout \u0026lt;\u0026lt; \u0026#34;i=\u0026#34; \u0026lt;\u0026lt; i \u0026lt;\u0026lt; \u0026#34;\\n\u0026#34;;  double f = from[i]; //windowã®å§‹ç‚¹ã®æ™‚åˆ»  double t = f + time_window; //windowã®çµ‚ç‚¹ã®æ™‚åˆ»  // windowã®çµ‚ç‚¹ãŒæœ€åˆã®è¨ˆæ¸¬æ™‚åˆ»ä»¥å‰ã®æ™‚ã¯NAã€ã¾ãŸã¯  // windowã®å§‹ç‚¹ãŒæœ€å¾Œã®è¨ˆæ¸¬æ™‚åˆ»ã®ã‚ˆã‚Šå¾Œã®æ™‚ã¯NA  if(t \u0026lt;= *begin || f \u0026gt; *(end-1)){ value[i] = NA_REAL; continue;//æ¬¡ã®ãƒ«ãƒ¼ãƒ—ã¸  } // ãƒ™ã‚¯ãƒˆãƒ« time ã®ä½ç½® p1 ä»¥é™ã®è¦ç´ xã‹ã‚‰  // æ™‚åˆ»ãŒwindowã®å§‹ç‚¹fã€Œä»¥é™ã€ã§ã‚ã‚‹ã€Œæœ€åˆã®è¦ç´ ã€ã®ä½ç½®ã‚’ p1 ã¨ã™ã‚‹  p1 = std::find_if(p1, end, [\u0026amp;f](double x){return f\u0026lt;=x;}); // p1 = std::lower_bound(p1, end, f); //ä¸Šã¨åŒç¾©  // ãƒ™ã‚¯ãƒˆãƒ« time ã®ä½ç½® p1 ä»¥é™ã®è¦ç´ xã‹ã‚‰  // æ™‚åˆ»ãŒwindowã®çµ‚ç‚¹tã€Œã‚ˆã‚Šå‰ã€ã§ã‚ã‚‹ã€Œæœ€å¾Œã®è¦ç´ ã€ã®ä½ç½®ã‚’ p2 ã¨ã™ã‚‹  // ï¼ˆä¸‹ã§ã¯ã€æ™‚åˆ»ãŒwindowã®çµ‚ç‚¹tã€Œä»¥é™ã€ã§ã‚ã‚‹ã€Œæœ€åˆã®è¦ç´ ã€ã®ï¼‘ã¤å‰ã®ä½ç½®ã€ã«ã™ã‚‹ã“ã¨ã§å®Ÿç¾ã—ã¦ã„ã‚‹â€™ï¼‰  p2 = std::find_if(p1, end, [\u0026amp;t](double x){return t\u0026lt;=x;}) - 1 ; // p2 = std::lower_bound(p1, end, t) - 1 ;//ä¸Šã¨åŒç¾©  // è¦ç´ ã®ä½ç½®p1,p2ã‚’ã€è¦ç´ ç•ªå·i1, i2ã«å¤‰æ›ã™ã‚‹  R_xlen_t i1 = p1 - begin; R_xlen_t i2 = p2 - begin; // è¦ç´ ç•ªå·ã®ç¢ºèª  // C++ã¯è¦ç´ ç•ªå·ãŒ0ã‹ã‚‰å§‹ã¾ã‚‹ã®ã§Rã«åˆã‚ã›ã‚‹ãŸã‚ã«1ã‚’è¶³ã—ã¦ã„ã‚‹  // Rcout \u0026lt;\u0026lt; \u0026#34;i1 = \u0026#34; \u0026lt;\u0026lt; i1+1 \u0026lt;\u0026lt; \u0026#34; i2 = \u0026#34; \u0026lt;\u0026lt; i2+1 \u0026lt;\u0026lt; \u0026#34;\\n\u0026#34;;  // è©²å½“ã™ã‚‹ç¯„å›²ã®ãƒ‡ãƒ¼ã‚¿ã«ã¤ã„ã¦è¨ˆç®—ã™ã‚‹  if(i1\u0026gt;i2) { value[i] = NA_REAL; // windowå†…ã«ãƒ‡ãƒ¼ã‚¿ãŒãªã„å ´åˆ  } else { value[i] = data[i2] - data[i1]; } // â†‘ã‚’å¤‰æ›´ã™ã‚‹ã“ã¨ã§æ§˜ã€…ãªwindowé–¢æ•°ã‚’ä½œæˆã§ãã‚‹  } // è¨ˆç®—ã—ãŸæ™‚é–“ã¨ã€å€¤ã‚’ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ¬ãƒ¼ãƒ ã¨ã—ã¦å‡ºåŠ›ã™ã‚‹  DataFrame out = DataFrame::create( Named(\u0026#34;from\u0026#34;, from), Named(\u0026#34;r\u0026#34;, value*100)); return out; } Rcpp::sourceCppã§ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã—ãŸã‚‰ã€ä»¥ä¸‹ã®ã‚ˆã†ã«Rã®é–¢æ•°ã¨ã—ã¦å®Ÿè¡Œã—ã¾ã™ã€‚\nsystem.time(results \u0026lt;- Rolling_r_cpp(JPYUSD,from)) ## ãƒ¦ãƒ¼ã‚¶ ã‚·ã‚¹ãƒ†ãƒ  çµŒé ## 0.06 0.00 0.07\rã¯ã„ã€‚1200ä¸‡ä»¶ã®ãƒ‡ãƒ¼ã‚¿ã®å‡¦ç†ã«1ç§’ã‹ã‹ã‚Šã¾ã›ã‚“ã€‚ä¾¿åˆ©ãƒ¼ã€‚\nsummary(results) ## from r ## Min. :2011-01-02 22:00:00 Min. :-1.823 ## 1st Qu.:2011-04-03 15:58:45 1st Qu.:-0.014 ## Median :2011-07-03 09:57:30 Median : 0.000 ## Mean :2011-07-03 09:57:30 Mean : 0.000 ## 3rd Qu.:2011-10-02 03:56:15 3rd Qu.: 0.015 ## Max. :2011-12-31 21:55:00 Max. : 2.880 ## NA's :29977\rå•é¡Œãªãã€ãƒªã‚¿ãƒ¼ãƒ³ãŒè¨ˆç®—ã•ã‚Œã¦ã„ã¾ã™ã€‚ã§ã¯ã€Realized Bipower Variationã®è¨ˆç®—ã«ç§»ã‚Šã¾ã—ã‚‡ã†ã€‚5minåˆ»ã¿ã®å ´åˆã¯Windowã®é•·ã•ã¯270ãŒæ¨å¥¨ã§ã—ãŸãŒã€ãã“ã‚‚å¼•æ•°ã¨ã—ã¦æŸ”è»Ÿã‚’æŒãŸã›ãŸä½œã‚Šã«ã—ã¾ã™ã€‚ã¾ãŸã€NAã®å‡¦ç†ã«ã¤ã„ã¦ã‚‚ä¸å¯§ã«è¡Œã„ã¾ã™ã€‚\n#include \u0026lt;Rcpp.h\u0026gt;#include \u0026lt;cmath\u0026gt; using namespace Rcpp; //[[Rcpp::plugins(cpp11)]]  // [[Rcpp::export]] float rbv_cpp( NumericVector x, // rbvã‚’è¨ˆç®—ã™ã‚‹ãƒªã‚¿ãƒ¼ãƒ³ãƒ™ã‚¯ãƒˆãƒ«  bool na_rm = true) // xã«NAãŒå«ã¾ã‚Œã¦ã„ã‚‹å ´åˆã€å–ã‚Šé™¤ã„ã¦è¨ˆç®—ã™ã‚‹ã‹ { // è¨ˆç®—å›æ•°ã‚’å–å¾—  R_xlen_t N = x.length(); // è¨ˆç®—çµæœã‚’å…¥ã‚Œã‚‹å¤‰æ•°ã‚’å®šç¾©  float out = 0; // xã®æ¬ ææœ‰ç„¡ã‚’ç¢ºèª  LogicalVector lg_NA = is_na(x); // xã«NAãŒå­˜åœ¨ã—ãŸå ´åˆã€ãã®NAã‚’é™¤ã„ã¦è¨ˆç®—ã™ã‚‹ã‹ã©ã†ã‹  if(any(lg_NA).is_true() and na_rm==FALSE){ out = NA_REAL; // NAã‚’è¨ˆç®—çµæœã¨ã—ã¦å‡ºåŠ›  } else { // NAã‚’é™¤ãå ´åˆ  if (any(lg_NA).is_true() and na_rm==TRUE){ x[is_na(x)==TRUE] = 0.00; // NAã«0ã‚’åŸ‹ã‚ã€å®Ÿè³ªçš„ã«è¨ˆç®—ã‹ã‚‰é™¤å¤–ã™ã‚‹  } // rbvã®åˆ†å­(ç·å’Œ)ã‚’è¨ˆç®—  for(R_xlen_t i = 1; i \u0026lt; N; ++i){ out = out + std::abs(x[i])*std::abs(x[i-1]); } // å¹³å‡å€¤ã‚’è¨ˆç®—ã—ã€ãƒ«ãƒ¼ãƒˆã‚’ã¨ã‚‹  long denomi; //åˆ†æ¯  if(N-sum(lg_NA)-2\u0026gt;0){ denomi = N-sum(lg_NA)-2; } else { denomi = 1; } out = out/denomi; out = std::sqrt(out); } return out; } // [[Rcpp::export]] DataFrame Rolling_rbv_cpp( DataFrame input, //ï¼ˆè¨ˆæ¸¬æ™‚åˆ»time, è¨ˆæ¸¬å€¤dataï¼‰ã®ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ¬ãƒ¼ãƒ   int K = 270, // è¨ˆç®—ã™ã‚‹Rolling Windowå¹…  bool na_pad = false, // Windowå¹…ãŒè¶³ã‚Šãªã„ã¨ãã«NAã‚’è¿”ã™ã‹  bool na_remove = false // Windowå¹…ã®ä¸­ã«NAãŒå­˜åœ¨ã—ãŸå ´åˆã€é™¤ã„ã¦è¨ˆç®—ã‚’è¡Œã†ã‹ ){ // ãƒªã‚¿ãƒ¼ãƒ³ãƒ™ã‚¯ãƒˆãƒ«ã¨ã‚µãƒ³ãƒ—ãƒ«æ•°ã‚’å–ã‚Šå‡ºã™  NumericVector data = input[\u0026#34;r\u0026#34;]; R_xlen_t T = data.length(); // è¨ˆç®—çµæœã‚’æ ¼ç´ã™ã‚‹ãƒ™ã‚¯ãƒˆãƒ«ã‚’æº–å‚™  NumericVector value(T); // Windowså¹…æ¯ã«RBVã‚’è¨ˆç®—ã—ã€æ ¼ç´ã™ã‚‹  if(na_pad==TRUE){ value[0] = NA_REAL; // NAã‚’è¿”ã™  value[1] = NA_REAL; // NAã‚’è¿”ã™  value[2] = NA_REAL; // NAã‚’è¿”ã™  } else { value[0] = 0; // 0ã‚’è¿”ã™  value[1] = 0; // 0ã‚’è¿”ã™  value[2] = 0; // NAã‚’è¿”ã™  } for(R_xlen_t t = 3; t \u0026lt; T; ++t){ // Windowså¹…ãŒè¶³ã‚Šã‚‹ã‹ã©ã†ã‹ã§å‡¦ç†ã‚’åˆ†å²  if (t-K\u0026gt;=0){ value[t] = rbv_cpp(data[seq(t-K,t-1)],na_remove); // é€šå¸¸è¨ˆç®—ã‚’å®Ÿè¡Œ  } else if(na_pad==FALSE) { value[t] = rbv_cpp(data[seq(0,t-1)],na_remove); // Kã«æº€ãŸãªã„ä¸å®Œå…¨ãªWidnowså¹…ã§è¨ˆç®—ã‚’å®Ÿè¡Œ  } else { value[t] = NA_REAL; // NAã‚’è¿”ã™  } } // è¨ˆç®—ã—ãŸæ™‚é–“ã¨å€¤ã‚’ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ¬ãƒ¼ãƒ ã¨ã—ã¦å‡ºåŠ›ã™ã‚‹  DataFrame out = DataFrame::create( Named(\u0026#34;from\u0026#34;, input[\u0026#34;from\u0026#34;]), Named(\u0026#34;r\u0026#34;, data), Named(\u0026#34;rbv\u0026#34;,value)); return out; } ã§ã¯ã€ã“ã‚Œã‚‚ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã—ã€Rã§å®Ÿè¡Œã—ã¾ã™ã€‚\nsystem.time(results \u0026lt;- results %\u0026gt;% Rolling_rbv_cpp(na_remove = FALSE)) ## ãƒ¦ãƒ¼ã‚¶ ã‚·ã‚¹ãƒ†ãƒ  çµŒé ## 1.00 0.38 1.45\rã“ã¡ã‚‰ã‚‚ä¸€ç¬ã§ã™ã­ã€‚\n3. Jumpçµ±è¨ˆé‡ã®è¨ˆç®— ã§ã¯ã€æ¬¡ã«ä»Šè¨ˆç®—ã—ãŸãƒªã‚¿ãƒ¼ãƒ³ã¨æ¨™æº–åå·®ã‹ã‚‰çµ±è¨ˆé‡$\\mathcal{L}_{t_i}$ã‚’è¨ˆç®—ã—ã¾ã—ã‚‡ã†ã€‚\n# å¯¾æ•°ãƒªã‚¿ãƒ¼ãƒ³ã®çµ¶å¯¾å€¤ã‚’æ¨™æº–åŒ–=Jumpçµ±è¨ˆé‡ results \u0026lt;- results %\u0026gt;% dplyr::mutate(J=ifelse(rbv\u0026gt;0,abs(r)/rbv,NA)) ä»Šã“ã‚“ãªæ„Ÿã˜ã§ã™ã€‚\nsummary(results) ## from r rbv J ## Min. :2011-01-02 22:00:00 Min. :-1.823 Min. :0.00 Min. : 0.00 ## 1st Qu.:2011-04-03 15:58:45 1st Qu.:-0.014 1st Qu.:0.02 1st Qu.: 0.28 ## Median :2011-07-03 09:57:30 Median : 0.000 Median :0.02 Median : 0.64 ## Mean :2011-07-03 09:57:30 Mean : 0.000 Mean :0.03 Mean : 0.93 ## 3rd Qu.:2011-10-02 03:56:15 3rd Qu.: 0.015 3rd Qu.:0.03 3rd Qu.: 1.23 ## Max. :2011-12-31 21:55:00 Max. : 2.880 Max. :0.16 Max. :58.60 ## NA's :29977 NA's :44367 NA's :44423\rã§ã¯ã€Jumpæ¤œå®šã«ç§»ã‚Šã¾ã—ã‚‡ã†ã€‚ã¾ãšã€å¿…è¦ãªé–¢æ•°ã‚’å®šç¾©ã—ã¦ãŠãã¾ã™ã€‚\n# Jumpæ¤œå®šã‚’è¨ˆç®—ã™ã‚‹ãŸã‚ã®å®šæ•°\u0026amp;é–¢æ•°ã‚’æº–å‚™ c \u0026lt;- (2/pi)^0.5 Cn \u0026lt;- function(n){ return((2*log(n))^0.5/c - (log(pi)+log(log(n)))/(2*c*(2*log(n))^0.5)) } Sn \u0026lt;- function(n){ 1/(c*(2*log(n))^0.5) } ã§ã¯æ¤œå®šã‚’è¡Œã„ã¾ã™ã€‚æ£„å´ã•ã‚ŒãŸã‚µãƒ³ãƒ—ãƒ«ã¯1ã€ãã‚Œä»¥å¤–ã¯0ã‚’è¿”ã—ã¾ã™ã€‚\n# Jumpæ¤œå®š(10%)ã‚’å®Ÿè¡Œ(è¿”ã‚Šå€¤ã¯logical) N \u0026lt;- NROW(results$J) results \u0026lt;- results %\u0026gt;% dplyr::mutate(Jump = J \u0026gt; 2.25*Sn(N) + Cn(N)) summary(results) ## from r rbv J ## Min. :2011-01-02 22:00:00 Min. :-1.823 Min. :0.00 Min. : 0.00 ## 1st Qu.:2011-04-03 15:58:45 1st Qu.:-0.014 1st Qu.:0.02 1st Qu.: 0.28 ## Median :2011-07-03 09:57:30 Median : 0.000 Median :0.02 Median : 0.64 ## Mean :2011-07-03 09:57:30 Mean : 0.000 Mean :0.03 Mean : 0.93 ## 3rd Qu.:2011-10-02 03:56:15 3rd Qu.: 0.015 3rd Qu.:0.03 3rd Qu.: 1.23 ## Max. :2011-12-31 21:55:00 Max. : 2.880 Max. :0.16 Max. :58.60 ## NA's :29977 NA's :44367 NA's :44423 ## Jump ## Mode :logical ## FALSE:59864 ## TRUE :257 ## NA's :44423 ## ## ## 4. ggplot2ã‚’ç”¨ã„ãŸå¯è¦–åŒ– æ•°å€¤ãŒè¨ˆç®—ã§ãã¾ã—ãŸã®ã§å¯è¦–åŒ–ã—ã¾ã—ã‚‡ã†ã€‚2011/03/11ã®æ—¥ä¸­ã®JPY/USDã®5minåˆ»ã¿å¯¾æ•°ãƒªã‚¿ãƒ¼ãƒ³ã®æ¨ç§»ã¨Jumpã‚’é‡ã­ã¦Plotã—ã¾ã™ã€‚ã¡ãªã¿ã«æ¨ªè»¸ã¯æ—¥æœ¬æ™‚é–“ã«ä¿®æ­£ã—ã¦ã„ã¾ã™ã€‚\n# 2011/03/11ã®æ±æ—¥æœ¬å¤§éœ‡ç½ç™ºç”Ÿæ™‚ã®Jumpã«ã¤ã„ã¦Plot results %\u0026gt;% dplyr::filter(from \u0026gt;= as.POSIXct(\u0026#34;2011-03-11 00:00:00\u0026#34;,tz=\u0026#34;UTC\u0026#34;),from \u0026lt; as.POSIXct(\u0026#34;2011-03-12 00:00:00\u0026#34;,tz=\u0026#34;UTC\u0026#34;)) %\u0026gt;% ggplot2::ggplot(ggplot2::aes(x=from,y=r)) + ggplot2::geom_path(linetype=3) + ggplot2::geom_path(ggplot2::aes(x=from,y=r*Jump,colour=\u0026#34;red\u0026#34;)) + ggplot2::scale_x_datetime(date_breaks = \u0026#34;2 hours\u0026#34;, labels = scales::date_format(format=\u0026#34;%H:%M\u0026#34;,tz=\u0026#34;Asia/Tokyo\u0026#34;)) + ggplot2::ggtitle(\u0026#34;JPY/USD Jumps within Tohoku earthquake on 2011-3-11\u0026#34;) ## Warning: Removed 36 row(s) containing missing values (geom_path).\r## Warning: Removed 36 row(s) containing missing values (geom_path).\rã“ã“ã¾ã§åŸ·ç­†ã™ã‚‹ã®ã«çµæ§‹æ™‚é–“ä½¿ã£ã¦ã„ã¦ã€ä»Š23:37ãªã‚“ã§æ·±ã„è€ƒå¯Ÿã¯æ§ãˆã¾ã™ãŒã€éœ‡ç½ãŒç™ºç”Ÿã—ãŸã®ãŒ14:46:18ã§ã™ã‹ã‚‰å¸‚å ´ã¯éœ‡ç½ç›´å¾Œå³åº§ã«å††å®‰ã«åå¿œã—ãŸã“ã¨ãŒåˆ†ã‹ã‚Šã¾ã™ã€‚ãã®å¾Œãªãœã‹å††é«˜æ–¹å‘ã¸é€²ã¿19:00ã«ã¯ãƒ”ãƒ¼ã‚¯ã«ãªã£ã¦ã„ã¾ã™ã€‚å®‰å…¨è³‡ç”£ã®å††ã¨ã‹è¨€ã‚ã‚Œã¾ã™ãŒã€ã“ã®æ™‚ã°ã‹ã‚Šã¯ä¸ç¢ºå®Ÿæ€§ã®é«˜ã¾ã‚Šã‹ã‚‰ã—ã¦å®‰å…¨ã˜ã‚ƒãªã„ã ã‚ã¨æ€ã„ã¾ã™ãŒã€‚ã€‚ã€‚\n5. ã¾ã¨ã‚ Rcppã‚’ä½¿ã£ãŸRåˆ†æã®åŠ¹ç‡åŒ–ã«ã¤ã„ã¦ç´¹ä»‹ã—ã¾ã—ãŸã€‚C++ã¯æ„šç›´ã«ã‚³ãƒ¼ãƒ‰ã‚’æ›¸ã„ã¦ã‚‚Rã‚ˆã‚Šæ ¼æ®µã«å‡¦ç†ãŒæ—©ã„ã®ã§ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ãƒŸã‚¹ã—ã«ãã„å°è±¡ã§ã™ã€‚å­¦è¡“çš„ãªå®Ÿè£…ã‚’ã‚„ã‚‹ã¨ãã¯å†…å®¹ãŒè¤‡é›‘ã«ãªã‚‹ã®ã§ã“ã‚Œã¯ã‚ã‚ŠãŒãŸã„ã§ã™ã€‚ã¾ãŸã€ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã‚¨ãƒ©ãƒ¼ãŒèµ·ã“ã£ã¦ã‚‚RStudioã‚’ä½¿ã£ã¦ã„ã‚Œã°ã©ã“ã§ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã‚¨ãƒ©ãƒ¼ãŒèµ·ã“ã£ã¦ã„ã‚‹ã‹æ‰‹ãŒã‹ã‚Šã‚’ãã‚Œã¾ã™ã®ã§ãã®ç‚¹ã§ã‚‚ã‚¹ãƒˆãƒ¬ã‚¹ã¯ãªã„ã®ã§ãŠå‹§ã‚ã§ã™ã€‚\n  éè² ã€æ•´æ•°ã€éæ¸›å°‘ã®å€¤ã‚’æŒã¤ç¢ºç‡éç¨‹ã®ã“ã¨ã€‚ \u0026#x21a9;\u0026#xfe0e;\n å¹³å‡ã¯ãƒ‰ãƒªãƒ•ãƒˆé …ã®å½¢çŠ¶ã«ã‚ˆã‚Šå¿…ãšã—ã‚‚0ã«ã¯ãªã‚Šã¾ã›ã‚“ãŒã€ä»Šãƒ‰ãƒªãƒ•ãƒˆé …ã¯ååˆ†å°ã•ã„å€¤ã‚’æƒ³å®šã—ã¦ã„ã‚‹ã®ã§ã“ã®æ›¸ãæ–¹ã«ã•ã›ã¦ãã ã•ã„ã€‚è«–æ–‡ã§ã¯ã‚ˆã‚Šå³å¯†ã«å®šç¾©ã—ã¦ã„ã¾ã™ã€‚ \u0026#x21a9;\u0026#xfe0e;\n   ","date":1599696000,"expirydate":-62135596800,"kind":"page","lang":"ja","lastmod":1599696000,"objectID":"6264c9dd2374f6071851bf483d6c2fee","permalink":"/post/post21/","publishdate":"2020-09-10T00:00:00Z","relpermalink":"/post/post21/","section":"post","summary":"ãŠã¯ã“ã‚“ã°ã‚“ã«ã¡ã¯ã€‚ç‚ºæ›¿ã®Tickãƒ‡ãƒ¼ã‚¿ã‚’ä½¿ã£ãŸè§£æã‚’è¡Œã£ã¦ã„ã‚‹ã‚“ã§ã™ãŒã€ã‚µãƒ³ãƒ—ãƒ«ã‚µã‚¤ã‚ºãŒ1å¹´é–“ã®ãƒ‡ãƒ¼ã‚¿ã§1200ä¸‡ä»¶ã«ã‚‚åŠã³ã¾ã™ã€‚ãƒ¡ãƒ¢ãƒªã«ã¯ä¹—ã‚‹ã‚“ã§ã™ãŒã€ä¸€ã¤ä¸€ã¤ã«å¯¾ã—ã¦å°‘ã—è¤‡é›‘ãªå‡¦ç†ã‚’è¡ŒãŠã†ã¨ã™ã‚‹ã¨å‡¦ç†ã«ã‹ãªã‚Šæ™‚é–“ãŒã‹ã‹ã£ãŸã‚Šã—ã¦éå¸¸ã«éåŠ¹ç‡ã§ã™ã€‚ä»Šå›ã¯Rcppãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’ç”¨ã„ã¦ã€C++ã§æ›¸ã„ãŸé–¢æ•°ã‚’Rä¸Šã®é–¢æ•°ã¨ã—ã¦ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã—å‡¦ç†é€Ÿåº¦ã‚’é«˜ã‚ã‚‹ã¨ã„ã†æ–¹æ³•ã‚’ç´¹ä»‹ã—ãŸã„ã¨æ€ã„ã¾ã™ã€‚","tags":["R","C++","å‰å‡¦ç†","é‡‘è"],"title":"Rcppã§ãƒ‡ãƒ¼ã‚¿ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã‚’é«˜é€Ÿã«è¡Œã†(Tickãƒ‡ãƒ¼ã‚¿ã®å‡¦ç†ã‚’äº‹ä¾‹ã«)","type":"post"},{"authors":null,"categories":["ç«¶é¦¬"],"content":"ãŠã¯ã“ã‚“ã°ã‚“ã«ã¡ã¯ã€‚å‰å›ã€ç«¶èµ°é¦¬ã®é¦¬ä½“å†™çœŸã‹ã‚‰CNNã‚’ç”¨ã„ã¦é †ä½ã‚’äºˆæƒ³ã™ã‚‹ãƒ¢ãƒ‡ãƒ«ã‚’æ§‹ç¯‰ã—ã¾ã—ãŸã€‚çµæœã¯èŠ³ã—ããªãã€ç‰¹ã«shapå€¤ã‚’ç”¨ã„ãŸè¦å› åˆ†æã‚’è¡Œã†ã¨é¦¬ä½“ã‚ˆã‚Šã‚‚èƒŒæ™¯ã®å©èˆã«åå¿œã—ã¦ã„ã‚‹æ§˜å­ãŒè¦‹ãˆãŸã‚Šã¨åˆ†æã®ç²¾ç·»åŒ–ãŒå¿…è¦ã¨ãªã‚Šã¾ã—ãŸã€‚ä»Šå›ã¯Pytorchã®Pre-trainedãƒ¢ãƒ‡ãƒ«ã‚’ç”¨ã„ã¦é¦¬ä½“å†™çœŸã‹ã‚‰èƒŒæ™¯ã‚’åˆ‡ã‚Šå‡ºã—ã€é¦¬ä½“ã®ã¿ã¨ãªã£ãŸå†™çœŸã§å†åˆ†æã‚’è¡Œã„ãŸã„ã¨æ€ã„ã¾ã™ã€‚\n1. Pre-trainedãƒ¢ãƒ‡ãƒ«ã®ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ ã‚³ãƒ¼ãƒ‰ã¯ã“ã¡ã‚‰ã®ã‚‚ã®ã‚’å‚è€ƒã«ã—ã¦ã„ã¾ã™ã€‚ã¾ãšã€ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¾ã™ã€‚\nimport numpy as np import cv2 import matplotlib.pyplot as plt import torch import torchvision from torchvision import transforms import glob from PIL import Image import PIL import os å­¦ç¿’æ¸ˆã¿ãƒ¢ãƒ‡ãƒ«ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã‚’è¡Œã„ã¾ã™ã€‚\n#å­¦ç¿’æ¸ˆã¿ãƒ¢ãƒ‡ãƒ«ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ« device = torch.device(\u0026#34;cuda:0\u0026#34; if torch.cuda.is_available() else \u0026#34;cpu\u0026#34;) model = torchvision.models.segmentation.deeplabv3_resnet101(pretrained=True) model = model.to(device) model.eval() ã©ã†ã‚„ã‚‰å…¨ã¦ã®Pre-trainedãƒ¢ãƒ‡ãƒ«ã¯ã€åŒã˜æ–¹æ³•ã§æ­£è¦åŒ–ã•ã‚ŒãŸå½¢çŠ¶$ï¼ˆN, 3, H, Wï¼‰$ã®3ãƒãƒ£ãƒ³ãƒãƒ«RGBç”»åƒã®ãƒŸãƒ‹ãƒãƒƒãƒã‚’æƒ³å®šã—ã¦ã„ã‚‹ã‚ˆã†ã§ã™ã€‚ã“ã“ã§$N$ã¯ç”»åƒã®æ•°ã€$H$ã¨$W$ã¯å°‘ãªãã¨ã‚‚224ãƒ”ã‚¯ã‚»ãƒ«ã§ã‚ã‚‹ã“ã¨ãŒæƒ³å®šã•ã‚Œã¦ã„ã¾ã™ã€‚ç”»åƒã¯ã€[0, 1]ã®ç¯„å›²ã«ã‚¹ã‚±ãƒ¼ãƒªãƒ³ã‚°ã•ã‚Œã€ãã®å¾Œã€å¹³å‡å€¤ï¼[0.485, 0.456, 0.406]ã¨æ¨™æº–å€¤ï¼[0.229, 0.224, 0.225]ã‚’ä½¿ç”¨ã—ã¦æ­£è¦åŒ–ã•ã‚Œã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚ã¨ã„ã†ã“ã¨ã§ã€å‰å‡¦ç†ã‚’è¡Œã†é–¢æ•°ã‚’å®šç¾©ã—ã¾ã™ã€‚\n#å‰å‡¦ç† preprocess = transforms.Compose([ transforms.ToTensor(), transforms.Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225]), ]) 2. èƒŒæ™¯å‰Šé™¤å‡¦ç†ã®å®Ÿè¡Œ ã§ã¯ã€å‰å›è¨˜äº‹ã®seleniumã‚’ç”¨ã„ãŸã‚³ãƒ¼ãƒ‰ã§åé›†ã—ãŸç”»åƒã‚’èª­ã¿è¾¼ã¿ã€1æš1æšèƒŒæ™¯å‰Šé™¤å‡¦ç†ã‚’è¡Œã£ã¦ã„ãã¾ã™ã€‚\n#ãƒ•ã‚©ãƒ«ãƒ€ã‚’æŒ‡å®š folders = os.listdir(r\u0026#34;C:\\Users\\aashi\\umanalytics\\photo\\image\u0026#34;) #ãã‚Œãã‚Œã®ãƒ•ã‚©ãƒ«ãƒ€ã‹ã‚‰ç”»åƒã‚’èª­ã¿è¾¼ã¿ã€Imageé–¢æ•°ã‚’ä½¿ç”¨ã—ã¦RGBå€¤ãƒ™ã‚¯ãƒˆãƒ«(numpy array)ã¸å¤‰æ› for i, folder in enumerate(folders): files = glob.glob(\u0026#34;C:/Users/aashi/umanalytics/photo/image/\u0026#34; + folder + \u0026#34;/*.jpg\u0026#34;) index = i for k, file in enumerate(files): img_array = np.fromfile(file, dtype=np.uint8) img = cv2.imdecode(img_array, cv2.IMREAD_COLOR) h,w,_ = img.shape input_tensor = preprocess(img) input_batch = input_tensor.unsqueeze(0).to(device) with torch.no_grad(): output = model(input_batch)[\u0026#39;out\u0026#39;][0] output_predictions = output.argmax(0) mask_array = output_predictions.byte().cpu().numpy() Image.fromarray(mask_array*255).save(r\u0026#39;C:\\Users\\aashi\\umanalytics\\photo\\image\\mask.jpg\u0026#39;) mask = cv2.imread(r\u0026#39;C:\\Users\\aashi\\umanalytics\\photo\\image\\mask.jpg\u0026#39;) bg = np.full_like(img,255) img = cv2.multiply(img.astype(float), mask.astype(float)/255) bg = cv2.multiply(bg.astype(float), 1.0 - mask.astype(float)/255) outImage = cv2.add(img, bg) Image.fromarray(outImage.astype(np.uint8)).convert(\u0026#39;L\u0026#39;).save(file) è¡Œã£ã¦ã„ã‚‹å‡¦ç†ã¯Pre-trainedãƒ¢ãƒ‡ãƒ«ã§ä»¥ä¸‹ã®ã‚ˆã†ãªmaskç”»åƒã‚’å‡ºåŠ›ã—ã€å®Ÿéš›ã®ç”»åƒã®numpyé…åˆ—ã¨maskç”»åƒã‚’çµ±åˆã—ã¦ã€èƒŒæ™¯å‰Šé™¤ç”»åƒã‚’ç”Ÿæˆã—ã¦ã„ã¾ã™ã€‚å‡ºåŠ›ä¾‹ã¯ä»¥ä¸‹ã®ã‚ˆã†ãªæ„Ÿã˜ã§ã™ã€‚\nplt.gray() plt.figure(figsize=(20,20)) plt.subplot(1,3,1) plt.imshow(img) plt.subplot(1,3,2) plt.imshow(mask) plt.subplot(1,3,3) plt.imshow(outImage) plt.show() plt.close() ãƒ•ã‚©ãƒ«ãƒ€ã¯ã“ã‚“ãªæ„Ÿã˜ã§ã™ã€‚ã†ã¾ãå‡¦ç†ã§ãã¦ã„ã‚‹ã‚‚ã®ã‚‚ã‚ã‚Œã°èª¿æ•™å¸«ã®æ–¹ãŒæ˜ ã£ã¦ã—ã¾ã£ã¦ã„ã‚‹ã®ã‚‚ã‚ã‚Šã¾ã™ã­ã€‚ç‰©ä½“ã‚’è­˜åˆ¥ã—ã¦ã€é¦¬ã ã‘ã‚’maskã™ã‚‹æ–¹æ³•ã‚‚ã‚ã‚‹ã¨ã¯æ€ã„ã¾ã™ãŒã“ã®ãƒ¢ãƒ‡ãƒ«ã§ã¯ç‰©ä½“ã®ãƒ©ãƒ™ãƒªãƒ³ã‚°ã¾ã§ã¯ã§ããªã„ã®ã§ã“ã®ã¾ã¾é€²ã¿ã¾ã™ã€‚\n3. CNNã‚’ç”¨ã„ãŸåˆ†æ ã“ã“ã‹ã‚‰ã¯å‰å›è¨˜äº‹ã¨åŒã˜å†…å®¹ã§ã™ã€‚çµæœã®ã¿æ²è¼‰ã—ã¾ã™ã€‚\n## Test accuracy: 0.711864406779661\r## \u0026lt;sklearn.metrics._plot.confusion_matrix.ConfusionMatrixDisplay object at 0x000000003694DFC8\u0026gt;\rã¾ã£ãŸãè­˜åˆ¥ã§ãã¦ã„ã¾ã›ã‚“ã€‚å…¨ã¦ã®é¦¬ãŒè² å€¤ã®äºˆæƒ³ã«ãªã£ã¦ã„ã¾ã™ã€‚é¦¬ä½“å†™çœŸã«ã¯é †ä½ã‚’äºˆæ¸¬ã™ã‚‹ã‚ˆã†ãªç‰¹å¾´é‡ã¯ãªã„ã‚“ã§ã—ã‚‡ã†ã‹ã€‚ãã‚Œã¨ã‚‚G1ã®å‡ºèµ°é¦¬ã§ã¯ãƒãƒ©ãƒ„ã‚­ãŒãªãã€è­˜åˆ¥ä¸å¯èƒ½ãªã®ã§ã—ã‚‡ã†ã‹ã€‚ã„ãšã‚Œã„ã«ã›ã‚ˆã€ã¡ã‚‡ã£ã¨å³ã—ãã†ã§ã™ã€‚\n4. Shapå€¤ã‚’ç”¨ã„ãŸçµæœè§£é‡ˆ å‰å›åŒæ§˜ã€ã©ã®ã‚ˆã†ã«å¤±æ•—ã—ãŸã®ã‹shapå€¤ã‚’ä½¿ã£ã¦æ¤œè¨¼ã—ã¦ã¿ã¾ã—ã‚‡ã†ã€‚ã“ã®ç”»åƒã‚’ä¾‹ã¨ã—ã¦ä½¿ã„ã¾ã™ã€‚\nplt.imshow(X_test[4]) plt.show() plt.close() import shap background = X_resampled[np.random.choice(X_resampled.shape[0],100,replace=False)] e = shap.GradientExplainer(model,background) shap_values = e.shap_values(X_test[[4]]) shap.image_plot(shap_values[1],X_test[[4]]) å‰è¶³ã‹ã‚‰é¡”ã«ã‹ã‘ã¦ã‚’è©•ä¾¡ã—ã¦ã„ã‚‹ã‚ˆã†ã§ã™ã€‚æ„å¤–ã«è‡€éƒ¨ã‚’è©•ä¾¡ã—ã¦ã„ã‚‹æ§˜å­ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚\n5.ã¾ã¨ã‚ å©èˆèƒŒæ™¯ã‚’å‰Šé™¤ã—ã€å†å®Ÿè¡Œã—ã¦ã¿ã¾ã—ãŸãŒçµæœå¤‰ã‚ã‚‰ãšã§ã—ãŸã€‚PyTorchã‚’ä½¿ã£ãŸã‚Šã€èƒŒæ™¯å‰Šé™¤ã‚’è¡Œã†ã„ã„çµŒé¨“ã«ã¯ãªã‚Šã¾ã—ãŸãŒçµæœã¯ä¼´ã‚ãšã¨ã„ã†ã“ã¨ã§é¦¬ä½“å†™çœŸã¯ã„ã£ãŸã‚“ã“ã“ã§ã‚¹ãƒˆãƒƒãƒ—ã§ã™ã€‚\n","date":1597190400,"expirydate":-62135596800,"kind":"page","lang":"ja","lastmod":1597190400,"objectID":"cc3bd2ae9c58d0a37a0f6159c997c020","permalink":"/post/post20/","publishdate":"2020-08-12T00:00:00Z","relpermalink":"/post/post20/","section":"post","summary":"å‰å›ã®é¦¬ä½“ãƒ¢ãƒ‡ãƒ«ã§ã¯å©èˆã®èƒŒæ™¯ãŒé‚ªé­”ã ã£ãŸã®ã§ãƒˆãƒªãƒŸãƒ³ã‚°ã—ã¾ã—ãŸã€‚","tags":["Python","æ©Ÿæ¢°å­¦ç¿’","å‰å‡¦ç†"],"title":"Pytorchã®Pre-trainedãƒ¢ãƒ‡ãƒ«ã§é¦¬ä½“å†™çœŸã®èƒŒæ™¯ã‚’è‡ªå‹•ãƒˆãƒªãƒŸãƒ³ã‚°ã™ã‚‹","type":"post"},{"authors":null,"categories":["å˜ç™º","ä»•äº‹é–¢é€£","çµ±è¨ˆ"],"content":"1. ä»Šå›ã®ãƒ†ãƒ¼ãƒã€Œãƒãƒƒã‚¯ãƒ†ã‚¹ãƒˆã€ã¨ã¯ï¼Ÿ ãƒãƒƒã‚¯ãƒ†ã‚¹ãƒˆã¯ã€ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã«ã‚ˆã‚‹æŠ•è³‡æˆ¦ç•¥ã®ãƒ’ã‚¹ãƒˆãƒªã‚«ãƒ«ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã§ã™ã€‚ãƒãƒƒã‚¯ãƒ†ã‚¹ãƒˆã¯ã€ç«‹æ¡ˆã—ãŸæŠ•è³‡æˆ¦ç•¥ãŒã‚ã‚‹æœŸé–“ã«ã‚ãŸã£ã¦å®Ÿè¡Œã•ã‚Œã¦ã„ãŸå ´åˆã«ç™ºç”Ÿã—ãŸã§ã‚ã‚ã†åˆ©ç›Šã¨æå¤±ã‚’ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã‚’ç”¨ã„ã¦è¨ˆç®—ã—ã¾ã™ã€‚ãã®éš›ã€ã‚·ãƒ£ãƒ¼ãƒ—ãƒ¬ã‚·ã‚ªã‚„ã‚¤ãƒ³ãƒ•ã‚©ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ãƒ¬ã‚·ã‚ªãªã©ã®æŠ•è³‡æˆ¦ç•¥ã®ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ã‚’è©•ä¾¡ã™ã‚‹ä¸€èˆ¬çš„ãªçµ±è¨ˆé‡ãŒä½¿ç”¨ã•ã‚Œã¦ã„ã¾ã™ã€‚æŠ•è³‡å®¶ã¯é€šå¸¸ã€ã“ã‚Œã‚‰ã®ãƒãƒƒã‚¯ãƒ†ã‚¹ãƒˆã®çµ±è¨ˆé‡ã‚’èª¿æŸ»ã—ã€æœ€é«˜ã®ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ã‚’ç™ºæ®ã™ã‚‹æŠ•è³‡(é‹ç”¨)æˆ¦ç•¥ã«è³‡ç”£é…åˆ†ã‚’æ±ºå®šã™ã‚‹ãŸã‚ã€è³‡ç”£é‹ç”¨ä¼šç¤¾ã¯è‰¯å¥½ãªãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ã‚’è¡€ã®ã«ã˜ã‚€ã‚ˆã†ãªå›æ•°ã®ãƒãƒƒã‚¯ãƒ†ã‚¹ãƒˆã‚’è©¦è¡ŒéŒ¯èª¤ã—ã€è³‡æ–™ã‚’ä½œã£ã¦ãƒ—ãƒ¬ã‚¼ãƒ³ã—ãŸã‚Šã™ã‚‹ã‚ã‘ã§ã™ã€‚\næŠ•è³‡å®¶ã®ç«‹å ´ã«ç«‹ã¤ãªã‚‰ã€ãƒãƒƒã‚¯ãƒ†ã‚¹ãƒˆã•ã‚ŒãŸæŠ•è³‡æˆ¦ç•¥ã®ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ã«ã¤ã„ã¦ã¯ã€ã‚¤ãƒ³ã‚µãƒ³ãƒ—ãƒ«(IS)ã¨ã‚¢ã‚¦ãƒˆã‚ªãƒ–ã‚µãƒ³ãƒ—ãƒ«(OOS)ã‚’åŒºåˆ¥ã™ã‚‹ã“ã¨ãŒé‡è¦ã§ã™ã€‚ISã®ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ã¯ã€æŠ•è³‡æˆ¦ç•¥ã®è¨­è¨ˆã«ä½¿ç”¨ã—ãŸã‚µãƒ³ãƒ—ãƒ«ï¼ˆæ©Ÿæ¢°å­¦ç¿’ã®æ–‡çŒ®ã§ã¯ã€Œå­¦ç¿’æœŸé–“ã€ã‚„ã€Œè¨“ç·´ã‚»ãƒƒãƒˆã€ã¨å‘¼ã°ã‚Œã‚‹ç‰©ã§ã™ï¼‰ã§ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ãƒˆã—ãŸã‚‚ã®ã§ã™ã€‚ä¸€æ–¹ã€OOSãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ã¯ã€æŠ•è³‡æˆ¦ç•¥ã®è¨­è¨ˆã«ä½¿ç”¨ã•ã‚Œãªã‹ã£ãŸã‚µãƒ³ãƒ—ãƒ«ï¼ˆåˆ¥åã€Œãƒ†ã‚¹ãƒˆã‚»ãƒƒãƒˆã€ï¼‰ã§ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã•ã‚ŒãŸã‚‚ã®ã§ã™ã€‚ãƒãƒƒã‚¯ãƒ†ã‚¹ãƒˆã¯ã€ãã®ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ã‚’æŒã£ã¦ãã®æŠ•è³‡æˆ¦ç•¥ã®æœ‰åŠ¹æ€§ã‚’å ã†ç‰©ã§ã™ã®ã§ã€ISã®ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãŒOOSã®ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ã¨ä¸€è‡´ã—ã¦ã„ã‚‹å ´åˆã«å†ç¾æ€§ãŒæ‹…ä¿ã•ã‚Œã€ç¾å®Ÿçš„ã§ã‚ã‚‹ã¨ã„ã†ã“ã¨ãŒã§ãã¾ã™ã€‚ãŸã ã€ã‚¢ã‚¦ãƒˆã‚µãƒ³ãƒ—ãƒ«ã®çµæœã¯ã“ã‚Œã‹ã‚‰ã®çµæœã§ã‚ã‚‹ã®ã§ã€ãƒãƒƒã‚¯ãƒ†ã‚¹ãƒˆã‚’å—ã‘å–ã£ãŸæ™‚ç‚¹ã§ãã®ãƒãƒƒã‚¯ãƒ†ã‚¹ãƒˆãŒä¿¡é ¼ã«è¶³ã‚‹ã‚‚ã®ã‹åˆ¤æ–­ã™ã‚‹ã“ã¨ã¯é›£ã—ã„ã§ã™ã€‚hold-outæ³•ãªã©ã§ã€ä»¥ä¸‹ã®ã‚ˆã†ã«å­¦ç¿’ãƒ‡ãƒ¼ã‚¿ã¨ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ã‚’åˆ†ã‘ã€OOSã§ã®ãƒ†ã‚¹ãƒˆã‚’è¡Œã£ã¦ã„ã‚‹ã‚‚ã®ã‚‚ã‚ã‚Šã¾ã™ãŒã€OOSã®çµæœã‚’ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ã—ã¦æˆ¦ç•¥ã®æ”¹å–„ãŒã§ãã‚‹ä»¥ä¸Šã€ç´”ç²‹ãªã‚¢ã‚¦ãƒˆã‚µãƒ³ãƒ—ãƒ«ã¨ã¯å‘¼ã¹ã¾ã›ã‚“ã€‚\nã§ã™ã®ã§ã€ãƒ•ã‚¡ãƒ³ãƒ‰ãƒãƒãƒ¼ã‚¸ãƒ£ãƒ¼ã‹ã‚‰è‰¯ã„çµæœã®ãƒãƒƒã‚¯ãƒ†ã‚¹ãƒˆã‚’å—ã‘å–ã£ãŸå ´åˆã€ãã®ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãŒã©ã‚Œã ã‘ç¾å®Ÿçš„ã§ã‚ã‚‹ã‹ã‚’ãªã‚“ã¨ã‹ã—ã¦è©•ä¾¡ã™ã‚‹ã“ã¨ãŒéå¸¸ã«é‡è¦ã¨ãªã‚Šã¾ã™ã€‚ã¾ãŸã€ãƒ•ã‚¡ãƒ³ãƒ‰ãƒãƒãƒ¼ã‚¸ãƒ£ãƒ¼ã‚‚è‡ªèº«ã®ãƒãƒƒã‚¯ãƒ†ã‚¹ãƒˆçµæœãŒæŒã¤ä¸ç¢ºå®Ÿæ€§ã‚’ç†è§£ã—ã¦ãŠãã“ã¨ãŒé‡è¦ã§ã™ã€‚ä»Šå›ã¯ãƒãƒƒã‚¯ãƒ†ã‚¹ãƒˆã®ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã®ç¾å®Ÿæ€§ã‚’ã©ã®ã‚ˆã†ã«ã—ã¦è©•ä¾¡ã™ã‚‹ã®ã‹ã€å†ç¾æ€§ã®ã‚ã‚‹ãƒãƒƒã‚¯ãƒ†ã‚¹ãƒˆã‚’è¡Œã†ãŸã‚ã«ã¯ä½•ã«æ³¨æ„ã™ã‚Œã°è‰¯ã„ã®ã‹ã‚’èª¿ã¹ã¦ã¿ãŸã„ã¨æ€ã„ã¾ã™ã€‚\n2. ãƒãƒƒã‚¯ãƒ†ã‚¹ãƒˆã¯ã‚ªãƒ¼ãƒãƒ¼ãƒ•ã‚£ãƒƒãƒˆã™ã‚‹ Bailey, Borwein, LÃ³pez de Prado and Zhu(2015)ã¯ã€ã©ã®ã‚ˆã†ãªé‡‘èæ™‚ç³»åˆ—ã§ã‚‚ã€ãƒãƒƒã‚¯ãƒ†ã‚¹ãƒˆã®ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ã‚ªãƒ¼ãƒãƒ¼ãƒ•ã‚£ãƒƒãƒˆ(éå­¦ç¿’)ã•ã›ã‚‹ã“ã¨ãŒ(æ¯”è¼ƒçš„)ç°¡å˜ã«ã§ãã‚‹ã¨ä¸»å¼µã—ã¦ã„ã¾ã™ã€‚ã“ã“ã§ã€ã‚ªãƒ¼ãƒãƒ¼ãƒ•ã‚£ãƒƒãƒˆã¨ã¯ã€æ©Ÿæ¢°å­¦ç¿’ã®æ¦‚å¿µã§ã‚ã‚Šï¼Œãƒ¢ãƒ‡ãƒ«ãŒä¸€èˆ¬çš„ãªæ§‹é€ ã‚ˆã‚Šã‚‚ç‰¹å®šã®è¦³å¯Ÿãƒ‡ãƒ¼ã‚¿(ISãƒ‡ãƒ¼ã‚¿)ã«ãƒ•ã‚©ãƒ¼ã‚«ã‚¹ã—ã¦ã—ã¾ã†çŠ¶æ³ã‚’è¡¨ã—ã¾ã™ã€‚\nBailey et. al.(2015)ã§ã¯ã€ã“ã®ä¸»å¼µã®ä¸€ä¾‹ã¨ã—ã¦æ ªå¼æˆ¦ç•¥ã®ãƒãƒƒã‚¯ãƒ†ã‚¹ãƒˆçµæœãŒèŠ³ã—ããªã„çŠ¶æ³ãŒæŒ™ã’ã‚‰ã‚Œã¦ã„ã¾ã™ã€‚ãƒãƒƒã‚¯ãƒ†ã‚¹ãƒˆã§ã¯ãã®åã®é€šã‚Šéå»ãƒ‡ãƒ¼ã‚¿ã‚’ä½¿ç”¨ã—ã¦ã„ã‚‹ã®ã§ã€å…·ä½“çš„ã«æå¤±ãŒç™ºç”Ÿã—ã¦ã„ã‚‹éŠ˜æŸ„ã‚’ç‰¹å®šã™ã‚‹ã“ã¨ãŒå¯èƒ½ã§ã€ãã®éŠ˜æŸ„ã®æ¨å¥¨ã‚’å‰Šé™¤ã™ã‚‹ãŸã‚ã«ã„ãã¤ã‹ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’è¿½åŠ ã—ã€å–å¼•ã‚·ã‚¹ãƒ†ãƒ ã‚’è¨­è¨ˆã™ã‚‹ã“ã¨ã§ã€ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ã‚’å‘ä¸Šã•ã›ã‚‹ã“ã¨ãŒã§ãã‚‹ã¨ã„ã†ã‚ã‘ã§ã™ï¼ˆã€Œãƒ‡ãƒ¼ã‚¿ãƒ»ã‚¹ãƒŒãƒ¼ãƒ”ãƒ³ã‚°ã€ã¨ã—ã¦çŸ¥ã‚‰ã‚Œã¦ã„ã‚‹ãƒ†ã‚¯ãƒ‹ãƒƒã‚¯ï¼‰ã€‚æ•°å›ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ç¹°ã‚Šè¿”ãˆã›ã°ã€ç‰¹å®šã®ã‚µãƒ³ãƒ—ãƒ«ã«å­˜åœ¨ã™ã‚‹ãŒã€æ¯é›†å›£ã®ä¸­ã§ã¯ç¨€ã§ã‚ã‚‹ã‹ã‚‚ã—ã‚Œãªã„ç‰¹å¾´ã‹ã‚‰åˆ©ç›Šã‚’å¾—ã‚‹ã€Œæœ€é©ãªãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã€ã‚’å°ãã“ã¨ãŒã§ãã¾ã™ã€‚\næ©Ÿæ¢°å­¦ç¿’ã®æ–‡çŒ®ã§ã¯ã€ã‚ªãƒ¼ãƒãƒ¼ãƒ•ã‚£ãƒƒãƒ†ã‚£ãƒ³ã‚°ã®å•é¡Œã‚’å¯¾å‡¦ã™ã‚‹ãŸã‚ã®è†¨å¤§ãªç ”ç©¶ã®è“„ç©ãŒã‚ã‚Šã¾ã™ã€‚ã§ã™ãŒã€Bailey et. al.(2015)ã¯ã€æ©Ÿæ¢°å­¦ç¿’ã®æ–‡è„ˆã§ææ¡ˆã•ã‚Œã¦ã„ã‚‹æ‰‹æ³•ã¯ä¸€èˆ¬çš„ã«è¤‡æ•°ã®æŠ•è³‡å•é¡Œã«ã¯é©ç”¨ã§ããªã„ã¨ä¸»å¼µã—ã¾ã™ã€‚ãã®ç†ç”±ã¯ä»¥ä¸‹4ç‚¹ã®ã‚ˆã†ã§ã™ã€‚\n  æ©Ÿæ¢°å­¦ç¿’ã§ã‚ªãƒ¼ãƒãƒ¼ãƒ•ã‚£ãƒƒãƒ†ã‚£ãƒ³ã‚°ã‚’é˜²ãæ‰‹æ³•ã¯ã€äºˆæ¸¬ã®èª¬æ˜åŠ›ã‚„è³ªã‚’è©•ä¾¡ã™ã‚‹ãŸã‚ã«ã€ãã®äº‹è±¡ãŒå®šç¾©ã•ã‚Œã‚‹é ˜åŸŸã«ãŠã„ã¦æ˜ç¤ºçš„ãªç‚¹æ¨å®šã¨ä¿¡é ¼åŒºé–“ã‚’å¿…è¦ã¨ã—ã¾ã™ãŒã€ã“ã®ã‚ˆã†ãªæ˜ç¢ºãªäºˆæ¸¬ã‚’è¡Œã†æŠ•è³‡æˆ¦ç•¥ã¯ã»ã¨ã‚“ã©ãªã„ãŸã‚ã€‚\n ä¾‹ãˆã°ã€ã€ŒE-mini S\u0026amp;P500ã¯ã€é‡‘æ›œæ—¥ã®çµ‚å€¤ã§1æ¨™æº–åå·®5ãƒã‚¤ãƒ³ãƒˆã§1,600å‰å¾Œã«ãªã‚‹ã¨äºˆæ¸¬ã•ã‚Œã¦ã„ã¾ã™ã€ã¨ã¯ã‚ã¾ã‚Šè¨€ã‚ã‚Œãšã€ã‚€ã—ã‚ã€Œè²·ã„ã€ã¾ãŸã¯ã€Œå¼·ã„è²·ã„ã€ã¨ã„ã£ãŸå®šæ€§çš„ãªæ¨å¥¨ãŒæä¾›ã•ã‚Œã‚‹ã“ã¨ãŒä¸€èˆ¬çš„ã§ã™ã€‚ã—ã‹ã‚‚ã€ã“ã®äºˆæƒ³ã¯äºˆæ¸¬ã®æœ‰åŠ¹æœŸé™ã‚‚æ˜ç¤ºã•ã‚Œãšã€ãªã«ã‹äºˆæœŸã›ã¬äº‹è±¡ãŒç™ºç”Ÿã—ãŸéš›ã«å¤‰æ›´ãŒãªã•ã‚Œã¾ã™ã€‚ä¸€æ–¹ã€å®šé‡äºˆæ¸¬ã§ã¯é‡‘æ›œæ—¥ã®çµ‚å€¤ã¨æ˜è¨˜ã•ã‚Œã¦ã„ã¾ã™ã€‚    ä»®ã«ç‰¹å®šã®æŠ•è³‡æˆ¦ç•¥ãŒäºˆæ¸¬å¼ã«ä¾å­˜ã—ã¦ã„ãŸã¨ã—ã¦ã‚‚ã€æŠ•è³‡æˆ¦ç•¥ã®ä»–ã®æ§‹æˆè¦ç´ ãŒã‚ªãƒ¼ãƒãƒ¼ãƒ•ã‚£ãƒƒãƒˆã•ã‚Œã¦ã„ã‚‹å¯èƒ½æ€§ãŒã‚ã‚‹ã€‚\n è¨€ã„æ›ãˆã‚Œã°ã€å˜ã«äºˆæ¸¬å¼ã‚’èª¿æ•´ã™ã‚‹ä»¥å¤–ã«ã‚‚ã€æŠ•è³‡æˆ¦ç•¥ã‚’ã‚ªãƒ¼ãƒãƒ¼ãƒ•ã‚£ãƒƒãƒˆã•ã›ã‚‹æ–¹æ³•ã¯ãŸãã•ã‚“ã‚ã‚‹ã¨ã„ã†ã“ã¨ã§ã™ã€‚    å›å¸°ã®ã‚ªãƒ¼ãƒãƒ¼ãƒ•ã‚£ãƒƒãƒˆã®æ–¹æ³•ã¯ãƒ‘ãƒ©ãƒ¡ãƒˆãƒªãƒƒã‚¯ã§ã‚ã‚Šã€é‡‘èã®å ´åˆè¦³å¯Ÿä¸å¯èƒ½ãªãƒ‡ãƒ¼ã‚¿ã«é–¢ã™ã‚‹å¤šãã®ä»®å®šã‚’å«ã‚€ãŸã‚ã€‚\n  ã„ãã¤ã‹ã®æ‰‹æ³•ã¯è©¦è¡Œå›æ•°ã‚’ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«ã—ã¦ã„ãªã„ãŸã‚ã€‚\n  Bailey et. al.(2015)ã§ã¯ã€ãƒãƒƒã‚¯ãƒ†ã‚¹ãƒˆã®ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãŒæ¯”è¼ƒçš„ä½ã„æŠ•è³‡æˆ¦ç•¥ã‚’ç‰¹å®šã™ã‚‹ãŸã‚ã«ã¯ã€æ¯”è¼ƒçš„å°‘ãªã„è©¦è¡Œå›æ•°ãŒå¿…è¦ã§ã‚ã‚‹ã“ã¨ã‚’ç¤ºã—ã¦ã„ã¾ã™ã€‚ã“ã“ã§ã®è©¦è¡Œå›æ•°ã¨ã¯è©¦è¡ŒéŒ¯èª¤ã®å›æ•°ã ã¨æ€ã£ã¦ãã ã•ã„ã€‚ã¾ãŸã€è©¦è¡Œå›æ•°ã«å¿œã˜ã¦å¿…è¦ã¨ã•ã‚Œã‚‹ãƒãƒƒã‚¯ãƒ†ã‚¹ãƒˆã®æœŸé–“ã§ã‚ã‚‹the minimum backtest lengthï¼ˆMinBTLï¼‰ã‚’è¨ˆç®—ã—ã¦ã„ã¾ã™ã€‚ã“ã®è«–æ–‡ã§ã¯ã€ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ã‚’è©•ä¾¡ã™ã‚‹ãŸã‚ã«å¸¸ã«ã‚·ãƒ£ãƒ¼ãƒ—ãƒ¬ã‚·ã‚ªãŒä½¿ç”¨ã•ã‚Œã¦ã„ã¾ã™ãŒã€ä»–ã®ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æŒ‡æ¨™ã«ã‚‚å¿œç”¨ã§ãã‚‹ãã†ã§ã™ã€‚ãã®å†…å®¹ã‚’è¦‹ã¦ã¿ã¾ã—ã‚‡ã†ã€‚\n3. ã‚·ãƒ£ãƒ¼ãƒ—ãƒ¬ã‚·ã‚ªãŒå¾“ã†åˆ†å¸ƒã¨ã¯ MinBTLã‚’å°å‡ºã™ã‚‹ãŸã‚ã«ã€ã¾ãšã‚·ãƒ£ãƒ¼ãƒ—ãƒ¬ã‚·ã‚ªã®(æ¼¸è¿‘)åˆ†å¸ƒã‚’å°å‡ºã—ã¾ã™ã€‚ãã‚‚ãã‚‚ã€æŠ•è³‡æˆ¦ç•¥ã®è¨­è¨ˆã¯ã€é€šå¸¸ã€ç‰¹å®šã®ãƒ‘ã‚¿ãƒ¼ãƒ³ãŒé‡‘èå¤‰æ•°ã®å°†æ¥å€¤ã‚’äºˆæ¸¬ã™ã‚‹ã®ã«å½¹ç«‹ã¤ã‹ã‚‚ã—ã‚Œãªã„ã¨ã„ã†äº‹å‰çŸ¥è­˜ã¾ãŸã¯ä¿¡å¿µã‹ã‚‰å§‹ã¾ã‚Šã¾ã™ã€‚ä¾‹ãˆã°ã€ã•ã¾ã–ã¾ãªæº€æœŸã®å‚µåˆ¸ã®é–“ã«ãƒªãƒ¼ãƒ‰ãƒ©ã‚°åŠ¹æœã‚’èªè­˜ã—ã¦ã„ã‚‹å ´åˆã¯ã€ã‚¤ãƒ¼ãƒ«ãƒ‰ã‚«ãƒ¼ãƒ–ãŒä¸Šæ˜‡ã—ãŸå ´åˆã«å‡è¡¡å€¤ã¸ã®å›å¸°ã«è³­ã‘ã‚‹æˆ¦ç•¥ã‚’è¨­è¨ˆã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚ã“ã®ãƒ¢ãƒ‡ãƒ«ã¯ã€cointegration equationã€ãƒ™ã‚¯ãƒˆãƒ«èª¤å·®è£œæ­£ãƒ¢ãƒ‡ãƒ«ã€ç¢ºç‡å¾®åˆ†æ–¹ç¨‹å¼ã®ã‚·ã‚¹ãƒ†ãƒ ãªã©ã®å½¢ã‚’ã¨ã‚‹ã“ã¨ãŒè€ƒãˆã‚‰ã‚Œã¾ã™ã€‚\nã“ã®ã‚ˆã†ãªãƒ¢ãƒ‡ãƒ«æ§‹æˆï¼ˆã¾ãŸã¯è©¦è¡Œï¼‰ã®æ•°ã¯è†¨å¤§ã§ã‚ã‚Šã€ãƒ•ã‚¡ãƒ³ãƒ‰ãƒãƒãƒ¼ã‚¸ãƒ£ãƒ¼ã¯å½“ç„¶ã€æˆ¦ç•¥ã®ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ã‚’æœ€å¤§åŒ–ã™ã‚‹ã‚‚ã®ã‚’é¸æŠã—ãŸã„ã¨è€ƒãˆã€ãã®ãŸã‚ã«ãƒ’ã‚¹ãƒˆãƒªã‚«ãƒ«ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ï¼ˆãƒãƒƒã‚¯ãƒ†ã‚¹ãƒˆï¼‰ã‚’è¡Œã„ã¾ã™(å‰è¿°)ã€‚ãƒãƒƒã‚¯ãƒ†ã‚¹ãƒˆã§ã¯ã€æœ€é©ãªã‚µãƒ³ãƒ—ãƒ«ã‚µã‚¤ã‚ºã€ã‚·ã‚°ãƒŠãƒ«ã®æ›´æ–°é »åº¦ã€ãƒªã‚¹ã‚¯ã‚µã‚¤ã‚¸ãƒ³ã‚°ã€ã‚¹ãƒˆãƒƒãƒ—ãƒ­ã‚¹ã€æœ€å¤§ä¿æœ‰æœŸé–“ãªã©ãªã©ã‚’ä»–ã®å¤‰æ•°ã¨ã®å…¼ã­åˆã„ã®ä¸­ã§è©•ä¾¡ã—ã¾ã™ã€‚\nã“ã®è«–æ–‡ä¸­ã§ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹è©•ä¾¡ã®å°ºåº¦ã¨ã—ã¦ä½¿ç”¨ã•ã‚Œã‚‹ã‚·ãƒ£ãƒ¼ãƒ—ãƒ¬ã‚·ã‚ªã¯ã€éå»ã®ãƒªã‚¿ãƒ¼ãƒ³ã®ã‚µãƒ³ãƒ—ãƒ«ã«åŸºã¥ã„ã¦ã€æˆ¦ç•¥ã®ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ã‚’è©•ä¾¡ã™ã‚‹çµ±è¨ˆé‡ã§ã€BMã«å¯¾ã™ã‚‹å¹³å‡è¶…éãƒªã‚¿ãƒ¼ãƒ³/æ¨™æº–åå·®(ãƒªã‚¹ã‚¯)ã¨ã—ã¦å®šç¾©ã•ã‚Œã¾ã™ã€‚é€šå¸¸ã«ã¯ã€ã€Œãƒªã‚¹ã‚¯1æ¨™æº–åå·®ã«å¯¾ã™ã‚‹ãƒªã‚¿ãƒ¼ãƒ³ã€ã¨è§£é‡ˆã•ã‚Œã€è³‡ç”£ã‚¯ãƒ©ã‚¹ã«ã‚‚ã‚ˆã‚Šã¾ã™ãŒ1ã‚’ä¸Šå›ã£ã¦ã„ã‚‹ã¨éå¸¸ã«è‰¯ã„æˆ¦ç•¥ã§ã‚ã‚‹ã¨è¦‹ãªã›ã¾ã™ã€‚ä»¥ä¸‹ã§ã¯ã€ã‚ã‚‹æˆ¦ç•¥ã®è¶…éãƒªã‚¿ãƒ¼ãƒ³$r_t$ãŒi.i.d.ã®ç¢ºç‡å¤‰æ•°ã§ã‚ã‚Šã€æ­£è¦åˆ†å¸ƒã«å¾“ã†ã¨ä»®å®šã—ã¾ã™ã€‚ã¤ã¾ã‚Šã€$r_t$ã®åˆ†å¸ƒã¯$r_s(t\\neq s)$ã¨ç‹¬ç«‹ã§ã‚ã‚‹ã“ã¨ã‚’ä»®å®šã—ã¦ã„ã¾ã™ã€‚ã‚ã¾ã‚Šç¾å®Ÿçš„ãªä»®å®šã§ã¯ã‚ã‚Šã¾ã›ã‚“ãŒã€‚ã€‚ã€‚\n$$ r_t \\sim \\mathcal{N}(\\mu,\\sigma^2) $$ ã“ã“ã§ã€$\\mathcal{N}$ã¯å¹³å‡$\\mu$ã€åˆ†æ•£$\\sigma^2$ã®æ­£è¦åˆ†å¸ƒã‚’è¡¨ã—ã¦ã„ã¾ã™ã€‚ä»Šã€æ™‚ç‚¹t~t-q+1ã®è¶…éãƒªã‚¿ãƒ¼ãƒ³$r_{t}(q)$ã‚’\n$$ r_{t}(q) \\equiv r_{t} + r_{t-1} + \u0026hellip; + r_{t-q+1} $$ ã¨å®šç¾©ã™ã‚‹ã¨(è¤‡åˆ©éƒ¨åˆ†ã‚’ç„¡è¦–ã—ã¦ã¾ã™)ã€å¹´ç‡åŒ–ã•ã‚ŒãŸã‚·ãƒ£ãƒ¼ãƒ—ãƒ¬ã‚·ã‚ªã¯\n\r$$\r\\begin{eqnarray}\rSR(q) \u0026=\u0026 \\frac{E[r_{t}(q)]}{\\sqrt{Var(r_{t}(q))}}\\\\\r\u0026=\u0026 \\frac{q\\mu}{\\sqrt{q}\\sigma}\\\\\r\u0026=\u0026 \\frac{\\mu}{\\sigma}\\sqrt{q}\r\\end{eqnarray}\r$$\r\rã¨è¡¨ã™ã“ã¨ãŒã§ãã¾ã™ã€‚ã“ã“ã§ã€$q$ã¯å¹´æ¯ã®ãƒªã‚¿ãƒ¼ãƒ³ã®æ•°(é »åº¦)ã§ã™ã€‚ä¾‹ãˆã°ã€æ—¥æ¬¡ãƒªã‚¿ãƒ¼ãƒ³ã®å ´åˆ$q=365$ã¨ãªã‚Šã¾ã™(é–å¹´ã‚’é™¤ã)ã€‚ $\\mu$ã¨$\\sigma$ã¯ä¸€èˆ¬ã«æœªçŸ¥ã§ã™ã®ã§ã€$SR$ã®çœŸå€¤ã‚’çŸ¥ã‚‹ã“ã¨ã¯ã§ãã¾ã›ã‚“ã€‚ãªã®ã§ã€$R_t$ã‚’æ¨™æœ¬ãƒªã‚¿ãƒ¼ãƒ³ã€ãƒªã‚¹ã‚¯ãƒ•ãƒªãƒ¼ãƒ¬ãƒ¼ãƒˆ$R^f$(å®šæ•°)ã¨ã™ã‚‹ã¨ã€æ¨™æœ¬å¹³å‡$\\hat{\\mu}=1/T\\sum_{t=1}^T R_{t}-R^f$ã¨æ¨™æœ¬æ¨™æº–åå·®$\\hat{\\sigma}=\\sqrt{1/T\\sum_{t=1}^{T}(R_{t}-\\hat{\\mu})}$ã‚’ç”¨ã„ã¦ã‚·ãƒ£ãƒ¼ãƒ—ãƒ¬ã‚·ã‚ªã®æ¨å®šå€¤ã‚’è¨ˆç®—ã™ã‚‹ã“ã¨ã«ãªã‚Šã¾ã™($T$ã¯ãƒãƒƒã‚¯ãƒ†ã‚¹ãƒˆã‚’è¡Œã†ã‚µãƒ³ãƒ—ãƒ«ã‚µã‚¤ã‚º)ã€‚\n$$ \\hat{SR}(q) = \\frac{\\hat{\\mu}}{\\hat{\\sigma}}\\sqrt{q} $$ å¿…ç„¶çš„ãªçµæœã¨ã—ã¦ã€$SR$ã®è¨ˆç®—ã¯ã‹ãªã‚Šã®æ¨å®šèª¤å·®ãŒä¼´ã†å¯èƒ½æ€§ãŒé«˜ããªã‚Šã¾ã™ã€‚ã§ã¯ã€æœ¬ç¯€ã®æœ¬é¡Œã€$\\hat{SR}$ã®æ¼¸è¿‘åˆ†å¸ƒã‚’å°å‡ºã—ã¦ã¿ã¾ã—ã‚‡ã†ã€‚ã¾ãšã€$\\hat{\\mu}$ã¨$\\hat{\\sigma}^2$ã®æ¼¸è¿‘åˆ†å¸ƒã¯i.i.d.ã¨$\\mu, \\sigma$ãŒæœ‰é™ãªå€¤ã‚’ã¨ã‚‹ã“ã¨ã‹ã‚‰ä¸­å¿ƒæ¥µé™å®šç†ã‚’é©ç”¨ã™ã‚‹ã“ã¨ã«ã‚ˆã‚Šã€\n$$ \\sqrt{T}\\hat{\\mu}\\sim^{a}\\mathcal{N}(\\mu,\\sigma^2), \\\n\\sqrt{T}\\hat{\\sigma}^2\\sim^a\\mathcal{N}(\\sigma^2,2\\sigma^4) $$ ã¨ãªã‚Šã¾ã™ã€‚ã‚·ãƒ£ãƒ¼ãƒ—ãƒ¬ã‚·ã‚ªã¯ã“ã®$\\hat{\\mu}$ã¨$\\hat{\\sigma}^2$ã‹ã‚‰è¨ˆç®—ã•ã‚Œã‚‹ç¢ºç‡å¤‰æ•°ã§ã‚ã‚‹ã®ã§ã€ã“ã®é–¢æ•°ã‚’$g(\\hat{{\\boldsymbol \\theta}})$ã¨è¡¨ã—ã¾ã—ã‚‡ã†ã€‚ã“ã“ã§ã€$\\hat{{\\boldsymbol \\theta}}=(\\hat{\\mu},\\hat{\\sigma}^2)'$ã§ã™ã€‚ä»Šã€i.i.d.ã§ã‚ã‚‹ã®ã§$\\hat{{\\boldsymbol \\theta}}$ã¯äº’ã„ã«ç‹¬ç«‹ã¨ãªã‚Šã€ä¸Šè¨˜ã®è­°è«–ã‹ã‚‰æ¼¸è¿‘åŒæ™‚åˆ†å¸ƒã¯\n$$ \\sqrt{T}\\hat{{\\boldsymbol \\theta}} \\sim^a \\mathcal{N}({\\boldsymbol \\theta},{\\boldsymbol V_{\\boldsymbol \\theta}}) $$ ã¨æ›¸ã‘ã¾ã™ã€‚ã“ã“ã§ã€${\\boldsymbol V_{\\boldsymbol \\theta}}$ã¯\n$$ {\\boldsymbol V_{\\boldsymbol \\theta}} = \\left( \\begin{array}{cccc} \\sigma^2 \u0026amp; 0\\\n0 \u0026amp; 2\\sigma^4\\\n\\end{array} \\right) $$ ã§ã™ã€‚ã‚·ãƒ£ãƒ¼ãƒ—ãƒ¬ã‚·ã‚ªã®æ¨å®šå€¤ã¯ä»Š$g(\\hat{{\\boldsymbol \\theta}})$ã¨$\\hat{{\\boldsymbol \\theta}}$ã ã‘ã®é–¢æ•°ã«ãªã£ã¦ã„ã¾ã™ã®ã§ãƒ‡ãƒ«ã‚¿æ³•ã‚ˆã‚Šã€\n$$ \\hat{SR} = g(\\hat{{\\boldsymbol \\theta}}) \\sim^a \\mathcal{N}(g({\\boldsymbol \\theta}),\\boldsymbol V_g) $$ ã¨æ¼¸è¿‘çš„ã«æ­£è¦åˆ†å¸ƒã«å¾“ã„ã¾ã™ã€‚ã“ã“ã§ã€$\\boldsymbol V_g$ã¯\n$$ \\boldsymbol V_g=\\frac{\\partial g}{\\partial{\\boldsymbol \\theta}}{\\boldsymbol V_{\\boldsymbol \\theta}}\\frac{\\partial g}{\\partial{\\boldsymbol \\theta}'} $$ ã§ã™ã€‚$g({\\boldsymbol \\theta})=\\mu/\\sigma$ãªã®ã§ã€\n$$ \\frac{\\partial g}{\\partial{\\boldsymbol \\theta}'} = \\left[ \\begin{array}{cccc} \\frac{\\partial g}{\\partial \\mu}\\\n\\frac{\\partial g}{\\partial \\sigma^2}\\\n\\end{array} \\right] = \\left[ \\begin{array}{cccc} \\frac{1}{\\sigma}\\\n-\\frac{\\mu}{2\\sigma^3}\\\n\\end{array} \\right] $$ ã‚ˆã£ã¦ã€\n\r$$\r\\begin{eqnarray}\r\\boldsymbol V_g \u0026=\u0026 \\left(\r\\begin{array}{cccc}\r\\frac{\\partial g}{\\partial \\mu}, \\frac{\\partial g}{\\partial \\sigma}\\\\\r\\end{array}\r\\right)\r\\left( \\begin{array}{cccc}\r\\sigma^2 \u0026 0\\\\\r0 \u0026 2\\sigma^4\\\\\r\\end{array}\r\\right)\r\\left(\r\\begin{array}{cccc}\r\\frac{\\partial g}{\\partial \\mu}\\\\\r\\frac{\\partial g}{\\partial \\sigma}\\\\\r\\end{array}\r\\right) \\\\\r\u0026=\u0026 \\left(\r\\begin{array}{cccc}\r\\frac{\\partial g}{\\partial \\mu}\\sigma^2, \\frac{\\partial g}{\\partial \\sigma}2\\sigma^4\\\\\r\\end{array}\r\\right)\r\\left(\r\\begin{array}{cccc}\r\\frac{\\partial g}{\\partial \\mu}\\\\\r\\frac{\\partial g}{\\partial \\sigma}\\\\\r\\end{array}\r\\right) \\\\\r\u0026=\u0026 (\\frac{\\partial g}{\\partial \\mu})^2\\sigma^2 + (\\frac{\\partial g}{\\partial \\sigma})^2\\sigma^4 \\\\\r\u0026=\u0026 1 + \\frac{\\mu^2}{2\\sigma^2} \\\\\r\u0026=\u0026 1 + \\frac{1}{2}SR^2\r\\end{eqnarray}\r$$\r\rã¨å°å‡ºã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚ã‚·ãƒ£ãƒ¼ãƒ—ãƒ¬ã‚·ã‚ªã®çµ¶å¯¾å€¤ãŒå¤§ãããªã‚‹ã»ã©æŒ‡æ•°çš„ã«åˆ†æ•£ãŒå¤§ãããªã‚‹å‚¾å‘ãŒã‚ã‚‹ã®ã§è‰¯ã„ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ã‚’è¦‹ãŸæ™‚ã«ã¯æ³¨æ„ãŒå¿…è¦ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ã€‚å¹´ç‡åŒ–ã•ã‚ŒãŸã‚·ãƒ£ãƒ¼ãƒ—ãƒ¬ã‚·ã‚ªã®æ¨å®šå€¤$\\hat{SR}(q)$ãŒå¾“ã†åˆ†å¸ƒã¯ã“ã“ã‹ã‚‰\n$$ \\hat{SR}(q)\\sim^a \\mathcal{N}(\\sqrt{q}SR,\\frac{V(q)}{T}) \\\nV(q) = q{\\boldsymbol V}_g = q(1 + \\frac{1}{2}SR^2) $$ ã¨ãªã‚Šã¾ã™ã€‚ä»Šã€$y$ã‚’ãƒãƒƒã‚¯ãƒ†ã‚¹ãƒˆã‚’è¡Œã†å¹´æ•°ã¨ã™ã‚‹ã¨$T=yq$ã¨æ›¸ã‘ã€ã“ã‚Œã‚’ç”¨ã„ã¦ä¸Šå¼ã‚’ä»¥ä¸‹ã®ã‚ˆã†ã«æ›¸ãæ›ãˆã‚‹ã“ã¨ãŒã§ãã¾ã™(æ—¥æ¬¡ãƒªã‚¿ãƒ¼ãƒ³ã§3å¹´è¨ˆæ¸¬ã®å ´åˆã€ã‚µãƒ³ãƒ—ãƒ«ã‚µã‚¤ã‚º$T$ã¯$T=3Ã—365=1095$)ã€‚\n$$ \\hat{SR}(q)\\sim^a \\mathcal{N}(\\sqrt{q}SR,\\frac{1+\\frac{1}{2}SR^2}{y}) \\tag{1} $$ é »åº¦$q$ã¯ã‚·ãƒ£ãƒ¼ãƒ—ãƒ¬ã‚·ã‚ªã®å¹³å‡ã«ã¯å½±éŸ¿ã—ã¾ã™ãŒåˆ†æ•£ã«ã¯å½±éŸ¿ã‚’åŠã¼ã—ã¾ã›ã‚“ã€‚ã“ã‚Œã§ã‚·ãƒ£ãƒ¼ãƒ—ãƒ¬ã‚·ã‚ªã®æ¨å®šå€¤ã®æ¼¸è¿‘åˆ†å¸ƒã‚’å°å‡ºã™ã‚‹ã“ã¨ãŒã§ãã¾ã—ãŸã€‚ã•ã¦ã€ã“ã‚Œã‚’ä½¿ã£ã¦ãªã«ã‚’ã—ãŸã‹ã£ãŸã®ã‹ã¨ã„ã†ã“ã¨ã§ã™ãŒã€ç§ãŸã¡ã¯ä»Šãƒãƒƒã‚¯ãƒ†ã‚¹ãƒˆã®ä¿¡é ¼æ€§ã«ã¤ã„ã¦è€ƒãˆã¦ã„ãŸã®ã§ã—ãŸã€‚ã¤ã¾ã‚Šã€FMãŒæ–°å•†å“ã‚’é–‹ç™ºã™ã‚‹ãŸã‚ã«é ­ã‚’ã²ã­ã£ã¦è€ƒãˆå‡ºã—ãŸ$N$å€‹ã®æŠ•è³‡æˆ¦ç•¥æ¡ˆã®ãƒãƒƒã‚¯ãƒ†ã‚¹ãƒˆã‚’ã—ãŸéš›ã«ã€ãã‚Œã‚‰ã®ã‚·ãƒ£ãƒ¼ãƒ—ãƒ¬ã‚·ã‚ªã®çœŸå€¤ãŒã©ã‚Œã‚‚0ã§ã‚ã‚‹ã«ã‚‚é–¢ã‚ã‚‰ãšã€éå¸¸ã«é«˜ã„(è‰¯ã„)å€¤ãŒå‡ºã‚‹ç¢ºç‡ã¯ã„ã‹ã»ã©ãªã®ã‹ã¨ã„ã†ã“ã¨ã§ã™ã€‚Bailey et. al.(2015)ã§ã¯ä»¥ä¸‹ã®ã‚ˆã†ã«è¨˜è¿°ã•ã‚Œã¦ã„ã¾ã—ãŸã€‚\nHow high is the expected maximum Sharpe ratio IS among a set of strategy configurations where the true Sharpe ratio is zero?\nã¾ãŸã€æœŸå¾…æœ€å¤§ã‚·ãƒ£ãƒ¼ãƒ—ãƒ¬ã‚·ã‚ªã®å€¤ã‚’å°ã•ãã™ã‚‹ãŸã‚ã«ã¯ã€ã„ã£ãŸã„ã©ã‚Œã»ã©ã®æœŸé–“ãƒãƒƒã‚¯ãƒ†ã‚¹ãƒˆã‚’ã™ã¹ããªã®ã‹ã‚‚çŸ¥ã‚ŠãŸã„ã‚ã‘ã§ã™ã€‚\n4. the minimum backtest lengthã‚’å°å‡ºã—ã¦ã¿ã‚‹ ä»Šè€ƒãˆã¦ã„ã‚‹çŠ¶æ³ã¯ã€$\\mu=0$ã§$y$ã‚’ç°¡å˜åŒ–ã®ãŸã‚ã«1å¹´ã¨ã™ã‚‹ã¨(1)å¼ã‚ˆã‚Š$\\hat{SR}(q)$ã¯æ¨™æº–æ­£è¦åˆ†å¸ƒ$\\mathcal{N}(0,1)$ã«å¾“ã„ã¾ã™ã€‚ã•ã¦ã€ä»Šã‹ã‚‰ç§ãŸã¡ã¯$\\hat{SR}_n(n=1,2,\u0026hellip;N)$ã®æœ€å¤§å€¤$\\max[\\hat{SR}]_N$ã®æœŸå¾…å€¤ã«ã¤ã„ã¦è€ƒãˆã¦ã„ãã®ã§ã™ãŒã€å‹˜ã®è‰¯ã„äººãªã‚‰ãŠæ°—ã¥ãã®é€šã‚Šã€è­°è«–ã¯æ¥µå€¤çµ±è¨ˆã®æ–‡è„ˆã«å…¥ã£ã¦ã„ãã“ã¨ã«ãªã‚Šã¾ã™ã€‚$\\hat{SR}_n\\sim\\mathcal{N}(0,1)$ã¯i.i.d.ãªã®ã§ã€ãã®æœ€å¤§çµ±è¨ˆé‡ã®æ¥µå€¤åˆ†å¸ƒã¯Fisher-Tippett-Gnedenkoå®šç†ã‚ˆã‚Šã‚¬ãƒ³ãƒ™ãƒ«åˆ†å¸ƒã«ãªã‚Šã¾ã™(è¨¼æ˜è¿½ãˆã¦ãªã„ã§ã™ã€ã”ã‚ã‚“ãªã•ã„)ã€‚\n$$ \\lim_{N\\rightarrow\\infty}prob[\\frac{\\max[\\hat{SR}]_N-\\alpha}{\\beta}\\leq x] = G(x) = e^{-e^{-x}} $$ ã“ã“ã§ã€$\\alpha=Z(x)^{-1}[1-1/N], \\beta=Z(x)^{-1}[1-1/Ne^{-1}]-\\alpha$ã§ã€$Z(x)$ã¯æ¨™æº–æ­£è¦åˆ†å¸ƒã®ç´¯ç©åˆ†å¸ƒé–¢æ•°ã‚’è¡¨ã—ã¦ã„ã¾ã™ã€‚ã‚¬ãƒ³ãƒ™ãƒ«åˆ†å¸ƒã®ãƒ¢ãƒ¼ãƒ¡ãƒ³ãƒˆæ¯é–¢æ•°$M_x(t)$ã¯\n\r$$\r\\begin{eqnarray}\rM_x(t) \u0026=\u0026 E[e^{tx}] = \\int_{-\\infty}^\\infty e^{tx}e^{-x}e^{-e^{-x}}dx \\\\\r\\end{eqnarray}\r$$\r\rã¨æ›¸ã‘ã€$x=-\\log(y)$ã¨å¤‰æ•°å¤‰æ›ã™ã‚‹ã¨$dx/dy=-1/y=-(e^{-x})^{-1}$ãªã®ã§ã€\n\r$$\r\\begin{eqnarray}\rM_x(t) \u0026=\u0026 \\int_{\\infty}^0-e^{-t\\log(y)}e^{-y}dy \\\\\r\u0026=\u0026 \\int_{0}^\\infty y^{-t}e^{-y}dy \\\\\r\u0026=\u0026 \\Gamma(1-t)\r\\end{eqnarray}\r$$\r\rã¨ãªã‚Šã¾ã™ã€‚$\\Gamma(x)$ã¯ã‚¬ãƒ³ãƒé–¢æ•°ã§ã™ã€‚ã“ã“ã‹ã‚‰ã€æ¨™æº–åŒ–ã•ã‚ŒãŸæœ€å¤§çµ±è¨ˆé‡ã®æœŸå¾…å€¤(å¹³å‡)ã¯\n\r$$\r\\begin{eqnarray}\r\\lim_{N\\rightarrow\\infty} E[\\frac{\\max[\\hat{SR}]_N-\\alpha}{\\beta}] \u0026=\u0026 M_x'(t)|_{t=0} \\\\\r\u0026=\u0026 (-1)\\Gamma'(1) \\\\\r\u0026=\u0026 (-1)(-\\gamma) = \\gamma\r\\end{eqnarray}\r$$\r\rã¨ãªã‚Šã¾ã™ã€‚ã“ã“ã§ã€$\\gamma\\approx0.5772156649\u0026hellip;$ã¯Euler-Mascheroniå®šæ•°ã§ã™ã€‚ã‚ˆã£ã¦ã€$N$ãŒå¤§ãã„ã¨ãã€i.i.d.ã®æ¨™æº–æ­£è¦åˆ†å¸ƒã®æœ€å¤§çµ±è¨ˆé‡ã®æœŸå¾…å€¤ã¯\n$$ E[\\max[\\hat{SR}]] \\approx \\alpha + \\gamma\\beta = (1-\\gamma)Z^{-1}[1-\\frac{1}{N}]+\\gamma Z^{-1}[1-\\frac{1}{N}e^{-1}] \\tag{2} $$ ã¨è¿‘ä¼¼ã§ãã¾ã™($N\u0026gt;1$)ã€‚ã“ã‚ŒãŒBailey et. al.(2015)ã®Proposition 1.ã«ãªã‚Šã¾ã™ã€‚$E[\\max[\\hat{SR}]]$ã‚’æˆ¦ç•¥æ•°(è©¦è¡ŒéŒ¯èª¤æ•°)$N$ã®é–¢æ•°ã¨ã—ã¦ãƒ—ãƒ­ãƒƒãƒˆã—ãŸã®ãŒä»¥ä¸‹ã«ãªã‚Šã¾ã™ã€‚\nlibrary(ggplot2) ## Warning: ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ 'ggplot2' ã¯ãƒãƒ¼ã‚¸ãƒ§ãƒ³ 4.1.3 ã® R ã®ä¸‹ã§é€ ã‚‰ã‚Œã¾ã—ãŸ\rExMaxSR = function(N){ gamma_ct = -digamma(1) Z = qnorm(0.99) return((1-gamma_ct)*Z*(1-1/N) + gamma_ct*Z*(1-1/N*exp(1)^{-1})) } N = list(0:100) result = purrr::map(N,ExMaxSR) ggplot2::ggplot(data.frame(ExpMaxSR = unlist(result),N = unlist(N)),aes(x=N,y=ExpMaxSR)) + geom_line(size=1) + ylim(0,3) å°ã•ã„$N$ã«å¯¾ã—ã¦æ€¥æ¿€ã«$\\max[\\hat{SR}]$ã®æœŸå¾…å€¤ãŒä¸Šæ˜‡ã—ã¦ã„ã‚‹ã“ã¨ãŒã‚ã‹ã‚‹ã¨æ€ã„ã¾ã™ã€‚$N=10$ã®æ™‚ã€$\\max[\\hat{SR}]=1.54$ã¨ãªã£ã¦ãŠã‚Šã€å…¨ã¦ã®æˆ¦ç•¥ã®ã‚·ãƒ£ãƒ¼ãƒ—ãƒ¬ã‚·ã‚ªã®çœŸå€¤ãŒ0ã«ã‚‚æ‹˜ã‚ã‚‰ãšã€å°‘ãªãã¨ã‚‚1ã¤ã¯è¦‹ã‹ã‘ä¸Šã‹ãªã‚Šè‰¯ã„ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ã®æˆ¦ç•¥ãŒè¦‹ã¤ã‹ã‚‹ã“ã¨ãŒæœŸå¾…ã•ã‚Œã¾ã™ã€‚é‡‘èã§ã¯hold-outæ³•ã§ã®ãƒãƒƒã‚¯ãƒ†ã‚¹ãƒˆã¯ã—ã°ã—ã°ä½¿ç”¨ã•ã‚Œã‚‹ã‹ã¨æ€ã„ã¾ã™ãŒã€ã“ã®æ–¹æ³•ã¯è©¦è¡Œ(éŒ¯èª¤)å›æ•°ã‚’è€ƒæ…®ã«å…¥ã‚Œã¦ã„ãªã„ãŸã‚ã€$N$ãŒå¤§ãã„ã¨ãã«ã¯ä¿¡é ¼ã«è¶³ã‚‹çµæœã‚’è¿”ã—ã¦ãã‚Œãªã„ã‚ã‘ã§ã™ã€‚ãƒãƒƒã‚¯ãƒ†ã‚¹ãƒˆã®çµæœã‚’å‘ä¸Šã•ã›ã‚‹ãŸã‚ã€é—‡é›²ã«ã‚ã‚Œã‚„ã“ã‚Œã‚„ã¨ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã‚’è¡Œã†ã“ã¨ã¯éå¸¸ã«å±é™ºã ã¨æ€ã„ã¾ã›ã‚“ã‹ï¼Ÿæœ€çµ‚çš„ã«ãƒ—ãƒ¬ã‚¼ãƒ³è³‡æ–™ã«ä¸ŠãŒã£ã¦ãã‚‹ã®ã¯$N$å€‹ã®æˆ¦ç•¥ã®ã†ã¡ã€æœ€ã‚‚ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãŒè‰¯ã„ã‚‚ã®ã®ã¿ã§ã™ã‹ã‚‰ã€ä»Šå›ã®ä¾‹ã®ã‚ˆã†ã«10å€‹æˆ¦ç•¥ã‚’è€ƒãˆãŸã ã‘ã§ã‚‚ã©ã‚Œã‹ã¯ã‚·ãƒ£ãƒ¼ãƒ—ãƒ¬ã‚·ã‚ªãŒ1.87ä»˜è¿‘ã«åˆ†å¸ƒã—ã¦ã„ã‚‹ã‚ã‘ã§ã™ã€‚è©¦è¡ŒéŒ¯èª¤æ•°ãªã‚“ã¦ã‚‚ã¡ã‚ã‚“è³‡æ–™ã«ã¯è¨˜è¼‰ã—ã¾ã›ã‚“ã‹ã‚‰ã€éå¸¸ã«ãƒŸã‚¹ãƒªãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ãªã‚ã‘ã§ã™ã€‚ã“ã†ã„ã£ãŸè³‡æ–™ã‚’è©•ä¾¡ã™ã‚‹éš›ã«ã¯ã¾ãšå½é™½æ€§ã‚’ç–‘ã£ã¦ã‹ã‹ã£ãŸæ–¹ãŒã„ã„ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ã€‚\nã§ã¯ã€ã©ã†ã™ã‚Œã°è‰¯ã„ã®ã‹ã¨ã„ã†è©±ã§ã™ãŒã€Bailey et. al.(2015)ã§ã¯ã€Minimum Backtest Lengthã‚’è¨ˆç®—ã—ã¦ã„ã¾ã™ã€‚è¦ã¯è©¦è¡Œ(éŒ¯èª¤)æ•°$N$ã‚’å¢—ã‚„ã™ã«ã¤ã‚Œã¦ã€ãƒãƒƒã‚¯ãƒ†ã‚¹ãƒˆã®å¹´æ•°$y$ã‚‚ä¼¸ã°ã—ã¦ã„ã‘ã‚ˆã¨æˆ’ã‚ã¦ã„ã‚‹ã‚ã‘ã§ã™ã€‚$N$ã¨Minimum Backtest Lengthã®é–¢ä¿‚æ€§ã‚’ç¤ºã—ã¦ã„ãã¾ã—ã‚‡ã†ã€‚å…ˆã»ã©ã¨åŒã˜ã$\\mu=0$ã‚’ä»®å®šã—ã¾ã™ãŒã€$y\\neq 1$ã§ã‚ã‚‹ã‚±ãƒ¼ã‚¹ã‚’è€ƒãˆã¾ã™ã€‚å¹´ç‡åŒ–ã‚·ãƒ£ãƒ¼ãƒ—ãƒ¬ã‚·ã‚ªã®æœ€å¤§çµ±è¨ˆé‡ã®æœŸå¾…å€¤ã¯(2)å¼ã‚ˆã‚Šã€\n$$ E[\\max[\\hat{SR}(q)]_N] \\approx y^{-1/2}((1-\\gamma)Z^{-1}[1-\\frac{1}{N}]+\\gamma Z^{-1}[1-\\frac{1}{N}e^{-1}]) $$ ã¨ãªã‚Šã¾ã™ã€‚ã“ã‚Œã‚’$y$ã«å¯¾ã—ã¦è§£ã„ã¦ã‚„ã‚‹ã“ã¨ã§MinBTLãŒæ±‚ã¾ã‚Šã¾ã™ã€‚\n$$ MinBTL \\approx (\\frac{(1-\\gamma)Z^{-1}[1-\\frac{1}{N}]+\\gamma Z^{-1}[1-\\frac{1}{N}e^{-1}]}{\\bar{E[\\max[\\hat{SR}(q)]_N]}})^2 $$ ã“ã“ã§ã€$\\bar{E[\\max[\\hat{SR}(q)]_N]}$ã¯$E[\\max[\\hat{SR}(q)]_N]$ã®ä¸Šé™å€¤ã§ã€ã‚·ãƒ£ãƒ¼ãƒ—ãƒ¬ã‚·ã‚ªã®çœŸå€¤ãŒ0ã§ã‚ã‚‹$N$æˆ¦ç•¥ã§ã‚·ãƒ£ãƒ¼ãƒ—ãƒ¬ã‚·ã‚ªã®æœ€å¤§çµ±è¨ˆé‡ãŒå–ã‚Šã†ã‚‹å€¤ã‚’æŠ‘ãˆã¾ã™ã€‚ãã®éš›ã«ã€å¿…è¦ãªãƒãƒƒã‚¯ãƒ†ã‚¹ãƒˆå¹´æ•°$y$ãŒMinBTLã¨ã—ã¦å°å‡ºã•ã‚Œã‚‹ã®ã§ã™ã€‚$\\bar{E[\\max[\\hat{SR}(q)]_N]}=1$ã¨ã—ã¦ã€MinBTLã‚’$N$ã®é–¢æ•°ã¨ã—ã¦ãƒ—ãƒ­ãƒƒãƒˆã—ãŸã‚‚ã®ãŒä»¥ä¸‹ã§ã™ã€‚\nMinBTL \u0026lt;- function(N,MaxSR){ return((ExMaxSR(N)/MaxSR)^2) } N = list(1:100) result = purrr::map2(N,1,MinBTL) ggplot2::ggplot(data.frame(MinBTL = unlist(result),N = unlist(N)),aes(x=N,y=MinBTL)) + geom_line(size=1) + ylim(0,6) simSR \u0026lt;- function(T1){ r = rnorm(T1) return(mean(r)/sd(r)) } ä»®ã«ãƒãƒƒã‚¯ãƒ†ã‚¹ãƒˆå¹´æ•°ãŒ3å¹´ä»¥å†…ã—ã‹ã§ããªã„å ´åˆã¯è©¦è¡Œ(éŒ¯èª¤)å›æ•°$N$ã¯ã»ã¼1å›ã«æŠ‘ãˆãªã„ã¨ã„ã‘ãªã„ã“ã¨ã«ãªã‚Šã¾ã™ã€‚3å¹´ä»¥å†…ã®å ´åˆã¯ä¸€ç™ºã§å½“ã¦ã¦ã­ã¨ã„ã†å³ã—ã‚ã®åˆ¶ç´„ã§ã™ã€‚æ³¨æ„ã—ãªã„ã¨ã„ã‘ãªã„ã®ã¯ã€MinBTLã®ç¯„å›²å†…ã§ãƒãƒƒã‚¯ãƒ†ã‚¹ãƒˆã‚’è¡Œã£ã¦ã„ãŸã¨ã—ã¦ã‚‚ã‚ªãƒ¼ãƒãƒ¼ãƒ•ã‚£ãƒƒãƒˆã™ã‚‹ã“ã¨ã¯è€ƒãˆã‚‰ã‚Œã‚‹ã¨ã„ã†ã“ã¨ã§ã™ã€‚ã¤ã¾ã‚Šã€MinBTLã¯å¿…è¦æ¡ä»¶ã§ã‚ã£ã¦ååˆ†æ¡ä»¶ã§ãªã„ã¨ã„ã†ã‚ã‘ã§ã™ã€‚\n4. çµ‚ã‚ã‚Šã« LÃ³pez de Prado(2018)ã§ã¯ã€ã‚ªãƒ¼ãƒãƒ¼ãƒ•ã‚£ãƒƒãƒ†ã‚£ãƒ³ã‚°ã‚’é˜²ãæ±ç”¨çš„ãªæ‰‹æ®µã¨ã—ã¦ä»¥ä¸‹ãŒæŒ™ã’ã‚‰ã‚Œã¦ã„ã¾ã™ã€‚\n  Develop models for entire asset classes or investment universes, rather than for specific securities. Investors diversify, hence they do not make mistake X only on security Y. If you find mistake X only on security Y, no matter how apparently profitable, it is likely a false discovery. (æ‹™è¨³ï¼šç‰¹å®šã®æœ‰ä¾¡è¨¼åˆ¸ã§ã¯ãªãã€ã‚¢ã‚»ãƒƒãƒˆã‚¯ãƒ©ã‚¹å…¨ä½“ã¾ãŸã¯ãƒ¦ãƒ‹ãƒãƒ¼ã‚¹å…¨ä½“ã®ãƒ¢ãƒ‡ãƒ«ã‚’é–‹ç™ºã™ã‚‹ã“ã¨ã€‚æŠ•è³‡å®¶ã¯ãƒªã‚¹ã‚¯ã‚’åˆ†æ•£ã•ã›ã¦ã„ã‚‹ã®ã§ã€å½¼ã‚‰ã¯ã‚ã‚‹è¨¼åˆ¸Yã ã‘ã«å¯¾ã—ã¦ãƒŸã‚¹Xã‚’ã™ã‚‹ã“ã¨ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚ã‚ãªãŸãŒè¨¼åˆ¸Yã ã‘ã«ãƒŸã‚¹Xã‚’è¦‹ã¤ã‘ãŸå ´åˆã¯ã€ãã‚ŒãŒã©ã‚“ãªã«æ˜ã‚‰ã‹ã«æœ‰ç›Šã§ã‚ã£ã¦ã‚‚ã€èª¤ç™ºè¦‹ã§ã‚ã‚‹å¯èƒ½æ€§ãŒé«˜ã„ã€‚)\n  Apply bagging as a means to both prevent overfitting and reduce the variance of the forecasting error. If bagging deteriorates the performance of a strategy, it was likely overfit to a small number of observations or outliers. (æ‹™è¨³ï¼šã‚ªãƒ¼ãƒãƒ¼ãƒ•ã‚£ãƒƒãƒˆã‚’é˜²ãã€äºˆæ¸¬èª¤å·®ã®åˆ†æ•£ã‚’æ¸›ã‚‰ã™ãŸã‚ã®æ‰‹æ®µã¨ã—ã¦ã€ãƒã‚®ãƒ³ã‚°ã‚’é©ç”¨ã™ã‚‹ã“ã¨ã€‚ãƒã‚®ãƒ³ã‚°ãŒæˆ¦ç•¥ã®ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ã‚’æ‚ªåŒ–ã•ã›ã‚‹å ´åˆã€ãã‚Œã¯å°‘æ•°ã®è¦³æ¸¬å€¤ã¾ãŸã¯å¤–ã‚Œå€¤ã«ã‚ªãƒ¼ãƒãƒ¼ãƒ•ã‚£ãƒƒãƒˆã—ãŸå¯èƒ½æ€§ãŒé«˜ã„ã€‚)\n  Do not backtest until all your research is complete. (æ‹™è¨³ï¼šã™ã¹ã¦ã®ãƒªã‚µãƒ¼ãƒãŒå®Œäº†ã™ã‚‹ã¾ã§ãƒãƒƒã‚¯ãƒ†ã‚¹ãƒˆã‚’ã—ãªã„ã“ã¨ã€‚)\n  Record every backtest conducted on a dataset so that the probability of backtest overfitting may be estimated on the final selected result (see Bailey, Borwein, LÃ³pez de Prado and Zhu(2017)), and the Sharpe ratio may be properly deflated by the number of trials carried out (Bailey and LÃ³pez de Prado(2014.b)). (æ‹™è¨³ï¼šç ”ç©¶è€…ãŒæœ€çµ‚çš„ã«é¸æŠã—ãŸãƒãƒƒã‚¯ãƒ†ã‚¹ãƒˆçµæœãŒã‚ªãƒ¼ãƒãƒ¼ãƒ•ã‚£ãƒƒãƒˆã—ã¦ã„ã‚‹ç¢ºç‡ã‚’æ¨å®šã§ãã‚‹ã‚ˆã†ã«ã€å˜ä¸€ã®(åŒã˜)ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã§å®Ÿæ–½ã•ã‚ŒãŸãƒãƒƒã‚¯ãƒ†ã‚¹ãƒˆã‚’ã™ã¹ã¦è¨˜éŒ²ã™ã‚‹ã“ã¨ï¼ˆBailey, Borwein, LÃ³pez de Prado and Zhu [2017]ï¼‰ã€ã¾ãŸã€å®Ÿæ–½ã•ã‚ŒãŸè©¦è¡Œæ•°ã«ã‚ˆã£ã¦ã‚·ãƒ£ãƒ¼ãƒ—ãƒ¬ã‚·ã‚ªã‚’é©åˆ‡ã«ãƒ‡ãƒ•ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã§ãã‚‹ã‚ˆã†ã«ã™ã‚‹ã“ã¨ï¼ˆBailey and LÃ³pez de Prado [2014]ï¼‰ã€‚)\n  Simulate scenarios rather than history. A standard backtest is a historical simulation, which can be easily overfit. History is just the random path that was realized, and it could have been entirely different. Your strategy should be profitable under a wide range of scenarios, not just the anecdotal historical path. It is harder to overfit the outcome of thousands of â€œwhat ifâ€ scenarios. (æ‹™è¨³ï¼šãƒ’ã‚¹ãƒˆãƒªã‚«ãƒ«ã§ã¯ãªãã‚·ãƒŠãƒªã‚ªã‚’ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã™ã‚‹ã“ã¨ã€‚æ¨™æº–çš„ãªãƒãƒƒã‚¯ãƒ†ã‚¹ãƒˆã¯ãƒ’ã‚¹ãƒˆãƒªã‚«ãƒ«ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã§ã‚ã‚Šã€ã‚ªãƒ¼ãƒãƒ¼ãƒ•ã‚£ãƒƒãƒˆã—ã‚„ã™ã„ã€‚æ­´å²(ã“ã‚Œã¾ã§ã®å®Ÿç¸¾)ã¯ãƒ©ãƒ³ãƒ€ãƒ ãªãƒ‘ã‚¹ã®å®Ÿç¾å€¤ã«éããšã€å…¨ãé•ã£ãŸã‚‚ã®ã«ãªã£ã¦ã„ãŸå¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚ã‚ãªãŸã®æˆ¦ç•¥ã¯ã€é€¸è©±çš„ãªãƒ’ã‚¹ãƒˆãƒªã‚«ãƒ«ãƒ‘ã‚¹ã§ã¯ãªãã€æ§˜ã€…ãªã‚·ãƒŠãƒªã‚ªã®ä¸‹ã§åˆ©ç›Šã‚’å¾—ã‚‹ã“ã¨ãŒã§ãã‚‹ã‚‚ã®ã§ã‚ã‚‹ã¹ãã§ã™ã€‚ä½•åƒã‚‚ã®ã€Œã‚‚ã—ã‚‚ã€ã®ã‚·ãƒŠãƒªã‚ªçµæœã‚’ã‚ªãƒ¼ãƒãƒ¼ãƒ•ã‚£ãƒƒãƒˆã•ã›ã‚‹ã®ã¯(ãƒ’ã‚¹ãƒˆãƒªã‚«ãƒ«ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã§éå­¦ç¿’ã™ã‚‹ã‚ˆã‚Šã‚‚)ã‚ˆã‚Šé›£ã—ã„ã“ã¨ã§ã™ã€‚)\n  Do not research under the influence of a backtest. If the backtest fails to identify a profitable strategy, start from scratch. Resist the temptation of reusing those results. (æ‹™è¨³ï¼šãƒãƒƒã‚¯ãƒ†ã‚¹ãƒˆã®ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ã‚’å—ã‘ã¦ãƒªã‚µãƒ¼ãƒã—ãªã„ã“ã¨ã€‚ãƒãƒƒã‚¯ãƒ†ã‚¹ãƒˆãŒæœ‰ç›Šãªæˆ¦ç•¥ã‚’è¦‹ã¤ã‘å‡ºã™ã“ã¨ã«å¤±æ•—ã—ãŸå ´åˆã¯ã€ã‚¼ãƒ­ã‹ã‚‰ãƒªã‚µãƒ¼ãƒã‚’å†å§‹å‹•ã—ã¦ãã ã•ã„ã€‚ãã‚Œã‚‰ã®çµæœã‚’å†åˆ©ç”¨ã™ã‚‹èª˜æƒ‘ã«æŠ—ã£ã¦ãã ã•ã„ã€‚)\n  3ã¨6ã¯æœ¬æ—¥ã®è«–æ–‡ã¨é–¢ä¿‚ã®ã‚ã‚‹æ–‡è„ˆã ã¨æ€ã„ã¾ã™ã€‚ã“ã®åˆ†é‡ã¯ä»–ã«ã‚‚ç ”ç©¶ã®è“„ç©ãŒã‚ã‚‹ã®ã§ã€æ¥­å‹™ã§ãƒãƒƒã‚¯ãƒ†ã‚¹ãƒˆã‚’è¡Œã†ã¨ã„ã†äººã¯é‹ç”¨æ‰‹æ³•ã®å‹‰å¼·ã‚‚ã„ã„ã§ã™ãŒã€ãã‚‚ãã‚‚ã®ãŠä½œæ³•ã¨ã—ã¦ãƒãƒƒã‚¯ãƒ†ã‚¹ãƒˆã®æ­£ã—ã„é‹ç”¨æ–¹æ³•ã«ã¤ã„ã¦å­¦ã¶ã“ã¨ã‚’ãŠå‹§ã‚ã—ã¾ã™ã€‚\nã•ã¦ã€ã„ã¤ã‚‚ã¨ã¯é•ã†è¦³ç‚¹ã§ã€å°‘ã—ãƒ¡ã‚¿çš„ãªãƒˆãƒ”ãƒƒã‚¯ã«å–ã‚Šçµ„ã‚“ã§ã¿ã¾ã—ãŸã€‚è‡ªåˆ†è‡ªèº«ä»•äº‹æŸ„ãƒãƒƒã‚¯ãƒ†ã‚¹ãƒˆçµæœãªã©ã‚’è¦‹ã‚‹ã“ã¨ã‚‚å¤šã„ã§ã™ã—ã€ã“ã®ãƒ–ãƒ­ã‚°ã§ã‚‚ã—ã°ã—ã°hold-outæ³•ã§ã®ãƒãƒƒã‚¯ãƒ†ã‚¹ãƒˆã‚’ã—ã¦ã„ã¾ã™ã€‚å¾—ã‚‰ã‚ŒãŸçµæœã®ä¸ç¢ºå®Ÿæ€§ã‚’ç†è§£ã—ã¦ã€è©•ä¾¡ã§ãã‚‹ã‚ˆã†ä»Šå¾Œã‚‚ã“ã®ãƒˆãƒ”ãƒƒã‚¯ã®ç ”ç©¶ã‚’è¿½ã£ã¦ã„ããŸã„ã¨æ€ã„ã¾ã™ã€‚\n","date":1594166400,"expirydate":-62135596800,"kind":"page","lang":"ja","lastmod":1594166400,"objectID":"229d2ed415199727e60335773ffb3171","permalink":"/post/post19/","publishdate":"2020-07-08T00:00:00Z","relpermalink":"/post/post19/","section":"post","summary":"é‡‘èã§ã‚ã‚Œã°ã‚¯ã‚ªãƒ³ãƒ„ã®æ–¹ã¯æ–°è¦é‹ç”¨æˆ¦ç•¥ã®ç«‹æ¡ˆã‚’ã™ã‚‹éš›ã«ã€ãƒãƒƒã‚¯ãƒ†ã‚¹ãƒˆã‚’è¡Œã£ã¦ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ã®ç¢ºèªã‚’ã™ã‚‹ã“ã¨ãŒã‚ã‚‹ã¨æ€ã„ã¾ã™ã€‚ä»Šå›ã¯ã€ãƒãƒƒã‚¯ãƒ†ã‚¹ãƒˆã®ã‚ªãƒ¼ãƒãƒ¼ãƒ•ã‚£ãƒƒãƒ†ã‚£ãƒ³ã‚°ãŒã‚¢ã‚¦ãƒˆã‚ªãƒ–ã‚µãƒ³ãƒ—ãƒ«ãƒ»ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ã«åŠã¼ã™å½±éŸ¿ã«ã¤ã„ã¦èª¿ã¹ãŸã®ã§å‚™å¿˜éŒ²ã‚’ã‹ã­ã¦ã¾ã¨ã‚ã¦ã¿ã¾ã—ãŸã€‚","tags":["æ©Ÿæ¢°å­¦ç¿’","é‡‘è","æ™‚ç³»åˆ—è§£æ"],"title":"ãã®ãƒãƒƒã‚¯ãƒ†ã‚¹ãƒˆæœ¬å½“ã«å†ç¾æ€§ã‚ã‚Šã¾ã™ã‹ï¼Ÿ","type":"post"},{"authors":null,"categories":["ç«¶é¦¬"],"content":"ãŠã¯ã“ã‚“ã°ã‚“ã«ã¡ã¯ã€‚ä»Šå›ã¯ç«¶é¦¬äºˆæƒ³ã«ã¤ã„ã¦ã®è¨˜äº‹ã‚’æ›¸ããŸã„ã¨æ€ã„ã¾ã™ã€‚å‰å›ã€LightGBMã‚’ç”¨ã„ã¦yahooç«¶é¦¬ã‹ã‚‰å–å¾—ã—ãŸãƒ¬ãƒ¼ã‚¹çµæœãƒ‡ãƒ¼ã‚¿(ãƒ†ãƒ¼ãƒ–ãƒ«ãƒ‡ãƒ¼ã‚¿)ã‚’ç”¨ã„ã¦ã€ç«¶é¦¬é †ä½äºˆæƒ³ãƒ¢ãƒ‡ãƒ«ã‚’ä½œæˆã—ã¾ã—ãŸã€‚å‰å›ã¯æ§‹é€ ãƒ‡ãƒ¼ã‚¿ã‚’ç”¨ã„ã¾ã—ãŸãŒã€ã“ã®ã”æ™‚ä¸–ã§ã™ã‹ã‚‰ã“ã‚“ãªåˆ†æã¯èª°ã«ã§ã‚‚ã§ãã‚‹ã‚ã‘ã§ã™ã€‚æ™‚ä»£ã¯éæ§‹é€ ãƒ‡ãƒ¼ã‚¿ã€ã¨ã„ã†ã‚ã‘ã§ä»Šå›ã¯é¦¬ä½“ç”»åƒã‹ã‚‰ç‰¹å¾´é‡ã‚’æŠ½å‡ºã—ã€é †ä½äºˆæƒ³ã‚’è¡Œã†ç•³ã¿è¾¼ã¿ãƒ‹ãƒ¥ãƒ¼ãƒ©ãƒ«ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯(Convolutional Neural Network, CNN)ã‚’ä½œæˆã—ã¦ã¿ã¾ã—ãŸã€‚ç”»åƒè§£æã¯Earth Engineã‚’ç”¨ã„ãŸè¡›æ˜Ÿç”»åƒã®è§£æã«ç¶šã„ã¦2å›ç›®ã€æ·±å±¤å­¦ç¿’ã¯ã“ã®ãƒ–ãƒ­ã‚°ã§ã¯åˆã‚ã¦ã¨è¨€ã†ã“ã¨ã«ãªã‚Šã¾ã™ã€‚ãªãŠã€Pythonã‚’ä½¿ç”¨ã—ã¦ã„ã¾ã™ã€‚\n1. ãƒ‡ãƒ¼ã‚¿åé›†ã®ãŸã‚ã®ã‚¯ãƒ­ãƒ¼ãƒªãƒ³ã‚° ã¾ãšã€é¦¬ä½“ç”»åƒã‚’ãƒãƒƒãƒˆã‹ã‚‰åé›†ã™ã‚‹ã“ã¨ã‹ã‚‰å§‹ã‚ã¾ã™ã€‚1ç•ªè‰¯ã„ã®ã¯ãƒ¬ãƒ¼ã‚¹å½“æ—¥ã®ãƒ‘ãƒ‰ãƒƒã‚¯ã®å†™çœŸã‚’ä½¿ç”¨ã™ã‚‹ã“ã¨ã§ã—ã‚‡ã†ã€‚ãŸã ã€ãƒ‘ãƒ‰ãƒƒã‚¯ã®å†™çœŸã‚’ã¾ã¨ã¾ã£ãŸå½¢ã§æ²è¼‰ã—ã¦ãã‚Œã¦ã„ã‚‹ã‚µã‚¤ãƒˆã¯èª¿ã¹ãŸé™ã‚Šã¯å­˜åœ¨ã—ã¾ã›ã‚“ã§ã—ãŸã€‚ã‚‚ã—ã‹ã—ãŸã‚‰ã€Youtubeã«ç«¶é¦¬ãƒ•ã‚¡ãƒ³ã®æ–¹ãŒãƒ‘ãƒ‰ãƒƒã‚¯å‹•ç”»ã‚’ä¸Šã’ã¦ã„ã‚‰ã£ã—ã‚ƒã‚‹ã‹ã‚‚çŸ¥ã‚Œã¾ã›ã‚“ã®ã§ã€ãã‚Œã‚’ç”»åƒã«åˆ‡ã‚ŠæŠœã„ã¦ä½¿ã† or å‹•ç”»ã¨ã—ã¦CNNâ†’RNNã®Encoder-Decoderãƒ¢ãƒ‡ãƒ«ã«é©ç”¨ã™ã‚‹ã¨é¢ç™½ã„ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ã€‚ã—ã‹ã—ã€ãã“ã¾ã§ã®èƒ½åŠ›ã¯ä»Šã®è‡ªåˆ†ã«ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚\nãƒ‡ãƒ¼ã‚¿ã‚’ã©ã“ã‹ã‚‰å–å¾—ã™ã‚‹ã‹ ãã“ã§ã€ä»Šå›ã¯ãƒ‡ã‚¤ãƒªãƒ¼ã®Webã‚µã‚¤ãƒˆã‹ã‚‰ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—ã—ã¦ã„ã¾ã™ã€‚ã“ã“ã«ã¯ç›´è¿‘1å¹´é–“?ã®G1ãƒ¬ãƒ¼ã‚¹ã«å‡ºé¦¬ã™ã‚‹ç«¶èµ°é¦¬ã®ãƒ¬ãƒ¼ã‚¹å‰ã®é¦¬ä½“å†™çœŸãŒæ²è¼‰ã•ã‚Œã¦ã„ã¾ã™ã€‚å®Ÿéš›ã®ãƒ¬ãƒ¼ã‚¹å ´ã¸è¡Œã‘ãªã„é¦¬åˆ¸å¸«ã•ã‚“ãŸã¡ã¯ã“ã®å†™çœŸã‚’è¦‹ã¦é¦¬ã®çŠ¶æ…‹ã‚’åˆ†æã—ã¦ã„ã‚‹ã¨æ€ã‚ã‚Œã¾ã™ã€‚\nãªãŠã€ã“ã®ã‚µã‚¤ãƒˆã«ã¯å‡ºé¦¬å…¨é ­ã®é¦¬ä½“å†™çœŸãŒæ²è¼‰ã•ã‚Œã¦ã„ã‚‹ã‚ã‘ã§ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚ã¾ãŸã€G1ã®é™ã‚‰ã‚ŒãŸãƒ¬ãƒ¼ã‚¹ã®ã¿ã§ã™ã®ã§ã€ãã‚‚ãã‚‚å…¨ã¦ã®é¦¬ãŒä»•ä¸ŠãŒã£ã¦ã„ã‚‹å¯èƒ½æ€§ã‚‚ã‚ã‚Šã€å·®ãŒã¤ã‹ãªã„ã“ã¨ã‚‚ååˆ†äºˆæƒ³ã•ã‚Œã¾ã™ã€‚ãŸã ã€æ‰‹ã£å–ã‚Šæ—©ãã‚„ã£ã¦ã¿ã‚‹ã“ã¨ã‚’å„ªå…ˆã—ã€ä»Šå›ã¯ã“ã®ãƒ‡ãƒ¼ã‚¿ã‚’ä½¿ç”¨ã™ã‚‹ã“ã¨ã«ã—ãŸã„ã¨æ€ã„ã¾ã™ã€‚\nseleniumã§ã‚¯ãƒ­ãƒ¼ãƒªãƒ³ã‚°ã‚’å®Ÿè¡Œã™ã‚‹ ã‚¯ãƒ­ãƒ¼ãƒªãƒ³ã‚°ã«ã¯seleniumã‚’ä½¿ç”¨ã—ã¾ã™ã€‚ä»Šå›ã¯CNNãŒãƒ¡ã‚¤ãƒ³ãªã®ã§Webã‚¯ãƒ­ãƒ¼ãƒªãƒ³ã‚°ã«ã¤ã„ã¦ã¯èª¬æ˜ã—ã¾ã›ã‚“ã€‚ä½¿ç”¨ã—ãŸã‚³ãƒ¼ãƒ‰ã¯ä»¥ä¸‹ã§ã™ã€‚\nã€æ³¨æ„ã€‘ä»¥ä¸‹ã®ã‚³ãƒ¼ãƒ‰ã‚’ä½¿ç”¨ã•ã‚Œã‚‹å ´åˆã¯è‡ªå·±è²¬ä»»ã§ãŠé¡˜ã„ã—ã¾ã™ã€‚\nfrom selenium import webdriver from selenium.webdriver.chrome.options import Options from selenium.webdriver.support.select import Select from selenium.webdriver.common.by import By from selenium.webdriver.common.keys import Keys from selenium.webdriver.common.alert import Alert from selenium.webdriver.support.ui import WebDriverWait from selenium.webdriver.support import expected_conditions as EC from selenium.common.exceptions import TimeoutException from selenium.webdriver.common.action_chains import ActionChains from time import sleep from urllib import request import random # seleniumã®ã‚ªãƒ—ã‚·ãƒ§ãƒ³è¨­å®šï¼ˆãŠã¾ã˜ãªã„ï¼‰ options = Options() options.add_argument(\u0026#39;--disable-gpu\u0026#39;); options.add_argument(\u0026#39;--disable-extensions\u0026#39;); options.add_argument(\u0026#39;--proxy-server=\u0026#34;direct://\u0026#34;\u0026#39;); options.add_argument(\u0026#39;--proxy-bypass-list=*\u0026#39;); options.add_argument(\u0026#39;--start-maximized\u0026#39;); # driveræŒ‡å®š DRIVER_PATH = r\u0026#39;C:/Users/aashi/Desktop/chromedriver_win32/chromedriver.exe\u0026#39; driver = webdriver.Chrome(executable_path=DRIVER_PATH, chrome_options=options) # urlã‚’æ¸¡ã—ã€ã‚µã‚¤ãƒˆã¸ã‚¢ã‚¯ã‚»ã‚¹ url = \u0026#39;https://www.daily.co.jp/horse/horsecheck/photo/\u0026#39; driver.get(url) driver.implicitly_wait(15) # ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®ãƒ­ãƒ¼ãƒ‰å¾…ã¡ã®æœ€å¤§æ™‚é–“ã§ã“ã‚Œã‚’è¶Šãˆã‚‹ã¨ã‚¨ãƒ©ãƒ¼ sleep(5) # webãƒšãƒ¼ã‚¸ã®é·ç§»ã‚’è¡Œã†ã®ã§1ç§’sleep # å„ãƒ¬ãƒ¼ã‚¹æ¯ã«ç”»åƒãƒ‡ãƒ¼ã‚¿ä¿å­˜ selector0 = \u0026#34;body \u0026gt; div \u0026gt; main \u0026gt; div \u0026gt; div.primaryContents \u0026gt; article \u0026gt; div \u0026gt; section \u0026gt; a\u0026#34; elements = driver.find_elements_by_css_selector(selector0) for i in range(0,len(elements)): elements = driver.find_elements_by_css_selector(selector0) element = elements[i] element.click() sleep(5) # webãƒšãƒ¼ã‚¸ã®é·ç§»ã‚’è¡Œã†ã®ã§5ç§’sleep target = driver.find_element_by_link_text(\u0026#39;ï¼§ï¼‘é¦¬ä½“è¨ºæ–­å†™çœŸé›†ã®TOP\u0026#39;) actions = ActionChains(driver) actions.move_to_element(target) actions.perform() sleep(5) # webãƒšãƒ¼ã‚¸ã®é·ç§»ã‚’è¡Œã†ã®ã§5ç§’sleep selector = \u0026#34;body \u0026gt; div.wrapper.horse.is-fixedHeader.is-fixedAnimation \u0026gt; main \u0026gt; div \u0026gt; div.primaryContents \u0026gt; article \u0026gt; article \u0026gt; div.photoDetail-wrapper \u0026gt; section \u0026gt; div \u0026gt; figure\u0026#34; figures = driver.find_elements_by_css_selector(selector) download_dir = r\u0026#39;C:\\Users\\aashi\\umanalytics\\photo\\image\u0026#39; selector = \u0026#34;body \u0026gt; div \u0026gt; main \u0026gt; div \u0026gt; div.primaryContents \u0026gt; article \u0026gt; article \u0026gt; div.photoDetail-wrapper \u0026gt; section \u0026gt; h1\u0026#34; race_name = driver.find_element_by_css_selector(selector).text for figure in figures: img_name = figure.find_element_by_tag_name(\u0026#39;figcaption\u0026#39;).text horse_src = figure.find_element_by_tag_name(\u0026#39;img\u0026#39;).get_attribute(\u0026#34;src\u0026#34;) save_name = download_dir + \u0026#39;/\u0026#39; + race_name + \u0026#39;_\u0026#39; + img_name + \u0026#39;.jpg\u0026#39; request.urlretrieve(horse_src,save_name) driver.back() ä¿å­˜ã—ãŸç”»åƒã‚’å®Ÿéš›ã®ãƒ¬ãƒ¼ã‚¹çµæœã¨çªåˆã—ã€æ‰‹ä½œæ¥­ã§ä¸Šä½3ä½ä»¥å†…ã‚°ãƒ«ãƒ¼ãƒ—ã¨ãã‚Œä»¥å¤–ã®ã‚°ãƒ«ãƒ¼ãƒ—ã«åˆ†ã‘ã¾ã—ãŸã€‚ä»¥ä¸‹ã®ã‚ˆã†ãªæ„Ÿã˜ã§ç”»åƒãŒä¿å­˜ã•ã‚Œã¦ã„ã¾ã™ã€‚\nã“ã‚Œã§å…ƒãƒ‡ãƒ¼ã‚¿ã®åé›†ãŒå®Œäº†ã—ã¾ã—ãŸã€‚\n2. Kerasã‚’ç”¨ã„ã¦CNNã‚’å­¦ç¿’ã•ã›ã‚‹ Kerasã¨ã¯ï¼Ÿ ã•ã¦ã€æ¬¡ã«Kerasã‚’ä½¿ã£ã¦CNNã‚’å­¦ç¿’ã•ã›ã¾ã—ã‚‡ã†ã€‚ã¾ãšã€Kerasã¨ã¯Tensorflowã‚„Theanoä¸Šã§å‹•ãNeural Networkãƒ©ã‚¤ãƒ–ãƒ©ãƒªã®1ã¤ã§ã™ã€‚Kerasã¯æ¯”è¼ƒçš„çŸ­ã„ã‚³ãƒ¼ãƒ‰ã§ãƒ¢ãƒ‡ãƒ«ã‚’çµ„ã‚€ã“ã¨ãŒã§ãã€ã¾ãŸå­¦ç¿’ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ãŒå¤šã„ã“ã¨ãŒç‰¹å¾´ã®ã‚ˆã†ã§ã™ã€‚\nCNNã¨ã¯ï¼Ÿ CNNã¯ç”»åƒè§£æã‚’è¡Œã†éš›ã«ã‚ˆãä½¿ç”¨ã•ã‚Œã‚‹(Deep) Neural Networkã®1ç¨®ã§ã€ãã®åã®é€šã‚ŠConvolution(ç•³ã¿è¾¼ã¿)ã‚’è¿½åŠ ã—ãŸç‰©ã¨ãªã£ã¦ã„ã¾ã™ã€‚ç•³ã¿è¾¼ã¿ã¨ã¯ä»¥ä¸‹ã®ã‚ˆã†ãªå‡¦ç†ã®ã“ã¨ã‚’è¨€ã„ã¾ã™ã€‚\nã“ã“ã®ã‚¤ãƒ³ãƒ—ãƒƒãƒˆã¨ã¯ç”»åƒãƒ‡ãƒ¼ã‚¿ã®ã“ã¨ã§ã™ã€‚ç”»åƒè§£æã§ã¯ç”»åƒã‚’æ•°å€¤ã¨ã—ã¦èªè­˜ã—ã€è§£æã‚’è¡Œã„ã¾ã™ã€‚ã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ã‚¿ä¸Šã®ç”»åƒã¯RGBå€¤ã¨ã„ã†ã€èµ¤(Red)ã€ç·‘(Green)ã€é’(Blue)ã®3è‰²ã®0~255ã¾ã§ã®æ•°å€¤ã®å¼·å¼±ã§è¡¨ç¾ã•ã‚Œã¦ã„ã¾ã™ã€‚èµ¤255ã€ç·‘0ã€é’0ã¨ã„ã£ãŸå½¢ã§3å±¤ã®ãƒ™ã‚¯ãƒˆãƒ«ã«ãªã£ã¦ãŠã‚Šã€ã“ã®å ´åˆå®Œå…¨ãªèµ¤ãŒè¡¨ç¾ã•ã‚Œã¾ã™ã€‚ä¸Šå›³ã®å ´åˆã€a,b,cãªã©ãŒå„ãƒ”ã‚¯ã‚»ãƒ«ã®RGBå€¤ã®ã„ãšã‚Œã‹ã‚’è¡¨ã—ã¦ã„ã‚‹ã¨è€ƒãˆã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚ç•³ã¿è¾¼ã¿ã¯ã“ã®RGBå€¤ã‚’ã‚«ãƒ¼ãƒãƒ«ã¨å‘¼ã°ã‚Œã‚‹è¡Œåˆ—ã¨ã®å†…ç©ã‚’ã¨ã‚‹ã“ã¨ã§ç”»åƒã®ç‰¹å¾´é‡ã‚’è¨ˆç®—ã—ã¾ã™ã€‚ç•³ã¿è¾¼ã¿å±¤ã®æ„å‘³ã¯ä»¥ä¸‹ã®å‹•ç”»ãŒã‚ã‹ã‚Šã‚„ã™ã„ã§ã™ã€‚\n\rã‚«ãƒ¼ãƒãƒ«ã‚’ä¸Šæ‰‹ããã®ç”»åƒã®ç‰¹å¾´çš„ãªéƒ¨åˆ†ã‚’å–å¾—ã§ãã‚‹ã‚ˆã†ã«å­¦ç¿’ã™ã‚‹ã“ã¨ã§ã€ç”»åƒã®è­˜åˆ¥ãŒå¯èƒ½ã«ãªã‚Šã¾ã™ã€‚ç•³ã¿è¾¼ã¿å±¤ã¯CNNã®æœ€é‡è¦éƒ¨åˆ†ã ã¨æ€ã„ã¾ã™ã€‚\nä¸Šå›³ã®ã‚ˆã†ã«CNNã¯ç•³ã¿è¾¼ã¿æ„å¤–ã«ã‚‚ã‚‚ã¡ã‚ã‚“å…¥åŠ›å±¤ã‚„å‡ºåŠ›å±¤ãªã©é€šå¸¸ã®Neural Networkã¨åŒã˜å±¤ã‚‚æŒã£ã¦ã„ã¾ã™ã€‚ãªãŠã€MaxPoolingå±¤ã«ã¤ã„ã¦çŸ¥ã‚ŠãŸã„äººã¯ä»¥ä¸‹ã®å‹•ç”»ã‚’å‚ç…§ã•ã‚Œã¦ãã ã•ã„ã€‚\n\ræ·±å±¤å­¦ç¿’ã®å­¦ç¿’æ–¹æ³•ã«ã¤ã„ã¦ã¯æœ€æ€¥ä¸‹é™æ³•(å‹¾é…æ³•)ãŒã‚ªãƒ¼ã‚½ãƒ‰ãƒƒã‚¯ã‚¹ãªã‚‚ã®ã¨ã—ã¦çŸ¥ã‚‰ã‚Œã¦ã„ã¾ã™ãŒã€Adamãªã©è‰²ã€…ãªæ‹¡å¼µã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ãŒææ¡ˆã•ã‚Œã¦ã„ã¾ã™ã€‚åŸºæœ¬çš„ã«ã¯ã€Adamã¯momentumã‚’ä½¿ç”¨ã™ã‚‹ã“ã¨ãŒå¤šã„ã§ã—ã‚‡ã†ã‹ã€‚\nã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚° ã§ã¯ã€å®Ÿéš›ã«ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã—ã¦ã„ãã¾ã™ã€‚\nfrom keras.utils import np_utils ## Using TensorFlow backend.\rfrom keras.models import Sequential from keras.layers.convolutional import MaxPooling2D from keras.layers import Activation, Conv2D, Flatten, Dense,Dropout from sklearn.model_selection import train_test_split from keras.optimizers import SGD, Adadelta, Adagrad, Adam, Adamax, RMSprop, Nadam from PIL import Image import numpy as np import glob import matplotlib.pyplot as plt import time import os ã¾ãšæœ€åˆã«åé›†ã—ã¦ããŸç”»åƒãƒ‡ãƒ¼ã‚¿ã‚’æ•°å€¤ãƒ‡ãƒ¼ã‚¿ã«å¤‰æ›ã—å­¦ç¿’ãƒ‡ãƒ¼ã‚¿ã‚’ä½œæˆã—ã¾ã™ã€‚ ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹é€ ã¯ä»¥ä¸‹ã®ã‚ˆã†ã«ãªã£ã¦ãŠã‚Šã€ä¸Šä½ç”»åƒã¨ãã®ä»–ç”»åƒãŒåˆ¥ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«ä¿å­˜ã•ã‚Œã¦ã„ã¾ã™ã€‚å„ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‹ã‚‰ç”»åƒã‚’èª­ã¿è¾¼ã‚€éš›ã«ã€ä¸Šä½ç”»åƒã«ã¯1ã€ãã®ä»–ã«ã¯0ã¨ã„ã†ã‚«ãƒ†ã‚´ãƒªå¤‰æ•°ã‚’ä¸ãˆã¾ã™ã€‚\né¦¬ä½“å†™çœŸ\n ä¸Šä½ ãã®ä»–  #ãƒ•ã‚©ãƒ«ãƒ€ã‚’æŒ‡å®š folders = os.listdir(r\u0026#34;C:\\Users\\aashi\\umanalytics\\photo\\image\u0026#34;) #ç”»ç·æ•°ã‚’æŒ‡å®š(ä»Šå›ã¯50Ã—50Ã—3)ã€‚ image_size = 300 dense_size = len(folders) X = [] Y = [] #ãã‚Œãã‚Œã®ãƒ•ã‚©ãƒ«ãƒ€ã‹ã‚‰ç”»åƒã‚’èª­ã¿è¾¼ã¿ã€Imageé–¢æ•°ã‚’ä½¿ç”¨ã—ã¦RGBå€¤ãƒ™ã‚¯ãƒˆãƒ«(numpy array)ã¸å¤‰æ› for i, folder in enumerate(folders): files = glob.glob(\u0026#34;C:/Users/aashi/umanalytics/photo/image/\u0026#34; + folder + \u0026#34;/*.jpg\u0026#34;) index = i for k, file in enumerate(files): image = Image.open(file) image = image.convert(\u0026#34;L\u0026#34;).convert(\u0026#34;RGB\u0026#34;) image = image.resize((image_size, image_size)) #ç”»ç´ æ•°ã‚’è½ã¨ã—ã¦ã„ã‚‹ data = np.asarray(image) X.append(data) Y.append(index) X = np.array(X) Y = np.array(Y) X = X.astype(\u0026#39;float32\u0026#39;) X = X / 255.0 # 0~1ã¸å¤‰æ› X.shape Y = np_utils.to_categorical(Y, dense_size) #è¨“ç·´ãƒ‡ãƒ¼ã‚¿ã¨ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ã¸å¤‰æ› X_train, X_test, y_train, y_test = train_test_split(X, Y, test_size=0.20) è¨“ç·´ãƒ‡ãƒ¼ã‚¿ã¨ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ã®åˆ†å‰²ãŒã§ãã¾ã—ãŸã€‚ä»Šè€ƒãˆã¦ã„ã‚‹ã®ã¯ã€Œä¸Šä½ã€ã¨ã€Œãã®ä»–ã€ã®2å€¤åˆ†é¡ã¨ãªã£ã¦ã„ã¾ã™ãŒã€ã€Œä¸Šä½ã€ã‚’3ä½ä»¥å†…ã¨å®šç¾©ã—ãŸã®ã§ä¸å‡è¡¡ãªãƒ‡ãƒ¼ã‚¿ã¨ãªã£ã¦ã„ã¾ã™(ãã®ä»–ãƒ‡ãƒ¼ã‚¿ãŒä¸Šä½ãƒ‡ãƒ¼ã‚¿ã®5å€ãã‚‰ã„)ã€‚ã“ã†ã„ã£ãŸå ´åˆã€ãã®ã¾ã¾ã®ãƒ‡ãƒ¼ã‚¿ã§å­¦ç¿’ã‚’ã™ã‚‹ã¨ã‚µãƒ³ãƒ—ãƒ«ã‚µã‚¤ã‚ºãŒå¤šã„æ–¹ã®ãƒ©ãƒ™ãƒ«(ã“ã®å ´åˆã€Œãã®ä»–ã€)ã‚’äºˆæ¸¬ã—ã‚„ã™ããªã‚Šã€ãƒã‚¤ã‚¢ã‚¹ã®ã‚ã‚‹ãƒ¢ãƒ‡ãƒ«ã¨ãªã‚Šã¾ã™ã€‚ã‚ˆã£ã¦ã€å­¦ç¿’ãƒ‡ãƒ¼ã‚¿ã¯2ã‚¯ãƒ©ã‚¹ãã‚Œãã‚ŒãŒåŒã˜ã‚µãƒ³ãƒ—ãƒ«ã‚µã‚¤ã‚ºã¨ãªã‚‹ã‚ˆã†èª¿æ•´ã—ã¦ã‚„ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚\nindex_zero = np.random.choice(np.array(np.where(y_train[:,1]==0))[0,],np.count_nonzero(y_train[:,1]==1),replace=False) index_one = np.array(np.where(y_train[:,1]==1))[0] y_resampled = y_train[np.hstack((index_one,index_zero))] X_resampled = X_train[np.hstack((index_one,index_zero))] å­¦ç¿’ãƒ‡ãƒ¼ã‚¿ã«ã¯ã“ã®y_resampledã¨X_resampledã‚’ä½¿ç”¨ã—ã¾ã™ã€‚æ¬¡ã«ã€CNNã‚’æ§‹ç¯‰ã—ã¦ã„ãã¾ã™ã€‚Kerasã§ã¯ã€sequential modelã‚’æŒ‡å®šã—ã€addãƒ¡ã‚½ãƒƒãƒ‰ã§å±¤ã‚’è¿½åŠ ã—ã¦è¡Œãã“ã¨ã§ãƒ¢ãƒ‡ãƒ«ã‚’å®šç¾©ã—ã¾ã™ã€‚\nmodel = Sequential() model.add(Conv2D(32, (3, 3), padding=\u0026#39;same\u0026#39;,input_shape=X_train.shape[1:])) model.add(Activation(\u0026#39;relu\u0026#39;)) model.add(Conv2D(32, (3, 3))) model.add(Activation(\u0026#39;relu\u0026#39;)) model.add(MaxPooling2D(pool_size=(2, 2))) model.add(Dropout(0.25)) model.add(Conv2D(64, (3, 3), padding=\u0026#39;same\u0026#39;)) model.add(Activation(\u0026#39;relu\u0026#39;)) model.add(Conv2D(64, (3, 3))) model.add(Activation(\u0026#39;relu\u0026#39;)) model.add(MaxPooling2D(pool_size=(2, 2))) model.add(Dropout(0.25)) model.add(Flatten()) model.add(Dense(512)) model.add(Activation(\u0026#39;relu\u0026#39;)) model.add(Dropout(0.5)) model.add(Dense(dense_size)) model.add(Activation(\u0026#39;softmax\u0026#39;)) model.summary() ## Model: \u0026quot;sequential_1\u0026quot;\r## _________________________________________________________________\r## Layer (type) Output Shape Param # ## =================================================================\r## conv2d_1 (Conv2D) (None, 300, 300, 32) 896 ## _________________________________________________________________\r## activation_1 (Activation) (None, 300, 300, 32) 0 ## _________________________________________________________________\r## conv2d_2 (Conv2D) (None, 298, 298, 32) 9248 ## _________________________________________________________________\r## activation_2 (Activation) (None, 298, 298, 32) 0 ## _________________________________________________________________\r## max_pooling2d_1 (MaxPooling2 (None, 149, 149, 32) 0 ## _________________________________________________________________\r## dropout_1 (Dropout) (None, 149, 149, 32) 0 ## _________________________________________________________________\r## conv2d_3 (Conv2D) (None, 149, 149, 64) 18496 ## _________________________________________________________________\r## activation_3 (Activation) (None, 149, 149, 64) 0 ## _________________________________________________________________\r## conv2d_4 (Conv2D) (None, 147, 147, 64) 36928 ## _________________________________________________________________\r## activation_4 (Activation) (None, 147, 147, 64) 0 ## _________________________________________________________________\r## max_pooling2d_2 (MaxPooling2 (None, 73, 73, 64) 0 ## _________________________________________________________________\r## dropout_2 (Dropout) (None, 73, 73, 64) 0 ## _________________________________________________________________\r## flatten_1 (Flatten) (None, 341056) 0 ## _________________________________________________________________\r## dense_1 (Dense) (None, 512) 174621184 ## _________________________________________________________________\r## activation_5 (Activation) (None, 512) 0 ## _________________________________________________________________\r## dropout_3 (Dropout) (None, 512) 0 ## _________________________________________________________________\r## dense_2 (Dense) (None, 2) 1026 ## _________________________________________________________________\r## activation_6 (Activation) (None, 2) 0 ## =================================================================\r## Total params: 174,687,778\r## Trainable params: 174,687,778\r## Non-trainable params: 0\r## _________________________________________________________________\rã§ã¯ã€å­¦ç¿’ãƒ‘ãƒ¼ãƒˆã«å…¥ã‚Šã¾ã™ã€‚ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã«ã¯Adadeltaã‚’ä½¿ç”¨ã—ã¾ã™ã€‚ã‚ˆãã‚ã‹ã£ã¦ãªã„ã‚“ã§ã™ã‘ã©ã­ã€‚ã€‚ã€‚\noptimizers =\u0026#34;Adadelta\u0026#34; results = {} epochs = 50 model.compile(loss=\u0026#39;categorical_crossentropy\u0026#39;, optimizer=optimizers, metrics=[\u0026#39;accuracy\u0026#39;]) results = model.fit(X_resampled, y_resampled, validation_split=0.2, epochs=epochs) ä¸å‡è¡¡ãƒ‡ãƒ¼ã‚¿èª¿æ•´ã®ãŸã‚ã®ã‚¢ãƒ³ãƒ€ãƒ¼ã‚µãƒ³ãƒ—ãƒªãƒ³ã‚° ã“ã“ã‹ã‚‰ã€Testãƒ‡ãƒ¼ã‚¿ã§2å€¤åˆ†é¡ã‚’è¡Œã†ã®ã§ã™ãŒã€å­¦ç¿’ãƒ‡ãƒ¼ã‚¿ã‚’ã‚¢ãƒ³ãƒ€ãƒ¼ã‚µãƒ³ãƒ—ãƒªãƒ³ã‚°ã—ã¦ã„ã‚‹ã®ã§ã€äºˆæ¸¬ç¢ºç‡ã‚’è¨ˆç®—ã™ã‚‹éš›ã«ã‚¢ãƒ³ãƒ€ãƒ¼ã‚µãƒ³ãƒ—ãƒªãƒ³ã‚°ã‚’è¡Œã£ãŸã‚µãƒ³ãƒ—ãƒ«é¸æŠãƒã‚¤ã‚¢ã‚¹ãŒç”Ÿã˜ã¦ã—ã¾ã„ã¾ã™ã€‚è«–æ–‡ã¯ã“ã¡ã‚‰ã€‚ ã‚ˆã£ã¦ã€è£œæ­£ãŒå¿…è¦ã«ãªã‚‹ã®ã§ã™ãŒã“ã®éƒ¨åˆ†ã®å®šå¼åŒ–ã‚’ã“ã“ã§ã—ã¦ãŠããŸã„ã¨æ€ã„ã¾ã™ã€‚ç¾åœ¨è¡Œã£ã¦ã„ã‚‹2å€¤åˆ†é¡å•é¡Œã‚’èª¬æ˜åƒæ•°$X$ã‹ã‚‰2å€¤ã‚’å–ã‚‹ç›®çš„å¤‰æ•°$Y$ã‚’äºˆæ¸¬ã™ã‚‹å•é¡Œã¨è¡¨ç¾ã™ã‚‹ã“ã¨ã«ã—ã¾ã™ã€‚ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆ$(X,Y)$ã¯æ­£ä¾‹ãŒè² ä¾‹ã‚ˆã‚Šã‚‚ã‹ãªã‚Šå°‘ãªãã€è² ä¾‹ã®ã‚µãƒ³ãƒ—ãƒ«ã‚µã‚¤ã‚ºã‚’æ­£ä¾‹ã«åˆã‚ã›ãŸãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã‚’$(X_s,Y_s)$ã¨ã—ã¾ã™ã€‚ã“ã“ã§ã€$(X,Y)$ã®ã‚µãƒ³ãƒ—ãƒ«çµ„ãŒ$(X_s,Y_s)$ã«ã‚‚å«ã¾ã‚Œã‚‹å ´åˆã«1ã‚’å–ã‚Šã€å«ã¾ã‚Œãªã„å ´åˆã«0ã‚’ã¨ã‚‹ã‚«ãƒ†ã‚´ãƒªå¤‰æ•°$s$ã‚’å®šç¾©ã—ã¾ã™ã€‚ ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆ$(X,Y)$ã‚’ç”¨ã„ã¦æ§‹ç¯‰ã—ãŸãƒ¢ãƒ‡ãƒ«ã«èª¬æ˜å¤‰æ•°$x$ã‚’ä¸ãˆãŸæ™‚ã€æ­£ä¾‹ã¨äºˆæ¸¬ã™ã‚‹æ¡ä»¶ä»˜ãç¢ºç‡ã¯$P(y=1|x)$ã§è¡¨ã™ã“ã¨ãŒã§ãã¾ã™ã€‚ä¸€æ–¹ã€$(X_s,Y_s)$ã‚’ç”¨ã„ã¦æ§‹ç¯‰ã—ãŸãƒ¢ãƒ‡ãƒ«ã§æ­£ä¾‹ã‚’äºˆæ¸¬ã™ã‚‹æ¡ä»¶ä»˜ãç¢ºç‡ã¯ãƒ™ã‚¤ã‚ºã®å®šç†ã¨ã‚«ãƒ†ã‚´ãƒªå¤‰æ•°$s$ã‚’ç”¨ã„ã¦ã€\n$$ P(y=1|x,s=1) = \\frac{P(s=1|y=1)P(y=1|x)}{P(s=1|y=1)P(y=1|x) + P(s=1|y=0)P(y=0|x)} $$ ã¨æ›¸ã‘ã¾ã™ã€‚$(X_s,Y_s)$ã¯è² ä¾‹ã®ã‚µãƒ³ãƒ—ãƒ«ã‚µã‚¤ã‚ºã‚’æ­£ä¾‹ã«åˆã‚ã›ã¦ã„ã‚‹ãŸã‚ã€$P(s=1,y=1)=1$ã§ã‚ã‚‹ã®ã§ä¸Šå¼ã¯\n$$ P(y=1|x,s=1) = \\frac{P(y=1|x)}{P(y=1|x) + P(s=1|y=0)P(y=0|x)} = \\frac{P(y=1|x)}{P(y=1|x) + P(s=1|y=0)(1-P(y=1|x))} $$ ã¨æ›¸ãæ›ãˆã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚$P(s=1|y=0)\\neq0$ã§ã‚ã‚‹ã“ã¨ã¯$(X_s,Y_s)$ã®å®šç¾©ã‚ˆã‚Šè‡ªæ˜ã§ã™(0ã ã¨æ­£ä¾‹ã—ã‹ãªã„ä¸å‡è¡¡ãƒ‡ãƒ¼ã‚¿ã«ãªã‚‹)ã€‚ã‚ˆã£ã¦ã€$P(y=0,x)\\neq0$ã§ã‚ã‚‹é™ã‚Šã€ã‚¢ãƒ³ãƒ€ãƒ¼ã‚µãƒ³ãƒ—ãƒªãƒ³ã‚°ã®ãƒ¢ãƒ‡ãƒ«ãŒæ­£ä¾‹ã¨ã¯ã˜ãå‡ºã™ç¢ºç‡ã¯å…ƒã®ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆãŒå‡ºã™ç¢ºç‡ã«å¯¾ã—ã¦æ­£ã®ãƒã‚¤ã‚¢ã‚¹ãŒã‚ã‚‹ã“ã¨ãŒã‚ã‹ã‚Šã¾ã™ã€‚æ±‚ã‚ãŸã„ã®ã¯ãƒã‚¤ã‚¢ã‚¹ã®ãªã„$P(y=1|x)$ãªã®ã§$P=P(y=1|x),P_s=P(y|x,s=1),\\beta=P(s=1,y=0)$ã¨ã™ã‚‹ã¨ã€\n$$ P = \\frac{\\beta P_s}{\\beta P_s-P_s+1} $$ ã¨ã‹ã‘ã€ã“ã®é–¢ä¿‚å¼ã‚’ç”¨ã„ã¦ãƒã‚¤ã‚¢ã‚¹ã‚’è£œæ­£ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚ ä»Šç¢ºèªã—ãŸã“ã¨ã‚’é–¢æ•°ã¨ã—ã¦å®šç¾©ã—ã¾ã—ã‚‡ã†ã€‚\ndef calibration(y_proba, beta): return y_proba / (y_proba + (1 - y_proba) / beta) sampling_rate = sum(y_train[:,1]) / sum(1-y_train[:,1]) y_proba_calib = calibration(model.predict(X_test), sampling_rate) y_pred = np_utils.to_categorical(np.argmax(y_proba_calib,axis=1), dense_size) from sklearn.metrics import confusion_matrix, ConfusionMatrixDisplay, accuracy_score score = accuracy_score(y_test, y_pred) print(\u0026#39;Test accuracy:\u0026#39;, score) ## Test accuracy: 0.22033898305084745\rã¾ã£ãŸãè‰¯ããªã„çµæœã§ã™ã€‚ConfusionMatrixã‚’å‡ºã—ã¦ã¿ãŸã¨ã“ã‚ã©ã†ã‚„ã‚‰ã†ã¾ãã„ã£ã¦ã„ãªã„ã“ã¨ãŒã‚ã‹ã‚Šã¾ã—ãŸã€‚\nConfusionMatrixDisplay(confusion_matrix(np.argmax(y_test,axis=1), np.argmax(y_pred,axis=1))).plot() ## \u0026lt;sklearn.metrics._plot.confusion_matrix.ConfusionMatrixDisplay object at 0x000000005474F108\u0026gt;\rplt.show() plt.close() ä¸å‡è¡¡ãƒ‡ãƒ¼ã‚¿ã®ãƒã‚¤ã‚¢ã‚¹ä¿®æ­£ã¯ã—ãŸã‚“ã§ã™ãŒã€ãã‚Œã§ã‚‚ãªãŠæ­£å€¤ã‚’äºˆæ¸¬ã—ã‚„ã™ã„ãƒ¢ãƒ‡ãƒ«ã¨ãªã£ã¦ã„ã¾ã™ã€‚ã“ã‚Œã§ã¯ä½¿ãˆãªã„ã§ã™ã­ã€‚\n3. Shapå€¤ã‚’ç”¨ã„ãŸçµæœè§£é‡ˆ ä»Šå­¦ç¿’ã—ãŸãƒ¢ãƒ‡ãƒ«ã®shapå€¤ã‚’è€ƒãˆã€çµæœã®è§£é‡ˆã‚’ã—ãŸã„ã¨æ€ã„ã¾ã™ã€‚shapå€¤ã«ã¤ã„ã¦ã¯æ™‚é–“ãŒã‚ã‚Œã°ã€èª¬æ˜ã‚’è¿½è¨˜ã—ãŸã„ã¨æ€ã„ã¾ã™ã€‚ç°¡å˜ã«è¨€ãˆã°ã€CNNãŒç”»åƒã®ã©ã®éƒ¨åˆ†ã«ç‰¹å¾´ã‚’æ‰ãˆã€é¦¬ãŒä¸Šä½ã«å…¥ã‚‹ã‹ã‚’äºˆæƒ³ã—ãŸã‹ã‚’å¯è¦–åŒ–ã§æ‰ãˆã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚ã“ã®é¦¬ã®è§£æã‚’ã™ã‚‹ã“ã¨ã«ã—ã¾ã™ã€‚\nplt.imshow(X_test[0]) plt.show() plt.close() import shap background = X_train[np.random.choice(X_train.shape[0],100,replace=False)] e = shap.GradientExplainer(model,background) shap_values = e.shap_values(X_test[[0]]) shap.image_plot(shap_values[1],X_test[[0]]) éå¸¸ã«å¾®å¦™ã§ã™ãŒã€è¶³ã‚„è‡€éƒ¨ãªã©ã‚’è©•ä¾¡ã—ã¦ã„ã‚‹ã‚ˆã†ã«ã¿ãˆã¾ã™ã€‚ã§ã™ãŒã€èƒŒæ™¯ã«åå¿œã—ã¦ã„ã‚‹ã‚ˆã†ã«ã‚‚è¦‹ãˆã‚‹ã®ã§é¦¬ä½“ã®ã¿å–ã‚Šå‡ºã™ãƒˆãƒªãƒŸãƒ³ã‚°ã‚’ã‚„ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã­ã€‚ã“ã‚Œã¯ç‰©ä½“æ¤œçŸ¥ã®ãƒ¢ãƒ‡ãƒ«ã‚’æ§‹ç¯‰ã™ã‚‹å¿…è¦ãŒã‚ã‚Šãã†ã§ã™ã€‚ã¾ãŸã€ä»Šåº¦ã®æ©Ÿä¼šã«è€ƒãˆã¾ã™ã€‚\n4. æœ€å¾Œã« æ­£ç›´ã¾ã£ãŸãä¸Šæ‰‹ãã„ã£ã¦ã„ã¾ã›ã‚“ã€‚ã‚„ã¯ã‚Šé¦¬ä½“ã‹ã‚‰é †ä½äºˆæ¸¬ã‚’ã™ã‚‹ã®ã¯é›£ã—ã„ã®ã§ã—ã‚‡ã†ã‹ã€‚ã»ã‹ã®å¤‰æ•°ã¨æ›ã‘åˆã‚ã›ã‚‹ã¨çµæœãŒå¤‰ã‚ã£ãŸã‚Šã™ã‚‹ã®ã§ã—ã‚‡ã†ã‹ã€‚ä»Šã®ã¾ã¾ã ã¨ã‚ˆã„ç‰¹å¾´é‡ã‚’æŠ½å‡ºã™ã‚‹ã“ã¨ãŒã§ãã¦ã„ãªã„ã‚ˆã†ã«æ€ã„ã¾ã™ã€‚ Youtubeã‹ã‚‰ãƒ‘ãƒ‰ãƒƒã‚¯å‹•ç”»ã‚’å–å¾—ã—ã¦ã€Encoder-Decoderãƒ¢ãƒ‡ãƒ«ã§è§£æã™ã‚‹ã¨ã“ã‚ã¾ã§ã‚„ã‚‰ãªã„ã¨ã†ã¾ãã„ã‹ãªã„ã‚“ã§ã™ã‹ã­ã€‚è‡ªåˆ†ã®å®ŸåŠ›ãŒååˆ†ä¸ŠãŒã‚Œã°æ˜¯éã‚„ã£ã¦ã¿ãŸã„ã¨æ€ã„ã¾ã™(ã„ã¤ã«ãªã‚‹ã“ã¨ã‚„ã‚‰)ã€‚ãã‚Œã¾ã§ã«ã¯ã€PCã®ã‚¹ãƒšãƒƒã‚¯ã‚’ä¸Šã’ãªã„ã¨ã„ã‘ã¾ã›ã‚“ã€‚å®šé¡çµ¦ä»˜é‡‘ã‚’ä½¿ã†ã‹ãªã€‚ã€‚ã€‚\n","date":1593907200,"expirydate":-62135596800,"kind":"page","lang":"ja","lastmod":1593907200,"objectID":"6dc680f46f0d2b9d9526697571eabba2","permalink":"/post/post18/","publishdate":"2020-07-05T00:00:00Z","relpermalink":"/post/post18/","section":"post","summary":"é¦¬ä½“å†™çœŸã¨ã„ã†æ–°ã—ã„è¦³ç‚¹ã‹ã‚‰ç«¶é¦¬äºˆæ¸¬ãƒ¢ãƒ‡ãƒ«ã‚’ä½œã‚Šã¾ã—ãŸã€‚","tags":["Python","Webã‚¹ã‚¯ãƒ¬ã‚¤ãƒ”ãƒ³ã‚°","æ©Ÿæ¢°å­¦ç¿’"],"title":"CNNã‚’ä½¿ã£ã¦é¦¬ä½“å†™çœŸã‹ã‚‰é †ä½äºˆæƒ³ã—ã¦ã¿ãŸ","type":"post"},{"authors":null,"categories":["å˜ç™º","Tips"],"content":"çš†ã•ã‚“ãŠã¯ã“ã‚“ã°ã‚“ã«ã¡ã¯ã€‚ æœ€è¿‘åœ¨å®…å‹¤å‹™ã§é‹å‹•ä¸è¶³ã§ã™ãŒã€å¹³æ—¥ä¼‘æ—¥å•ã‚ãšç ”ç©¶æ´»å‹•ã‚’ã—ã¦ã„ã¾ã™ã€‚ å­¦è¡“èªŒæŠ•ç¨¿ã‚’ç›®æŒ‡ã—ãŸBlogè¨˜äº‹ã«ã¯æ›¸ã‘ãªã„å†…å®¹ãªã®ã§ã€æ›´æ–°ã¯ã‚¹ãƒˆãƒƒãƒ—ã—ã¦ã—ã¾ã£ã¦ã„ã¾ã™ãŒã¡ã‚ƒã‚“ã¨æ´»å‹•ã¯ã—ã¦ã„ã¾ã™ã€‚\nä»Šå›ã¯ãã®ç ”ç©¶ã®ä¸­ã§åˆ©ç”¨ã—ã¦ã„ã‚‹MeCabã«ã¾ã¤ã‚ã‚‹Tipsã®ã”ç´¹ä»‹ã§ã™ã€‚MeCabã¨ã„ã†ã¨å½¢æ…‹ç´ è§£æã‚½ãƒ•ãƒˆã¨ã„ã†ã“ã¨ã¯ã“ã®ãƒ–ãƒ­ã‚°ã‚’èª­ã¾ã‚Œã¦ã„ã‚‹æ–¹ã¯ãŠåˆ†ã‹ã‚Šã‹ã¨æ€ã„ã¾ã™ãŒã€ãã®è¾æ›¸ã«NEologdè¾æ›¸ã‚’ä½¿ç”¨ã§ãã‚‹ã‚ˆã†ã«ã—ã¦ã¿ãŸã¨ã„ã†ã®ãŒå†…å®¹ã§ã™ã€‚MeCabã£ã¦ãªã«ï¼Ÿã¨ã„ã†æ–¹ã‚‚ã„ã‚‰ã£ã—ã‚ƒã‚‹ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ã®ã§ã€ã‹ãªã‚Šç°¡å˜ã«ã”ç´¹ä»‹ã—ã¾ã™ã€‚\n1. Mecab(RMeCab)ã¨ã¯ï¼Ÿ MeCabã¯æ—¥æœ¬èªãƒ†ã‚­ã‚¹ãƒˆãƒã‚¤ãƒ‹ãƒ³ã‚°ã§ä½¿ç”¨ã•ã‚Œã‚‹å½¢æ…‹ç´ è§£æã‚½ãƒ•ãƒˆã§ã™ã€‚è‹±èªãªã©ã®è¨€èªã¨ã¯ç•°ãªã‚Šã€æ—¥æœ¬èªã¯å˜èªæ¯ã«ã‚¹ãƒšãƒ¼ã‚¹ã‚’ç½®ã‹ãªã„ãŸã‚ã€ãƒ†ã‚­ã‚¹ãƒˆãƒã‚¤ãƒ‹ãƒ³ã‚°ã‚’è¡Œã†éš›ã€ãã®ã¾ã¾ã§ã¯æ–‡ç« ã‚’å˜èªå˜ä½ã«åŒºåˆ‡ã£ã¦é›†è¨ˆã™ã‚‹ã¨ã„ã£ãŸã“ã¨ãŒã§ãã¾ã›ã‚“ã€‚ä¾‹ãˆã°ã€ã€Œã“ã‚Œã¯ãƒšãƒ³ã§ã™ã€‚ã€ã¨ã„ã†æ–‡ç« ã¯ãã®ã¾ã¾ã§ã¯ã€Œã“ã‚Œã¯ãƒšãƒ³ã§ã™ã€‚ã€ã¨ã„ã†1ã¤ã®å˜èªã¨ã—ã¦èªè­˜ã•ã‚Œã¦ã—ã¾ã„ã¾ã™ã€‚ã§ã™ãŒã€å˜èªã®é »åº¦åˆ†æã‚’è¡Œã†éš›ãªã©ã¯ã€ã€Œã“ã‚Œ/ã¯/ãƒšãƒ³/ã§ã™/ã€‚ã€ã¨ã„ã†é¢¨ã«æ–‡ç« ã‚’å˜èªãƒ¬ãƒ™ãƒ«ã«ã¾ã§åˆ†å‰²ã—ã€ã€Œãƒšãƒ³ã€ã¨ã„ã†ç‰¹å¾´é‡ã‚’å–å¾—ã—ãŸã„ã‚ã‘ã§ã™ã€‚ãã‚ŒãŒã§ãã‚‹ã®ãŒRMeCabã§ã€ã“ã®å‡¦ç†ã¯å½¢æ…‹ç´ è§£æã¨å‘¼ã°ã‚Œã¾ã™ã€‚1ãã—ã¦ã€RMeCabã¨ã¯ã“ã®MeCabã®ãƒ©ãƒƒãƒ‘ãƒ¼ã«ãªã‚Šã¾ã™ã€‚Rã‹ã‚‰MeCabã‚’ä½¿ç”¨ã™ã‚‹ã«ã¯RMeCabã‚’ä½¿ç”¨ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚ä½¿ç”¨æ–¹æ³•ã¯ç°¡å˜ã§ã€RMeCabCé–¢æ•°ã«æ–‡ç« ã‚’æ¸¡ã™ã ã‘ã§ã™ã€‚\nlibrary(magrittr) library(RMeCab) RMeCabC(\u0026#34;ã“ã‚Œã¯ãƒšãƒ³ã§ã™ã€‚\u0026#34;) %\u0026gt;% unlist() ## åè© åŠ©è© åè© åŠ©å‹•è© è¨˜å· ## \u0026quot;ã“ã‚Œ\u0026quot; \u0026quot;ã¯\u0026quot; \u0026quot;ãƒšãƒ³\u0026quot; \u0026quot;ã§ã™\u0026quot; \u0026quot;ã€‚\u0026quot;\rRMeCabCé–¢æ•°ã¯çµæœã‚’ãƒªã‚¹ãƒˆã§è¿”ã—ã¦ãã‚‹ã®ã§ã€unlistã§characterã«å¤‰æ›ã—ã¦ã„ã¾ã™ã€‚\nå›ºæœ‰åè©ã«å¼±ã„ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã®MeCab ä¾¿åˆ©ãªã‚ˆã†ã«æ€ãˆã‚‹ã®ã§ã™ãŒã€ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã®MeCabã¯å›ºæœ‰åè©ã«å¼±ã„ã¨ã„ã†å¼±ç‚¹ãŒã‚ã‚Šã¾ã™ã€‚ä¾‹ãˆã°ã€ã€Œæ¬…å‚46ãŒèµ¤ã„ãã¤ã­ã‚’é£Ÿã¹ã¦ã„ã‚‹ã€‚ã€ã¨ã„ã†æ–‡ç« ã‚’å½¢æ…‹ç´ è§£æã—ã¦ã¿ã¾ã—ã‚‡ã†ã€‚\nRMeCabC(\u0026#34;æ¬…å‚46ãŒèµ¤ã„ãã¤ã­ã‚’é£Ÿã¹ã¦ã„ã‚‹ã€‚\u0026#34;) %\u0026gt;% unlist() ## åè© åè© åè© åŠ©è© å½¢å®¹è© åè© åŠ©è© å‹•è© ## \u0026quot;æ¬…\u0026quot; \u0026quot;å‚\u0026quot; \u0026quot;46\u0026quot; \u0026quot;ãŒ\u0026quot; \u0026quot;èµ¤ã„\u0026quot; \u0026quot;ãã¤ã­\u0026quot; \u0026quot;ã‚’\u0026quot; \u0026quot;é£Ÿã¹\u0026quot; ## åŠ©è© å‹•è© è¨˜å· ## \u0026quot;ã¦\u0026quot; \u0026quot;ã„ã‚‹\u0026quot; \u0026quot;ã€‚\u0026quot;\räºˆæƒ³ã—ã¦ã„ãŸçµæœã¯ã€Œæ¬…å‚46/ãŒ/èµ¤ã„ãã¤ã­/ã‚’/é£Ÿã¹/ã¦/ã„ã‚‹/ã€‚ã€ã§ã—ã‚‡ã†ã€‚ãŸã ã€å›ºæœ‰åè©ã‚’ä¸Šæ‰‹ãå½¢æ…‹ç´ è§£æã™ã‚‹ã“ã¨ãŒã§ãã¦ã„ãªã„ãŸã‚ã€ä¸å¿…è¦ãªã¨ã“ã‚ã§åˆ†å‰²ãŒãªã•ã‚Œã¦ãŠã‚Šã€ã€Œèµ¤ã„/ãã¤ã­/ã‚’/é£Ÿã¹ã€ã¨ã„ã†éƒ¨åˆ†ã«ã¤ã„ã¦ã¯ã€Œèµ¤ã„ï¼ˆå‹•ç‰©ã®ï¼‰ãã¤ã­ã€ã‚’é£Ÿã¹ã¦ã„ã‚‹ã‹ã®ã‚ˆã†ãªè§£æçµæœã«ãªã£ã¦ã„ã¾ã™ã€‚èµ¤ã„ãã¤ã­ã®ã€Œãã¤ã­ã€ã¨å‹•ç‰©ã®ã€Œãã¤ã­ã€ã‚’åŒç­‰ã«æ‰±ã£ã¦ã—ã¾ã†ã®ã§ã€å•é¡ŒãŒã‚ã‚Šã¾ã™ã€‚ã¾ãŸã€çµŒæ¸ˆã«ãŠã„ã¦ã‚‚ä»¥ä¸‹ã®ã‚ˆã†ã«æ—¥çµŒå¹³å‡æ ªä¾¡ãŒåˆ†å‰²ã•ã‚Œã€æ–°èç¤¾ã®ã€Œæ—¥çµŒã€ã¨æ ªä¾¡ã®ã€Œæ—¥çµŒã€ãŒã€å¤§çµ±é ˜ã®ã€Œãƒˆãƒ©ãƒ³ãƒ—ã€ã¨ã‚«ãƒ¼ãƒ‰ã®ã€Œãƒˆãƒ©ãƒ³ãƒ—ã€ãŒåŒºåˆ¥ã§ããªã„ã¨ã„ã£ãŸã“ã¨ãŒæƒ³å®šã•ã‚Œã¾ã™ã€‚\nRMeCabC(\u0026#34;ä»Šé€±ã®æ—¥çµŒå¹³å‡æ ªä¾¡ã¯ã€ä¸Šå€¤æŠµæŠ—ç·šã‚’çªç ´ã—ã¦ä¸Šæ˜‡ï¼\u0026#34;) %\u0026gt;% unlist() ## åè© åŠ©è© åè© åè© åè© åŠ©è© è¨˜å· åè© åè© åè© åŠ©è© ## \u0026quot;ä»Šé€±\u0026quot; \u0026quot;ã®\u0026quot; \u0026quot;æ—¥çµŒ\u0026quot; \u0026quot;å¹³å‡\u0026quot; \u0026quot;æ ªä¾¡\u0026quot; \u0026quot;ã¯\u0026quot; \u0026quot;ã€\u0026quot; \u0026quot;ä¸Šå€¤\u0026quot; \u0026quot;æŠµæŠ—\u0026quot; \u0026quot;ç·š\u0026quot; \u0026quot;ã‚’\u0026quot; ## åè© å‹•è© åŠ©è© åè© è¨˜å· ## \u0026quot;çªç ´\u0026quot; \u0026quot;ã—\u0026quot; \u0026quot;ã¦\u0026quot; \u0026quot;ä¸Šæ˜‡\u0026quot; \u0026quot;ï¼\u0026quot;\rRMeCabC(\u0026#34;ãƒˆãƒ©ãƒ³ãƒ—æ”¿æ¨©ã«ã‚ˆã‚‹çµŒæ¸ˆæ´»å‹•å†é–‹ã®æŒ‡é‡ç™ºè¡¨ãŒè©•ä¾¡ã•ã‚Œã‚‹\u0026#34;) %\u0026gt;% unlist() ## åè© åè© åŠ©è© åè© åè© åè© åŠ©è© ## \u0026quot;ãƒˆãƒ©ãƒ³ãƒ—\u0026quot; \u0026quot;æ”¿æ¨©\u0026quot; \u0026quot;ã«ã‚ˆã‚‹\u0026quot; \u0026quot;çµŒæ¸ˆ\u0026quot; \u0026quot;æ´»å‹•\u0026quot; \u0026quot;å†é–‹\u0026quot; \u0026quot;ã®\u0026quot; ## åè© åè© åŠ©è© åè© å‹•è© å‹•è© ## \u0026quot;æŒ‡é‡\u0026quot; \u0026quot;ç™ºè¡¨\u0026quot; \u0026quot;ãŒ\u0026quot; \u0026quot;è©•ä¾¡\u0026quot; \u0026quot;ã•\u0026quot; \u0026quot;ã‚Œã‚‹\u0026quot;\rã“ã‚Œã¯ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§MeCabãŒä½¿ç”¨ã—ã¦ã„ã‚‹è¾æ›¸ã«åŸå› ãŒã‚ã‚Šã¾ã™ã€‚IPAè¾æ›¸(ipadic)ã¨å‘¼ã°ã‚Œã‚‹ç‰©ã§ã€å¥ˆè‰¯å…ˆç«¯ç§‘å­¦æŠ€è¡“å¤§å­¦é™¢å¤§å­¦ãŒå…¬é–‹ã—ã¦ã„ã‚‹èŒ¶ç­Œã¨å‘¼ã°ã‚Œã‚‹å½¢æ…‹ç´ è§£æã‚½ãƒ•ãƒˆç”¨ã«ä½œã‚‰ã‚Œã¾ã—ãŸã€‚ã“ã¡ã‚‰ã‚’è¦‹ã‚‹ã¨è¾æ›¸ã®æ›´æ–°ã¯2007å¹´ã§ã‚¹ãƒˆãƒƒãƒ—ã—ã¦ãŠã‚Šã€æ–°èªã‚„æµè¡ŒèªãŒã‚¢ãƒƒãƒ—ãƒ‡ãƒ¼ãƒˆã•ã‚Œã¦ã„ãªã„ãŸã‚ã«ä¸Šè¨˜ã®å›ºæœ‰åè©ãŒä¸Šæ‰‹ãå½¢æ…‹ç´ è§£æã§ããªã„ã“ã¨ãŒã‚ã‹ã‚Šã¾ã™ã€‚\næ–°èªã«å¼·ã„NEologdè¾æ›¸ æœ€è¿‘MeCabã§ã‚ˆãä½¿ç”¨ã•ã‚Œã¦ã„ã‚‹è¾æ›¸ã«NEologdè¾æ›¸ã¨ã„ã†ã‚‚ã®ãŒã‚ã‚Šã¾ã™ã€‚NEologdè¾æ›¸ã¨ã¯ã€Webä¸Šã‹ã‚‰å¾—ãŸæ–°èªã«å¯¾å¿œã—ã¦ãŠã‚Šã€é »ç¹ã«æ›´æ–°ã•ã‚Œã‚‹MeCabç”¨ã®ã‚·ã‚¹ãƒ†ãƒ è¾æ›¸ã§ã™ã€‚2Twitterã®ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã«ã¯ã€\n ç‰¹è‰²ã¯èªå½™ã®å¤šã•ã¨æ›´æ–°é »åº¦ã€æ–°èªã®æ¡éŒ²ã®é€Ÿã•ã€èª­ã¿ä»®åã®æ­£ç¢ºã•ã€è¡¨è¨˜æºã‚Œã¸ã®å¯¾å¿œã€‚ãŠã‚‚ãªè§£æå¯¾è±¡ã¯Webä¸Šã®ãƒ‹ãƒ¥ãƒ¼ã‚¹è¨˜äº‹ã‚„æµè¡Œã—ãŸå‡ºæ¥äº‹ã€‚ ãŠã‚‚ãªç”¨é€”ã¯æ–‡æ›¸åˆ†é¡ã€æ–‡æ›¸ãƒ™ã‚¯ãƒˆãƒ«ä½œæˆã€å˜èªåŸ‹ã‚è¾¼ã¿ãƒ™ã‚¯ãƒˆãƒ«ä½œæˆã€èª­ã¿ä»®åä»˜ä¸ã€‚\n ã¨è¨˜è¼‰ã•ã‚Œã¦ãŠã‚Šã€ä¸Šè¿°ã—ãŸIPAè¾æ›¸ã®å¼±ç‚¹ã‚’è£œå®Œã™ã‚‹è¾æ›¸ã¨ãªã£ã¦ã„ã¾ã™ã€‚ä»Šå›ã®è¨˜äº‹ã¯ãã®è¾æ›¸ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«æ–¹æ³•ã«ã¤ã„ã¦ã§ã™ãŒã€ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ãŸè¾æ›¸ã®å¨åŠ›ã‚’å…ˆã«ãŠè¦‹ã›ã—ã¦ãŠãã¾ã™ã€‚å®Ÿè¡Œã™ã‚‹ã«ã¯ã€RMeCabé–¢æ•°ã«è¾æ›¸ãƒ•ã‚¡ã‚¤ãƒ«(.dicãƒ•ã‚¡ã‚¤ãƒ«)ã®ãƒ‘ã‚¹ã‚’æ¸¡ã—ã¦ã‚„ã‚Œã°è‰¯ã„ã§ã™ã€‚\ndic_directory \u0026lt;- \u0026#34;C:\\\\hogehoge\\\\mecab-user-dict-seed.yyyymmdd.dic\u0026#34; RMeCabC(\u0026#34;æ¬…å‚46ãŒèµ¤ã„ãã¤ã­ã‚’é£Ÿã¹ã¦ã„ã‚‹ã€‚\u0026#34;,dic=dic_directory) %\u0026gt;% unlist() ## åè© åŠ©è© åè© åŠ©è© å‹•è© åŠ©è© ## \u0026quot;æ¬…å‚46\u0026quot; \u0026quot;ãŒ\u0026quot; \u0026quot;èµ¤ã„ãã¤ã­\u0026quot; \u0026quot;ã‚’\u0026quot; \u0026quot;é£Ÿã¹\u0026quot; \u0026quot;ã¦\u0026quot; ## å‹•è© è¨˜å· ## \u0026quot;ã„ã‚‹\u0026quot; \u0026quot;ã€‚\u0026quot;\rRMeCabC(\u0026#34;ä»Šé€±ã®æ—¥çµŒå¹³å‡æ ªä¾¡ã¯ã€ä¸Šå€¤æŠµæŠ—ç·šã‚’çªç ´ã—ã¦ä¸Šæ˜‡ï¼\u0026#34;,dic=dic_directory) %\u0026gt;% unlist() ## åè© åŠ©è© åè© åŠ©è© è¨˜å· ## \u0026quot;ä»Šé€±\u0026quot; \u0026quot;ã®\u0026quot; \u0026quot;æ—¥çµŒå¹³å‡æ ªä¾¡\u0026quot; \u0026quot;ã¯\u0026quot; \u0026quot;ã€\u0026quot; ## åè© åè© åè© åŠ©è© åè© ## \u0026quot;ä¸Šå€¤\u0026quot; \u0026quot;æŠµæŠ—\u0026quot; \u0026quot;ç·š\u0026quot; \u0026quot;ã‚’\u0026quot; \u0026quot;çªç ´\u0026quot; ## å‹•è© åŠ©è© åè© è¨˜å· ## \u0026quot;ã—\u0026quot; \u0026quot;ã¦\u0026quot; \u0026quot;ä¸Šæ˜‡\u0026quot; \u0026quot;ï¼\u0026quot;\rRMeCabC(\u0026#34;ãƒˆãƒ©ãƒ³ãƒ—æ”¿æ¨©ã«ã‚ˆã‚‹çµŒæ¸ˆæ´»å‹•å†é–‹ã®æŒ‡é‡ç™ºè¡¨ãŒè©•ä¾¡ã•ã‚Œã‚‹\u0026#34;,dic=dic_directory) %\u0026gt;% unlist() ## åè© åŠ©è© åè© åè© åŠ©è© ## \u0026quot;ãƒˆãƒ©ãƒ³ãƒ—æ”¿æ¨©\u0026quot; \u0026quot;ã«ã‚ˆã‚‹\u0026quot; \u0026quot;çµŒæ¸ˆæ´»å‹•\u0026quot; \u0026quot;å†é–‹\u0026quot; \u0026quot;ã®\u0026quot; ## åè© åè© åŠ©è© åè© å‹•è© ## \u0026quot;æŒ‡é‡\u0026quot; \u0026quot;ç™ºè¡¨\u0026quot; \u0026quot;ãŒ\u0026quot; \u0026quot;è©•ä¾¡\u0026quot; \u0026quot;ã•\u0026quot; ## å‹•è© ## \u0026quot;ã‚Œã‚‹\u0026quot;\rä¸Šå€¤æŠµæŠ—ç·šã¯1èªã‚«ã‚¦ãƒ³ãƒˆã—ã¦ã»ã—ã„ã¨ã“ã‚ã§ã¯ã‚ã‚Šã¾ã™ãŒã€ãã‚Œä»¥å¤–ã¯ä¸Šæ‰‹ãå½¢æ…‹ç´ è§£æã§ãã¦ã„ãã†ã§ã™ã€‚ ã“ã®NEologdè¾æ›¸ã§ã™ãŒã€Windowsã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ãŒæƒ³å®šã•ã‚Œã¦ã„ã¾ã›ã‚“ã€‚ã¤ã¾ã‚Šã€Windowsãƒ¦ãƒ¼ã‚¶ãƒ¼ã¯ç›´æ¥ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹ã“ã¨ãŒã§ããªã„ã®ã§ã™ã€‚Windowsãƒ¦ãƒ¼ã‚¶ãƒ¼ã¯å°‘ã€…ã‚„ã‚„ã“ã—ã„æ‰‹é †ã‚’è¸ã¾ãªã‘ã‚Œã°ãªã‚Šã¾ã›ã‚“ã€‚ä»Šå›ã¯ãã®ã‚„ã‚„ã“ã—ã„æ‰‹é †ã‚’è§£èª¬ã™ã‚‹è¨˜äº‹ã§ã™ã€‚Linuxã§ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã‚’è¡Œã„ã€ãã‚Œã‚’Windowsç’°å¢ƒã«ã‚³ãƒ”ãƒ¼ã€ãã®å¾Œè¾æ›¸ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆã—ã¾ã™ã€‚\n2. ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«æ‰‹é † A. Windows Subsystem for Linux(WSL)ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ« Windows Power Shellã‚’ç®¡ç†è€…æ¨©é™ã§é–‹ãã€\nEnable-WindowsOptionalFeature -Online -FeatureName Microsoft-Windows-Subsystem-Linux ã‚’å®Ÿè¡Œã™ã‚‹ã€‚WSLã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚\n{width=100%}\nB. Ubuntu Linuxã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ« Microsoft Storeã‚ˆã‚Šubuntuã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã™ã‚‹ã€‚\n{width=100%}\nã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ãŒå®Œäº†ã—ãŸã‚‰ubuntuã‚’èµ·å‹•ã—ã€åˆæœŸè¨­å®šã‚’å®Œäº†ã•ã›ã‚‹(IDã€ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰)ã€‚\nC. Ubuntu Linuxã«MeCabã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ« ubuntuã®ã‚³ãƒãƒ³ãƒ‰ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã§ã€\nsudo apt-get update sudo apt install mecab sudo apt install libmecab-dev sudo apt install mecab-ipadic-utf8 ã‚’å…¥åŠ›ã—ã€MeCabã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã€‚\n{width=100%}\nD. Ubuntu for Linuxã«NEologdè¾æ›¸ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ« ubuntsuã®ã‚³ãƒãƒ³ãƒ‰ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã§\nsudo apt install make git clone --depth 1 https://github.com/neologd/mecab-ipadic-neologd.git cd mecab-ipadic-neologd sudo bin/install-mecab-ipadic-neologd -n -a ã‚’å®Ÿè¡Œã€‚NEologdè¾æ›¸ãƒ•ã‚¡ã‚¤ãƒ«ãŒ(/usr/lib/x86_64-linux-gnu/mecab/dic/mecab-ipadic-neologd/)ã«ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã§ãã¾ã™ã€‚\nE. Ubuntu for Linuxã‹ã‚‰Windowsã¸è¾æ›¸ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ã‚³ãƒ”ãƒ¼ ubuntuã®ã‚³ãƒãƒ³ãƒ‰ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã§\nexplorer.exe . ã‚’å…¥åŠ›ã€‚ã‚¨ã‚¯ã‚¹ãƒ—ãƒ­ãƒ¼ãƒ©ãƒ¼ãŒç«‹ã¡ä¸ŠãŒã‚‹ã®ã§ã€/usr/lib/x86_64-linux-gnu/mecab/dic/mecab-ipadic-neologd/(ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª)ã‚’Windowsã®ä»»æ„ã®ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«ã‚³ãƒ”ãƒ¼ã™ã‚‹ã€‚å®Œäº†ã—ãŸã‚‰Ubuntuã¯é–‰ã˜ã‚‹ã€‚\n{width=100%}\nF. Windowså†…ã§è¾æ›¸ãƒ•ã‚¡ã‚¤ãƒ«ã®ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«(SHIFT-JIS)ã‚’è¡Œã†ã€‚ ã‚³ãƒ”ãƒ¼ã—ãŸãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªå†…ã®ä»¥ä¸‹ã®csvã‚’è¾æ›¸ãƒ•ã‚¡ã‚¤ãƒ«(.dic)ã«ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã—ã¾ã™ã€‚(yyyymmddã¯è¾æ›¸ã®æœ€çµ‚æ›´æ–°æ—¥ãªã®ã§å¤‰æ›´ã—ã¦ãã ã•ã„)\n-mecab-ipadic-neologd-buildmecab-ipadic-2.7.0-20070801-neologd-yyyymmdd-mecab-user-dict-seed.yyyymmdd.csv ãã®éš›ã€å…ƒãƒ•ã‚¡ã‚¤ãƒ«ã¯ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ãŒUTF-8ã¨ãªã£ã¦ã„ã‚‹ã®ã§ã€SHIFT-JISã¸å¤‰æ›ã™ã‚‹ã“ã¨ã«æ³¨æ„ã§ã™ã€‚ã“ã‚Œã‚’ã—ãªã„ã¨ã€RMeCabã‚’å®Ÿè¡Œã—ãŸã¨ãã«çµæœãŒæ–‡å­—åŒ–ã‘ã—ã¾ã™ã€‚ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã«ã¯MeCabã®mecab-dict-indexã¨ã„ã†ãƒã‚¤ãƒŠãƒªãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½¿ç”¨ã—ã¾ã™ã€‚è‡ªåˆ†ã¯ä»¥ä¸‹ã®ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«å­˜åœ¨ã—ã¾ã—ãŸã€‚\nC: -Program Files (x86) -MeCab -bin -mecab-dict-index.exe\n{width=100%}\nã‚³ãƒãƒ³ãƒ‰ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã‚’ç«‹ã¡ä¸Šã’ã€\nC:\\Program Files (x86)\\MeCab\\bin\\mecab-dict-index.exe -d .../mecab-ipadic-neologd/buildmecab/ipadic-2.7.0-20070801-neologd-yyyymmdd(ãƒ•ã‚¡ã‚¤ãƒ«ã®ä¿å­˜å ´æ‰€) -u NEologd.yyyymmdd.dic -f utf-8 -t shift-jis mecab-ipadic-neologd\\buildmecab\\ipadic-2.7.0-20070801-neologd-yyyymmdd\\mecab-user-dict-seed.yyyymmdd.csv ã‚’é©å®œå¤‰æ›´ã®ä¸Šã€å…¥åŠ›ã€‚.../mecab-ipadic-neologd/buildmecab/ipadic-2.7.0-20070801-neologd-yyyymmddã«è¾æ›¸ãŒã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã•ã‚Œã€NEologd.yyyymmdd.dicãŒã§ãã¾ã™ã€‚\n3. ã¾ã¨ã‚ ä»¥ä¸Šã§ã€NEologdè¾æ›¸ãŒä½¿ç”¨ã§ãã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚éå¸¸ã«å¼·åŠ›ãªãƒ„ãƒ¼ãƒ«ãªã®ã§ä½¿ç”¨ã—ã¦ã¿ã¦ãã ã•ã„ã€‚ãªãŠã€è¾æ›¸ãŒã‚¢ãƒƒãƒ—ãƒ‡ãƒ¼ãƒˆã•ã‚ŒãŸéš›ã¯åŒã˜æ‰‹ç¶šãã‚’è¡Œã†å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚\n\u0026lt;å¾Œæ—¥è«‡\u0026gt; Ubuntu for Linuxã‚’ä½¿ç”¨ã—ãªãã¦ã‚‚ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã§ããã†ãªæ–¹æ³•ã‚ã‚Šã¾ã—ãŸã€‚\nhttps://qiita.com/zincjp/items/c61c441426b9482b5a48\nãŸã ã€è‡ªåˆ†ã¯å®Ÿè¡Œã—ã¦ã„ãªã„ã®ã§å®Ÿéš›ã«ã§ãã‚‹ã‹ã¯ã‚ã‹ã‚Šã¾ã›ã‚“ã€‚è¾æ›¸ãŒæ›´æ–°ã•ã‚ŒãŸã‚‰ã€ã‚„ã£ã¦ã¿ãŸã„ã¨æ€ã„ã¾ã™ã€‚\n  MeCabå†…éƒ¨ã®ä»•çµ„ã¿ã«ã¤ã„ã¦ã¯ã“ã¡ã‚‰ã®è¨˜äº‹ãŒå‚è€ƒã«ãªã‚Šã¾ã™ã€‚ \u0026#x21a9;\u0026#xfe0e;\n 2020/4/19æ™‚ç‚¹ã®æœ€è¿‘ç‰ˆã¯2020/3/15æ›´æ–°ã®è¾æ›¸ã§ã™ã€‚ \u0026#x21a9;\u0026#xfe0e;\n   ","date":1587254400,"expirydate":-62135596800,"kind":"page","lang":"ja","lastmod":1587254400,"objectID":"76148b2112439101151e4d7e3e7f6986","permalink":"/post/post17/","publishdate":"2020-04-19T00:00:00Z","relpermalink":"/post/post17/","section":"post","summary":"æ–°èªã«å¼·ã„NEologdè¾æ›¸ã‚’Mecabã«ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¦ã¿ã¾ã—ãŸã€‚","tags":["R","ãƒ†ã‚­ã‚¹ãƒˆãƒã‚¤ãƒ‹ãƒ³ã‚°"],"title":"Windowsã«NEologdè¾æ›¸ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¦ã€RMeCabã‚’å®Ÿè¡Œã™ã‚‹æ–¹æ³•","type":"post"},{"authors":null,"categories":["ç«¶é¦¬"],"content":"ãŠã¯ã“ã‚“ã°ã‚“ã«ã¡ã¯ã€‚ã‹ãªã‚Šä¹…ã—ã¶ã‚Šã§ã¯ã‚ã‚Šã¾ã™ãŒã€Pythonã®å‹‰å¼·ã‚’ã‹ã­ã¦ä»¥å‰yahoo.keibaã§åé›†ã—ãŸç«¶é¦¬ã®ãƒ¬ãƒ¼ã‚¹çµæœãƒ‡ãƒ¼ã‚¿ã‹ã‚‰ã€ãƒ¬ãƒ¼ã‚¹çµæœã‚’äºˆæƒ³ã™ã‚‹ãƒ¢ãƒ‡ãƒ«ã‚’ä½œæˆã—ãŸã„ã¨æ€ã„ã¾ã™ã€‚\n1.ãƒ‡ãƒ¼ã‚¿ã‚¤ãƒ³ãƒãƒ¼ãƒˆ ã¾ãšã€å‰å›sqliteã«ä¿å­˜ã—ãŸãƒ¬ãƒ¼ã‚¹çµæœãƒ‡ãƒ¼ã‚¿ã‚’pandasãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ¬ãƒ¼ãƒ ã¸ä¿å­˜ã—ã¾ã™ã€‚\nconn = sqlite3.connect(r\u0026#39;C:\\hogehoge\\horse_data.db\u0026#39;) sql = r\u0026#39;SELECT * FROM race_result\u0026#39; df = pd.read_sql(con=conn,sql=sql) ãƒ‡ãƒ¼ã‚¿ã®ä¸­èº«ã‚’ç¢ºèªã—ã¦ã¿ã¾ã—ã‚‡ã†ã€‚åˆ—ã¯ä»¥ä¸‹ã®ã‚ˆã†ã«ãªã£ã¦ã„ã¾ã™ã€‚orderãŒç€é †ã¨ãªã£ã¦ã„ã¾ã™ã€‚\ndf.columns ## Index(['order', 'frame_number', 'horse_number', 'trainer', 'passing_rank',\r## 'last_3F', 'time', 'margin', 'horse_name', 'horse_age', 'horse_sex',\r## 'horse_weight', 'horse_weight_change', 'brinker', 'jockey',\r## 'jockey_weight', 'jockey_weight_change', 'odds', 'popularity',\r## 'race_date', 'race_course', 'race_name', 'race_distance', 'type',\r## 'race_turn', 'race_condition', 'race_weather', 'colour', 'owner',\r## 'farm', 'locality', 'horse_birthday', 'father', 'mother', 'prize',\r## 'http'],\r## dtype='object')\rorderã®ä¸­èº«ã‚’ç¢ºèªã—ã¦ã¿ã‚‹ã¨ã€æ‹¬å¼§ï¼ˆï¼‰ãŒã¤ã„ã¦ã„ã‚‹ç‰©ãŒå¤šãã€ã¾ãŸå–æ¶ˆã‚„ä¸­æ­¢ã€å¤±æ ¼ãªã©ãŒå­˜åœ¨ã™ã‚‹ãŸã‚ã€æ–‡å­—å‹ã«èªè­˜ã•ã‚Œã¦ã„ã‚‹ã“ã¨ãŒã‚ã‹ã‚Šã¾ã™ã€‚ã¡ãªã¿ã«æ‹¬å¼§ï¼ˆï¼‰å†…ã®é †ä½ã¯å…¥ç·šé †ä½ã¨ã„ã†ã‚„ã¤ã§ã€ä»–é¦¬ã®èµ°è¡Œã‚’å¦¨å®³ã—ãŸã‚Šã—ã¦é †ä½ãŒé™ç€ã•ã›ã‚‰ã‚ŒãŸã“ã¨ã‚’æ„å‘³ã—ã¾ã™ï¼ˆhttp://www.jra.go.jp/judge/ï¼‰ã€‚\ndf.loc[:,\u0026#39;order\u0026#39;].unique() ## array(['1', '7', '2', '8', '5', '15', '6', '12', '11', '14', '3', '13',\r## '4', '16', '9', '10', 'å–æ¶ˆ', 'ä¸­æ­¢', 'é™¤å¤–', '17', '18', '4(3)', '2(1)',\r## '3(2)', '6(4)', 'å¤±æ ¼', '9(8)', '16(6)', '12(12)', '13(9)', '6(3)',\r## '10(7)', '6(5)', '9(3)', '11(8)', '13(2)', '12(9)', '14(7)',\r## '10(1)', '16(8)', '14(6)', '10(3)', '12(1)', '13(6)', '7(1)',\r## '12(6)', '6(2)', '11(2)', '15(6)', '13(10)', '14(4)', '7(5)',\r## '17(4)', '9(7)', '16(14)', '12(11)', '14(2)', '8(2)', '9(5)',\r## '11(5)', '12(7)', '11(1)', '12(8)', '7(4)', '5(4)', '13(12)',\r## '14(3)', '10(2)', '11(10)', '18(3)', '10(4)', '15(8)', '8(3)',\r## '5(1)', '10(5)', '7(3)', '5(2)', '9(1)', '13(3)', '16(11)',\r## '11(3)', '18(15)', '11(6)', '10(6)', '14(12)', '12(5)', '15(14)',\r## '17(8)', '18(6)', '4(2)', '18(10)', '16(7)', '13(1)', '16(10)',\r## '15(7)', '9(4)', '15(5)', '12(3)', '8(7)', '15(2)', '12(10)',\r## '14(9)', '3(1)', '6(1)', '14(5)', '15(4)', '11(4)', '12(4)',\r## '16(4)', '9(2)', '13(5)', '12(2)', '15(1)', '4(1)', '14(13)',\r## '14(1)', '13(7)', '5(3)', '8(6)', '15(13)', '7(2)', '15(11)',\r## '10(9)', '11(9)', '8(4)', '15(3)', '13(4)', '16(12)', '16(5)',\r## '18(11)', '10(8)', '18(8)', '14(8)', '16(9)', '8(5)', '8(1)',\r## '14(11)', '9(6)', '16(13)', '16(15)', '11(11)', '15(10)', '7(6)'],\r## dtype=object)\rã¾ãšã“ã“ã‚’ä¿®æ­£ã—ã¾ã—ã‚‡ã†ã€‚æ‹¬å¼§ã‚’é™¤å»ã—ã¦intå‹ã«å‹å¤‰æ›´ã—ã€å…¥ç·šé †ä½ã¯æ–°ãŸãªåˆ—arriving orderã¨ã—ã¦è¿½åŠ ã—ã¾ã™ã€‚\ndf[\u0026#39;arriving order\u0026#39;] = df[df.order.str.contains(r\u0026#39;\\d*\\(\\d*\\)\u0026#39;,regex=True)][\u0026#39;order\u0026#39;].replace(r\u0026#39;\\d+\\(\u0026#39;,r\u0026#39;\u0026#39;,regex=True).replace(r\u0026#39;\\)\u0026#39;,r\u0026#39;\u0026#39;,regex=True).astype(\u0026#39;float64\u0026#39;) df[\u0026#39;arriving order\u0026#39;].unique() ## array([nan, 3., 1., 2., 4., 8., 6., 12., 9., 7., 5., 10., 14.,\r## 11., 15., 13.])\rdf[\u0026#39;order\u0026#39;] = df[\u0026#39;order\u0026#39;].replace(r\u0026#39;\\(\\d+\\)\u0026#39;,r\u0026#39;\u0026#39;,regex=True) df = df[lambda df: ~df.order.str.contains(r\u0026#39;(å–æ¶ˆ|ä¸­æ­¢|é™¤å¤–|å¤±æ ¼)\u0026#39;,regex=True)] ## C:\\Users\\aashi\\ANACON~1\\lib\\site-packages\\pandas\\core\\strings.py:1954: UserWarning: This pattern has match groups. To actually get the groups, use str.extract.\r## return func(self, *args, **kwargs)\rdf[\u0026#39;order\u0026#39;] = df[\u0026#39;order\u0026#39;].astype(\u0026#39;float64\u0026#39;) df[\u0026#39;order\u0026#39;].unique() ## array([ 1., 7., 2., 8., 5., 15., 6., 12., 11., 14., 3., 13., 4.,\r## 16., 9., 10., 17., 18.])\rãã‚Œã„ãªfloatå‹ã«å‡¦ç†ã™ã‚‹ã“ã¨ãŒã§ãã¾ã—ãŸã€‚ã§ã¯ã€æ¬¡ã«ãƒ©ã‚¹ãƒˆ3Fã®ã‚¿ã‚¤ãƒ ã®å‰å‡¦ç†ã«ç§»ã‚Šã¾ã™ã€‚å‰èµ°ã®ãƒ©ã‚¹ãƒˆ3Fã®ã‚¿ã‚¤ãƒ ã‚’äºˆæ¸¬ã«ä½¿ç”¨ã—ã¾ã™ã€‚\nimport numpy as np df[\u0026#39;last_3F\u0026#39;] = df[\u0026#39;last_3F\u0026#39;].replace(r\u0026#39;character(0)\u0026#39;,np.nan,regex=False).astype(\u0026#39;float64\u0026#39;) df[\u0026#39;last_3F\u0026#39;] = df.groupby(\u0026#39;horse_name\u0026#39;)[\u0026#39;last_3F\u0026#39;].shift(-1) å‰èµ°ã®ãƒ¬ãƒ¼ã‚¹ã¨é †ä½ã€è¿½åŠ é †ä½ã‚‚ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã¸å«ã‚ã¾ã—ã‚‡ã†ã€‚\ndf[\u0026#39;prerace\u0026#39;] = df.groupby(\u0026#39;horse_name\u0026#39;)[\u0026#39;race_name\u0026#39;].shift(-1) df[\u0026#39;preorder\u0026#39;] = df.groupby(\u0026#39;horse_name\u0026#39;)[\u0026#39;order\u0026#39;].shift(-1) df[\u0026#39;prepassing\u0026#39;] = df.groupby(\u0026#39;horse_name\u0026#39;)[\u0026#39;passing_rank\u0026#39;].shift(-1) å‡ºèµ°æ™‚ç‚¹ã§ç²å¾—ã—ã¦ã„ã‚‹ç´¯ç©è³é‡‘é¡ã‚‚è¿½åŠ ã—ã¾ã™ã€‚\ndf[\u0026#39;preprize\u0026#39;] = df.groupby(\u0026#39;horse_name\u0026#39;)[\u0026#39;prize\u0026#39;].shift(-1) df[\u0026#39;preprize\u0026#39;] = df[\u0026#39;preprize\u0026#39;].fillna(0) df[\u0026#39;margin\u0026#39;] = df.groupby(\u0026#39;horse_name\u0026#39;)[\u0026#39;margin\u0026#39;].shift(-1) ãã®ä»–ã€æ¬ æå€¤ã‚„ãƒ‡ãƒ¼ã‚¿å‹ã®ä¿®æ­£ã€ã‚«ãƒ†ã‚´ãƒªãƒ‡ãƒ¼ã‚¿ã®ãƒ©ãƒ™ãƒ«ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã§ã™ã€‚\ndf[\u0026#39;horse_weight\u0026#39;] = df[\u0026#39;horse_weight\u0026#39;].astype(\u0026#39;float64\u0026#39;) df[\u0026#39;margin\u0026#39;] = df[\u0026#39;margin\u0026#39;].replace(r\u0026#39;character(0)\u0026#39;,np.nan,regex=False) df[\u0026#39;horse_age\u0026#39;] = df[\u0026#39;horse_age\u0026#39;].astype(\u0026#39;float64\u0026#39;) df[\u0026#39;horse_weight_change\u0026#39;] = df[\u0026#39;horse_weight_change\u0026#39;].astype(\u0026#39;float64\u0026#39;) df[\u0026#39;jockey_weight\u0026#39;] = df[\u0026#39;jockey_weight\u0026#39;].astype(\u0026#39;float64\u0026#39;) df[\u0026#39;race_distance\u0026#39;] = df[\u0026#39;race_distance\u0026#39;].replace(r\u0026#39;m\u0026#39;,r\u0026#39;\u0026#39;,regex=True).astype(\u0026#39;float64\u0026#39;) df[\u0026#39;race_turn\u0026#39;] = df[\u0026#39;race_turn\u0026#39;].replace(r\u0026#39;character(0)\u0026#39;,np.nan,regex=False) df.loc[df[\u0026#39;order\u0026#39;]!=1,\u0026#39;order\u0026#39;] = 0 df[\u0026#39;race_turn\u0026#39;] = df[\u0026#39;race_turn\u0026#39;].fillna(\u0026#39;missing\u0026#39;) df[\u0026#39;colour\u0026#39;] = df[\u0026#39;colour\u0026#39;].fillna(\u0026#39;missing\u0026#39;) df[\u0026#39;prepassing\u0026#39;] = df[\u0026#39;prepassing\u0026#39;].fillna(\u0026#39;missing\u0026#39;) df[\u0026#39;prerace\u0026#39;] = df[\u0026#39;prerace\u0026#39;].fillna(\u0026#39;missing\u0026#39;) df[\u0026#39;father\u0026#39;] = df[\u0026#39;father\u0026#39;].fillna(\u0026#39;missing\u0026#39;) df[\u0026#39;mother\u0026#39;] = df[\u0026#39;mother\u0026#39;].fillna(\u0026#39;missing\u0026#39;) from sklearn import preprocessing cat_list = [\u0026#39;trainer\u0026#39;, \u0026#39;horse_name\u0026#39;, \u0026#39;horse_sex\u0026#39;, \u0026#39;brinker\u0026#39;, \u0026#39;jockey\u0026#39;, \u0026#39;race_course\u0026#39;, \u0026#39;race_name\u0026#39;, \u0026#39;type\u0026#39;, \u0026#39;race_turn\u0026#39;, \u0026#39;race_condition\u0026#39;, \u0026#39;race_weather\u0026#39;, \u0026#39;colour\u0026#39;, \u0026#39;father\u0026#39;, \u0026#39;mother\u0026#39;, \u0026#39;prerace\u0026#39;, \u0026#39;prepassing\u0026#39;] for column in cat_list: target_column = df[column] le = preprocessing.LabelEncoder() le.fit(target_column) label_encoded_column = le.transform(target_column) df[column] = pd.Series(label_encoded_column).astype(\u0026#39;category\u0026#39;) import pandas_profiling as pdq profile = pdq.ProfileReport(df) profile 2. äºˆæ¸¬ãƒ¢ãƒ‡ãƒ«ã®ä½œæˆ ã§ã¯LightGBMã§äºˆæ¸¬ãƒ¢ãƒ‡ãƒ«ã‚’ä½œã£ã¦ã¿ã¾ã™ã€‚optunaã®LightGBMã‚’ä½¿ç”¨ã—ã¦ã€ãƒã‚¤ãƒ‘ãƒ¼ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãƒãƒ¥ãƒ¼ãƒ‹ãƒ³ã‚°ã‚’è¡Œã„ã€å­¦ç¿’ã—ãŸãƒ¢ãƒ‡ãƒ«ã‚’ç”¨ã„ã¦è¨ˆç®—ã—ãŸãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ã®äºˆæ¸¬å€¤ã¨å®Ÿç¸¾å€¤ã®confusion matrixãªã‚‰ã³ã«æ­£è§£ç‡ã‚’ç®—å‡ºã—ã¾ã™ã€‚\nimport optuna.integration.lightgbm as lgb from sklearn.model_selection import train_test_split y = df[\u0026#39;order\u0026#39;] x = df.drop([\u0026#39;order\u0026#39;,\u0026#39;passing_rank\u0026#39;,\u0026#39;time\u0026#39;,\u0026#39;odds\u0026#39;,\u0026#39;popularity\u0026#39;,\u0026#39;owner\u0026#39;,\u0026#39;farm\u0026#39;,\u0026#39;locality\u0026#39;,\u0026#39;horse_birthday\u0026#39;,\u0026#39;http\u0026#39;,\u0026#39;prize\u0026#39;,\u0026#39;race_date\u0026#39;,\u0026#39;margin\u0026#39;],axis=1) X_train, X_test, y_train, y_test = train_test_split(x, y) X_train, x_val, y_train, y_val = train_test_split(X_train, y_train) lgb_train = lgb.Dataset(X_train, y_train) lgb_eval = lgb.Dataset(x_val, y_val) lgb_test = lgb.Dataset(X_test, y_test, reference=lgb_train) lgbm_params = { \u0026#39;objective\u0026#39;: \u0026#39;binary\u0026#39;, \u0026#39;boost_from_average\u0026#39;: False } model = lgb.train(lgbm_params, lgb_train, categorical_feature = cat_list, valid_sets = lgb_eval, num_boost_round=100, early_stopping_rounds=20, verbose_eval=False) def calibration(y_proba, beta): return y_proba / (y_proba + (1 - y_proba) / beta) sampling_rate = y_train.sum() / len(y_train) y_proba = model.predict(X_test, num_iteration=model.best_iteration) y_proba_calib = calibration(y_proba, sampling_rate) y_pred = np.vectorize(lambda x: 1 if x \u0026gt; 0.49 else 0)(y_proba_calib) å¯è¦–åŒ–ãƒ‘ãƒ¼ãƒˆã§ã™ã€‚\nfrom sklearn.metrics import confusion_matrix, ConfusionMatrixDisplay, accuracy_score, precision_score, recall_score, f1_score import matplotlib.pyplot as plt # Confusion Matrixã‚’ç”Ÿæˆ ConfusionMatrixDisplay(confusion_matrix(y_test, y_pred)).plot() ## \u0026lt;sklearn.metrics._plot.confusion_matrix.ConfusionMatrixDisplay object at 0x00000000C3E2F7C8\u0026gt;\rplt.show() plt.close() accuracy_score(y_test, y_pred) ## 0.9299209299125913\rprecision_score(y_test, y_pred) ## 0.9401709401709402\raccuracy_scoreï¼ˆäºˆæ¸¬ç²¾åº¦ï¼‰ãŒ90%ã‚’è¶…ãˆã€precision_Scoreï¼ˆé©åˆç‡ã€é™½=1ç€ã¨äºˆæƒ³ã—ãŸãƒ‡ãƒ¼ã‚¿ã®æ­£è§£ç‡ï¼‰ã‚‚ã„ã„æ„Ÿã˜ã§ã™ã€‚\nrecall_score(y_test, y_pred) ## 0.009727052997700878\rf1_score(y_test, y_pred) ## 0.019254893952212852\rä¸€æ–¹ã€recall_score(å†ç¾æ€§ã€é™½=1ç€ã®ã‚µãƒ³ãƒ—ãƒ«ã®ã†ã¡å®Ÿéš›ã«æ­£è§£ã—ãŸå‰²åˆ)ãŒä½ãå½é™°æ€§ãŒé«˜ã„ã“ã¨ãŒç¢ºèªã§ãã¾ã™ã€‚ãã®çµæœã€F1å€¤ã‚‚ä½ããªã£ã¦ã„ã¾ã™ã­ã€‚ç«¶é¦¬äºˆæ¸¬ãƒ¢ãƒ‡ãƒ«ã®å ´åˆã€å½é™°æ€§ãŒé«˜ã„ã“ã¨ã¯å½é™½æ€§ãŒé«˜ã„ã“ã¨ã‚ˆã‚Šã¯ã¾ã—ãªã®ã§ã™ãŒã€å›åç‡ã‚’ä¸Šã’ã‚‹ãŸã‚ã«ã¯å½é™°æ€§ã‚’ä¸‹ã’ã‚‹ã“ã¨ã‚’é ‘å¼µã‚‰ãªã‘ã‚Œã°ã„ã‘ã¾ã›ã‚“ã€‚ã“ã‚Œã¯ä»Šå¾Œã®èª²é¡Œã§ã™ã­ã€‚æ¬¡ç¯€ã§ã¯shapleyå€¤ã‚’ä½¿ã£ã¦è¦å› åˆ†è§£ã‚’ã—ãŸã„ã¨æ€ã„ã¾ã™ã€‚ã€‚\n3. shapã§ã®çµæœè§£é‡ˆ import shap shap.initjs() ## \u0026lt;IPython.core.display.HTML object\u0026gt;\rexplainer = shap.TreeExplainer(model) ## Setting feature_perturbation = \u0026quot;tree_path_dependent\u0026quot; because no background data was given.\rshap_values = explainer.shap_values(X_test) ## LightGBM binary classifier with TreeExplainer shap values output has changed to a list of ndarray\rã¾ãšã€å„ç‰¹å¾´é‡ã®é‡è¦åº¦ã‚’è¦‹ã‚‹ã“ã¨ã«ã—ã¾ã™ã€‚summary_plotãƒ¡ã‚½ãƒƒãƒ‰ã‚’ä½¿ç”¨ã—ã¾ã™ã€‚\nshap.summary_plot(shap_values, X_test) æ¨ªè»¸ã¯å„ç‰¹å¾´é‡ã®å¹³å‡çš„ãªé‡è¦åº¦ã‚’è¡¨ã—ã¦ã„ã¾ã™(shapå€¤ã®çµ¶å¯¾å€¤)ã€‚preprize(å‰èµ°ã¾ã§ã®è³é‡‘ç²å¾—é‡‘é¡)ã‚„horse_ageã€preorder(å‰èµ°ã®ç€é †)ãªã©ãŒäºˆæ¸¬ã«é‡è¦ã§ã‚ã‚‹ã“ã¨ãŒåˆ†ã‹ã‚Šã¾ã™ã€‚ç‰¹ã«preprizeã®é‡è¦åº¦ã¯1ç€ã®äºˆæ¸¬ã€1ç€ä»¥å¤–ã®äºˆæ¸¬ã©ã¡ã‚‰ã«å¯¾ã—ã¦ã‚‚å¤§ãã„ã§ã™ã€‚horse_ageã‚‚åŒæ§˜ã§ã™ã€‚ãŸã ã€ã“ã‚Œã§ã¯é‡è¦ã¨ã„ã†ã ã‘ã§å®šæ€§çš„ãªè©•ä¾¡ã¯ã§ãã¾ã›ã‚“ã€‚ä¾‹ãˆã°ã€preprizeãŒå¤§ãã„â†’1ä½ã«ãªã‚‹ç¢ºç‡ãŒä¸Šæ˜‡ã¨ã„ã£ãŸé–¢ä¿‚ãŒç¢ºèªã§ãã‚Œã°ã€ãã‚Œã¯é‡è¦ãªæƒ…å ±ã«ãªã‚Šå¾—ã¾ã™ã€‚æ¬¡ã«ãã‚Œã‚’ç¢ºèªã—ã¾ã™ã€‚summary_plotãƒ¡ã‚½ãƒƒãƒ‰ã‚’ä½¿ç”¨ã—ã¾ã™ã€‚\nshap.summary_plot(shap_values[1], X_test) ä¸Šå›³ã‚‚å„ç‰¹å¾´é‡ã®é‡è¦åº¦ã‚’è¡¨ã—ã¦ã„ã¾ã™(ä»Šå›ã¯çµ¶å¯¾å€¤ã§ã¯ã‚ã‚Šã¾ã›ã‚“)ã€‚ä»Šå›ã¯ãã‚Œãã‚Œã®ç‰¹å¾´é‡ã®é‡è¦åº¦ãŒãƒã‚¤ã‚ªãƒªãƒ³ãƒ—ãƒ­ãƒƒãƒˆã«ã‚ˆã£ã¦è¡¨ã•ã‚Œã¦ãŠã‚Šã€ã‹ã¤ç‰¹å¾´é‡ã®å€¤ã®å¤§ãã•ã§è‰²åˆ†ã‘ãŒã•ã‚Œã¦ã„ã¾ã™ã€‚ä¾‹ãˆã°ã€preprizeã ã¨æ¨ªè»¸ãŒ0ä»¥ä¸Šã®éƒ¨åˆ†ã§ã®ã¿èµ¤è‰²ã®åˆ†å¸ƒãŒç™ºç”Ÿã—ã¦ãŠã‚Šã€ã“ã“ã‹ã‚‰preprizeã®ç‰¹å¾´é‡ãŒå¤§ãã„ã€ã¤ã¾ã‚Šå‰èµ°ã¾ã§ã®ç²å¾—è³é‡‘é¡ãŒå¤šã„ã¨å¹³å‡çš„ã«1ç€ã®ç¢ºç‡ãŒä¸ŠãŒã‚‹ã¨ã„ã†å½“ãŸã‚Šå‰ã®è§£é‡ˆã‚’ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚ ä»–ã«ã‚‚ã€horse_age,preorder,last_3Fã¯ç‰¹å¾´é‡ãŒå°ã•ããªã‚‹ã»ã©1ç€ã«ãªã‚‹ç¢ºç‡ãŒã‚ãŒã‚‹ã“ã¨ã‚‚èª­ã¿å–ã‚Œã¾ã™ã€‚horse_weight, jokey_weightã¯å¤§ãããªã‚‹ã»ã©1ç€ã«ãªã‚‹ç¢ºç‡ãŒä¸ŠãŒã‚‹ã‚ˆã†ã§ã™ã€‚ä¸€æ–¹ã€ãã®ä»–ã¯ç‰¹ã«å®šæ€§çš„ãªé–¢ä¿‚ã‚’èª­ã¿å–ã‚‹ã“ã¨ã¯ã§ãã¾ã›ã‚“ã€‚\næ¬¡ã«ã€ç‰¹å¾´é‡ã¨ç¢ºç‡ã®é–¢ä¿‚ã‚’ã‚ˆã‚Šè©³ã—ãç¢ºèªã—ã¦ã¿ã¾ã—ã‚‡ã†ã€‚å…ˆã»ã©ã€preprizeã¯ç‰¹å¾´é‡ãŒå¤§ãããªã‚‹ã»ã©1ç€ã«ãªã‚‹ç¢ºç‡ãŒä¸Šæ˜‡ã™ã‚‹ã¨ã„ã†ã“ã¨ãŒã‚ã‹ã‚Šã¾ã—ãŸã€‚ãŸã ã€ãã®ç¢ºç‡ã®ä¸Šæ˜‡ã¯1æ¬¡é–¢æ•°çš„ã«å¢—åŠ ã™ã‚‹ã®ã‹ã€æŒ‡æ•°çš„ã«å¢—å¤§ã™ã‚‹ã®ã‹ã€ãã‚Œã¨ã‚‚$\\log x$ã®ã‚ˆã†ã«é€“æ¸›ã—ã¦ã„ãã®ã‹ã€ã‚ã‹ã‚Šã¾ã›ã‚“ã€‚dependence_plotã‚’ä½¿ç”¨ã—ã¦ãã‚Œã‚’ç¢ºèªã—ã¦ã¿ã¾ã—ã‚‡ã†ã€‚\nshap.dependence_plot(ind=\u0026#34;preprize\u0026#34;, shap_values=shap_values[1], features=X_test) ä¸Šå›³ã¯å­¦ç¿’ã—ãŸLightGBMã‚’preprizeã®é–¢æ•°ã¨ã—ã¦è¦‹ãŸã¨ãã®æ¦‚å½¢ã‚’plotã—ãŸã‚‚ã®ã§ã™ã€‚å…ˆã«ç¢ºèªã—ãŸã¨ãŠã‚Šã€ã‚„ã¯ã‚Šç‰¹å¾´é‡ãŒå¤§ãããªã‚‹ã«ã¤ã‚Œã€1ç€ã«ãªã‚‹ç¢ºç‡ãŒä¸Šæ˜‡ã—ã¦ã„ãã¾ã™ã€‚ãŸã ã€ãã®ä¸Šæ˜‡ã¯å¾ã€…ã«é€“æ¸›ã—ã¦ã„ãã€2000ä¸‡å††ã‚’è¶…ãˆã‚‹ã¨ã“ã‚ã§ã»ã¼é ­æ‰“ã¡ã¨ãªã‚Šã¾ã™ã€‚ã¾ãŸã€ä¸Šå›³ã§ã¯horse_ageã§ã®è‰²åˆ†ã‘ã‚’è¡Œã£ã¦ãŠã‚Šã€preprizeã¨ã®é–¢ä¿‚æ€§ã‚‚ç¢ºèªã§ãã‚‹ã‚ˆã†ã«ãªã£ã¦ã„ã¾ã™ã€‚ã‚„ã¯ã‚Šã€ç›´æ„Ÿã¨åŒã˜ãã€preprizeãŒé«˜ã„é¦¬ã®ä¸­ã§ã‚‚horse_ageãŒè‹¥ã„é¦¬ã®1ç€ç¢ºç‡ãŒé«˜ããªã‚‹ã“ã¨ãŒè¦‹ã¦å–ã‚Œã¾ã™ã€‚\npreorderã®dependence_plotã‚‚ç¢ºèªã—ã¦ã¿ã¾ã—ã‚‡ã†ã€‚\nshap.dependence_plot(ind=\u0026#34;preorder\u0026#34;, shap_values=shap_values[1], features=X_test) ã‚„ã¯ã‚Šã€å‰èµ°ã®ç€é †ãŒä¸Šä½ã«ãªã‚‹ã»ã©1ç€ç¢ºç‡ãŒé«˜ã¾ã‚‹ã“ã¨ãŒã“ã“ã‹ã‚‰ã‚‚åˆ†ã‹ã‚Šã¾ã™ã€‚ã¾ãŸã€ãã®ç¢ºç‡ã¯6ç€ä»¥ä¸Šã¨ãã‚Œä»¥å¤–ã§æ°´æº–æ„ŸãŒå¤‰ã‚ã‚‹ã“ã¨ã‚‚åˆ†ã‹ã‚Šã¾ã™ã€‚last_3Fã®ã‚¿ã‚¤ãƒ ã¨ã®é–¢ä¿‚æ€§ã‚‚ç¢ºèªã—ã¦ã„ã¾ã™ãŒã€ã“ã¡ã‚‰ã¯ã‚ã¾ã‚Šé–¢é€£æ€§ã¯ãªã•ãã†ã§ã™ã€‚\n4. æœ€å¾Œã« LightGBMã‚’ä½¿ç”¨ã—ã€ç«¶é¦¬ã®äºˆæ¸¬ãƒ¢ãƒ‡ãƒ«ã‚’ä½œæˆã—ã¦ã¿ã¾ã—ãŸã€‚ã•ã™ãŒLightGBMã¨ã„ã£ãŸæ„Ÿã˜ã§ã€äºˆæ¸¬ç²¾åº¦ã¯é«˜ã‹ã£ãŸã§ã™ã€‚ã¾ãŸã€shapå€¤ã‚’ä½¿ç”¨ã—ãŸé‡è¦ç‰¹å¾´é‡ã®æ¤œå‡ºã‚‚ä¸Šæ‰‹ãã„ãã¾ã—ãŸã€‚ã“ã‚Œã«ã‚ˆã£ã¦ã€LightGBMã®æ°—æŒã¡ã‚’ç†è§£ã—ã€ã‚ˆã‚Šè‰¯ã„ç‰¹å¾´é‡ã®ç™ºè¦‹ã‚’é€²ã‚ã¦ã„ãã“ã¨ã§ãƒ¢ãƒ‡ãƒªãƒ³ã‚°ã®ç²¾åº¦ã‚’é«˜ã‚ã¦ã„ã“ã†ã¨æ€ã„ã¾ã™ã€‚\n","date":1582934400,"expirydate":-62135596800,"kind":"page","lang":"ja","lastmod":1582934400,"objectID":"ab5059d2582cbfad9b39f58a8285b701","permalink":"/post/post16/","publishdate":"2020-02-29T00:00:00Z","relpermalink":"/post/post16/","section":"post","summary":"KagglerãŒå¤§å¥½ããªLightGBMã§ç«¶é¦¬ã®é †ä½äºˆæƒ³ã—ã¦ã¿ã¾ã—ãŸã€‚","tags":["Python","å‰å‡¦ç†","æ©Ÿæ¢°å­¦ç¿’"],"title":"LightGBMã‚’ä½¿ç”¨ã—ã¦ç«¶é¦¬çµæœã‚’äºˆæƒ³ã—ã¦ã¿ã‚‹","type":"post"},{"authors":null,"categories":["ãƒã‚¯ãƒ­çµŒæ¸ˆå­¦"],"content":"ãŠã¯ã“ã‚“ã°ã‚“ã«ã¡ã¯ã€‚ã¨ã‚ã‚‹ç†ç”±ã§10å¹´ç‰©é•·æœŸé‡‘åˆ©ã®ãƒ•ã‚£ãƒƒãƒ†ã‚£ãƒ³ã‚°ã‚’è¡Œã„ãŸã„ã¨æ€ã„ã¾ã—ãŸã€‚ã¨ã„ã†ã‚ã‘ã§ã€USãƒ‡ãƒ¼ã‚¿ã‚’ç”¨ã„ã¦è§£æã—ã¦ã„ãã¾ã™ã€‚ã¾ãšã€ãƒ‡ãƒ¼ã‚¿ã‚’åé›†ã—ã¾ã—ã‚‡ã†ã€‚quantmodãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’ç”¨ã„ã¦ã€FREDã‹ã‚‰ãƒ‡ãƒ¼ã‚¿ã‚’è½ã¨ã—ã¾ã™ã€‚getsymbols(ã‚­ãƒ¼,from=é–‹å§‹æ—¥,src=\u0026quot;FRED\u0026quot;, auto.assign=TRUE)ã§ç°¡å˜ã«ã§ãã¡ã‚ƒã„ã¾ã™ã€‚ã¡ãªã¿ã«ã‚­ãƒ¼ã¯FREDã®HPã§ç¢ºèªã§ãã¾ã™ã€‚\n1. ãƒ‡ãƒ¼ã‚¿åé›† library(quantmod) # data name collected symbols.name \u0026lt;- c(\u0026#34;10-Year Treasury Constant Maturity Rate\u0026#34;,\u0026#34;Effective Federal Funds Rate\u0026#34;,\u0026#34; Consumer Price Index for All Urban Consumers: All Items\u0026#34;,\u0026#34;Civilian Unemployment Rate\u0026#34;,\u0026#34;3-Month Treasury Bill: Secondary Market Rate\u0026#34;,\u0026#34;Industrial Production Index\u0026#34;,\u0026#34; 10-Year Breakeven Inflation Rate\u0026#34;,\u0026#34;Trade Weighted U.S. Dollar Index: Broad, Goods\u0026#34;,\u0026#34; Smoothed U.S. Recession Probabilities\u0026#34;,\u0026#34;Moody\u0026#39;s Seasoned Baa Corporate Bond Yield\u0026#34;,\u0026#34;5-Year, 5-Year Forward Inflation Expectation Rate\u0026#34;,\u0026#34;Personal Consumption Expenditures\u0026#34;) # Collect economic data symbols \u0026lt;- c(\u0026#34;GS10\u0026#34;,\u0026#34;FEDFUNDS\u0026#34;,\u0026#34;CPIAUCSL\u0026#34;,\u0026#34;UNRATE\u0026#34;,\u0026#34;TB3MS\u0026#34;,\u0026#34;INDPRO\u0026#34;,\u0026#34;T10YIEM\u0026#34;,\u0026#34;TWEXBMTH\u0026#34;,\u0026#34;RECPROUSM156N\u0026#34;,\u0026#34;BAA\u0026#34;,\u0026#34;T5YIFRM\u0026#34;,\u0026#34;PCE\u0026#34;) getSymbols(symbols, from = \u0026#39;1980-01-01\u0026#39;, src = \u0026#34;FRED\u0026#34;, auto.assign = TRUE) ## [1] \u0026quot;GS10\u0026quot; \u0026quot;FEDFUNDS\u0026quot; \u0026quot;CPIAUCSL\u0026quot; \u0026quot;UNRATE\u0026quot; ## [5] \u0026quot;TB3MS\u0026quot; \u0026quot;INDPRO\u0026quot; \u0026quot;T10YIEM\u0026quot; \u0026quot;TWEXBMTH\u0026quot; ## [9] \u0026quot;RECPROUSM156N\u0026quot; \u0026quot;BAA\u0026quot; \u0026quot;T5YIFRM\u0026quot; \u0026quot;PCE\u0026quot;\rmacro_indicator \u0026lt;- merge(GS10,FEDFUNDS,CPIAUCSL,UNRATE,TB3MS,INDPRO,T10YIEM,TWEXBMTH,RECPROUSM156N,BAA,T5YIFRM,PCE) rm(GS10,FEDFUNDS,CPIAUCSL,UNRATE,TB3MS,INDPRO,T10YIEM,TWEXBMTH,RECPROUSM156N,BAA,T5YIFRM,PCE,USEPUINDXD) 2. æœˆæ¬¡è§£æãƒ‘ãƒ¼ãƒˆ ãƒ‡ãƒ¼ã‚¿ã¯ ã“ã¡ã‚‰ ã‹ã‚‰å‚ç…§ã§ãã¾ã™ã€‚ã§ã¯ã€æ¨è¨ˆç”¨ã®ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã‚’ä½œæˆã—ã¦ã„ãã¾ã™ã€‚è¢«èª¬æ˜å¤‰æ•°ã¯10-Year Treasury Constant Maturity Rate(GS10)ã§ã™ã€‚èª¬æ˜å¤‰æ•°ã¯ä»¥ä¸‹ã®é€šã‚Šã§ã™ã€‚\n   èª¬æ˜å¤‰æ•°å ã‚­ãƒ¼ ä»£ç†å¤‰æ•°     Federal Funds Rate FEDFUNDS çŸ­æœŸé‡‘åˆ©   Consumer Price Index CPIAUCSL ç‰©ä¾¡   Unemployment Rate UNRATE é›‡ç”¨é–¢é€£   3-Month Treasury Bill TB3MS çŸ­æœŸé‡‘åˆ©   Industrial Production Index INDPRO æ™¯æ°—   Breakeven Inflation Rate T10YIEM ç‰©ä¾¡   Trade Weighted Dollar Index TWEXBMTH ç‚ºæ›¿   Recession Probabilities RECPROUSM156N æ™¯æ°—   Moody\u0026rsquo;s Seasoned Baa Corporate Bond Yield BAA ãƒªã‚¹ã‚¯ãƒ—ãƒ¬ãƒŸã‚¢ãƒ    Inflation Expectation Rate T5YIFRM ç‰©ä¾¡   Personal Consumption Expenditures PCE æ™¯æ°—   Economic Policy Uncertainty Index USEPUINDXD æ”¿æ²»    ã‹ãªã‚Šé©å½“ãªå¤‰æ•°é¸æŠã§ã¯ã‚ã‚‹ã‚“ã§ã™ãŒã€ãƒã‚¯ãƒ­ãƒ¢ãƒ‡ãƒªãƒ³ã‚°çš„ã«é•·æœŸé‡‘åˆ©ã£ã¦ã©ã†ã‚„ã£ã¦ãƒ¢ãƒ‡ãƒ«åŒ–ã™ã‚‹ã‹ã¨ã„ã†ã¨ã¡ã‚ƒã‚“ã¨ã‚„ã£ã¦ãªã„å ´åˆãŒå¤šã„ã§ã™ã€‚DSGEã§ã¯åŠ¹ç‡å¸‚å ´ä»®èª¬ã«å¾“ã£ã¦10å¹´å…ˆã¾ã§ã®çŸ­æœŸé‡‘åˆ©ã®ãƒ‘ã‚¹ã‚’ãƒªãƒ³ã‚¯ã—ãŸã‚‚ã®ã¨é•·æœŸé‡‘åˆ©ãŒç­‰ã—ããªã‚‹ã¨å®šå¼åŒ–ã™ã‚‹ã®ãŒé™¢ç”Ÿæ™‚ä»£ã®ãƒ¢ãƒ‡ãƒªãƒ³ã‚°ã§ã—ãŸï¼ˆãƒã‚¯ãƒ­ãƒ•ã‚¡ã‚¤ãƒŠãƒ³ã‚¹ã®ç•Œéšˆã§ã¯ã¡ã‚ƒã‚“ã¨ã‚„ã£ã¦ãã†ï¼‰ã€‚ãã†ã„ã†ã‚ã‘ã§ã€çŸ­æœŸé‡‘åˆ©ã‚’èª¬æ˜å¤‰æ•°ã«åŠ ãˆã¦ã„ã¾ã™ã€‚ãã—ã¦ã€çŸ­æœŸé‡‘åˆ©ã«å½±éŸ¿ã‚’ä¸ãˆã‚‹ã§ã‚ã‚ã†ç‰©ä¾¡ã«ã‹ã‹ã‚‹æŒ‡æ¨™ã‚‚3ã¤è¿½åŠ ã—ã¾ã—ãŸã€‚åŠ ãˆã¦ã€æ™¯æ°—ã¨ã®ç›¸é–¢ãŒå¼·ã„ã“ã¨ã¯ã‚ˆãçŸ¥ã‚‰ã‚Œã¦ã„ã‚‹ã®ã§æ™¯æ°—ã«é–¢ã™ã‚‹ãƒ‡ãƒ¼ã‚¿ã‚‚è¿½åŠ ã—ã¾ã—ãŸã€‚ã“ã‚Œã‚‰ã¯ãã‚‚ãã‚‚ãƒã‚¯ãƒ­ãƒ¢ãƒ‡ãƒ«ã§ã¯çŸ­æœŸé‡‘åˆ©ã¯ä»¥ä¸‹ã®ã‚ˆã†ãªãƒ†ã‚¤ãƒ©ãƒ¼ãƒ«ãƒ¼ãƒ«ã«å¾“ã†ã¨ãƒ¢ãƒ‡ãƒªãƒ³ã‚°ã™ã‚‹ã“ã¨ãŒä¸€èˆ¬çš„ã§ã‚ã‚‹ã“ã¨ãŒèƒŒæ™¯ã«ã‚ã‚Šã¾ã™ã€‚\n$$ r_t = \\rho r_{t-1} + \\alpha \\pi_{t} + \\beta y_{t} $$ ã“ã“ã§ã€$r_t$ã¯æ”¿ç­–é‡‘åˆ©ï¼ˆçŸ­æœŸé‡‘åˆ©ï¼‰ã€$\\pi_t$ã¯ã‚¤ãƒ³ãƒ•ãƒ¬ç‡ã€$y_t$ã¯outputã§ã™ã€‚$\\rho, \\alpha, \\beta$ã¯deep parameterã¨å‘¼ã°ã‚Œã‚‹ã‚‚ã®ã§ã€ãã‚Œãã‚Œæ…£æ€§ã€ã‚¤ãƒ³ãƒ•ãƒ¬ç‡ã¸ã®é‡‘åˆ©ã®æ„Ÿå¿œåº¦ã€outputã«å¯¾ã™ã‚‹æ„Ÿå¿œåº¦ã‚’è¡¨ã—ã¦ã„ã¾ã™ã€‚$\\rho=0,\\beta=0$ã®æ™‚ã€$\\alpha\u0026gt;=1$ã§ãªã‘ã‚Œã°åˆç†çš„æœŸå¾…å‡è¡¡è§£ãŒå¾—ã‚‰ã‚Œãªã„ã“ã¨ã¯ã€Œãƒ†ã‚¤ãƒ©ãƒ¼ã®åŸç†ã€ã¨ã—ã¦æœ‰åã§ã™ã€‚ ãã®ä»–ã€Corporate bondã¨ã®è£å®šé–¢ä¿‚ã‚‚å­˜åœ¨ã—ãã†ãªMoody's Seasoned Baa Corporate Bond Yieldã‚‚èª¬æ˜å¤‰æ•°ã«è¿½åŠ ã—ã¦ã„ã¾ã™ã€‚ã¾ãŸã€æ¬²ã‚’è¨€ãˆã°VIXæŒ‡æ•°ã¨è²¡æ”¿ã«é–¢ã™ã‚‹æŒ‡æ¨™ã‚’è¿½åŠ ã—ãŸã„ã¨ã“ã‚ã§ã™ã€‚è²¡æ”¿ã«é–¢ã™ã‚‹æŒ‡æ•°ã¯Quateryã‹Annualyãªã®ã§ä»Šå›ã®ã‚ˆã†ãªmonthlyã®æ¨è¨ˆã«ã¯ä½¿ç”¨ã™ã‚‹ã“ã¨ãŒã§ãã¾ã›ã‚“ã€‚ã“ã®éƒ¨åˆ†ã¯æœ€ã‚‚ãƒãƒƒã‚¯ãªã¨ã“ã‚ã§ã™ã€‚ãªã«ã‹è€ƒãˆä»˜ã„ãŸã‚‰å†æ¨è¨ˆã—ã¾ã™ã€‚\nã§ã¯ã€æ¨è¨ˆã«å…¥ã‚Šã¾ã™ã€‚ä»Šå›ã¯èª¬æ˜å¤‰æ•°ãŒå¤šã„ã®ã§lassoå›å¸°ã‚’è¡Œã„ã€æœ‰åŠ¹ãªå¤‰æ•°ã‚’çµã‚Šè¾¼ã¿ãŸã„ã¨æ€ã„ã¾ã™ã€‚ã¾ãŸã€æ¯”è¼ƒã®ãŸã‚ã«OLSã‚‚ã‚„ã‚Šã¾ã™ã€‚èª¬æ˜å¤‰æ•°ã¯è¢«èª¬æ˜å¤‰æ•°ã®1æœŸå‰ã®å€¤ã‚’ä½¿ç”¨ã—ã¾ã™ã€‚ãŠãã‚‰ãã€1æœŸå‰ã§ã‚‚ãƒ‡ãƒ¼ã‚¿ã®å…¬è¡¨æ™‚æœŸã«ã‚ˆã£ã¦ã¯ç¿Œæœˆã®æ¨è¨ˆã«é–“ã«åˆã‚ãªã„å¯èƒ½æ€§ã‚‚ã‚ã‚Šã¾ã™ãŒã€ã¨ã‚Šã‚ãˆãšã“ã‚Œã§ã‚„ã£ã¦ã¿ã¾ã™ã€‚\n# make dataset traindata \u0026lt;- na.omit(merge(macro_indicator[\u0026#34;2003-01-01::2015-12-31\u0026#34;][,1],stats::lag(macro_indicator[\u0026#34;2003-01-01::2015-12-31\u0026#34;][,-1],1))) testdata \u0026lt;- na.omit(merge(macro_indicator[\u0026#34;2016-01-01::\u0026#34;][,1],stats::lag(macro_indicator[\u0026#34;2016-01-01::\u0026#34;][,-1],1))) # fitting OLS trial1 \u0026lt;- lm(GS10~.,data = traindata) summary(trial1) ## ## Call:\r## lm(formula = GS10 ~ ., data = traindata)\r## ## Residuals:\r## Min 1Q Median 3Q Max ## -0.7593 -0.2182 0.0041 0.2143 0.7051 ## ## Coefficients:\r## Estimate Std. Error t value Pr(\u0026gt;|t|) ## (Intercept) 15.0576773 4.3419245 3.468 0.000693 ***\r## FEDFUNDS -0.2075752 0.1413832 -1.468 0.144253 ## CPIAUCSL -0.0750111 0.0204871 -3.661 0.000352 ***\r## UNRATE -0.2183796 0.0784608 -2.783 0.006109 ** ## TB3MS 0.3031085 0.1393904 2.175 0.031310 * ## INDPRO -0.0705997 0.0263855 -2.676 0.008328 ** ## T10YIEM 1.1476564 0.1758964 6.525 1.10e-09 ***\r## TWEXBMTH -0.0313911 0.0117338 -2.675 0.008338 ** ## RECPROUSM156N -0.0103854 0.0021233 -4.891 2.66e-06 ***\r## BAA 0.7802368 0.0858538 9.088 7.60e-16 ***\r## T5YIFRM -0.4529529 0.1881510 -2.407 0.017342 * ## PCE 0.0009815 0.0002477 3.963 0.000116 ***\r## ---\r## Signif. codes: 0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\r## ## Residual standard error: 0.2953 on 143 degrees of freedom\r## Multiple R-squared: 0.9218,\tAdjusted R-squared: 0.9158 ## F-statistic: 153.2 on 11 and 143 DF, p-value: \u0026lt; 2.2e-16\rè‡ªç”±åº¦ä¿®æ­£æ¸ˆã¿æ±ºå®šä¿‚æ•°é«˜ã‚ã§ã™ã­ã€‚2015/12/31ã¾ã§ã®ãƒ¢ãƒ‡ãƒ«ã‚’ä½¿ã£ã¦ã€ã‚¢ã‚¦ãƒˆã‚µãƒ³ãƒ—ãƒ«ã®ãƒ‡ãƒ¼ã‚¿(2016/01/01~)ã‚’äºˆæ¸¬ã—ã€å¹³å‡äºŒä¹—èª¤å·®ã‚’è¨ˆç®—ã—ã¾ã™ã€‚\nest.OLS.Y \u0026lt;- predict(trial1,testdata[,-1]) Y \u0026lt;- as.matrix(testdata[,1]) mse.OLS \u0026lt;- sum((Y - est.OLS.Y)^2) / length(Y) mse.OLS ## [1] 0.2422673\ræ¬¡ã«lassoå›å¸°ã§ã™ã€‚Cross Validationã‚’è¡Œã„ã€$\\lambda$ã‚’æ±ºã‚ã‚‹glmnetãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®cv.glmneté–¢æ•°ã‚’ä½¿ç”¨ã—ã¾ã™ã€‚\n# fitting lasso regression library(glmnet) trial2 \u0026lt;- cv.glmnet(as.matrix(traindata[,-1]),as.matrix(traindata[,1]),family=\u0026#34;gaussian\u0026#34;,alpha=1) plot(trial2) trial2$lambda.min ## [1] 0.001463052\rcoef(trial2,s=trial2$lambda.min) ## 12 x 1 sparse Matrix of class \u0026quot;dgCMatrix\u0026quot;\r## s1\r## (Intercept) 8.1170282595\r## FEDFUNDS . ## CPIAUCSL -0.0370371311\r## UNRATE -0.1675017594\r## TB3MS 0.1244417351\r## INDPRO -0.0554153857\r## T10YIEM 1.1916137480\r## TWEXBMTH -0.0124760531\r## RECPROUSM156N -0.0094119322\r## BAA 0.7423502867\r## T5YIFRM -0.4664569086\r## PCE 0.0004936828\rUnemployment Rateã€3-Month Treasury Billã€Breakeven Inflation Rateã€Moody's Seasoned Baa Corporate Bond Yieldã€Inflation Expectation Rateã®å›å¸°ä¿‚æ•°ãŒå¤§ãããªã‚‹ã¨ã„ã†çµæœã§ã™ã­ã€‚å¤±æ¥­ç‡ä»¥å¤–ã¯æƒ³å®šå†…ã®çµæœã§ã™ã€‚ãŸã ã€ä»Šå›ã®çµæœã‚’è¦‹ã‚‹é™ã‚Šæ™¯æ°—ã¨ã®ç›¸é–¢ã¯ä½ãã†ã§ã™ï¼ˆé€†å‘ãã«ã—ã‹åŠ¹ã‹ãªã„ï¼Ÿï¼‰ã€‚MSEã‚’è¨ˆç®—ã—ã¾ã™ã€‚\nest.lasso.Y \u0026lt;- predict(trial2, newx = as.matrix(testdata[,-1]), s = trial2$lambda.min, type = \u0026#39;response\u0026#39;) mse.lasso \u0026lt;- sum((Y - est.lasso.Y)^2) / length(Y) mse.lasso ## [1] 0.1590115\rlassoå›å¸°ã®ã»ã†ãŒè‰¯ã„çµæœã«ãªã‚Šã¾ã—ãŸã€‚lassoå›å¸°ã§è¨ˆç®—ã—ãŸäºˆæ¸¬å€¤ã¨å®Ÿç¸¾å€¤ã‚’æ™‚ç³»åˆ—ãƒ—ãƒ­ãƒƒãƒˆã—ã¦ã¿ã¾ã™ã€‚\nlibrary(tidyverse) ggplot(gather(data.frame(actual=Y[,1],lasso_prediction=est.lasso.Y[,1],OLS_prediction=est.OLS.Y,date=as.POSIXct(rownames(Y))),key=data,value=rate,-date),aes(x=date,y=rate, colour=data)) + geom_line() + scale_x_datetime(breaks = \u0026#34;6 month\u0026#34;,date_labels = \u0026#34;%Y-%m\u0026#34;) + scale_y_continuous(breaks=c(1,1.5,2,2.5,3,3.5),limits = c(1.25,3.5)) æ–¹å‘æ„Ÿã¯ã„ã„æ„Ÿã˜ã§ã™ã€‚ä¸€æ–¹ã§ã€2016å¹´1æœˆã‹ã‚‰ã‚„2018å¹´12æœˆä»¥é™ã®æ€¥æ¿€ãªé‡‘åˆ©ä½ä¸‹ã¯äºˆæ¸¬ã§ãã¦ã„ã¾ã›ã‚“ã€‚ã“ã®éƒ¨åˆ†ã«ã¤ã„ã¦ã¯ä½•ã‹å¤‰æ•°ã‚’è€ƒãˆã‚‹orãƒ­ãƒ¼ãƒªãƒ³ã‚°æ¨è¨ˆã‚’å®Ÿæ–½ã™ã‚‹ã€ã®ã„ãšã‚Œã‹ã‚’ã‚„ã£ã¦ã¿ãªã„ã¨ç²¾åº¦ãŒä¸ŠãŒã‚‰ãªãã†ã§ã™ã€‚\n3. æ—¥æ¬¡è§£æãƒ‘ãƒ¼ãƒˆ æœˆæ¬¡ã§ã®è§£æã«åŠ ãˆã¦æ—¥æ¬¡ã§ã®è§£æã‚‚ã‚„ã‚ŠãŸã„ã¨ãŠã‚‚ã„ã¾ã™ã€‚æ—¥æ¬¡ãƒ‡ãƒ¼ã‚¿ã§ã‚ã‚Œã°ãƒ‡ãƒ¼ã‚¿ã®å…¬è¡¨ã¯å¸‚å ´ãŒé–‰ã¾ã‚Šæ¬¡ç¬¬ã®å ´åˆãŒå¤šã„ã®ã§ã€ã„ã‚ã‚†ã‚‹jagged edgeã®å•é¡ŒãŒèµ·ã“ã‚Šã«ãã„ã¨æ€ã„ã¾ã™ã€‚ã¾ãšã¯æ—¥æ¬¡ãƒ‡ãƒ¼ã‚¿ã®åé›†ã‹ã‚‰å§‹ã‚ã¾ã™ã€‚\n# data name collected symbols.name \u0026lt;- c(\u0026#34;10-Year Treasury Constant Maturity Rate\u0026#34;,\u0026#34;Effective Federal Funds Rate\u0026#34;,\u0026#34;NASDAQ Composite Index\u0026#34;,\u0026#34;3-Month Treasury Bill: Secondary Market Rate\u0026#34;,\u0026#34;Economic Policy Uncertainty Index for United States\u0026#34;,\u0026#34; 10-Year Breakeven Inflation Rate\u0026#34;,\u0026#34;Trade Weighted U.S. Dollar Index: Broad, Goods\u0026#34;,\u0026#34;Moody\u0026#39;s Seasoned Baa Corporate Bond Yield\u0026#34;,\u0026#34;5-Year, 5-Year Forward Inflation Expectation Rate\u0026#34;) # Collect economic data symbols \u0026lt;- c(\u0026#34;DGS10\u0026#34;,\u0026#34;DFF\u0026#34;,\u0026#34;NASDAQCOM\u0026#34;,\u0026#34;DTB3\u0026#34;,\u0026#34;USEPUINDXD\u0026#34;,\u0026#34;T10YIE\u0026#34;,\u0026#34;DTWEXB\u0026#34;,\u0026#34;DBAA\u0026#34;,\u0026#34;T5YIFR\u0026#34;) getSymbols(symbols, from = \u0026#39;1980-01-01\u0026#39;, src = \u0026#34;FRED\u0026#34;, auto.assign = TRUE) ## [1] \u0026quot;DGS10\u0026quot; \u0026quot;DFF\u0026quot; \u0026quot;NASDAQCOM\u0026quot; \u0026quot;DTB3\u0026quot; \u0026quot;USEPUINDXD\u0026quot;\r## [6] \u0026quot;T10YIE\u0026quot; \u0026quot;DTWEXB\u0026quot; \u0026quot;DBAA\u0026quot; \u0026quot;T5YIFR\u0026quot;\rNASDAQCOM.r \u0026lt;- ROC(na.omit(NASDAQCOM)) macro_indicator.d \u0026lt;- merge(DGS10,DFF,NASDAQCOM.r,DTB3,USEPUINDXD,T10YIE,DTWEXB,DBAA,T5YIFR) rm(DGS10,DFF,NASDAQCOM,NASDAQCOM.r,DTB3,USEPUINDXD,T10YIE,DTWEXB,DBAA,T5YIFR) æ¬¡ã«ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã‚’æ§‹ç¯‰ã—ã¾ã™ã€‚å­¦ç¿’ç”¨ã¨è¨“ç·´ç”¨ã«ãƒ‡ãƒ¼ã‚¿ã‚’åˆ†ã‘ã¾ã™ã€‚å®Ÿéš›ã®äºˆæ¸¬ãƒ—ãƒ­ã‚»ã‚¹ã‚’è€ƒãˆã€2å–¶æ¥­æ—¥å‰ã®ãƒ‡ãƒ¼ã‚¿ã‚’èª¬æ˜å¤‰æ•°ã«ç”¨ã„ã¦ã„ã¾ã™ã€‚\n# make dataset traindata.d \u0026lt;- na.omit(merge(macro_indicator.d[\u0026#34;1980-01-01::2010-12-31\u0026#34;][,1],stats::lag(macro_indicator.d[\u0026#34;1980-01-01::2010-12-31\u0026#34;][,-1],2))) testdata.d \u0026lt;- na.omit(merge(macro_indicator.d[\u0026#34;2010-01-01::\u0026#34;][,1],stats::lag(macro_indicator.d[\u0026#34;2010-01-01::\u0026#34;][,-1],2))) # fitting OLS trial1.d \u0026lt;- lm(DGS10~.,data = traindata.d) summary(trial1.d) ## ## Call:\r## lm(formula = DGS10 ~ ., data = traindata.d)\r## ## Residuals:\r## Min 1Q Median 3Q Max ## -0.81961 -0.12380 0.00509 0.14514 0.72712 ## ## Coefficients:\r## Estimate Std. Error t value Pr(\u0026gt;|t|) ## (Intercept) -3.5168438 0.1664198 -21.132 \u0026lt; 2e-16 ***\r## DFF 0.0770736 0.0217208 3.548 0.000403 ***\r## NASDAQCOM -0.4301865 0.4280568 -1.005 0.315121 ## DTB3 0.1137128 0.0238678 4.764 2.14e-06 ***\r## USEPUINDXD -0.0006591 0.0001073 -6.144 1.11e-09 ***\r## T10YIE 0.6957403 0.0351666 19.784 \u0026lt; 2e-16 ***\r## DTWEXB 0.0276208 0.0010896 25.350 \u0026lt; 2e-16 ***\r## DBAA 0.2879946 0.0131335 21.928 \u0026lt; 2e-16 ***\r## T5YIFR 0.3433321 0.0376058 9.130 \u0026lt; 2e-16 ***\r## ---\r## Signif. codes: 0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\r## ## Residual standard error: 0.2167 on 1148 degrees of freedom\r## Multiple R-squared: 0.8902,\tAdjusted R-squared: 0.8894 ## F-statistic: 1163 on 8 and 1148 DF, p-value: \u0026lt; 2.2e-16\rä¾ç„¶æ±ºå®šä¿‚æ•°ã¯é«˜ã‚ã§ã™ã€‚\nest.OLS.Y.d \u0026lt;- predict(trial1.d,testdata.d[,-1]) Y.d \u0026lt;- as.matrix(testdata.d[,1]) mse.OLS.d \u0026lt;- sum((Y.d - est.OLS.Y.d)^2) / length(Y.d) mse.OLS.d ## [1] 0.8350614\ræ¬¡ã«lassoå›å¸°ã§ã™ã€‚CVã§$\\lambda$ã‚’æ±ºå®šã€‚\n# fitting lasso regression trial2.d \u0026lt;- cv.glmnet(as.matrix(traindata.d[,-1]),as.matrix(traindata.d[,1]),family=\u0026#34;gaussian\u0026#34;,alpha=1) plot(trial2.d) trial2.d$lambda.min ## [1] 0.001339007\rcoef(trial2.d,s=trial2.d$lambda.min) ## 9 x 1 sparse Matrix of class \u0026quot;dgCMatrix\u0026quot;\r## s1\r## (Intercept) -3.4297225594\r## DFF 0.0707532975\r## NASDAQCOM -0.3512778327\r## DTB3 0.1204390843\r## USEPUINDXD -0.0006453775\r## T10YIE 0.6894098221\r## DTWEXB 0.0272773903\r## DBAA 0.2831306290\r## T5YIFR 0.3411269206\rliborã®ä¿‚æ•°å€¤ãŒ0ã«ãªã‚Šã¾ã—ãŸã€‚MSEã¯OLSã®æ–¹ãŒé«˜ã„çµæœã«ã€‚\nest.lasso.Y.d \u0026lt;- predict(trial2.d, newx = as.matrix(testdata.d[,-1]), s = trial2.d$lambda.min, type = \u0026#39;response\u0026#39;) mse.lasso.d \u0026lt;- sum((Y.d - est.lasso.Y.d)^2) / length(Y.d) mse.lasso.d ## [1] 0.8492769\räºˆæ¸¬å€¤ã‚’ãƒ—ãƒ­ãƒƒãƒˆã—ã¾ã™ã€‚\nggplot(gather(data.frame(actual=Y.d[,1],lasso_prediction=est.lasso.Y.d[,1],OLS_prediction=est.OLS.Y.d,date=as.POSIXct(rownames(Y.d))),key=data,value=rate,-date),aes(x=date,y=rate, colour=data)) + geom_line() + scale_x_datetime(breaks = \u0026#34;2 year\u0026#34;,date_labels = \u0026#34;%Y-%m\u0026#34;) + scale_y_continuous(breaks=c(1,1.5,2,2.5,3,3.5),limits = c(1.25,5)) æœˆæ¬¡ã¨åŒã˜ãã€OLSã¨lassoã§äºˆæ¸¬å€¤ã«å·®ã¯ã»ã¨ã‚“ã©ã‚ã‚Šã¾ã›ã‚“ã€‚ãªã‹ãªã‹ã„ã„æ„Ÿã˜ã«å¤‰å‹•ã‚’æ‰ãˆã‚‹ã“ã¨ãŒã§ãã¦ã„ã¾ã™ãŒã€2011å¹´ã®United States federal government credit-rating downgradesã«ã‚ˆã‚‹é‡‘åˆ©ä½ä¸‹ã‚„2013å¹´ã®æ™¯æ°—å›å¾©ã«ä¼´ã†é‡‘åˆ©ä¸Šæ˜‡ã¯æ‰ãˆã‚‹ã“ã¨ãŒã§ãã¦ã„ã¾ã›ã‚“ã€‚æ—¥æ¬¡ã®æ™¯æ°—æŒ‡æ¨™ã¯POSãƒ‡ãƒ¼ã‚¿ãã‚‰ã„ã—ã‹ãªã„ã‚“ã§ã™ãŒã€å¼·ã„ã¦è¨€ã†ãªã‚‰æœ€è¿‘ä½¿ç”¨ã—ãŸå¤œé–“å…‰ã®è¡›æ˜Ÿç”»åƒãƒ‡ãƒ¼ã‚¿ãªã‚“ã‹ã¯ä½¿ãˆã‚‹ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ã€‚æ™‚é–“ãŒã‚ã‚Œã°ã‚„ã£ã¦ã¿ã¾ã™ã€‚ã¨ã‚Šã‚ãˆãšã€ã„ã£ãŸã‚“ã“ã‚Œã§ã“ã®è¨˜äº‹ã¯çµ‚ã‚ã‚ŠãŸã„ã¨æ€ã„ã¾ã™ã€‚ã“ã“ã¾ã§èª­ã¿é€²ã‚ã¦ã„ãŸã ãã€ã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã—ãŸã€‚\n","date":1563235200,"expirydate":-62135596800,"kind":"page","lang":"ja","lastmod":1563235200,"objectID":"8bd91b4fb1550ed802c88f7dcf9db6b7","permalink":"/post/post14/","publishdate":"2019-07-16T00:00:00Z","relpermalink":"/post/post14/","section":"post","summary":"å˜ãªã‚‹æ€ã„ä»˜ãã§ã™ã€‚","tags":["R","æ™‚ç³»åˆ—è§£æ","é‡‘è"],"title":"10å¹´ç‰©é•·æœŸé‡‘åˆ©ã‚’ãƒ•ã‚£ãƒƒãƒ†ã‚£ãƒ³ã‚°ã—ã¦ã¿ã‚‹","type":"post"},{"authors":null,"categories":["ãƒã‚¯ãƒ­çµŒæ¸ˆå­¦"],"content":"çš†ã•ã‚“ãŠã¯ã“ã‚“ã°ã‚“ã«ã¡ã‚ã€‚å‰å›ã€GPLVMãƒ¢ãƒ‡ãƒ«ã‚’ç”¨ã„ãŸGDPäºˆæ¸¬ãƒ¢ãƒ‡ãƒ«ã‚’æ§‹ç¯‰ã—ã¾ã—ãŸã€‚ãŸã ã€ãƒŠã‚¦ã‚­ãƒ£ã‚¹ãƒ†ã‚£ãƒ³ã‚°ã¨ã„ã†ã‹ã‚‰ã«ã¯ã‚ªãƒ«ã‚¿ãƒŠãƒ†ã‚£ãƒ–ãƒ‡ãƒ¼ã‚¿ã‚’ç”¨ã„ãŸè§£æã‚’è¡Œã„ãŸã„ã¨ã“ã‚ã§ã¯ã‚ã‚Šã¾ã™ã€‚ãµã¨ã€ä»¥ä¸‹ã®è¨˜äº‹ã‚’è¦‹ã¤ã‘ã¾ã—ãŸã€‚\nç„¦ç‚¹ï¼šãƒŠã‚¦ã‚­ãƒ£ã‚¹ãƒˆã®ï¼§ï¼¤ï¼°æ¨è¨ˆã€ä¸–ç•Œåˆã®è¡›æ˜Ÿç”»åƒåˆ©ç”¨ã€€åˆ©ç”¨æ‹¡å¤§ã‚‚\nã“ã¡ã‚‰ã¯æ±äº¬å¤§å­¦ã®æ¸¡è¾ºåŠªå…ˆç”ŸãŒäººå·¥è¡›æ˜Ÿç”»åƒã‚’ç”¨ã„ã¦GDPäºˆæ¸¬ãƒ¢ãƒ‡ãƒ«ã‚’é–‹ç™ºã—ãŸã¨ã„ã†ã‚‚ã®ã§ã™ã€‚è¨˜äº‹ã«ã¯\n ç±³å›½ã®æµ·æ´‹å¤§æ°—åºãŒé‹å–¶ã™ã‚‹æ°—è±¡è¡›æ˜Ÿã€Œã‚¹ã‚ªãƒŸï¼®ï¼°ï¼°ã€ãŒæ—¥æœ¬ä¸Šç©ºã‚’é€šéã™ã‚‹æ¯æ—¥åˆå‰ï¼‘æ™‚ï¼“ï¼åˆ†æ™‚ç‚¹ã®ç”»åƒã‚’è³¼å…¥ã—ã€ç¸¦ã€æ¨ªï¼—ï¼’ï¼ãƒ¡ãƒ¼ãƒˆãƒ«å››æ–¹ã®ãƒã‚¹ç›®ã”ã¨ã®æ˜ã‚‹ã•ã‚’è¨ˆæ¸¬ã™ã‚‹ã€‚åŒã˜æ˜ã‚‹ã•ã§ã‚‚ã€è¾²åœ°ã€å•†æ¥­ç”¨åœ°ã€å·¥æ¥­ç”¨åœ°ãªã©åœŸåœ°ã®ç”¨é€”ã«ã‚ˆã£ã¦çµŒæ¸ˆæ´»å‹•ã®å¤§ãã•ãŒç•°ãªã‚‹ãŸã‚ã€å›½åœŸåœ°ç†é™¢ã®åœŸåœ°åˆ©ç”¨èª¿æŸ»ã‚’å‚ç…§ã€‚åœŸåœ°ã®ç”¨é€”ã¨ã€æ˜ã‚‹ã•ãŒç¤ºã™çµŒæ¸ˆæ´»å‹•ã®ç›¸é–¢ã‚’å¼¾ãå‡ºã—ã€ã“ã®çµæœã‚’è€ƒæ…®ã—ãŸä¸Šã§ã€æ˜ã‚‹ã•ã‹ã‚‰çµŒæ¸ˆæ´»å‹•ã®å¤§ãã•ã‚’è©¦ç®—ã™ã‚‹ã€‚ ï¼ˆä¸­ç•¥ï¼‰è¡›æ˜Ÿç”»åƒã®ã‚ˆã†ã«èª°ã‚‚ãŒå…¥æ‰‹å¯èƒ½ãªå…¬è¡¨ãƒ‡ãƒ¼ã‚¿ã§ã‚ã‚Œã°ã€æ”¿åºœã€æ°‘é–“ã®åŒºåˆ¥ãªãåˆ†æãŒå¯èƒ½ã§ã‚ã‚‹ãŸã‚ã€æ¸¡è¾ºæ°ã¯ã“ã‚Œã‚’ã€Œçµ±è¨ˆã®æ°‘ä¸»åŒ–ã€ã¨å‘¼ã³ã€ä¸–ç•Œçš„ãªæ½®æµã«ãªã‚‹ã¨äºˆæƒ³ã—ã¦ã„ã‚‹ã€‚\n ã¨æ›¸ã‹ã‚Œã¦ãŠã‚Šã€è¡›æ˜Ÿå†™çœŸã‚’ç”¨ã„ãŸåˆ†æã«èˆˆå‘³ã‚’æƒ¹ã‹ã‚Œã¾ã—ãŸã€‚ è¡›æ˜Ÿå†™çœŸã£ã¦èª°ã§ã‚‚åˆ©ç”¨å¯èƒ½ã‹ï¼Ÿã¨ã„ã†ã¨ã“ã‚ã§ã™ãŒã€GoogleãŒEarth Engineã¨ã„ã†ã‚µãƒ¼ãƒ“ã‚¹ã‚’æä¾›ã—ã¦ã„ã‚‹ã“ã¨ãŒã‚ã‹ã‚Šã¾ã—ãŸã€‚\nhttps://earthengine.google.com/\n ï¼ˆæ‹™è¨³ï¼‰Google Earth Engineã¯ã€æ•°ãƒšã‚¿ãƒã‚¤ãƒˆã®è¡›æ˜Ÿç”»åƒç¾¤ã¨åœ°ç†ç©ºé–“ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã‚’æƒ‘æ˜Ÿè¦æ¨¡ã®è§£ææ©Ÿèƒ½ã¨çµ„ã¿åˆã‚ã›ã€ç§‘å­¦è€…ã€ç ”ç©¶è€…ã€é–‹ç™ºè€…ãŒå¤‰åŒ–ã‚’æ¤œå‡ºã—ã€å‚¾å‘ã‚’å°„å½±ã—ã€åœ°çƒã®å¤‰å®¹ã‚’å®šé‡åŒ–ã™ã‚‹ã“ã¨ã‚’å¯èƒ½ã«ã—ã¾ã™ã€‚\n ç ”ç©¶ãƒ»æ•™è‚²ãƒ»éå–¶åˆ©ç›®çš„ãªã‚‰ã°ã€ãªã‚“ã¨ç„¡æ–™ã§è¡›æ˜Ÿå†™çœŸãƒ‡ãƒ¼ã‚¿ã‚’è§£æã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚å…·ä½“çš„ã«ä½•ãŒã§ãã‚‹ã®ã‹ã¯ä»¥ä¸‹ã®å‹•ç”»ã‚’è¦‹ã¦ãã ã•ã„ã€‚\n\rä»Šå›ã¯ãã‚“ãªEath Engineã®python APIã‚’ç”¨ã„ã¦è¡›æ˜Ÿç”»åƒãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—ã—ã€è§£æã—ã¦ã„ããŸã„ã¨æ€ã„ã¾ã™ã€‚\n1. Earth Engineã‚’ä½¿ã†ãŸã‚ã®äº‹å‰æº–å‚™ Earth Engineã‚’ä½¿ç”¨ã™ã‚‹ãŸã‚ã«ã¯ã€Google Accountã‚’ä½¿ã£ã¦ç”³è«‹ã‚’è¡Œã†å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚å…ˆã»ã©ã®ç”»åƒã®å³ä¸Šã®ã€ŒSign Upã€ã‹ã‚‰ã§ãã¾ã™ã€‚ç”³è«‹ã‚’è¡Œã£ã¦ã€Gmailã«ä»¥ä¸‹ã®ã‚ˆã†ãªãƒ¡ãƒ¼ãƒ«ãŒæ¥ã‚‹ã¨ã¨ã‚Šã‚ãˆãšEarth Engineã¯ä½¿ç”¨ã§ãã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚\nã¨ã‚Šã‚ãˆãšã¨ã„ã†ã®ã¯WEBä¸Šã®Earth Engine ã‚³ãƒ¼ãƒ‰ã‚¨ãƒ‡ã‚£ã‚¿ã¯ä½¿ç”¨ã§ãã‚‹ã¨ã„ã†ã“ã¨ã§ã™ã€‚ã‚³ãƒ¼ãƒ‰ã‚¨ãƒ‡ã‚£ã‚¿ã¨ã„ã†ã®ã¯ä»¥ä¸‹ã®ã‚ˆã†ãªã‚‚ã®ã§ã€ãƒ–ãƒ©ã‚¦ã‚¶ä¸Šã§ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—ã—ãŸã‚Šã€è§£æã‚’ã—ãŸã‚Šã€è§£æçµæœã‚’MAPã«æŠ•å½±ã—ãŸã‚Šã™ã‚‹ã“ã¨ãŒã§ãã‚‹ä¾¿åˆ©ãƒ„ãƒ¼ãƒ«ã§ã™ã€‚Earth Engineã®æœ¬ä½“ã¯ã‚€ã—ã‚ã“ã„ã¤ã§ã€APIã¯å‰¯æ¬¡çš„ãªã‚‚ã®ã¨è€ƒãˆã¦ã„ã¾ã™ã€‚\nçœŸã‚“ä¸­ã®ã‚³ãƒ¼ãƒ‰ã‚¨ãƒ‡ã‚£ã‚¿ã«ã‚³ãƒ¼ãƒ‰ã‚’æ‰“ã£ã¦ã„ãã¾ã™ãŒã€è¨€èªã¯javascriptã§ã™(APIã¯pythonã¨javascriptä¸¡æ–¹ã‚ã‚‹ã‚“ã§ã™ã‘ã©ã­)ã€‚è§£æçµæœã‚’MAPã«æŠ•å½±ã—ãŸã‚Šã€referenceï¼ˆå·¦ï¼‰ã‚’å‚ç…§ã—ãŸã‚Šã€Consoleã«åãå‡ºã—ãŸãƒ‡ãƒ¼ã‚¿ã‚’ç¢ºèªã™ã‚‹ã“ã¨ãŒã§ãã‚‹ã®ã§ã‹ãªã‚Šä¾¿åˆ©ã§ã™ã€‚ãŒã€ãƒ‡ãƒ¼ã‚¿ã‚’è½ã¨ã—ãŸå¾Œã§é«˜åº¦ãªè§£æã‚’è¡Œã„ãŸã„å ´åˆã¯pythonã‚’ä½¿ã£ãŸã»ã†ãŒæ…£ã‚Œã¦ã„ã‚‹ã®ã§ä»Šå›ã¯APIã‚’ä½¿ç”¨ã—ã¦ã„ã¾ã™ã€‚ è©±ãŒè„±ç·šã—ã¾ã—ãŸã€‚ã•ã¦ã€Earth Engineã®æ‰¿èªã‚’å¾—ãŸã‚‰ã€pipã§earthengine-apiã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¦ãŠãã¾ã™ã€‚ãã—ã¦ã€ã‚³ãƒãƒ³ãƒ‰ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆä¸Šã§ã€earthengine authenticateã¨æ‰“ã¡ã¾ã™ã€‚ãã†ã™ã‚‹ã¨ã€å‹æ‰‹ã«ãƒ–ãƒ©ã‚¦ã‚¶ãŒç«‹ã¡ä¸ŠãŒã‚Šã€ä»¥ä¸‹ã®ã‚ˆã†ã«python apiã®authenticationã‚’è¡Œã†ç”»é¢ãŒã§ã¾ã™ã®ã§ã€Œæ¬¡ã¸ã€ã‚’æŠ¼ä¸‹ã—ã¾ã™ã€‚\næ¬¡ã«ä»¥ä¸‹ã®ã‚ˆã†ãªç”»é¢ã«ã„ãã¾ã™ã®ã§ã€ãã®ã¾ã¾æ‰¿èªã—ã¾ã™ã€‚ã“ã‚Œã§authenticationã®å®Œæˆã§ã™ã€‚pythonã‹ã‚‰APIãŒä½¿ãˆã¾ã™ã€‚\n2. Python APIã‚’ç”¨ã„ãŸè¡›æ˜Ÿç”»åƒãƒ‡ãƒ¼ã‚¿ã®å–å¾— Python APIã‚’ä½¿ç”¨ã™ã‚‹æº–å‚™ãŒã§ãã¾ã—ãŸã€‚ã“ã“ã‹ã‚‰ã¯è¡›æ˜Ÿç”»åƒãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—ã—ã¦ã„ãã¾ã™ã€‚ä»¥ä¸‹ã«ã‚ã‚‹ã‚ˆã†ã«Earth Engineã«ã¯ãŸãã•ã‚“ã®ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆãŒå­˜åœ¨ã—ã¾ã™ã€‚\nhttps://developers.google.com/earth-engine/datasets/\nä»Šå›ã¯VIIRS Stray Light Corrected Nighttime Day/Night Band Composites Version 1ã¨ã„ã†ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã‚’ä½¿ç”¨ã—ã¾ã™ã€‚ã“ã®ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã¯ä¸–ç•Œä¸­ã®å¤œé–“å…‰ã®å…‰é‡ã‚’æœˆæ¬¡å˜ä½ã§å¹³å‡ã—ã€æä¾›ã™ã‚‹ã‚‚ã®ã§ã™ã€‚ã‚µãƒ³ãƒ—ãƒ«æœŸé–“ã¯2014-01~ç¾åœ¨ã§ã™ã€‚\nEarth Engineã«ã¯ã„ãã¤ã‹ã®å›ºæœ‰ãªãƒ‡ãƒ¼ã‚¿å‹ãŒå­˜åœ¨ã—ã¾ã™ã€‚è¦šãˆã¦ãŠãã¹ãã‚‚ã®ã¯ä»¥ä¸‹ã®3ã¤ã§ã™ã€‚\nImageâ€¦ ã‚ã‚‹ï¼‘æ™‚ç‚¹ã«ãŠã‘ã‚‹rasterãƒ‡ãƒ¼ã‚¿ã§ã™ã€‚imageã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã¯ã„ãã¤ã‹ã®bandã§æ§‹æˆã•ã‚Œã¦ã„ã¾ã™ã€‚ã“ã®bandã¯ãƒ‡ãƒ¼ã‚¿ã«ã‚ˆã£ã¦ç•°ãªã‚Šã¾ã™ãŒã€ãŠãŠã‚ˆãã®ãƒ‡ãƒ¼ã‚¿ã¯bandãã‚Œãã‚ŒãŒRGBå€¤ã‚’è¡¨ã—ã¦ã„ãŸã‚Šã—ã¾ã™ã€‚Earth Engineã‚’ä½¿ç”¨ã™ã‚‹ä¸Šã§æœ€ã‚‚åŸºæœ¬çš„ãªãƒ‡ãƒ¼ã‚¿ã§ã™ã€‚\nImageCollectionâ€¦ Imageã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’æ™‚ç³»åˆ—ã«ä¸¦ã¹ãŸã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã§ã™ã€‚ä»Šå›ã¯æ™‚ç³»åˆ—è§£æã‚’ã™ã‚‹ã®ã§ã“ã®ãƒ‡ãƒ¼ã‚¿ã‚’ä½¿ç”¨ã—ã¾ã™ã€‚\nFeatureCollectionâ€¦ GeoJSON Featureã§ã™ã€‚åœ°ç†æƒ…å ±ã‚’è¡¨ã™Geometryã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚„ãã®ãƒ‡ãƒ¼ã‚¿ã®ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ï¼ˆå›½åç­‰ï¼‰ãŒæ ¼ç´ã•ã‚Œã¦ã„ã¾ã™ã€‚ä»Šå›ã¯æ—¥æœ¬ã®ä½ç½®æƒ…å ±ã‚’å–å¾—ã™ã‚‹éš›ã«ä½¿ç”¨ã—ã¦ã„ã¾ã™ã€‚\nã§ã¯ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã—ã¦ã„ãã¾ã™ã€‚ã¾ãšã€æ—¥æœ¬ã®åœ°ç†æƒ…å ±ã®FeatureCollectionã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’å–å¾—ã—ã¾ã™ã€‚åœ°ç†æƒ…å ±ã¯Fusion Tablesã«æ ¼ç´ã•ã‚Œã¦ã„ã¾ã™ã®ã§ã€IDã§å¼•ã£å¼µã‚ŠCountryãŒJapanã®ã‚‚ã®ã‚’æŠ½å‡ºã—ã¾ã™ã€‚ee.FeatureCollection()ã®å¼•æ•°ã«IDã‚’å…¥åŠ›ã™ã‚Œã°ç°¡å˜ã«å–å¾—ã§ãã¾ã™ã€‚\nimport ee from dateutil.parser import parse ee.Initialize() # get Japan geometory as FeatureCollection from fusion table japan = ee.FeatureCollection(\u0026#39;ft:1tdSwUL7MVpOauSgRzqVTOwdfy17KDbw-1d9omPw\u0026#39;).filter(ee.Filter.eq(\u0026#39;Country\u0026#39;, \u0026#39;Japan\u0026#39;)) æ¬¡ã«å¤œé–“å…‰ã®è¡›æ˜Ÿç”»åƒã‚’å–å¾—ã—ã¦ã¿ã¾ã™ã€‚ã“ã¡ã‚‰ã‚‚ee.ImageCollection()ã«ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã®IDã‚’æ¸¡ã™ã¨å–å¾—ã§ãã¾ã™ã€‚ãªãŠã€ã“ã“ã§ã¯bandã‚’æœˆæ¬¡ã®å¹³å‡å…‰é‡ã§ã‚ã‚‹avg_radã«æŠ½å‡ºã—ã¦ã„ã¾ã™ã€‚\n# get night-light data from earth engine from 2014-01-01 to 2019-01-01 dataset = ee.ImageCollection(\u0026#39;NOAA/VIIRS/DNB/MONTHLY_V1/VCMSLCFG\u0026#39;).filter(ee.Filter.date(\u0026#39;2014-01-01\u0026#39;,\u0026#39;2019-01-01\u0026#39;)).select(\u0026#39;avg_rad\u0026#39;) å–å¾—ã—ãŸè¡›æ˜Ÿç”»åƒã‚’æ—¥æœ¬å‘¨è¾ºã«åˆ‡ã‚Šå‡ºã—ã€ç”»åƒãƒ•ã‚¡ã‚¤ãƒ«ã¨ã—ã¦å‡ºåŠ›ã—ã¦ã¿ã¾ã—ã‚‡ã†ã€‚ç”»åƒãƒ•ã‚¡ã‚¤ãƒ«ã®å‡ºåŠ›ã¯imageã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã§å¯èƒ½ã§ã™ï¼ˆãã†ã§ãªã„ã¨ç”»åƒãŒãŸãã•ã‚“å‡ºã¦ãã¦ã—ã¾ã„ã¾ã™ã‹ã‚‰ã­ã€‚ã€‚ã€‚ï¼‰ã€‚ä»Šå–å¾—ã—ãŸã®ã¯ImageCollectionã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã§ã™ã‹ã‚‰Imageã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã¸åœ§ç¸®ã—ã¦ã‚„ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ï¼ˆä¸ŠãŒImageCollectionã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã€ä¸‹ãŒåœ§ç¸®ã•ã‚ŒãŸImageã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆï¼‰ã€‚\nã“ã“ã§ã¯ã€ImageCollectionã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®ä¸­ã«ã‚ã‚‹ã®Imageã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®å¹³å‡å€¤ã‚’ã¨ã£ã¦ã‚µãƒ³ãƒ—ãƒ«æœŸé–“ã®å¹³å‡çš„ãªç”»åƒã‚’å‡ºåŠ›ã—ã¦ã¿ãŸã„ã¨æ€ã„ã¾ã™ã€‚ImageCollection.mean()ã§ã§ãã¾ã™ã€‚ã¾ãŸã€.visualize({min:0.5})ã§ãƒ”ã‚¯ã‚»ãƒ«å€¤ãŒ0.5ä»¥ä¸Šã§ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ã‚’ã‹ã‘ã¦ã„ã¾ã™ã€‚ã“ã†ã—ãªã„ã¨é›²ã¨æ€ã‚ã‚Œã‚‹ã‚‚ã®ã‚„ã‚´ãƒŸï¼Ÿã¿ãŸã„ãªã‚‚ã®ãŒã¤ã„ã¦ã—ã¾ã„ã¾ã™ã€‚æ¬¡ã«ã€ã“ã“ã¾ã§åŠ å·¥ã—ãŸç”»åƒãƒ‡ãƒ¼ã‚¿ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã™ã‚‹urlã‚’.getDownloadURLãƒ¡ã‚½ãƒƒãƒ‰ã§å–å¾—ã—ã¦ã„ã¾ã™ã€‚ãã®éš›ã€regionã§åˆ‡ã‚Šå‡ºã™ç¯„å›²ã‚’ãƒãƒªã‚´ãƒ³å€¤ã§æŒ‡å®šã—ã€scaleã§ãƒ‡ãƒ¼ã‚¿ã®è§£åƒåº¦ã‚’æŒ‡å®šã—ã¦ã„ã¾ã™ï¼ˆscaleãŒå°ã•ã™ãã‚‹ã¨å‡¦ç†ãŒé‡ã™ãã‚‹ã‚‰ã—ãã‚¨ãƒ©ãƒ¼ãŒå‡ºã¦å‡¦ç†ã§ãã¾ã›ã‚“ï¼‰ã€‚\ndataset.mean().visualize(min=0.5).getDownloadURL(dict(name=\u0026#39;thumbnail\u0026#39;,region=[[[120.3345348936478, 46.853488838010854],[119.8071911436478, 24.598157870729043],[148.6353161436478, 24.75788466523463],[149.3384411436478, 46.61252884462868]]],scale=5000)) å–å¾—ã—ãŸç”»åƒãŒä»¥ä¸‹ã§ã™ã€‚\nã‚„ã¯ã‚Šã€æ±äº¬ã‚’ä¸­å¿ƒã¨ã—ãŸé–¢æ±åœã€å¤§é˜ªã‚’ä¸­å¿ƒã¨ã—ãŸé–¢è¥¿åœã€æ„›çŸ¥ã€ç¦å²¡ã€åŒ—æµ·é“ï¼ˆæœ­å¹Œå‘¨è¾ºï¼‰ã®å…‰é‡ãŒå¤šãã€çµŒæ¸ˆæ´»å‹•ãŒæ´»ç™ºã§ã‚ã‚‹ã“ã¨ãŒã‚ã‹ã‚Šã¾ã™ã€‚ã¾ãŸã€é™¸å†…ã‚ˆã‚Šã‚‚æ²¿å²¸éƒ¨ã§å…‰é‡ãŒå¤šã„åœ°åŸŸãŒã‚ã‚‹ã“ã¨ãŒã‚ã‹ã‚Šã¾ã™ã€‚ã“ã‚Œã¯çµŒæ¸ˆæ´»å‹•ã¨ã¯ç›´æ¥é–¢ä¿‚ã—ãªã„ç¾è±¡ã®ã‚ˆã†ãªæ°—ã‚‚ã—ã¾ã™ã€‚ä»Šå›ã¯åˆ†æå¯¾è±¡å¤–ã§ã™ãŒã€åŒ—ç·¯38åº¦ã‚’å¢ƒã«åŒ—å´ãŒçœŸã£æš—ã«ãªã‚‹ã®ãŒå°è±¡çš„ã§ã™ã€‚ã“ã‚Œã¯è¨€ã†ã¾ã§ã‚‚ãªãåŒ—æœé®®ã¨éŸ“å›½ã®å¢ƒç•Œç·šã§ã™ã‹ã‚‰ã€ä¸¡å›½ã®çµŒæ¸ˆæ´»å‹•æ°´æº–ã®å·®ãŒè¦–è¦šçš„ã«ã‚³ãƒ³ãƒˆãƒ©ã‚¹ãƒˆã•ã‚Œã¦ã„ã‚‹ã®ã§ã—ã‚‡ã†ã€‚ä»Šå›ä½¿ç”¨ã—ãŸãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã¯2014å¹´ã‹ã‚‰ã®ã‚‚ã®ã§ã™ãŒã€ä»–ã®ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã§ã¯1990å¹´ä»£ã‹ã‚‰ã®ãƒ‡ãƒ¼ã‚¿ãŒå–å¾—ã§ãã‚‹ã‚‚ã®ã‚‚ã‚ã‚Šã¾ã™ï¼ˆãã®ä»£ã‚ã‚Šæœ€è¿‘ã®ãƒ‡ãƒ¼ã‚¿ã¯å–ã‚Œã¾ã›ã‚“ãŒï¼‰ã€‚ãã‚Œã‚‰ã‚’ç”¨ã„ã¦æœé®®åŠå³¶ã‚„ä¸­å›½ã®çµŒæ¸ˆç™ºå±•ã‚’è¦³å¯Ÿã™ã‚‹ã®ã‚‚é¢ç™½ã„ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ã€‚\nã•ã¦ã€ç”»åƒã¯å–å¾—ã§ãã¾ã—ãŸãŒã“ã®ã¾ã¾ã§ã¯è§£æãŒã§ãã¾ã›ã‚“ã€‚ã“ã“ã‹ã‚‰ã¯å¤œé–“å…‰ã‚’ãƒ”ã‚¯ã‚»ãƒ«å€¤ã«ãƒãƒƒãƒ”ãƒ³ã‚°ã—ãŸãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—ã—ã€æ•°å€¤çš„ãªè§£æã‚’è©¦ã¿ã¾ã™ã€‚ãŸã ã€å…ˆã»ã©ã¨ã¯ãƒ‡ãƒ¼ã‚¿å–å¾—ã®æ‰‹ç¶šããŒå°‘ã—å¤‰ã‚ã‚Šã¾ã™ã€‚ã¨ã„ã†ã®ã‚‚ã€ä»Šåº¦ã¯æ—¥æœ¬å„åœ°ã§å„ãƒ”ã‚¯ã‚»ãƒ«å˜ä½ã”ã¨ã«ã•ã¾ã–ã¾ãªå€¤ã‚’ã¨ã‚‹å¤œé–“å…‰ã‚’é›†ç´„ã—ã€1ã¤ã®ä»£ç”¨å€¤ã«ã—ãªã‘ã‚Œã°ãªã‚‰ãªã„ã‹ã‚‰ã§ã™ã€‚ãƒ”ã‚¯ã‚»ãƒ«ã”ã¨ã®æ•°å€¤ã‚’æ‰‹ã«å…¥ã‚ŒãŸã¨ã“ã‚ã§è§£æã™ã‚‹ã«ã¯æ‰‹ã«ä½™ã£ã¦ã—ã¾ã„ã¾ã™ã‹ã‚‰ã­ã€‚ã‚¤ãƒ¡ãƒ¼ã‚¸ã¯ä»¥ä¸‹ã®ã‚ˆã†ãªæ„Ÿã˜ã§ã™ï¼ˆEarth Engineã‚µã‚¤ãƒˆã‹ã‚‰å¼•ç”¨ï¼‰ã€‚\nå…ˆã»ã©å–å¾—ã—ãŸå¤œé–“å…‰ã®ImageCollectionã®ã‚ã‚‹1æ™‚ç‚¹ã®è¡›æ˜Ÿç”»åƒãŒå·¦ã§ã™ã€‚ãã®ä¸­ã«æ—¥æœ¬ã¨ã„ã†RegionãŒå­˜åœ¨ã—ã€ãã‚Œã‚’ee.Reducerã«ã‚ˆã£ã¦å®šé‡çš„ã«é›†ç´„ï¼ˆaggregateï¼‰ã—ã¾ã™ã€‚Earth Engine APIã«ã¯.reduceRegions()ãƒ¡ã‚½ãƒƒãƒ‰ãŒç”¨æ„ã•ã‚Œã¦ã„ã¾ã™ã®ã§ãã‚Œã‚’ç”¨ã„ã‚Œã°ã„ã„ã§ã™ã€‚å¼•æ•°ã¯ã€reducer=é›†ç´„æ–¹æ³•ï¼ˆã“ã“ã§ã¯åˆè¨ˆå€¤ï¼‰ã€collection=é›†ç´„ã‚’ã‹ã‘ã‚‹regionï¼ˆFeatureCollectionã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆï¼‰ã€scale=è§£åƒåº¦ã€ã§ã™ã€‚ä»¥ä¸‹ã§ã¯ã€ImageCollectionï¼ˆdatasetï¼‰ã®ä¸­ã«ã‚ã‚‹1ç•ªç›®ã®Imageã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã«.reduceRegions()ãƒ¡ã‚½ãƒƒãƒ‰ã‚’ã‹ã‘ã¦ã„ã¾ã™ã€‚\n# initialize output box time0 = dataset.first().get(\u0026#39;system:time_start\u0026#39;); first = dataset.first().reduceRegions(reducer=ee.Reducer.sum(),collection=japan,scale=1000).set(\u0026#39;time_start\u0026#39;, time0) æˆ‘ã€…ã¯æ™‚ç³»åˆ—ãƒ‡ãƒ¼ã‚¿ãŒæ¬²ã—ã„ã‚ã‘ã§ã™ã‹ã‚‰ã€ImageCollectionå†…ã«ã‚ã‚‹Imageãã‚Œãã‚Œã«å¯¾ã—ã¦åŒã˜å‡¦ç†ã‚’è¡Œã†å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚Earth Engineã«ã¯iterateã¨ã„ã†ä¾¿åˆ©ãªé–¢æ•°ãŒã‚ã‚Šã€å¼•æ•°ã«å‡¦ç†ã—ãŸã„é–¢æ•°ã‚’æ¸¡ã›ã°foræ–‡ã„ã‚‰ãšã§ã“ã®å‡¦ç†ã‚’è¡Œã£ã¦ãã‚Œã¾ã™ã€‚ã“ã“ã§ã¯Imageã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã«reduceRegionsãƒ¡ã‚½ãƒƒãƒ‰ã‚’å‡¦ç†ã—ãŸComputed Objectã‚’ä»¥å‰ã«å‡¦ç†ã—ãŸã‚‚ã®ã¨mergeã™ã‚‹myfuncã¨ã„ã†é–¢æ•°ã‚’å®šç¾©ã—ã€ãã‚Œã‚’iterateã«æ¸¡ã—ã¦ã„ã¾ã™ã€‚æœ€å¾Œã«ã€å…ˆã»ã©ã¨åŒã˜ãç”Ÿæˆã—ãŸãƒ‡ãƒ¼ã‚¿ã‚’getDownloadURLãƒ¡ã‚½ãƒƒãƒ‰ã‚’ç”¨ã„ã¦urlã‚’å–å¾—ã—ã¦ã„ã¾ã™ï¼ˆãƒ•ã‚¡ã‚¤ãƒ«å½¢å¼ã¯csvï¼‰ã€‚\n# define reduceRegions function for iteration def myfunc(image,first): added = image.reduceRegions(reducer=ee.Reducer.sum(),collection=japan,scale=1000).set(\u0026#39;time_start\u0026#39;, image.get(\u0026#39;system:time_start\u0026#39;)) return ee.FeatureCollection(first).merge(added) # implement iteration nightjp = dataset.filter(ee.Filter.date(\u0026#39;2014-02-01\u0026#39;,\u0026#39;2019-01-01\u0026#39;)).iterate(myfunc,first) # get url to download ee.FeatureCollection(nightjp).getDownloadURL(filetype=\u0026#39;csv\u0026#39;,selectors=ee.FeatureCollection(nightjp).first().propertyNames().getInfo()) CSVãƒ•ã‚¡ã‚¤ãƒ«ã®urlãŒå–å¾—ã§ãã¾ã—ãŸã€‚ã“ã®æ™‚ç³»åˆ—ã‚’ãƒ—ãƒ­ãƒƒãƒˆã—ã¦ä»Šæ—¥ã¯çµ‚ã‚ã‚Šã«ã—ãŸã„ã¨æ€ã„ã¾ã™ã€‚ ãƒ‡ãƒ¼ã‚¿ã‚’èª­ã¿è¾¼ã‚€ã¨ã“ã‚“ãªæ„Ÿã˜ã§ã™ã€‚\nimport pandas as pd import matplotlib.pyplot as plt plt.style.use(\u0026#39;ggplot\u0026#39;) nightjp_csv.head() ## system:index sum Country Unnamed: 3 Unnamed: 4\r## 0 2014/1/1 881512.4572 Japan NaN NaN\r## 1 2014/2/1 827345.3551 Japan NaN NaN\r## 2 2014/3/1 729110.4619 Japan NaN NaN\r## 3 2014/4/1 612665.8866 Japan NaN NaN\r## 4 2014/5/1 661434.5027 Japan NaN NaN\rplt.plot(pd.to_datetime(nightjp_csv[\u0026#39;system:index\u0026#39;]),nightjp_csv[\u0026#39;sum\u0026#39;]) ã‹ãªã‚Šå­£ç¯€æ€§ãŒã‚ã‚Šã¾ã™ã­ã€‚å†¬å ´ã¯æ—¥ç…§æ™‚é–“ãŒå°‘ãªã„ã“ã¨ã‚‚ã‚ã£ã¦å…‰é‡ãŒå¢—ãˆã¦ã„ã‚‹ã¿ãŸã„ã§ã™ã€‚ãã‚Œã«ã—ã¦ã‚‚æ€¥æ¿€ãªå¢—ãˆæ–¹ã§ã™ãŒã€‚æ¬¡å›ã¯ã“ã®ãƒ‡ãƒ¼ã‚¿ã¨æ™¯æ³æ„Ÿã®ä»£ç†å¤‰æ•°ã¨ãªã‚‹çµŒæ¸ˆçµ±è¨ˆã‚’å…ƒã«çµ±è¨ˆè§£æã‚’è¡Œã„ãŸã„ã¨æ€ã„ã¾ã™ã€‚ãŠãŸã®ã—ã¿ã«ã€‚\n","date":1563235200,"expirydate":-62135596800,"kind":"page","lang":"ja","lastmod":1563235200,"objectID":"933532735edaadd769f2e019e917078f","permalink":"/post/post12/","publishdate":"2019-07-16T00:00:00Z","relpermalink":"/post/post12/","section":"post","summary":"ã‚ªãƒ«ã‚¿ãƒŠãƒ†ã‚£ãƒ–ãƒ‡ãƒ¼ã‚¿ã‚’ç”¨ã„ãŸè§£æã‚„ã£ã¦ã¿ã¾ã—ãŸã€‚","tags":["Python","å‰å‡¦ç†","Earth Engine"],"title":"Google Earth Engine APIã§è¡›æ˜Ÿç”»åƒãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—ã—ã€æ™¯æ³æ„Ÿã‚’ãƒŠã‚¦ã‚­ãƒ£ã‚¹ãƒ†ã‚£ãƒ³ã‚°ã—ã¦ã¿ã‚‹","type":"post"},{"authors":null,"categories":["ç«¶é¦¬"],"content":"2å›ç›®ã«ãªã‚Šã¾ã™ãŒã€ã¾ãŸrvestã§éå»ã®ãƒ¬ãƒ¼ã‚¹çµæœã‚’è½ã¨ã—ã¦ã¿ãŸã„ã¨æ€ã„ã¾ã™ã€‚éå»ã®è¨˜äº‹ã‚’è¦‹ã¦ãªã„ã¨ã„ã†äººã¯å…ˆã«ãã¡ã‚‰ã‚’ã”è¦§ã«ãªã‚‰ã‚Œã‚‹ã“ã¨ã‚’ãŠå‹§ã‚ã—ã¾ã™ã€‚\nä»Šå›ãƒ‡ãƒ¼ã‚¿ã‚’å–ã‚Šç›´ãã†ã¨æ€ã£ãŸã®ã¯ã€ç«¶é¦¬ã®åˆ†æã‚’ã—ãŸéš›ã«ã‚ˆã‚Šå¤šãã®é …ç›®ã‚’èª¬æ˜å¤‰æ•°ã«åŠ ãˆã¦ã€åˆ†æã‚’ã—ãŸã„ã¨æ€ã£ãŸã‹ã‚‰ã§ã™ã€‚ãªã®ã§ã€ä»Šå›ã¯å‰å›ã®Rã‚¹ã‚¯ãƒªãƒ—ãƒˆã«è¿½è¨˜ã‚’è¡Œã†å½¢ã§ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã‚’ä½œæˆã—ã¾ã—ãŸã€‚æ–°ãŸã«è¿½åŠ ã—ãŸãƒ‡ãƒ¼ã‚¿é …ç›®ã¯ä»¥ä¸‹ã®14å€‹ã§ã™ã€‚\n èŠã‹ãƒ€ãƒ¼ãƒˆã‹ å³å›ã‚Šã‹å·¦å›ã‚Šã‹ ãƒ¬ãƒ¼ã‚¹ã‚³ãƒ³ãƒ‡ã‚£ã‚·ãƒ§ãƒ³ï¼ˆè‰¯ã‚„ç¨é‡ãªã©ï¼‰ å¤©å€™ é¦¬ã®æ¯›è‰²ï¼ˆæ —æ¯›ã€é¹¿æ¯›ãªã©ï¼‰ é¦¬ä¸» ç”Ÿç”£è€… ç”£åœ° ç”Ÿå¹´æœˆæ—¥ çˆ¶é¦¬ æ¯é¦¬ ãã®ãƒ¬ãƒ¼ã‚¹ã¾ã§ã®ç²å¾—è³é‡‘ï¼ˆ2003å¹´ã‹ã‚‰å…¥æ‰‹å¯èƒ½ï¼‰ ã‚¸ãƒ§ãƒƒã‚­ãƒ¼ã®ä½“é‡ ã‚¸ãƒ§ãƒƒã‚­ãƒ¼ã®ä½“é‡ã®å¢—æ¸›  å®Ÿã¯ã¾ã ãƒ‡ãƒ¼ã‚¿åé›†ã¯çµ‚ã‚ã£ã¦ã„ãªãã¦ã€Rã®ãƒ—ãƒ­ã‚°ãƒ©ãƒ ãŒãšã£ã¨å®Ÿè¡Œä¸­ã«ãªã£ã¦ã„ã¾ã™ï¼ˆ3æ—¥ãã‚‰ã„å›ã—ã¦ã„ã¾ã™ï¼‰ã€‚ã—ã‹ã—ã€ãƒ—ãƒ­ã‚°ãƒ©ãƒ è‡ªä½“ã¯ãã£ã¡ã‚Šå›ã£ã¦ã„ã‚‹ã®ã§ã‚¹ã‚¯ãƒªãƒ—ãƒˆã®ç´¹ä»‹ã‚’ã—ã¦ã„ã“ã†ã¨æ€ã„ã¾ã™ã€‚ã‚‚ã—ã‹ã—ãŸã‚‰è¿½è¨˜ã§çµæœã‚’æ›¸ãã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ã€‚\n1. ã‚¹ã‚¯ãƒªãƒ—ãƒˆã®ä¸­èº« ã¾ãšã¯ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®å‘¼ã³å‡ºã—ã§ã™ã€‚\n# rvestã«ã‚ˆã‚‹ç«¶é¦¬ãƒ‡ãƒ¼ã‚¿ã®webã‚¹ã‚¯ãƒ¬ã‚¤ãƒ”ãƒ³ã‚° #install.packages(\u0026#34;rvest\u0026#34;) #if (!require(\u0026#34;pacman\u0026#34;)) install.packages(\u0026#34;pacman\u0026#34;) #install.packages(\u0026#34;beepr\u0026#34;) #install.packages(\u0026#34;RSQLite\u0026#34;) pacman::p_load(qdapRegex) library(rvest) library(stringr) library(dplyr) library(beepr) library(RSQLite) ã‹ãªã‚ŠwarnningãŒå‡ºã‚‹ã®ã§ãã‚Œã‚’ç¦æ­¢ã—ã€SQLiteã«æ¥ç¶šã—ã¦ã„ã¾ã™\n# warnningç¦æ­¢ options(warn=-1) # SQLiteã¸ã®æ¥ç¶š con = dbConnect(SQLite(), \u0026#34;horse_data.db\u0026#34;, synchronous=\u0026#34;off\u0026#34;) 1994å¹´ã‹ã‚‰ã—ã‹ã‚ªãƒƒã‚ºãŒå–ã‚Œãªã„ã®ã§ã€1994å¹´ã‹ã‚‰ç›´è¿‘ã¾ã§ã®ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—ã—ã¾ã™ã€‚yahooç«¶é¦¬ã§ã¯æœˆã”ã¨ã«ãƒ¬ãƒ¼ã‚¹ãŒã¾ã¨ã‚ã‚‰ã‚Œã¦ã„ã‚‹ã®ã§ã€ãã‚Œã‚’å¤‰æ•°ã¨ã—ã¦ä½¿ç”¨ã—ãªãŒã‚‰ãƒ‡ãƒ¼ã‚¿ã‚’ã¨ã£ã¦ã„ãã¾ã™ã€‚åŸºæœ¬çš„ã«ã¯ã€è©²å½“å¹´ã€è©²å½“æœˆã®ãƒ¬ãƒ¼ã‚¹çµæœä¸€è¦§ã¸ã‚¢ã‚¯ã‚»ã‚¹ã—ã€ãã®ãƒšãƒ¼ã‚¸ä¸Šã®å„æ—¥ã®å€‹ã€…ã®ç«¶é¦¬å ´ã”ã¨ã®ã‚¿ã‚¤ãƒ ãƒ†ãƒ¼ãƒ–ãƒ«ã¸ã®ãƒªãƒ³ã‚¯ã‚’å–å¾—ã—ã¾ã™ã€‚å€‹ã€…ã®ç«¶é¦¬å ´ã§ãƒ¬ãƒ¼ã‚¹ã¯ã ã„ãŸã„12ã»ã©ã‚ã‚‹ã®ã§ã€ãã®ãƒªãƒ³ã‚¯ã‚’å–å¾—ã—ã€å„ãƒ¬ãƒ¼ã‚¹ã®ãƒ¬ãƒ¼ã‚¹çµæœãƒšãƒ¼ã‚¸ã«ã‚¢ã‚¯ã‚»ã‚¹ã—ã¾ã™ã€‚ãã—ã¦ã€ãƒ¬ãƒ¼ã‚¹çµæœã‚’å–å¾—ã—ã¦ã„ãã¾ã™ã€‚ã¾ãšã€å„æ—¥ã®å€‹ã€…ã®ç«¶é¦¬å ´ã”ã¨ã®ã‚¿ã‚¤ãƒ ãƒ†ãƒ¼ãƒ–ãƒ«ã¸ã®ãƒªãƒ³ã‚¯ã®å–å¾—æ–¹æ³•ã§ã™ã€‚\nfor(year in 1994:2019){ start.time \u0026lt;- Sys.time() # è¨ˆç®—æ™‚é–“ã‚’å›³ã‚‹ # yahooç«¶é¦¬ã®ãƒ¬ãƒ¼ã‚¹çµæœä¸€è¦§ãƒšãƒ¼ã‚¸ã®å–å¾— for (k in 1:12){ # kã¯æœˆã‚’è¡¨ã™ tryCatch( { keiba.yahoo \u0026lt;- read_html(str_c(\u0026#34;https://keiba.yahoo.co.jp/schedule/list/\u0026#34;, year,\u0026#34;/?month=\u0026#34;,k)) # è©²å½“å¹´ã€è©²å½“æœˆã®ãƒ¬ãƒ¼ã‚¹çµæœä¸€è¦§ã«ã‚¢ã‚¯ã‚»ã‚¹ Sys.sleep(2) race_lists \u0026lt;- keiba.yahoo %\u0026gt;% html_nodes(\u0026#34;a\u0026#34;) %\u0026gt;% html_attr(\u0026#34;href\u0026#34;) # å…¨urlã‚’å–å¾— # ç«¶é¦¬å ´ã”ã¨ã®å„æ—¥ã®ãƒ¬ãƒ¼ã‚¹ãƒªã‚¹ãƒˆã‚’å–å¾— race_lists \u0026lt;- race_lists[str_detect(race_lists, pattern=\u0026#34;race/list/\\\\d+/\u0026#34;)==1] # ã€Œresultã€ãŒå«ã¾ã‚Œã‚‹urlã‚’æŠ½å‡º } , error = function(e){signal \u0026lt;- 1} ) ã“ã“ã§ã¯ã€å–å¾—ã—ãŸãƒªãƒ³ã‚¯ã®urlã«resultã¨ã„ã†æ–‡å­—ãŒå«ã¾ã‚Œã¦ã„ã‚‹ã‚‚ã®ã ã‘ã‚’æŠ½å‡ºã—ã¦ã„ã¾ã™ã€‚è¦ã¯ãã‚ŒãŒå„ç«¶é¦¬å ´ã®ãƒ¬ãƒ¼ã‚¹ãƒ†ãƒ¼ãƒ–ãƒ«ã¸ã®ãƒªãƒ³ã‚¯ã¨ãªã‚Šã¾ã™ã€‚ã“ã“ã‹ã‚‰ã¯å–å¾—ã—ãŸç«¶é¦¬å ´ã®ãƒ¬ãƒ¼ã‚¹ãƒ†ãƒ¼ãƒ–ãƒ«ã®ãƒªãƒ³ã‚¯ã‚’ç”¨ã„ã¦ã€ãã®ãƒšãƒ¼ã‚¸ã«ã‚¢ã‚¯ã‚»ã‚¹ã—ã€å…¨12ãƒ¬ãƒ¼ã‚¹ãã‚Œãã‚Œã®ãƒ¬ãƒ¼ã‚¹çµæœãŒæ²è¼‰ã•ã‚Œã¦ã„ã‚‹ãƒšãƒ¼ã‚¸ã®ãƒªãƒ³ã‚¯ã‚’å–å¾—ã—ã¦ã„ãã¾ã™ã€‚\nfor (j in 1:length(race_lists)){ # jã¯å½“è©²å¹´æœˆã«ã‚ã£ãŸãƒ¬ãƒ¼ã‚¹ãƒ†ãƒ¼ãƒ–ãƒ«ã¸ã®ãƒªãƒ³ã‚¯ã‚’è¡¨ã™ tryCatch( { race_list \u0026lt;- read_html(str_c(\u0026#34;https://keiba.yahoo.co.jp\u0026#34;,race_lists[j])) race_url \u0026lt;- race_list %\u0026gt;% html_nodes(\u0026#34;a\u0026#34;) %\u0026gt;% html_attr(\u0026#34;href\u0026#34;) # å…¨urlã‚’å–å¾— # ãƒ¬ãƒ¼ã‚¹çµæœã®urlã‚’å–å¾— race_url \u0026lt;- race_url[str_detect(race_url, pattern=\u0026#34;result\u0026#34;)==1] # ã€Œresultã€ãŒå«ã¾ã‚Œã‚‹urlã‚’æŠ½å‡º } , error = function(e){signal \u0026lt;- 1} ) å„ãƒ¬ãƒ¼ã‚¹çµæœã¸ã®ãƒªãƒ³ã‚¯ãŒå–å¾—ã§ããŸã®ã§ã€ã“ã“ã‹ã‚‰ã¯ã„ã‚ˆã„ã‚ˆãƒ¬ãƒ¼ã‚¹çµæœã®å–å¾—ã¨ãã®æ•´å½¢ãƒ‘ãƒ¼ãƒˆã«å…¥ã‚Šã¾ã™ã€‚ã‹ãªã‚Šé•·ã£ãŸã‚‰ã—ãè¤‡é›‘ãªã‚³ãƒ¼ãƒ‰ã«ãªã£ã¦ã—ã¾ã„ã¾ã—ãŸã€‚ãƒ¬ãƒ¼ã‚¹çµæœã¯ä»¥ä¸‹ã®ã‚ˆã†ãªãƒ†ãƒ¼ãƒ–ãƒ«å±æ€§ã«æ ¼ç´ã•ã‚Œã¦ã„ã‚‹ã®ã§ã€ã¾ãšãã‚Œã‚’å˜ç´”ã«å¼•ã£å¼µã£ã¦ãã¾ã™ã€‚\nfor (i in 1:length(race_url)){ # iã¯å½“è©²å¹´æœˆå½“è©²ç«¶é¦¬å ´ã§é–‹å‚¬ã•ã‚ŒãŸãƒ¬ãƒ¼ã‚¹ã‚’è¡¨ã™ print(str_c(\u0026#34;ç¾åœ¨ã€\u0026#34;, year, \u0026#34;å¹´\u0026#34;, k, \u0026#34;æœˆ\u0026#34;,j, \u0026#34;ã‚°ãƒ«ãƒ¼ãƒ—ã€\u0026#34;, i,\u0026#34;ç•ªç›®ã®ãƒ¬ãƒ¼ã‚¹ã®ä¿å­˜ä¸­ã§ã™\u0026#34;)) tryCatch( { race1 \u0026lt;- read_html(str_c(\u0026#34;https://keiba.yahoo.co.jp\u0026#34;,race_url[i])) # ãƒ¬ãƒ¼ã‚¹çµæœã®urlã‚’å–å¾— signal \u0026lt;- 0 Sys.sleep(2) } , error = function(e){signal \u0026lt;- 1} ) # ãƒ¬ãƒ¼ã‚¹ãŒä¸­æ­¢orã“ã‚Œã¾ã§ã®éç¨‹ã§ã‚¨ãƒ©ãƒ¼ã§ãªã‘ã‚Œã°å‡¦ç†ã‚’å®Ÿè¡Œ if (identical(race1 %\u0026gt;% html_nodes(xpath = \u0026#34;//div[@class = \u0026#39;resultAtt mgnBL fntSS\u0026#39;]\u0026#34;) %\u0026gt;% html_text(),character(0)) == TRUE \u0026amp;\u0026amp; signal == 0){ # ãƒ¬ãƒ¼ã‚¹çµæœã‚’ã‚¹ã‚¯ãƒ¬ã‚¤ãƒ”ãƒ³ã‚° race_result \u0026lt;- race1 %\u0026gt;% html_nodes(xpath = \u0026#34;//table[@id = \u0026#39;raceScore\u0026#39;]\u0026#34;) %\u0026gt;% html_table() race_result \u0026lt;- do.call(\u0026#34;data.frame\u0026#34;,race_result) # ãƒªã‚¹ãƒˆã‚’ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ¬ãƒ¼ãƒ ã«å¤‰æ›´ colnames(race_result) \u0026lt;- c(\u0026#34;order\u0026#34;,\u0026#34;frame_number\u0026#34;,\u0026#34;horse_number\u0026#34;,\u0026#34;horse_name/age\u0026#34;,\u0026#34;time/margin\u0026#34;,\u0026#34;passing_rank/last_3F\u0026#34;,\u0026#34;jockey/weight\u0026#34;,\u0026#34;popularity/odds\u0026#34;,\u0026#34;trainer\u0026#34;) #ã€€åˆ—åå¤‰æ›´ tableã‚’ãŸã å–å¾—ã—ãŸã ã‘ã§ã¯ä»¥ä¸‹ã®ã‚ˆã†ã«\\nãŒå…¥ã£ã¦ã„ãŸã‚Šã€ä¸€ã¤ã®ã‚»ãƒ«ã«è¤‡æ•°ã®æƒ…å ±ãŒå…¥ã£ã¦ã„ãŸã‚Šã¨åˆ†æã«ã¯ä½¿ãˆãªã„ãƒ‡ãƒ¼ã‚¿ã¨ãªã£ã¦ã„ã¾ã™ã€‚ãªã®ã§ã€ã“ã‚Œã‚’æˆå‹ã™ã‚‹å¿…è¦ãŒå‡ºã¦ãã¾ã™ã€‚\n# é€šéé †ä½ã¨ä¸Šã‚Š3Fã®ã‚¿ã‚¤ãƒ  race_result \u0026lt;- dplyr::mutate(race_result,passing_rank=as.character(str_extract_all(race_result$`passing_rank/last_3F`,\u0026#34;(\\\\d{2}-\\\\d{2}-\\\\d{2}-\\\\d{2})|(\\\\d{2}-\\\\d{2}-\\\\d{2})|(\\\\d{2}-\\\\d{2})\u0026#34;))) race_result \u0026lt;- dplyr::mutate(race_result,last_3F=as.character(str_extract_all(race_result$`passing_rank/last_3F`,\u0026#34;\\\\d{2}\\\\.\\\\d\u0026#34;))) race_result \u0026lt;- race_result[-6] # ã‚¿ã‚¤ãƒ ã¨ç€å·® race_result \u0026lt;- dplyr::mutate(race_result,time=as.character(str_extract_all(race_result$`time/margin`,\u0026#34;\\\\d\\\\.\\\\d{2}\\\\.\\\\d|\\\\d{2}\\\\.\\\\d\u0026#34;))) race_result \u0026lt;- dplyr::mutate(race_result,margin=as.character(str_extract_all(race_result$`time/margin`,\u0026#34;./.é¦¬èº«|.é¦¬èº«|.[:space:]./.é¦¬èº«|[ã‚¢-ãƒ³-]+\u0026#34;))) race_result$margin[race_result$order==1] \u0026lt;- \u0026#34;ãƒˆãƒƒãƒ—\u0026#34; race_result$margin[race_result$margin==\u0026#34;character(0)\u0026#34;] \u0026lt;- \u0026#34;å¤§å·®\u0026#34; race_result$margin[race_result$order==0] \u0026lt;- NA race_result \u0026lt;- race_result[-5] # é¦¬åã€é¦¬é½¢ã€é¦¬ä½“é‡ race_result \u0026lt;- dplyr::mutate(race_result,horse_name=as.character(str_extract_all(race_result$`horse_name/age`,\u0026#34;[ã‚¡-ãƒ´ãƒ¼ãƒ»]+\u0026#34;))) race_result \u0026lt;- dplyr::mutate(race_result,horse_age=as.character(str_extract_all(race_result$`horse_name/age`,\u0026#34;ç‰¡\\\\d+|ç‰\\\\d+|ã›ã‚“\\\\d+\u0026#34;))) race_result$horse_sex \u0026lt;- str_extract(race_result$horse_age, pattern = \u0026#34;ç‰¡|ç‰|ã›ã‚“\u0026#34;) race_result$horse_age \u0026lt;- str_extract(race_result$horse_age, pattern = \u0026#34;\\\\d\u0026#34;) race_result \u0026lt;- dplyr::mutate(race_result,horse_weight=as.character(str_extract_all(race_result$`horse_name/age`,\u0026#34;\\\\d{3}\u0026#34;))) race_result \u0026lt;- dplyr::mutate(race_result,horse_weight_change=as.character(str_extract_all(race_result$`horse_name/age`,\u0026#34;\\\\([\\\\+|\\\\-]\\\\d+\\\\)|\\\\([\\\\d+]\\\\)\u0026#34;))) race_result$horse_weight_change \u0026lt;- sapply(rm_round(race_result$horse_weight_change, extract=TRUE), paste, collapse=\u0026#34;\u0026#34;) race_result \u0026lt;- dplyr::mutate(race_result,brinker=as.character(str_extract_all(race_result$`horse_name/age`,\u0026#34;B\u0026#34;))) race_result$brinker[race_result$brinker!=\u0026#34;B\u0026#34;] \u0026lt;- \u0026#34;N\u0026#34; race_result \u0026lt;- race_result[-4] # ã‚¸ãƒ§ãƒƒã‚­ãƒ¼ race_result \u0026lt;- dplyr::mutate(race_result,jockey=as.character(str_extract_all(race_result$`jockey/weight`,\u0026#34;[ã-ã‚“ä¸€-é¾ ]+\\\\s[ã-ã‚“ä¸€-é¾ ]+|[:upper:].[ã‚¡-ãƒ¶ãƒ¼]+\u0026#34;))) race_result \u0026lt;- dplyr::mutate(race_result,jockey_weight=as.character(str_extract_all(race_result$`jockey/weight`,\u0026#34;\\\\d{2}\u0026#34;))) race_result$jockey_weight_change \u0026lt;- 0 race_result$jockey_weight_change[str_detect(race_result$`jockey/weight`,\u0026#34;â˜†\u0026#34;)==1] \u0026lt;- 1 race_result$jockey_weight_change[str_detect(race_result$`jockey/weight`,\u0026#34;â–³\u0026#34;)==1] \u0026lt;- 2 race_result$jockey_weight_change[str_detect(race_result$`jockey/weight`,\u0026#34;â–³\u0026#34;)==1] \u0026lt;- 3 race_result \u0026lt;- race_result[-4] # ã‚ªãƒƒã‚ºã¨äººæ°— race_result \u0026lt;- dplyr::mutate(race_result,odds=as.character(str_extract_all(race_result$`popularity/odds`,\u0026#34;\\\\(.+\\\\)\u0026#34;))) race_result \u0026lt;- dplyr::mutate(race_result,popularity=as.character(str_extract_all(race_result$`popularity/odds`,\u0026#34;\\\\d+[^(\\\\d+.\\\\d)]\u0026#34;))) race_result$odds \u0026lt;- sapply(rm_round(race_result$odds, extract=TRUE), paste, collapse=\u0026#34;\u0026#34;) race_result \u0026lt;- race_result[-4] æ¬¡ã«ã€ä»Šå–å¾—ã—ãŸtableä»¥å¤–ã®æƒ…å ±ã‚‚å–ã‚Šè¾¼ã‚€ã“ã¨ã«ã—ã¾ã™ã€‚å…·ä½“çš„ã«ã¯ã€ãƒ¬ãƒ¼ã‚¹åã‚„å¤©å€™ã€é¦¬å ´çŠ¶æ…‹ã€æ—¥ä»˜ã€ç«¶é¦¬å ´ãªã©ã§ã™ã€‚ã“ã‚Œã‚‰ã®æƒ…å ±ã¯ãƒ¬ãƒ¼ã‚¹çµæœãƒšãƒ¼ã‚¸ã®ä¸Šéƒ¨ã«æ²è¼‰ã•ã‚Œã¦ã„ã¾ã™ã€‚\n# ãƒ¬ãƒ¼ã‚¹æƒ…å ± race_date \u0026lt;- race1 %\u0026gt;% html_nodes(xpath = \u0026#34;//div[@id = \u0026#39;raceTitName\u0026#39;]/p[@id = \u0026#39;raceTitDay\u0026#39;]\u0026#34;) %\u0026gt;% html_text() race_name \u0026lt;- race1 %\u0026gt;% html_nodes(xpath = \u0026#34;//div[@id = \u0026#39;raceTitName\u0026#39;]/h1[@class = \u0026#39;fntB\u0026#39;]\u0026#34;) %\u0026gt;% html_text() race_distance \u0026lt;- race1 %\u0026gt;% html_nodes(xpath = \u0026#34;//p[@id = \u0026#39;raceTitMeta\u0026#39;]\u0026#34;) %\u0026gt;% html_text() race_result \u0026lt;- dplyr::mutate(race_result,race_date=as.character(str_extract_all(race_date,\u0026#34;\\\\d+å¹´\\\\d+æœˆ\\\\d+æ—¥\u0026#34;))) race_result$race_date \u0026lt;- str_replace_all(race_result$race_date,\u0026#34;å¹´\u0026#34;,\u0026#34;/\u0026#34;) race_result$race_date \u0026lt;- str_replace_all(race_result$race_date,\u0026#34;æœˆ\u0026#34;,\u0026#34;/\u0026#34;) race_result$race_date \u0026lt;- as.Date(race_result$race_date) race_course \u0026lt;- as.character(str_extract_all(race_date,pattern = \u0026#34;æœ­å¹Œ|å‡½é¤¨|ç¦å³¶|æ–°æ½Ÿ|æ±äº¬|ä¸­å±±|ä¸­äº¬|äº¬éƒ½|é˜ªç¥|å°å€‰\u0026#34;)) race_result$race_course \u0026lt;- race_course race_result \u0026lt;- dplyr::mutate(race_result,race_name=as.character(str_replace_all(race_name,\u0026#34;\\\\s\u0026#34;,\u0026#34;\u0026#34;))) race_result \u0026lt;- dplyr::mutate(race_result,race_distance=as.character(str_extract_all(race_distance,\u0026#34;\\\\d+m\u0026#34;))) race_type=as.character(str_extract_all(race_distance,pattern = \u0026#34;èŠ|ãƒ€ãƒ¼ãƒˆ\u0026#34;)) race_result$type \u0026lt;- race_type race_turn \u0026lt;- as.character(str_extract_all(race_distance,pattern = \u0026#34;å³|å·¦\u0026#34;)) race_result$race_turn \u0026lt;- race_turn if(length(race1 %\u0026gt;% html_nodes(xpath = \u0026#34;//img[@class = \u0026#39;spBg ryou\u0026#39;]\u0026#34;)) == 1){ race_result$race_condition \u0026lt;- \u0026#34;è‰¯\u0026#34; } else if (length(race1 %\u0026gt;% html_nodes(xpath = \u0026#34;//img[@class = \u0026#39;spBg yayaomo\u0026#39;]\u0026#34;)) == 1){ race_result$race_condition \u0026lt;- \u0026#34;ç¨é‡\u0026#34; } else if (length(race1 %\u0026gt;% html_nodes(xpath = \u0026#34;//img[@class = \u0026#39;spBg omo\u0026#39;]\u0026#34;)) == 1){ race_result$race_condition \u0026lt;- \u0026#34;é‡\u0026#34; } else if (length(race1 %\u0026gt;% html_nodes(xpath = \u0026#34;//img[@class = \u0026#39;spBg furyou\u0026#39;]\u0026#34;)) == 1){ race_result$race_condition \u0026lt;- \u0026#34;ä¸è‰¯\u0026#34; } else race_result$race_condition \u0026lt;- \u0026#34;NA\u0026#34; if (length(race1 %\u0026gt;% html_nodes(xpath = \u0026#34;//img[@class = \u0026#39;spBg hare\u0026#39;]\u0026#34;)) == 1){ race_result$race_weather \u0026lt;- \u0026#34;æ™´ã‚Œ\u0026#34; } else if (length(race1 %\u0026gt;% html_nodes(xpath = \u0026#34;//img[@class = \u0026#39;spBg ame\u0026#39;]\u0026#34;)) == 1){ race_result$race_weather \u0026lt;- \u0026#34;æ›‡ã‚Š\u0026#34; } else if (length(race1 %\u0026gt;% html_nodes(xpath = \u0026#34;//img[@class = \u0026#39;spBg kumori\u0026#39;]\u0026#34;)) == 1){ race_result$race_weather \u0026lt;- \u0026#34;é›¨\u0026#34; } else race_result$race_weather \u0026lt;- \u0026#34;ãã®ä»–\u0026#34; æ¬¡ã¯å„é¦¬ã®æƒ…å ±ã§ã™ã€‚ å®Ÿã¯ã•ãã»ã©å–å¾—ã—ãŸtableã®é¦¬åã¯ãƒªãƒ³ã‚¯ã«ãªã£ã¦ãŠã‚Šã€ãã®ãƒªãƒ³ã‚¯ã‚’ãŸã©ã‚‹ã¨å„é¦¬ã®æƒ…å ±ãŒå–å¾—ã§ãã¾ã™ï¼ˆæ¯›è‰²ã‚„ç”Ÿå¹´æœˆæ—¥ãªã©ï¼‰ã€‚\nhorse_url \u0026lt;- race1 %\u0026gt;% html_nodes(\u0026#34;a\u0026#34;) %\u0026gt;% html_attr(\u0026#34;href\u0026#34;) horse_url \u0026lt;- horse_url[str_detect(horse_url, pattern=\u0026#34;directory/horse\u0026#34;)==1] # é¦¬æƒ…å ±ã®ãƒªãƒ³ã‚¯ã ã‘æŠ½å‡ºã™ã‚‹ for (l in 1:length(horse_url)){ tryCatch( { horse1 \u0026lt;- read_html(str_c(\u0026#34;https://keiba.yahoo.co.jp\u0026#34;,horse_url[l])) Sys.sleep(0.5) horse_name \u0026lt;- horse1 %\u0026gt;% html_nodes(xpath = \u0026#34;//div[@id = \u0026#39;dirTitName\u0026#39;]/h1[@class = \u0026#39;fntB\u0026#39;]\u0026#34;) %\u0026gt;% html_text() horse \u0026lt;- horse1 %\u0026gt;% html_nodes(xpath = \u0026#34;//div[@id = \u0026#39;dirTitName\u0026#39;]/ul\u0026#34;) %\u0026gt;% html_text() race_result$colour[race_result$horse_name==horse_name] \u0026lt;- as.character(str_extract_all(horse,\u0026#34;æ¯›è‰²ï¼š.+\u0026#34;)) race_result$owner[race_result$horse_name==horse_name] \u0026lt;- as.character(str_extract_all(horse,\u0026#34;é¦¬ä¸»ï¼š.+\u0026#34;)) race_result$farm[race_result$horse_name==horse_name] \u0026lt;- as.character(str_extract_all(horse,\u0026#34;ç”Ÿç”£è€…ï¼š.+\u0026#34;)) race_result$locality[race_result$horse_name==horse_name] \u0026lt;- as.character(str_extract_all(horse,\u0026#34;ç”£åœ°ï¼š.+\u0026#34;)) race_result$horse_birthday[race_result$horse_name==horse_name] \u0026lt;- as.character(str_extract_all(horse,\u0026#34;\\\\d+å¹´\\\\d+æœˆ\\\\d+æ—¥\u0026#34;)) race_result$father[race_result$horse_name==horse_name] \u0026lt;- horse1 %\u0026gt;% html_nodes(xpath = \u0026#34;//td[@class = \u0026#39;bloodM\u0026#39;][@rowspan = \u0026#39;4\u0026#39;]\u0026#34;) %\u0026gt;% html_text() race_result$mother[race_result$horse_name==horse_name] \u0026lt;- horse1 %\u0026gt;% html_nodes(xpath = \u0026#34;//td[@class = \u0026#39;bloodF\u0026#39;][@rowspan = \u0026#39;4\u0026#39;]\u0026#34;) %\u0026gt;% html_text() } , error = function(e){ race_result$colour[race_result$horse_name==horse_name] \u0026lt;- NA race_result$owner[race_result$horse_name==horse_name] \u0026lt;- NA race_result$farm[race_result$horse_name==horse_name] \u0026lt;- NA race_result$locality[race_result$horse_name==horse_name] \u0026lt;- NA race_result$horse_birthday[race_result$horse_name==horse_name] \u0026lt;- NA race_result$father[race_result$horse_name==horse_name] \u0026lt;- NA race_result$mother[race_result$horse_name==horse_name] \u0026lt;- NA } ) } race_result$colour \u0026lt;- str_replace_all(race_result$colour,\u0026#34;æ¯›è‰²ï¼š\u0026#34;,\u0026#34;\u0026#34;) race_result$owner \u0026lt;- str_replace_all(race_result$owner,\u0026#34;é¦¬ä¸»ï¼š\u0026#34;,\u0026#34;\u0026#34;) race_result$farm \u0026lt;- str_replace_all(race_result$farm,\u0026#34;ç”Ÿç”£è€…ï¼š\u0026#34;,\u0026#34;\u0026#34;) race_result$locality \u0026lt;- str_replace_all(race_result$locality,\u0026#34;ç”£åœ°ï¼š\u0026#34;,\u0026#34;\u0026#34;) #race_result$horse_birthday \u0026lt;- str_replace_all(race_result$horse_birthday,\u0026#34;å¹´\u0026#34;,\u0026#34;/\u0026#34;) #race_result$horse_birthday \u0026lt;- str_replace_all(race_result$horse_birthday,\u0026#34;æœˆ\u0026#34;,\u0026#34;/\u0026#34;) #race_result$horse_birthday \u0026lt;- as.Date(race_result$horse_birthday) race_result \u0026lt;- dplyr::arrange(race_result,horse_number) # é¦¬ç•ªé †ã«ä¸¦ã¹ã‚‹ æ¬¡ã«ãã®ãƒ¬ãƒ¼ã‚¹ã¾ã§ã«ç²å¾—ã—ãŸè³é‡‘é¡ã‚’è½ã¨ã—ã«è¡Œãã¾ã™ã€‚ã“ã‚Œã¯ãƒ¬ãƒ¼ã‚¹çµæœã®ãƒšãƒ¼ã‚¸ã®å‡ºé¦¬è¡¨ã¨æ›¸ã‹ã‚ŒãŸãƒªãƒ³ã‚¯ã‚’ãŸã©ã‚‹ã¨ã‚¢ã‚¯ã‚»ã‚¹ã§ãã¾ã™ã€‚ã“ã“ã«è³é‡‘ãŒã‚ã‚‹ã®ã§ãã‚Œã‚’å–å¾—ã—ã¾ã™ã€‚\nyosou_url \u0026lt;- race1 %\u0026gt;% html_nodes(\u0026#34;a\u0026#34;) %\u0026gt;% html_attr(\u0026#34;href\u0026#34;) yosou_url \u0026lt;- yosou_url[str_detect(yosou_url, pattern=\u0026#34;denma\u0026#34;)==1] if (length(yosou_url)==1){ yosou1 \u0026lt;- read_html(str_c(\u0026#34;https://keiba.yahoo.co.jp\u0026#34;,yosou_url)) Sys.sleep(2) yosou \u0026lt;- yosou1 %\u0026gt;% html_nodes(xpath = \u0026#34;//td[@class = \u0026#39;txC\u0026#39;]\u0026#34;) %\u0026gt;% as.character() prize \u0026lt;- yosou[grepl(\u0026#34;ä¸‡\u0026#34;,yosou)==TRUE] %\u0026gt;% str_extract_all(\u0026#34;\\\\d+ä¸‡\u0026#34;) prize \u0026lt;- t(do.call(\u0026#34;data.frame\u0026#34;,prize)) %\u0026gt;% as.character() race_result$prize \u0026lt;- prize race_result$prize \u0026lt;- str_replace_all(race_result$prize,\u0026#34;ä¸‡\u0026#34;,\u0026#34;\u0026#34;) %\u0026gt;% as.numeric() } else race_result$prize \u0026lt;- NA å–å¾—ã—ãŸå„ãƒ¬ãƒ¼ã‚¹çµæœã‚’æ ¼ç´ã™ã‚‹datasetã¨ã„ã†ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ¬ãƒ¼ãƒ ã‚’ä½œæˆã—ã€ãƒ‡ãƒ¼ã‚¿ã‚’æ ¼ç´ã—ã¦ã„ãã¾ã™ã€‚1å¹´ã”ã¨ã«ãã‚Œã‚’SQLite ã¸ä¿å­˜ã—ã¦ã„ãã¾ã™ã€‚\n## ãƒ•ã‚¡ã‚¤ãƒ«è²¯ã‚ã‚‹ã®ã‹ã if (k == 1 \u0026amp;\u0026amp; i == 1 \u0026amp;\u0026amp; j == 1){ dataset \u0026lt;- race_result } else { dataset \u0026lt;- rbind(dataset,race_result) } # ifæ–‡2ã®çµ‚ã‚ã‚Š }else { print(\u0026#34;ä¿å­˜ã§ãã¾ã›ã‚“ã§ã—ãŸ\u0026#34;) }# ifæ–‡1ã®çµ‚ã‚ã‚Š } # iãƒ«ãƒ¼ãƒ—ã®çµ‚ã‚ã‚Š } # jãƒ«ãƒ¼ãƒ—çµ‚ã‚ã‚Š } # kãƒ«ãƒ¼ãƒ—ã®çµ‚ã‚ã‚Š beep(3) write.csv(dataset,\u0026#34;race_result2.csv\u0026#34;, row.names = FALSE) if (year == 1994){ dbWriteTable(con, \u0026#34;race_result\u0026#34;, dataset) } else { dbWriteTable(con, \u0026#34;temp\u0026#34;, dataset) dbSendQuery(con, \u0026#34;INSERT INTO race_result select * from temp\u0026#34;) dbSendQuery(con, \u0026#34;DROP TABLE temp\u0026#34;) } # ifã®çµ‚ã‚ã‚Š } # yearãƒ«ãƒ¼ãƒ—ã®çµ‚ã‚ã‚Š end.time \u0026lt;- Sys.time() print(str_c(\u0026#34;å‡¦ç†æ™‚é–“ã¯\u0026#34;,end.time-start.time,\u0026#34;ã§ã™ã€‚\u0026#34;)) beep(5) options(warn = 1) dbDisconnect(con) ä»¥ä¸Šã§ã™ã€‚å–ã‚ŒãŸãƒ‡ãƒ¼ã‚¿ã¯ä»¥ä¸‹ã®ã‚ˆã†ã«ãªã‚Šã¾ã—ãŸã€‚\nhead(race_result) ## order frame_number horse_number trainer passing_rank last_3F time\r## 1 10 1 1 ç”°ä¸­ å‰› 09-09 39.0 1.14.3\r## 2 16 1 2 å¤©é–“ æ˜­ä¸€ 11-11 40.3 1.15.7\r## 3 15 2 3 ç”°ä¸­ æ¸…éš† 14-14 39.4 1.15.1\r## 4 9 2 4 ä¸­èˆ˜ è‹±äºŒ 08-08 39.1 1.14.3\r## 5 12 3 5 æ ¹æœ¬ åº·åºƒ 11-11 39.0 1.14.4\r## 6 4 3 6 æ‰æµ¦ å®æ˜­ 04-04 38.4 1.13.2\r## margin horse_name horse_age horse_sex horse_weight\r## 1 ã‚¢ã‚¿ãƒ ã‚µãƒˆãƒã‚¸ãƒ§ãƒ‹ãƒ¼ 3 ç‰¡ 512\r## 2 3 1/2é¦¬èº« ãƒ„ã‚®ãƒã‚¤ãƒƒãƒ† 3 ç‰¡ 464\r## 3 3é¦¬èº« ã‚®ãƒ¥ã‚¦ãƒ› 3 ç‰¡ 444\r## 4 2 1/2é¦¬èº« ã‚»ã‚¤ã‚¦ãƒ³ãƒ¡ãƒ©ãƒ“ãƒªã‚¢ 3 ç‰ 466\r## 5 ã‚¯ãƒ“ ã‚µãƒã‚¤ãƒãƒ«ãƒˆãƒªãƒƒã‚¯ 3 ç‰ 450\r## 6 ã‚¢ã‚¿ãƒ ã‚¹ãƒ†ã‚¤ãƒ›ãƒƒãƒˆ 3 ç‰ 474\r## horse_weight_change brinker jockey jockey_weight jockey_weight_change\r## 1 +30 N æ¾å²¡ æ­£æµ· 56 0\r## 2 +8 N è¥¿ç”° é›„ä¸€éƒ 56 0\r## 3 +8 N æ‰åŸ èª äºº 56 0\r## 4 +10 N æ‘ç”° ä¸€èª  54 0\r## 5 -2 N é‡ä¸­ æ‚ å¤ªéƒ 51 0\r## 6 -2 N å¤§é‡ æ‹“å¼¥ 54 0\r## odds popularity race_date race_course race_name race_distance type\r## 1 40.3 9 2019-01-05 ä¸­å±± ã‚µãƒ©ç³»3æ­³æœªå‹åˆ© 1200m ãƒ€ãƒ¼ãƒˆ\r## 2 340.9 16 2019-01-05 ä¸­å±± ã‚µãƒ©ç³»3æ­³æœªå‹åˆ© 1200m ãƒ€ãƒ¼ãƒˆ\r## 3 283.1 14 2019-01-05 ä¸­å±± ã‚µãƒ©ç³»3æ­³æœªå‹åˆ© 1200m ãƒ€ãƒ¼ãƒˆ\r## 4 299.7 15 2019-01-05 ä¸­å±± ã‚µãƒ©ç³»3æ­³æœªå‹åˆ© 1200m ãƒ€ãƒ¼ãƒˆ\r## 5 26.7 8 2019-01-05 ä¸­å±± ã‚µãƒ©ç³»3æ­³æœªå‹åˆ© 1200m ãƒ€ãƒ¼ãƒˆ\r## 6 2.4 1 2019-01-05 ä¸­å±± ã‚µãƒ©ç³»3æ­³æœªå‹åˆ© 1200m ãƒ€ãƒ¼ãƒˆ\r## race_turn race_condition race_weather colour owner\r## 1 å³ è‰¯ æ™´ã‚Œ æ —æ¯› æ ªå¼ä¼šç¤¾ ã‚µãƒˆãƒŸãƒ›ãƒ¼ã‚¹ã‚«ãƒ³ãƒ‘ãƒ‹ãƒ¼\r## 2 å³ è‰¯ æ™´ã‚Œ é»’é¹¿æ¯› è¥¿æ‘ æ–°ä¸€éƒ\r## 3 å³ è‰¯ æ™´ã‚Œ é¹¿æ¯› æœ‰é™ä¼šç¤¾ ãƒŸãƒ«ãƒ•ã‚¡ãƒ¼ãƒ \r## 4 å³ è‰¯ æ™´ã‚Œ é’é¹¿æ¯› è¥¿å±± èŒ‚è¡Œ\r## 5 å³ è‰¯ æ™´ã‚Œ é»’é¹¿æ¯› ç¦ç”° å…‰åš\r## 6 å³ è‰¯ æ™´ã‚Œ æ —æ¯› å°æ— å–„ä¸€\r## farm locality horse_birthday father\r## 1 åƒä»£ç”°ç‰§å ´ æ–°ã²ã ã‹ç”º 2016å¹´1æœˆ29æ—¥ ã‚ªãƒ«ãƒ•ã‚§ãƒ¼ãƒ´ãƒ«\r## 2 ç¹”ç¬  æ™‚ç”· é’æ£®çœŒ 2016å¹´4æœˆ17æ—¥ ã‚¹ã‚¯ãƒ¯ãƒ¼ãƒˆãƒ«ã‚¹ã‚¯ãƒ¯ãƒ¼ãƒˆ\r## 3 ç¥å£ é“å¼˜ æ–°ã²ã ã‹ç”º 2016å¹´4æœˆ19æ—¥ ã‚¸ãƒ£ãƒ³ã‚°ãƒ«ãƒã‚±ãƒƒãƒˆ\r## 4 çŸ³éƒ·å²¡ é›…æ¨¹ æ–°å† ç”º 2016å¹´4æœˆ21æ—¥ ã‚­ãƒ³ã‚·ãƒ£ã‚µãƒã‚­ã‚»ã‚­\r## 5 åŸç”°ç‰§å ´ æ—¥é«˜ç”º 2016å¹´4æœˆ30æ—¥ ãƒªãƒ¼ãƒã‚¶ã‚¯ãƒ©ã‚¦ãƒ³\r## 6 ç¤¾å°ãƒ•ã‚¡ãƒ¼ãƒ  åƒæ­³å¸‚ 2016å¹´3æœˆ13æ—¥ ã‚­ãƒ£ãƒ—ãƒ†ãƒ³ãƒˆã‚¥ãƒ¼ãƒ¬\r## mother prize\r## 1 ã‚¹ãƒ‘ãƒ¼ã‚¯ãƒ«ã‚¸ãƒ¥ã‚¨ãƒ« 0\r## 2 ã‚¨ãƒ—ã‚½ãƒ ã‚¢ã‚¤ãƒªã‚¹ 0\r## 3 ãƒ‡ãƒ©ã‚¤ãƒˆã‚·ãƒ¼ãƒ³ 0\r## 4 ãƒ‰ãƒªãƒ¼ãƒ ã‚·ãƒƒãƒ— 0\r## 5 ãƒ•ãƒªãƒ¼ãƒ€ãƒ ã‚¬ãƒ¼ãƒ« 180\r## 6 ã‚¹ãƒ†ã‚¤ã‚¢ãƒ©ã‚¤ãƒ´ 455\r","date":1562976000,"expirydate":-62135596800,"kind":"page","lang":"ja","lastmod":1562976000,"objectID":"290827b2bff5fc58ceb8d3e3c7aa86ac","permalink":"/post/post11/","publishdate":"2019-07-13T00:00:00Z","relpermalink":"/post/post11/","section":"post","summary":"å‰å›ã®ãƒ‡ãƒ¼ã‚¿åé›†ã§ã¯è¶³ã‚Šãªã„ãƒ‡ãƒ¼ã‚¿ãŒã‚ã£ãŸã®ã§å†åº¦ã‚¹ã‚¯ãƒ¬ã‚¤ãƒ”ãƒ³ã‚°ã—ã¦ã¿ã¾ã—ãŸã€‚","tags":["R","Webã‚¹ã‚¯ãƒ¬ã‚¤ãƒ”ãƒ³ã‚°","å‰å‡¦ç†","SQL"],"title":"rvestã§yahooç«¶é¦¬ã«ã‚ã‚‹éå»ã®ãƒ¬ãƒ¼ã‚¹çµæœã‚’ã‚¹ã‚¯ãƒ¬ã‚¤ãƒ”ãƒ³ã‚°ã—ã¦ã¿ãŸï¼ˆ2å›ç›®ï¼‰","type":"post"},{"authors":null,"categories":["ãƒã‚¯ãƒ­çµŒæ¸ˆå­¦"],"content":"ãŠã¯ã“ã‚“ã°ã‚“ã«ã¡ã¯ã€‚ ãšã„ã¶ã‚“å‰ã«Gianonne et al (2008)ã®ãƒãƒ«ãƒãƒ•ã‚¡ã‚¯ã‚¿ãƒ¼ãƒ¢ãƒ‡ãƒ«ã§å››åŠæœŸGDPã®äºˆæƒ³ã‚’è¡Œã„ã¾ã—ãŸã€‚ çµæœã¨ã—ã¦ã¯ã€ã‚ã‚‹ç¨‹åº¦ã¯äºˆæ¸¬ç²¾åº¦ãŒå‡ºã¦ã„ãŸã‚‚ã®ã®å½¼ã‚‰ã®è«–æ–‡ã»ã©ã¯æº€è¶³ã®ã„ãã‚‚ã®ã§ã¯ã‚ã‚Šã¾ã›ã‚“ã§ã—ãŸã€‚åŸå› ã¨ã—ã¦ã¯ã‚¯ãƒ­ã‚¹ã‚»ã‚¯ã‚·ãƒ§ãƒŠãƒ«ãªãƒ‡ãƒ¼ã‚¿ä¸è¶³ãŒå¤§ãã„ã¨æ€ã‚ã‚Œã€ç¾åœ¨åé›†æ–¹æ³•ã«ã¤ã„ã¦ã‚‚EXCELã‚’ç”¨ã„ã¦æ”¹ä¿®ä¸­ã§ã™ã€‚ã—ã‹ã—ä¸€æ–¹ã§ã€ãƒãƒ«ãƒãƒ•ã‚¡ã‚¯ã‚¿ãƒ¼ãƒ¢ãƒ‡ãƒ«ã®æ”¹å–„ã‚‚è€ƒãˆãŸã„ã¨æ€ã£ã¦ã„ã¾ã™ã€‚å‰å›ã¯æœˆæ¬¡çµŒæ¸ˆçµ±è¨ˆã‚’ä¸»æˆåˆ†åˆ†æï¼ˆå®Ÿéš›ã«ã¯ã‚«ãƒ«ãƒãƒ³ãƒ•ã‚£ãƒ«ã‚¿ï¼‰ã‚’ç”¨ã„ã¦æ¬¡å…ƒå‰Šæ¸›ã‚’è¡Œã„ã€ä¸»æˆåˆ†å¾—ç‚¹ã‚’èª¬æ˜å¤‰æ•°ã¨ã—ã¦GDPã«å›å¸°ã—ã¾ã—ãŸã€‚ä»Šå›ã¯ã“ã®ä¸»æˆåˆ†åˆ†æã®ãƒ‰ç™ºå±•ç‰ˆã§ã‚ã‚‹Gaussian Process Latent Variable Model(GPLVM)ã‚’ç”¨ã„ã¦ãƒ•ã‚¡ã‚¯ã‚¿ãƒ¼ã‚’è¨ˆç®—ã—ã€ãã‚Œã‚’GDPã«å›å¸°ã—ãŸã„ã¨æ€ã„ã¾ã™ã€‚\n1. GPLVMã¨ã¯ GPLVMã¨ã¯ã€Gaussian Process Modelã®ä¸€ç¨®ã§ã™ã€‚ä»¥å‰ã€Gaussian Process Regressionã®è¨˜äº‹ã‚’æ›¸ãã¾ã—ãŸã€‚\næœ€ã‚‚åŸºæœ¬çš„ãªGaussian Process Modelã¯ä¸Šã®è¨˜äº‹ã®ã‚ˆã†ãªãƒ¢ãƒ‡ãƒ«ã§ã€éèª¬æ˜å¤‰æ•°$Y=(y_{1},y_{2},\u0026hellip;,y_{n})$ã¨èª¬æ˜å¤‰æ•°$X=(\\textbf{x}_{1},\\textbf{x}_{2},\u0026hellip;,\\textbf{x}_{n})$ãŒã‚ã‚Šã€ä»¥ä¸‹ã®ã‚ˆã†ãªé–¢ä¿‚å¼ã§è¡¨ã•ã‚Œã‚‹éš›ã«ãã®ãƒ¢ãƒ‡ãƒ«ã‚’ç›´æ¥æ¨å®šã™ã‚‹ã“ã¨ãªã—ã«æ–°ãŸãªèª¬æ˜å¤‰æ•°$X$ã®å…¥åŠ›ã«å¯¾ã—ã€éèª¬æ˜å¤‰æ•°$Y$ã®äºˆæ¸¬å€¤ã‚’ã¯ã˜ãå‡ºã™ã¨ã„ã†ã‚‚ã®ã§ã—ãŸã€‚\n$$ \\displaystyle y_{i} = \\textbf{w}^{T}\\phi(\\textbf{x}_{i}) $$\n\rã“ã“ã§ã€$\\textbf{x}_{i}$ã¯$i$ç•ªç›®ã®èª¬æ˜å¤‰æ•°ãƒ™ã‚¯ãƒˆãƒ«ã€$\\phi(ãƒ»)$ã¯éç·šå½¢é–¢æ•°ã€ $\\textbf{w}^{T}$ã¯å„å…¥åŠ›ãƒ‡ãƒ¼ã‚¿ã«å¯¾ã™ã‚‹é‡ã¿ä¿‚æ•°ï¼ˆå›å¸°ä¿‚æ•°ï¼‰ãƒ™ã‚¯ãƒˆãƒ«ã§ã™ã€‚éç·šå½¢é–¢æ•°ã¨ã—ã¦ã¯ã€$\\phi(\\textbf{x}_{i}) = (x_{1,i}, x_{1,i}^{2},...,x_{1,i}x_{2,i},...)$ã‚’æƒ³å®šã—ã¦ã„ã¾ã™ï¼ˆ$x_{1,i}$ã¯$i$ç•ªç›®ã®å…¥åŠ›ãƒ‡ãƒ¼ã‚¿$\\textbf{x}_{i}$ã®ï¼‘ç•ªç›®ã®å¤‰æ•°ï¼‰ã€‚è©³ã—ãã¯éå»è¨˜äº‹ã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚\r\rä»Šå›ã‚„ã‚‹GPLVMã¯èª¬æ˜å¤‰æ•°ãƒ™ã‚¯ãƒˆãƒ«ãŒè¦³æ¸¬ã§ããªã„æ½œåœ¨å¤‰æ•°ï¼ˆLatent Variableï¼‰ã§ã‚ã‚‹ã¨ã“ã‚ãŒç‰¹å¾´ã§ã™ã€‚ä»¥ä¸‹ã®ã‚¹ãƒ©ã‚¤ãƒ‰ãŒéå¸¸ã«ã‚ã‹ã‚Šã‚„ã™ã„ã§ã™ãŒã€GP-LVMã¯ç¢ºç‡çš„ä¸»æˆåˆ†åˆ†æï¼ˆPPCAï¼‰ã®éç·šå½¢ç‰ˆã¨ã„ã†ä½ç½®ä»˜ã‘ã«ãªã£ã¦ã„ã¾ã™ã€‚\nè³‡æ–™\nã§ã¯å…·ä½“çš„ãªèª¬æ˜ã«ç§»ã‚Šã¾ã™ã€‚GPLVMã¯ä¸»æˆåˆ†åˆ†æã®ç™ºå±•ç‰ˆã§ã™ã®ã§ã€ä¸»ã«æ¬¡å…ƒå‰Šæ¸›ã®ãŸã‚ã«è¡Œã‚ã‚Œã‚‹ã“ã¨ã‚’æƒ³å®šã—ã¦ã„ã¾ã™ã€‚ã¤ã¾ã‚Šã€ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆãŒã‚ã£ãŸã¨ã—ã¦ã€ã‚µãƒ³ãƒ—ãƒ«ã‚µã‚¤ã‚º$n$ã‚ˆã‚Šã‚‚å¤‰æ•°ã®æ¬¡å…ƒ$p$ãŒå¤§ãã„ã‚ˆã†ãªå ´åˆã‚’æƒ³å®šã—ã¦ã„ã¾ã™ã€‚\n2. æœ€ã‚‚PrimitiveãªGP-LVM \rå…ˆè¿°ã—ãŸã‚ˆã†ã«GPLVMã¯PPCAã®éç·šå½¢ç‰ˆã§ã™ã€‚ãªã®ã§ã€GPLVMã‚’èª¬æ˜ã™ã‚‹ã‚¹ã‚¿ãƒ¼ãƒˆã¯PPCAã«ãªã‚Šã¾ã™ã€‚è¦³æ¸¬å¯èƒ½ãª$D$æ¬¡å…ƒãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã‚’$\\{\\textbf{y}_{n}\\}_{n=1}^{N}$ã¨ã—ã¾ã™ã€‚ãã—ã¦ã€æ½œåœ¨å¤‰æ•°ã‚’$\\textbf{x}_{n}$ã¨ãŠãã¾ã™ã€‚ä»Šã€ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã¨æ½œåœ¨å¤‰æ•°ã®é–“ã«ã¯ä»¥ä¸‹ã®ã‚ˆã†ãªé–¢ä¿‚ãŒã‚ã‚‹ã¨ã—ã¾ã™ã€‚\r\r\r$$\r\\textbf{y}_{n} = \\textbf{W}\\textbf{x}_{n} + \\epsilon_{n}\r$$\r\r\rã“ã“ã§ã€$\\textbf{W}$ã¯ã‚¦ã‚§ã‚¤ãƒˆè¡Œåˆ—ã€$\\epsilon_{n}$ã¯ã‹ãä¹±é …ã§$N(0,\\beta^{-1}\\textbf{I})$ã«å¾“ã„ã¾ã™ï¼ˆè¢«èª¬æ˜å¤‰æ•°ãŒå¤šæ¬¡å…ƒã«ãªã‚‹ã“ã¨ã«æ³¨æ„ï¼‰ã€‚ã¾ãŸã€$\\textbf{x}_{n}$ã¯$N(0,\\textbf{I})$ã«å¾“ã„ã¾ã™ã€‚ã“ã®ã¨ãã€$\\textbf{y}_{n}$ã®å°¤åº¦ã‚’$\\textbf{x}_{n}$ã‚’å‘¨è¾ºåŒ–ã™ã‚‹ã“ã¨ã§è¡¨ç¾ã™ã‚‹ã¨ã€\r\r\r$$\r\\begin{eqnarray*}\r\\displaystyle p(\\textbf{y}_{n}|\\textbf{W},\\beta) \u0026=\u0026 \\int p(\\textbf{y}_{n}|\\textbf{x}_{n},\\textbf{W},\\beta)N(0,\\textbf{I})d\\textbf{x}_{n} \\\\\r\\displaystyle \u0026=\u0026 \\int N(\\textbf{W}\\textbf{x}_{n},\\beta^{-1}\\textbf{I})N(0,\\textbf{I})d\\textbf{x}_{n} \\\\\r\u0026=\u0026 N(0,\\textbf{W}\\textbf{W}^{T} + \\beta^{-1}\\textbf{I}) \\\\\r\\displaystyle \u0026=\u0026 \\frac{1}{(2\\pi)^{DN/2}|\\textbf{W}\\textbf{W}^{T} + \\beta^{-1}\\textbf{I}|^{N/2}}\\exp(\\frac{1}{2}\\textbf{tr}( (\\textbf{W}\\textbf{W}^{T} + \\beta^{-1}\\textbf{I})^{-1}\\textbf{YY}^{T}))\r\\end{eqnarray*}\r$$\r\r\rã¨ãªã‚Šã¾ã™ã€‚ã“ã“ã§ã€$p(\\textbf{y}_{n}|\\textbf{x}_{n},\\textbf{W},\\beta)=N(\\textbf{W}\\textbf{x}_{n},\\beta^{-1}\\textbf{I})$ã§ã™ã€‚å¹³å‡ã¨åˆ†æ•£ã¯ä»¥ä¸‹ã‹ã‚‰æ±‚ã‚ã¾ã—ãŸã€‚\r\r\r$$\r\\begin{eqnarray*}\rE(\\textbf{y}_{n}|\\textbf{W},\\beta) \u0026=\u0026 E(\\textbf{W}\\textbf{x}_{n} + \\epsilon_{n}) \\\\\r\u0026=\u0026 E(\\textbf{W}\\textbf{x}_{n}) + E(\\epsilon_{n}) \\\\\r\u0026=\u0026 \\textbf{W}E(\\textbf{x}_{n}) + E(\\epsilon_{n}) = 0\r\\end{eqnarray*}\r$$\r\r\r$$\r\\begin{eqnarray*}\rE[(\\textbf{y}_{n}|\\textbf{W},\\beta)(\\textbf{y}_{n}|\\textbf{W},\\beta)^{T}] \u0026=\u0026 E[ (\\textbf{W}\\textbf{x}_{n} + \\epsilon_{n} - 0)(\\textbf{W}\\textbf{x}_{n} + \\epsilon_{n} - 0)^{T} ] \\\\\r\u0026=\u0026 E[ (\\textbf{W}\\textbf{x}_{n} + \\epsilon_{n})(\\textbf{W}\\textbf{x}_{n} + \\epsilon_{n})^{T} ] \\\\\r\u0026=\u0026 E[ \\textbf{W}\\textbf{x}_{n}(\\textbf{W}\\textbf{x}_{n})^{T} + \\textbf{W}\\textbf{x}_{n}\\epsilon_{n}^{T} + \\epsilon_{n}\\textbf{W}\\textbf{x}_{n}^{T} + \\epsilon_{n}\\epsilon_{n}^{T} ] \\\\\r\u0026=\u0026 E[ \\textbf{W}\\textbf{x}_{n}(\\textbf{W}\\textbf{x}_{n})^{T} + \\epsilon_{n}\\epsilon_{n}^{T} ] \\\\\r\u0026=\u0026 E[ \\textbf{W}\\textbf{x}_{n}\\textbf{x}_{n}^{T}\\textbf{W}^{T} + \\epsilon_{n}\\epsilon_{n}^{T} ] \\\\\r\u0026=\u0026 E[ \\textbf{W}\\textbf{x}_{n}\\textbf{x}_{n}^{T}\\textbf{W}^{T}] + E[\\epsilon_{n}\\epsilon_{n}^{T} ] \\\\\r\u0026=\u0026 \\textbf{W}\\textbf{W}^{T} + \\beta^{-1}\\textbf{I}\r\\end{eqnarray*}\r$$\r\r$\\textbf{W}$ã‚’æ±‚ã‚ã‚‹ãŸã‚ã«ã¯$\\textbf{y}_{n}$ãŒi.i.d.ã¨ä»®å®šã—ã€ä»¥ä¸‹ã®ã‚ˆã†ãªãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆå…¨ä½“ã®å°¤åº¦ã‚’æœ€å¤§åŒ–ã™ã‚Œã°è‰¯ã„ã“ã¨ã«ãªã‚Šã¾ã™ã€‚\n$$ \\displaystyle p(\\textbf{Y}|\\textbf{W},\\beta) = \\prod_{n=1}^{N}p(\\textbf{y}_{n}|\\textbf{W},\\beta) $$\n\rã“ã“ã§ã€$\\textbf{Y}$ã¯$NÃ—D$ã®è¨ˆç”»è¡Œåˆ—ã§ã™ã€‚ã“ã®ã‚ˆã†ã«ã€PPCAã§ã¯$\\textbf{x}_{n}$ã‚’å‘¨è¾ºåŒ–ã—ã€$\\textbf{W}$ã‚’æœ€é©åŒ–ã—ã¾ã™ã€‚é€†ã«ã€Lawrence(2004)ã§ã¯$\\textbf{W}$ã‚’å‘¨è¾ºåŒ–ã—ã€$\\textbf{x}_{n}$ã—ã¾ã™ï¼ˆç†ç”±ã¯å¾Œè¿°ï¼‰ã€‚$\\textbf{W}$ã‚’å‘¨è¾ºåŒ–ã™ã‚‹ãŸã‚ã«ã€$\\textbf{W}$ã«äº‹å‰åˆ†å¸ƒã‚’ä¸ãˆã¾ã—ã‚‡ã†ã€‚\r\r$$ \\displaystyle p(\\textbf{W}) = \\prod_{i=1}^{D}N(\\textbf{w}_{i}|0,\\alpha^{-1}\\textbf{I}) $$\n\rã“ã“ã§ã€$\\textbf{w}_{i}$ã¯ã‚¦ã‚§ã‚¤ãƒˆè¡Œåˆ—$\\textbf{W}$ã®$i$ç•ªç›®ã®åˆ—ã§ã™ã€‚ã§ã¯ã€$\\textbf{W}$ã‚’å‘¨è¾ºåŒ–ã—ã¦$\\textbf{Y}$ã®å°¤åº¦é–¢æ•°ã‚’å°å‡ºã—ã¦ã¿ã¾ã™ã€‚ã‚„ã‚Šæ–¹ã¯ã•ã£ãã¨ã»ã¼åŒã˜ãªã®ã§çœç•¥ã—ã¾ã™ã€‚\r\r$$ \\displaystyle p(\\textbf{Y}|\\textbf{X},\\beta) = \\frac{1}{(2\\pi)^{DN/2}|K|^{D/2}}\\exp(\\frac{1}{2}\\textbf{tr}(\\textbf{K}^{-1}\\textbf{YY}^{T})) $$\n\rã“ã“ã§ã€$\\textbf{K}=\\alpha^2\\textbf{X}\\textbf{X}^{T} + \\beta^{-1}\\textbf{I}$ã¯$p(\\textbf{Y}|\\textbf{X},\\beta)$ã®åˆ†æ•£å…±åˆ†æ•£è¡Œåˆ—ã§ã€$\\textbf{X}=(\\textbf{x}_{1},\\textbf{x}_{2},...,\\textbf{x}_{N})^{T}$ã¯å…¥åŠ›ãƒ™ã‚¯ãƒˆãƒ«ã§ã™ã€‚å¯¾æ•°å°¤åº¦ã¯\r\r$$ \\displaystyle L = - \\frac{DN}{2}\\ln{2\\pi} - \\frac{1}{2}\\ln{|\\textbf{K}|} - \\frac{1}{2}\\textbf{tr}(\\textbf{K}^{-1}\\textbf{YY}^{T}) $$\nå‘¨è¾ºåŒ–ã®ãŠã‹ã’ã§ã‚¦ã‚§ã‚¤ãƒˆ$\\textbf{W}$ãŒæ¶ˆãˆãŸã®ã§ã“ã‚Œã‚’$X$ã§å¾®åˆ†ã—ã¦ã¿ã¾ã—ã‚‡ã†ã€‚\n$$ \\displaystyle\\frac{\\partial L}{ \\partial \\textbf{X}} = \\alpha^2 \\textbf{K}^{-1}\\textbf{Y}\\textbf{Y}^{T}\\textbf{K}^{-1}\\textbf{X} - \\alpha^2 D\\textbf{K}^{-1}\\textbf{X} $$\nã“ã“ã‹ã‚‰ã€\n$$ \\displaystyle \\frac{1}{D}\\textbf{Y}\\textbf{Y}^{T}\\textbf{K}^{-1}\\textbf{X} = \\textbf{X} $$\nã“ã“ã§ã€ç‰¹ç•°å€¤åˆ†è§£ã‚’ç”¨ã„ã‚‹ã¨\n$$ \\textbf{X} = \\textbf{ULV}^{T} $$\n\rã¨ãªã‚Šã¾ã™ã€‚$\\textbf{U} = (\\textbf{u}_{1},\\textbf{u}_{2},...,\\textbf{u}_{q})$ã¯$NÃ—q$ç›´äº¤è¡Œåˆ—ã€$\\textbf{L} = diag(l_{1},l_{2},..., l_{q})$ã¯$qÃ—q$ã®ç‰¹ç•°å€¤ã‚’å¯¾è§’æˆåˆ†ã«ä¸¦ã¹ãŸè¡Œåˆ—ã€$\\textbf{V}$ã¯$qÃ—q$ç›´äº¤è¡Œåˆ—ã§ã™ã€‚ã“ã‚Œã‚’å…ˆã»ã©ã®å¼ã«ä»£å…¥ã™ã‚‹ã¨ã€\r\r\r$$\r\\begin{eqnarray*}\r\\textbf{K}^{-1}\\textbf{X} \u0026=\u0026 (\\alpha^2\\textbf{X}\\textbf{X}^{T} + \\beta^{-1}\\textbf{I})^{-1}\\textbf{X} \\\\\r\u0026=\u0026 \\textbf{X}(\\alpha^2\\textbf{X}^{T}\\textbf{X} + \\beta^{-1}\\textbf{I})^{-1} \\\\\r\u0026=\u0026 \\textbf{ULV}^{T}(\\alpha^2\\textbf{VLU}^{T}\\textbf{ULV}^{T} + \\beta^{-1}\\textbf{I})^{-1} \\\\\r\u0026=\u0026 \\textbf{ULV}^{T}\\textbf{V}(\\alpha^2\\textbf{LU}^{T}\\textbf{UL} + \\beta^{-1}\\textbf{I}^{-1})\\textbf{V}^{T} \\\\\r\u0026=\u0026 \\textbf{UL}(\\alpha^2\\textbf{L}^{2} + \\beta^{-1}\\textbf{I})^{-1}\\textbf{V}^{T}\r\\end{eqnarray*}\r$$\r\rãªã®ã§ã€\n\r$$\r\\begin{eqnarray*}\r\\displaystyle \\frac{1}{D}\\textbf{Y}\\textbf{Y}^{T}\\textbf{UL}(\\alpha^2\\textbf{L}^{2} + \\beta^{-1}\\textbf{I})^{-1})\\textbf{V}^{T} \u0026=\u0026 \\textbf{ULV}^{T}\\\\\r\\displaystyle \\textbf{Y}\\textbf{Y}^{T}\\textbf{UL} \u0026=\u0026 D\\textbf{U}(\\alpha^2\\textbf{L}^{2} + \\beta^{-1}\\textbf{I})^{-1}\\textbf{L} \\\\\r\\end{eqnarray*}\r$$\r\rã¨ãªã‚Šã¾ã™ã€‚$l_{j}$ãŒ0ã§ãªã‘ã‚Œã°ã€$\\textbf{Y}\\textbf{Y}^{T}\\textbf{u}_{j} = D(\\alpha^2 l_{j}^{2} + \\beta^{-1})\\textbf{u}_{j}$ã¨ãªã‚Šã€$\\textbf{U}$ã®ãã‚Œãã‚Œã®åˆ—ã¯$\\textbf{Y}\\textbf{Y}^{T}$ã®å›ºæœ‰ãƒ™ã‚¯ãƒˆãƒ«ã§ã‚ã‚Šã€å¯¾å¿œã™ã‚‹å›ºæœ‰å€¤$\\lambda_{j}$ã¯$D(\\alpha^2 l_{j}^{2} + \\beta^{-1})$ã¨ãªã‚Šã¾ã™ã€‚ã¤ã¾ã‚Šã€æœªçŸ¥ã§ã‚ã£ãŸ$X=ULV$ãŒå®Ÿã¯$\\textbf{Y}\\textbf{Y}^{T}$ã®å›ºæœ‰å€¤å•é¡Œã‹ã‚‰æ±‚ã‚ã‚‹ã“ã¨ãŒå‡ºæ¥ã‚‹ã¨ã„ã†ã‚ã‘ã§ã™ã€‚$l_{j}$ã¯ä¸Šå¼ã‚’åˆ©ç”¨ã—ã¦ã€\n$$ \\displaystyle l_{j} = (\\frac{\\lambda_{j}}{D\\alpha^2} - \\frac{1}{\\beta\\alpha^2})^{1/2} $$\nã¨$\\textbf{Y}\\textbf{Y}^{T}$ã®å›ºæœ‰å€¤$\\lambda_{j}$ã¨ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‹ã‚‰æ±‚ã‚ã‚‰ã‚Œã‚‹ã“ã¨ãŒã‚ã‹ã‚Šã¾ã™ã€‚ã‚ˆã£ã¦ã€$X=ULV$ã¯\n$$ \\textbf{X} = \\textbf{U}_{q}\\textbf{L}\\textbf{V}^{T} $$\nã¨ãªã‚Šã¾ã™ã€‚ã“ã“ã§ã€$\\textbf{U}_{q}$ã¯$\\textbf{Y}\\textbf{Y}^{T}$ã®å›ºæœ‰ãƒ™ã‚¯ãƒˆãƒ«ã‚’$q$å€‹å–ã‚Šå‡ºã—ãŸã‚‚ã®ã§ã™ã€‚$\\beta$ãŒé™ã‚Šãªãå¤§ãã‘ã‚Œã°ï¼ˆ=è¦³æ¸¬èª¤å·®ãŒé™ã‚Šãªãå°ã•ã‘ã‚Œã°ï¼‰é€šå¸¸ã®PCAã¨ä¸€è‡´ã—ã¾ã™ã€‚\nä»¥ä¸ŠãŒPPCAã§ã™ã€‚GPLVMã¯PPCAã§ç¢ºç‡ãƒ¢ãƒ‡ãƒ«ã¨ã—ã¦æƒ³å®šã—ã¦ã„ãŸä»¥ä¸‹ã®ãƒ¢ãƒ‡ãƒ«ã‚’æ‹¡å¼µã—ã¾ã™ã€‚\n\r$$\r\\textbf{y}_{n} = \\textbf{W}^{T}\\textbf{x}_{n} + \\epsilon_{n}\r$$\r\rå…·ä½“çš„ã«ã¯ã€é€šå¸¸ã®ã‚¬ã‚¦ã‚¹éç¨‹ã¨åŒæ§˜ã€\n\r$$\r\\displaystyle \\textbf{y}_{n} = \\textbf{W}^{T}\\phi(\\textbf{x}_{n})+ \\epsilon_{n}\r$$\r\r\rã¨ã„ã†é¢¨ã«åŸºåº•é–¢æ•°$\\phi(\\textbf{x}_{n})$ã‚’ã‹ã¾ã›ã¦æ‹¡å¼µã—ã¾ã™ã€‚$\\phi(ãƒ»)$ã¯å¹³å‡$\\textbf{0}$ã€åˆ†æ•£å…±åˆ†æ•£è¡Œåˆ—$\\textbf{K}_{\\textbf{x}}$ã®ã‚¬ã‚¦ã‚¹éç¨‹ã¨ä»®å®šã—ã¾ã™ã€‚åˆ†æ•£å…±åˆ†æ•£è¡Œåˆ—$\\textbf{K}_{\\textbf{x}}$ã¯\r\r$$ \\textbf{K}_{\\textbf{x}} = \\alpha^2\\phi(\\textbf{x})\\phi(\\textbf{x})^T $$\n\rã§ã‚ã‚Šã€å…¥åŠ›ãƒ™ã‚¯ãƒˆãƒ«$\\textbf{X}$ã‚’$\\phi(\\textbf{ãƒ»})$ã§éç·šå½¢å¤‰æ›ã—ãŸç‰¹å¾´é‡$\\phi(\\textbf{x})$ãŒè¿‘ã„ã»ã©ã€å‡ºåŠ›å€¤$\\textbf{Y}$ã‚‚è¿‘ããªã‚Šã‚„ã™ã„ã¨ã„ã†æ€§è³ªãŒã‚ã‚‹ã“ã¨ã«ãªã‚Šã¾ã™ã€‚GPLVMã§ã¯ã“ã®æ€§è³ªã‚’é€†ã«åˆ©ç”¨ã—ã¦ã„ã¾ã™ã€‚ã¤ã¾ã‚Šã€å‡ºåŠ›å€¤$Y_i$ã¨$Y_j$ãŒè¿‘ã„â†’$\\phi(\\textbf{x}_i)$ã¨$\\phi(\\textbf{x}_j)$ãŒè¿‘ã„ï¼ˆå†…ç©ãŒå¤§ãã„ï¼‰â†’$\\textbf{K}_{x,ij}$ãŒå¤§ãã„â†’è¦³æ¸¬ä¸å¯èƒ½ãªãƒ‡ãƒ¼ã‚¿$X_{i}$ã¨$X_{j}$ã¯è¿‘ã„å€¤ï¼ˆoråŒã˜ã‚ˆã†ãªãƒ‘ã‚¿ãƒ¼ãƒ³ï¼‰ã‚’ã¨ã‚‹ã€‚\rã“ã®è­°è«–ã‹ã‚‰ã‚‚ã‚ã‹ã‚‹ã‚ˆã†ã«ã€$\\textbf{K}_{\\textbf{x}}$ã¯å…¥åŠ›ãƒ™ã‚¯ãƒˆãƒ«$\\textbf{X}$ãã‚Œãã‚Œã®è·é›¢ã‚’è¡¨ã—ãŸã‚‚ã®ã«ãªã‚Šã¾ã™ã€‚åˆ†æ•£å…±åˆ†æ•£è¡Œåˆ—ã®è¨ˆç®—ã«ã¯å…¥åŠ›ãƒ™ã‚¯ãƒˆãƒ«$\\textbf{X}$ã‚’åŸºåº•é–¢æ•°$\\phi(\\textbf{ãƒ»})$ã§éç·šå½¢å¤‰æ›ã—ãŸå¾Œã€å†…ç©ã‚’æ±‚ã‚ã‚‹ã¨ã„ã£ãŸã“ã¨ã‚’ã™ã‚‹å¿…è¦ã¯ãªãã€ã‚«ãƒ¼ãƒãƒ«é–¢æ•°ã‚’è¨ˆç®—ã™ã‚‹ã®ã¿ã§OKã§ã™ã€‚ä»Šå›ã¯ç‹é“ä¸­ã®ç‹é“RBFã‚«ãƒ¼ãƒãƒ«ã‚’ä½¿ç”¨ã—ã¦ã„ã¾ã™ã®ã§ã€ã“ã‚Œã‚’ä¾‹èª¬æ˜ã—ã¾ã™ã€‚\r\rRBFã‚«ãƒ¼ãƒãƒ«ï¼ˆã‚¹ã‚«ãƒ©ãƒ¼ã«å¯¾ã™ã‚‹ï¼‰ $$ \\theta_{1}\\exp(-\\frac{1}{\\theta_{2}}(x-x^T)^2) $$\nã“ã®RBFã‚«ãƒ¼ãƒãƒ«ã¯ä»¥ä¸‹ã®åŸºåº•é–¢æ•°ã¨å¯¾å¿œã—ã¦ã„ã¾ã™ã€‚\n$$ \\phi(x)_h = \\tau\\exp(-\\frac{1}{r}(x-h)^2) $$\nä¾‹ãˆã°ã€ã“ã®åŸºåº•é–¢æ•°ã§å…¥åŠ›$x$ã‚’å¤‰æ›ã—ãŸã‚‚ã®ã‚’$2H^2+1$å€‹ä¸¦ã¹ãŸé–¢æ•°ã‚’\n\r$$\r\\phi(x) = (\\phi(x)_{-H^2}, ..., \\phi(x)_{0},...,\\phi(x)_{H^2})\r$$\r\rå…¥åŠ›$x$ã®ç‰¹å¾´é‡ã ã¨ã™ã‚‹ã¨$x'$ã¨ã®å…±åˆ†æ•£$K_{x}(x,x')$ã¯å†…ç©ã®å’Œãªã®ã§\n$$ K_{x}(x,x') = \\sum_{h=-H^2}^{H^2}\\phi_{h}(x)\\phi_{h}(x') $$\nã¨ãªã‚Šã¾ã™ã€‚ã“ã“ã§ã€$H \\to \\infty$ã¨ã—ã€ã‚°ãƒªãƒƒãƒ‰ã‚’æ¥µé™ã¾ã§ç´°ã‹ãã—ã¦ã¿ã¾ã™ã€‚\n\r$$\r\\begin{eqnarray*}\rK_{x}(x,x') \u0026=\u0026 \\lim_{H \\to \\infty}\\sum_{h=-H^2}^{H^2}\\phi_{h}(x)\\phi_{h}(x') \\\\\r\u0026\\to\u0026\\int_{-\\infty}^{\\infty}\\tau\\exp(-\\frac{1}{r}(x-h)^2)\\tau\\exp(-\\frac{1}{r}(x'-h)^2)dh \\\\\r\u0026=\u0026 \\tau^2 \\int_{-\\infty}^{\\infty}\\exp(-\\frac{1}{r}\\{(x-h)^2+(x'-h)^2\\})dh \\\\\r\u0026=\u0026 \\tau^2 \\int_{-\\infty}^{\\infty}\\exp(-\\frac{1}{r}\\{2(h-\\frac{x+x'}{2})^2+\\frac{1}{2}(x-x')^2\\})dh \\\\\r\\end{eqnarray*}\r$$\r\rã¨ãªã‚Šã¾ã™ã€‚$h$ã«é–¢ä¿‚ã®ãªã„éƒ¨åˆ†ã‚’ç©åˆ†ã®å¤–ã«å‡ºã—ã¾ã™ã€‚\n\r$$\r\\begin{eqnarray*}\r\u0026=\u0026 \\tau^2 \\int_{-\\infty}^{\\infty}\\exp(-\\frac{2}{r}(h-\\frac{x+x'}{2})^2)dh\\exp(-\\frac{1}{2r}(x-x')^2) \\\\\r\\end{eqnarray*}\r$$\r\ræ®‹ã£ãŸç©åˆ†ã‚’è¦‹ã‚‹ã¨ã€æ­£è¦åˆ†å¸ƒã®æ­£è¦åŒ–å®šæ•°ã¨ç­‰ã—ã„ã“ã¨ãŒã‚ã‹ã‚Šã¾ã™ã€‚\n\r$$\r\\begin{eqnarray*}\r\\int_{-\\infty}^{\\infty}\\exp(-\\frac{1}{2\\sigma}(h-\\frac{x+x'}{2})^2)dh \u0026=\u0026 \\int_{-\\infty}^{\\infty}\\exp(-\\frac{2}{r}(h-\\frac{x+x'}{2})^2)dh\\\\\r\\sigma \u0026=\u0026 \\frac{r}{4}\r\\end{eqnarray*}\r$$\r\rã¨ãªã‚‹ã®ã§ã€ã‚¬ã‚¦ã‚¹ç©åˆ†ã®å…¬å¼ã‚’ç”¨ã„ã¦\n\r$$\r\\begin{eqnarray*}\r\u0026=\u0026 \\tau^2 \\sqrt{\\frac{\\pi r}{2}}\\exp(-\\frac{1}{2r}(x-x')^2)ã€€\\\\\r\u0026=\u0026 \\theta_{1}\\exp(-\\frac{1}{\\theta_{2}}(x-xâ€™)^2)\r\\end{eqnarray*}\r$$\r\rã¨ãªã‚Šã€RBFã‚«ãƒ¼ãƒãƒ«ã¨ç­‰ã—ããªã‚‹ã“ã¨ãŒã‚ã‹ã‚Šã¾ã™ã€‚ã‚ˆã£ã¦ã€RBFã‚«ãƒ¼ãƒãƒ«ã§è¨ˆç®—ã—ãŸå…±åˆ†æ•£ã¯ä¸Šè¿°ã—ãŸåŸºåº•é–¢æ•°ã§å…¥åŠ›$x$ã‚’ç„¡é™æ¬¡å…ƒã¸æ‹¡å¼µã—ãŸç‰¹å¾´é‡ãƒ™ã‚¯ãƒˆãƒ«ã®å†…ç©ã‹ã‚‰è¨ˆç®—ã—ãŸå…±åˆ†æ•£ã¨åŒå€¤ã«ãªã‚‹ã“ã¨ãŒã‚ã‹ã‚Šã¾ã™ã€‚ã¤ã¾ã‚Šã€å…¥åŠ›$x$ã¨$x'$ã®ã‚¹ã‚«ãƒ©ãƒ¼ã®è¨ˆç®—ã®ã¿ã§$K_{x}(x,x')$ãŒã§ãã¦ã—ã¾ã†ã¨ã„ã†å¤¢ã®ã‚ˆã†ãªè¨ˆç®—åŠ¹ç‡åŒ–ãŒå¯èƒ½ã«ãªã‚‹ã‚ã‘ã§ã™ã€‚ç„¡é™æ¬¡å…ƒç‰¹å¾´é‡ãƒ™ã‚¯ãƒˆãƒ«ã®å›å¸°å•é¡Œãªã‚“ã¦æ™®é€šè¨ˆç®—ã§ãã¾ã›ã‚“ã‹ã‚‰ã­ã€‚ã€‚ã€‚ã‚«ãƒ¼ãƒãƒ«é–¢æ•°ã¯å‰å¤§ã§ã™ã€‚ å‰ã®è¨˜äº‹ã«ã‚‚è¼‰ã›ã¾ã—ãŸãŒã€RBFã‚«ãƒ¼ãƒãƒ«ã§åˆ†æ•£å…±åˆ†æ•£è¡Œåˆ—ã‚’è¨ˆç®—ã—ãŸã‚¬ã‚¦ã‚¹éç¨‹ã®ã‚µãƒ³ãƒ—ãƒ«ãƒ‘ã‚¹ã¯ä»¥ä¸‹é€šã‚Šã§ã™ï¼ˆ$\\theta_1=1,\\theta_2=0.5$ï¼‰ã€‚\n# Define Kernel function Kernel_Mat \u0026lt;- function(X,sigma,beta){ N \u0026lt;- NROW(X) K \u0026lt;- matrix(0,N,N) for (i in 1:N) { for (k in 1:N) { if(i==k) kdelta = 1 else kdelta = 0 K[i,k] \u0026lt;- K[k,i] \u0026lt;- exp(-t(X[i,]-X[k,])%*%(X[i,]-X[k,])/(2*sigma^2)) + beta^{-1}*kdelta } } return(K) } N \u0026lt;- 10 # max value of X M \u0026lt;- 1000 # sample size X \u0026lt;- matrix(seq(1,N,length=M),M,1) # create X testK \u0026lt;- Kernel_Mat(X,0.5,1e+18) # calc kernel matrix library(MASS) P \u0026lt;- 6 # num of sample path Y \u0026lt;- matrix(0,M,P) # define Y for(i in 1:P){ Y[,i] \u0026lt;- mvrnorm(n=1,rep(0,M),testK) # sample Y } # Plot matplot(x=X,y=Y,type = \u0026#34;l\u0026#34;,lwd = 2) éå¸¸ã«æ»‘ã‚‰ã‹ãªé–¢æ•°ã¨ãªã£ã¦ã„ã‚‹ã“ã¨ãŒã‚ã‹ã‚Šã¾ã™ã€‚RBFã®ã»ã‹ã«ã‚‚ã‚«ãƒ¼ãƒãƒ«é–¢æ•°ã¯å­˜åœ¨ã—ã¾ã™ã€‚ã‚«ãƒ¼ãƒãƒ«é–¢æ•°ã‚’å¤‰ãˆã‚‹ã¨åŸºåº•é–¢æ•°ãŒå¤‰ã‚ã‚Šã¾ã™ã‹ã‚‰ã€ã‚µãƒ³ãƒ—ãƒ«ãƒ‘ã‚¹ã¯å¤§ããå¤‰ã‚ã‚‹ã“ã¨ã«ãªã‚Šã¾ã™ã€‚\nGPLVMã®æ¨å®šæ–¹æ³•ã«è©±ã‚’é€²ã‚ã¾ã—ã‚‡ã†ã€‚PPCAã®æ™‚ã¨åŒã˜ãã€ä»¥ä¸‹ã®å°¤åº¦é–¢æ•°ã‚’æœ€å¤§åŒ–ã™ã‚‹è¦³æ¸¬ä¸èƒ½ãªå…¥åŠ›$x$ã‚’æ¨å®šå€¤ã¨ã—ã¾ã™ã€‚\n$$ \\displaystyle L = - \\frac{DN}{2}\\ln{2\\pi} - \\frac{1}{2}\\ln{|\\textbf{K}|} - \\frac{1}{2}\\textbf{tr}(\\textbf{K}^{-1}\\textbf{YY}^{T}) $$\nãŸã ã€PPCAã¨ã¯ç•°ãªã‚Šã€ãã®å€¤ã¯è§£æçš„ã«æ±‚ã‚ã‚‹ã“ã¨ãŒã§ãã¾ã›ã‚“ã€‚å°¤åº¦é–¢æ•°ã®å°é–¢æ•°ã¯ä»Šã‚„è¤‡é›‘ãªé–¢æ•°ã§ã‚ã‚Šã€å±•é–‹ã™ã‚‹ã“ã¨ãŒã§ããªã„ã‹ã‚‰ã§ã™ã€‚ã‚ˆã£ã¦ã€å…±å½¹å‹¾é…æ³•ã‚’ç”¨ã„ã¦æ•°å€¤çš„ã«è¨ˆç®—ã™ã‚‹ã®ãŒä¸»æµãªã‚ˆã†ã§ã™ï¼ˆè‡ªåˆ†ã¯æº–ãƒ‹ãƒ¥ãƒ¼ãƒˆãƒ³æ³•ã§å®Ÿè£…ï¼‰ã€‚è§£æçš„ã€æ•°å€¤çš„ã®ã©ã¡ã‚‰ã«ã›ã‚ˆå°é–¢æ•°ã‚’æ±‚ã‚ã¦ãŠãã“ã¨ã¯å¿…è¦ãªã®ã§ã€å°é–¢æ•°ã‚’æ±‚ã‚ã¦ã¿ã¾ã™ã€‚\n$$ \\frac{\\partial L}{\\partial \\textbf{K}_x} = \\frac{1}{2}(\\textbf{K}_x^{-1}\\textbf{Y}\\textbf{Y}^T\\textbf{K}_x^{-1}-D\\textbf{K}_x^{-1}) $$\nãªã®ã§ã€ãƒã‚§ãƒ¼ãƒ³ãƒ«ãƒ¼ãƒ«ã‹ã‚‰\n$$ \\frac{\\partial L}{\\partial \\textbf{x}} = \\frac{\\partial L}{\\partial \\textbf{K}_x}\\frac{\\partial \\textbf{K}_x}{\\partial \\textbf{x}} $$\n\rãªã®ã§ã€ã‚«ãƒ¼ãƒãƒ«é–¢æ•°ã‚’æ±ºã‚ã€$\\textbf{x}$ã«åˆæœŸå€¤ã‚’ä¸ãˆã¦ã‚„ã‚Œã°å‹¾é…æ³•ã«ã‚ˆã£ã¦å°¤åº¦$L$ãŒæœ€å¤§ã¨ãªã‚‹ç‚¹ã‚’æ¢ç´¢ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚ä»Šå›ä½¿ç”¨ã™ã‚‹RBFã‚«ãƒ¼ãƒãƒ«ã§$\\frac{\\partial \\textbf{K}_x}{\\partial x_{nj}}$ã‚’è¨ˆç®—ã—ã¦ã¿ã¾ã™ã€‚\r\r\r$$\r\\begin{eqnarray*}\r\\frac{\\partial \\textbf{K}_x(\\textbf{x}_n,\\textbf{x}_n')}{x_{nj}}\u0026=\u0026\\frac{\\partial\\theta_{1}\\exp(-\\frac{|\\textbf{x}_n-\\textbf{x}_n'|^2}{\\theta_{2}})}{\\partial x_{nk}} \\\\\r\u0026=\u0026 \\frac{\\partial\\theta_{1}\\exp(-\\frac{(\\textbf{x}_n-\\textbf{x}_n')^T(\\textbf{x}_n-\\textbf{x}_n')}{\\theta_{2}})}{\\partial x_{nk}} \\\\\r\u0026=\u0026 \\frac{\\partial\\theta_{1}\\exp(-\\frac{-(\\textbf{x}_n^T\\textbf{x}_n-2\\textbf{x}_n'^T\\textbf{x}_n+\\textbf{x}_n'^T\\textbf{x}_n')}{\\theta_{2}})}{\\partial x_{nk}} \\\\\r\u0026=\u0026 -2\\textbf{K}_x(\\textbf{x}_n\\textbf{x}_n')\\frac{(x_{nj}-x_{n'j})}{\\theta_2}\r\\end{eqnarray*}\r$$\r\r$(j)$ç•ªç›®ã®æ½œåœ¨å¤‰æ•°ã®$n$ç•ªç›®ã®ã‚µãƒ³ãƒ—ãƒ«ãã‚Œãã‚Œã«å°é–¢æ•°ã‚’è¨ˆç®—ã—ã€ãã‚Œã‚’åˆ†æ•£å…±åˆ†æ•£è¡Œåˆ—ã¨åŒã˜è¡Œåˆ—ã«æ•´ç†ã—ãŸã‚‚ã®ã¨$\\frac{\\partial L}{\\partial \\textbf{K}_x}$ã¨ã®è¦ç´ ã”ã¨ã®ç©ã‚’è¶³ã—åˆã‚ã›ãŸã‚‚ã®ãŒå‹¾é…ã¨ãªã‚Šã¾ã™ã€‚\n3. Rã§ã®å®Ÿè£… GPLVMã‚’Rã§å®Ÿè£…ã—ã¾ã™ã€‚ä½¿ç”¨ã™ã‚‹ãƒ‡ãƒ¼ã‚¿ã¯ä»¥å‰giannoneã®è¨˜äº‹ã§ä½¿ç”¨ã—ãŸã‚‚ã®ã¨åŒã˜ã‚‚ã®ã§ã™ã€‚\nESTIMATE_GPLVM \u0026lt;- function(Y,P,sigma){ # 1. Set initial value Y \u0026lt;- as.matrix(Y) eigenvector \u0026lt;- eigen(cov(Y))$vectors X \u0026lt;- Y%*%eigenvector[,1:P] # initial value N \u0026lt;- NROW(Y) # Sample Size D \u0026lt;- NCOL(Y) # Dimention of dataset X0 \u0026lt;- c(as.vector(X)) sigma \u0026lt;- var(matrix(Y,dim(Y)[1]*dim(Y)[2],1)) # 2. Define log likelihood function loglik \u0026lt;- function(X0,Y,N,P,D,beta,sigma){ X \u0026lt;- matrix(X0,N,P) K \u0026lt;- matrix(0,N,N) scale \u0026lt;- diag(sqrt(3/((apply(X, 2, max) -apply(X, 2, min))^2))) X \u0026lt;- X%*%scale for (i in 1:N) { for (k in 1:N) { if(i==k) kdelta = 1 else kdelta = 0 K[i,k] \u0026lt;- K[k,i] \u0026lt;- sigma*exp(-t(X[i,]-X[k,])%*%(X[i,]-X[k,])*0.5) + beta^(-1)*kdelta + beta^(-1) } } L \u0026lt;- - D*N/2*log(2*pi) - D/2*log(det(K)) - 1/2*sum(diag(ginv(K)%*%Y%*%t(Y))) #loglikelihood return(L) } # 3. Define derivatives of log likelihood function dloglik \u0026lt;- function(X0,P,D,N,Y,beta,sigma){ X \u0026lt;- matrix(X0,N,P) K \u0026lt;- matrix(0,N,N) for (i in 1:N) { for (k in 1:N) { if(i==k) kdelta = 1 else kdelta = 0 K[i,k] \u0026lt;- K[k,i] \u0026lt;- exp(-t(X[i,]-X[k,])%*%(X[i,]-X[k,])*0.5) + beta^(-1)*kdelta + beta^(-1) } } invK \u0026lt;- ginv(K) dLdK \u0026lt;- invK%*%Y%*%t(Y)%*%invK - D*invK dLdx \u0026lt;- matrix(0,N,P) for (j in 1:P){ for(i in 1:N){ dKdx \u0026lt;- matrix(0,N,N) for (k in 1:N){ dKdx[i,k] \u0026lt;- dKdx[k,i] \u0026lt;- -exp(-(t(X[i,]-X[k,])%*%(X[i,]-X[k,]))*0.5)*((X[i,j]-X[k,j])*0.5) } dLdx[i,j] \u0026lt;- sum(dLdK*dKdx) } } return(dLdx) } # 4. Optimization res \u0026lt;- optim(X0, loglik, dloglik, Y = Y, N=N, P=P, D=D, beta = exp(2), sigma = sigma, method = \u0026#34;BFGS\u0026#34;, control = list(fnscale = -1,trace=1000,maxit=10000)) output \u0026lt;- matrix(res$par,N,P) result \u0026lt;- list(output,res,P) names(result) \u0026lt;- c(\u0026#34;output\u0026#34;,\u0026#34;res\u0026#34;,\u0026#34;P\u0026#34;) return(result) } GPLVM_SELECT \u0026lt;- function(Y){ D \u0026lt;- NCOL(Y) library(stringr) for (i in 1:D){ if (i == 1){ result \u0026lt;- ESTIMATE_GPLVM(Y,i) P \u0026lt;- 2 print(str_c(\u0026#34;STEP\u0026#34;, i, \u0026#34; loglikelihood \u0026#34;, as.numeric(result$res$value))) }else{ temp \u0026lt;- ESTIMATE_GPLVM(Y,i) print(str_c(\u0026#34;STEP\u0026#34;, i, \u0026#34; loglikelihood \u0026#34;, as.numeric(temp$res$value))) if (result$res$value \u0026lt; temp$res$value){ result \u0026lt;- temp P \u0026lt;- i } } } print(str_c(\u0026#34;The optimal number of X is \u0026#34;, P)) print(str_c(\u0026#34;loglikelihood \u0026#34;, as.numeric(result$res$value))) return(result) } result \u0026lt;- ESTIMATE_GPLVM(scale(Y),5) ## initial value 1123.451566 ## final value 1111.732375 ## converged\rlibrary(tidyverse) ggplot(gather(as.data.frame(result$output),key = name,value = value), aes(x=rep(dataset1$publication,5),y=value,colour=name)) + geom_line(size=1) + xlab(\u0026#34;Date\u0026#34;) + ggtitle(\u0026#34;5 economic factors\u0026#34;) library(xts) X.xts \u0026lt;- xts(result$output,order.by = dataset1$publication) X.q.xts \u0026lt;- apply.quarterly(X.xts,mean) X.3m.xts \u0026lt;- X.xts[endpoints(X.xts,on=\u0026#34;quarters\u0026#34;),] if (months(index(X.q.xts)[NROW(X.q.xts)]) %in% c(\u0026#34;3æœˆ\u0026#34;,\u0026#34;6æœˆ\u0026#34;,\u0026#34;9æœˆ\u0026#34;,\u0026#34;12æœˆ\u0026#34;)){ } else X.q.xts \u0026lt;- X.q.xts[-NROW(X.q.xts),] if (months(index(X.3m.xts)[NROW(X.3m.xts)]) %in% c(\u0026#34;3æœˆ\u0026#34;,\u0026#34;6æœˆ\u0026#34;,\u0026#34;9æœˆ\u0026#34;,\u0026#34;12æœˆ\u0026#34;)){ } else X.3m.xts \u0026lt;- X.3m.xts[-NROW(X.3m.xts),] colnames(X.xts) \u0026lt;- c(\u0026#34;factor1\u0026#34;,\u0026#34;factor2\u0026#34;,\u0026#34;factor3\u0026#34;,\u0026#34;factor4\u0026#34;,\u0026#34;factor5\u0026#34;) GDP$publication \u0026lt;- GDP$publication + months(2) GDP.q \u0026lt;- GDP[GDP$publication\u0026gt;=index(X.q.xts)[1] \u0026amp; GDP$publication\u0026lt;=index(X.q.xts)[NROW(X.q.xts)],] rg \u0026lt;- lm(scale(GDP.q$GDP)~X.q.xts[-54]) rg2 \u0026lt;- lm(scale(GDP.q$GDP)~X.3m.xts[-54]) summary(rg) ## ## Call:\r## lm(formula = scale(GDP.q$GDP) ~ X.q.xts[-54])\r## ## Residuals:\r## Min 1Q Median 3Q Max ## -0.48942 -0.13666 0.03985 0.14338 0.28562 ## ## Coefficients:\r## Estimate Std. Error t value Pr(\u0026gt;|t|) ## (Intercept) 0.02841 0.02795 1.017 0.3146 ## X.q.xts[-54]X.1 -0.31431 0.01090 -28.841 \u0026lt; 2e-16 ***\r## X.q.xts[-54]X.2 -0.19397 0.01247 -15.559 \u0026lt; 2e-16 ***\r## X.q.xts[-54]X.3 0.03879 0.01880 2.063 0.0447 * ## X.q.xts[-54]X.4 -0.31876 0.03288 -9.696 8.60e-13 ***\r## X.q.xts[-54]X.5 -0.21523 0.03486 -6.175 1.46e-07 ***\r## ---\r## Signif. codes: 0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\r## ## Residual standard error: 0.2033 on 47 degrees of freedom\r## Multiple R-squared: 0.9626,\tAdjusted R-squared: 0.9587 ## F-statistic: 242.1 on 5 and 47 DF, p-value: \u0026lt; 2.2e-16\rsummary(rg2) ## ## Call:\r## lm(formula = scale(GDP.q$GDP) ~ X.3m.xts[-54])\r## ## Residuals:\r## Min 1Q Median 3Q Max ## -0.71694 -0.16540 0.04863 0.20132 0.79584 ## ## Coefficients:\r## Estimate Std. Error t value Pr(\u0026gt;|t|) ## (Intercept) 0.06106 0.04843 1.261 0.2136 ## X.3m.xts[-54]1 -0.30018 0.01593 -18.843 \u0026lt; 2e-16 ***\r## X.3m.xts[-54]2 -0.18521 0.01859 -9.962 3.62e-13 ***\r## X.3m.xts[-54]3 0.05174 0.02803 1.846 0.0712 . ## X.3m.xts[-54]4 -0.29361 0.04235 -6.933 1.03e-08 ***\r## X.3m.xts[-54]5 -0.10650 0.04187 -2.544 0.0143 * ## ---\r## Signif. codes: 0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\r## ## Residual standard error: 0.3039 on 47 degrees of freedom\r## Multiple R-squared: 0.9165,\tAdjusted R-squared: 0.9076 ## F-statistic: 103.2 on 5 and 47 DF, p-value: \u0026lt; 2.2e-16\ræ±ºå®šä¿‚æ•°ãŒå¤§å¹…ã«æ”¹å–„ã—ã¾ã—ãŸã€‚ 3ãƒ¶æœˆã®å¹³å‡ã‚’ã¨ã£ãŸãƒ•ã‚¡ã‚¯ã‚¿ãƒ¼ã®æ–¹ãŒãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãŒè‰¯ã•ãã†ãªã®ã§ã€ã“ã¡ã‚‰ã§å®Ÿéš›ã®GDPã¨äºˆæ¸¬å€¤ã®ãƒ—ãƒ­ãƒƒãƒˆã‚’è¡Œã£ã¦ã¿ã¾ã™ã€‚\nggplot(gather(data.frame(fit=rg$fitted.values,actual=scale(GDP.q$GDP),Date=GDP.q$publication),key,value,-Date),aes(y=value,x=Date,colour=key)) + geom_line(size=1) + ggtitle(\u0026#34;fit v.s. actual GDP\u0026#34;) ã„ã‹ãŒã§ã—ã‚‡ã†ã‹ã€‚å€‹äººçš„ã«ã¯ã‹ãªã‚Šãƒ•ã‚£ãƒƒãƒ†ã‚£ãƒ³ã‚°ã§ãã¦ã„ã‚‹å°è±¡ãŒã‚ã‚Šã¾ã™ï¼ˆã‚‚ã¯ã‚„çµŒæ¸ˆç†è«–ãªã©ä¸è¦ãªã®ã§ã—ã‚‡ã†ã‹ï¼‰ã€‚ãŸã ã€æœ€ã‚‚æ–°ã—ã„å€¤ã‚’é™¤ã„ã¦ã¯æœªæ¥ã®å€¤ãŒæƒ…å ±é‡ã¨ã—ã¦åŠ å‘³ã•ã‚ŒãŸä¸Šã§æ¨è¨ˆã•ã‚Œã¦ã„ã‚‹ã“ã¨ã«ãªã‚Šã¾ã™ã‹ã‚‰ã€ãƒ•ã‚§ã‚¢ã§ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚æ­£ã—ãäºˆæ¸¬èƒ½åŠ›ã‚’æ¤œè¨¼ã™ã‚‹ãŸã‚ã«ã¯å››åŠæœŸã”ã¨ã«é€æ¬¡çš„ã«å›å¸°ã‚’è¡Œã†å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚\nã¨ã„ã†ã‚ã‘ã§ã€ã‚¢ã‚¦ãƒˆã‚µãƒ³ãƒ—ãƒ«ã®äºˆæ¸¬åŠ›ãŒã©ã‚Œã»ã©ã‚ã‚‹ã®ã‹ã‚’ãƒ†ã‚¹ãƒˆã—ã¦ã¿ãŸã„ã¨æ€ã„ã¾ã™ã€‚ã¾ãšã€2005å¹´4æœˆã‹ã‚‰2007å¹´3æœˆã¾ã§ã®æœˆæ¬¡çµ±è¨ˆãƒ‡ãƒ¼ã‚¿ã§ãƒ•ã‚¡ã‚¯ã‚¿ãƒ¼ã‚’è¨ˆç®—ã—ã€ãƒ‡ãƒ¼ã‚¿é »åº¦ã‚’å››åŠæœŸã«é›†ç´„ã—ã¾ã™ã€‚ãã—ã¦ã€2007å¹´1Qã®ãƒ‡ãƒ¼ã‚¿ã‚’é™¤ã„ã¦ã€GDPã«å›å¸°ã—ã¾ã™ã€‚å›å¸°ã—ãŸãƒ¢ãƒ‡ãƒ«ã®ä¿‚æ•°ã‚’ç”¨ã„ã¦ã€2007å¹´1Qã®ãƒ•ã‚¡ã‚¯ã‚¿ãƒ¼ãƒ‡ãƒ¼ã‚¿ã§åŒæ™‚ç‚¹ã®GDPã®äºˆæ¸¬å€¤ã‚’è¨ˆç®—ã—ã€ãã‚Œã‚’å®Ÿç¸¾å€¤ã¨æ¯”è¼ƒã—ã¾ã™ã€‚æ¬¡ã¯2005å¹´4æœˆã‹ã‚‰2007å¹´6æœˆã¾ã§ã®ãƒ‡ãƒ¼ã‚¿ã‚’ç”¨ã„ã¦ï½¥ï½¥ï½¥ã¨ã„ã†æ„Ÿã˜ã§ã‚¢ã‚¦ãƒˆã‚µãƒ³ãƒ—ãƒ«ã®äºˆæ¸¬ã‚’è¡Œã£ã¦ã¿ã¾ã™ã€‚\nlibrary(lubridate) test_df \u0026lt;- data.frame() for (i in as.list(seq(as.Date(\u0026#34;2015-04-01\u0026#34;),as.Date(\u0026#34;2019-03-01\u0026#34;),by=\u0026#34;quarter\u0026#34;))){ day(i) \u0026lt;- days_in_month(i) traindata \u0026lt;- dataset1[dataset1$publication\u0026lt;=i,] X_train \u0026lt;- ESTIMATE_GPLVM(scale(traindata[,-2]),5) X_train.xts \u0026lt;- xts(X_train$output,order.by = traindata$publication) X_train.q.xts \u0026lt;- apply.quarterly(X_train.xts,mean) if (months(index(X_train.q.xts)[NROW(X_train.q.xts)]) %in% c(\u0026#34;3æœˆ\u0026#34;,\u0026#34;6æœˆ\u0026#34;,\u0026#34;9æœˆ\u0026#34;,\u0026#34;12æœˆ\u0026#34;)){ } else X_train.q.xts \u0026lt;- X_train.q.xts[-NROW(X_train.q.xts),] colnames(X_train.q.xts) \u0026lt;- c(\u0026#34;factor1\u0026#34;,\u0026#34;factor2\u0026#34;,\u0026#34;factor3\u0026#34;,\u0026#34;factor4\u0026#34;,\u0026#34;factor5\u0026#34;) GDP_train.q \u0026lt;- scale(GDP[GDP$publication\u0026gt;=index(X_train.q.xts)[1] \u0026amp; GDP$publication\u0026lt;=index(X_train.q.xts)[NROW(X_train.q.xts)],2]) rg_train \u0026lt;- lm(GDP_train.q[-NROW(GDP_train.q)]~.,data=X_train.q.xts[-NROW(X_train.q.xts)]) summary(rg_train) test_df \u0026lt;- rbind(test_df,data.frame(predict(rg_train,X_train.q.xts[NROW(X_train.q.xts)],interval = \u0026#34;prediction\u0026#34;,level=0.90),GDP=GDP_train.q[NROW(GDP_train.q)])) } è¨ˆç®—ã§ãã¾ã—ãŸã€‚ã‚°ãƒ©ãƒ•ã«ã—ã¦ã¿ã¾ã—ã‚‡ã†ã€‚å…ˆã»ã©ã®ã‚°ãƒ©ãƒ•ã‚ˆã‚Šã¯ç²¾åº¦ãŒæ‚ªããªã‚Šã¾ã—ãŸã€‚ç‰¹ã«ãƒªãƒ¼ãƒãƒ³ã®å¾Œã¯äºˆæ¸¬å€¤ã®ä¿¡é ¼åŒºé–“ï¼ˆ90%ï¼‰ãŒå¤§ããæ‹¡å¤§ã—ã¦ãŠã‚Šã€ä¸ç¢ºå®Ÿæ€§ãŒå¢—å¤§ã—ã¦ã„ã‚‹ã“ã¨ã‚‚ã‚ã‹ã‚Šã¾ã™ã€‚2010å¹´ä»¥é™ã«é–¢ã—ã¦ã¯å®Ÿç¸¾å€¤ã¯ä¿¡é ¼åŒºé–“ã«ã»ã©å…¥ã£ã¦ãŠã‚Šã€äºˆæ¸¬ãƒ¢ãƒ‡ãƒ«ã¨ã—ã¦ã®æ€§èƒ½ã¯ã¾ã‚ã¾ã‚ãªã®ã‹ãªã¨æ€ã„ã¾ã™ã€‚ãŸã ã€ãƒªãƒ¼ãƒãƒ³ã®ã‚ˆã†ãªé‡‘èå±æ©Ÿã‚‚ã‚ºãƒãƒƒã¨å½“ã¦ã‚‹ã¨ã“ã‚ã«ãƒ­ãƒãƒ³ãŒã‚ã‚‹ã¨æ€ã†ã®ã§å…ƒãƒ‡ãƒ¼ã‚¿ã®æ”¹å–„ã‚’å›³ã‚ŠãŸã„ã¨æ€ã„ã¾ã™ã€‚ã“ã®è¨˜äº‹ã¯ã„ã£ãŸã‚“ã“ã“ã§çµ‚äº†ã§ã™ã€‚\nggplot(gather(data.frame(test_df,Date=as.Date(rownames(test_df))),,,-c(lwr,upr,Date)),aes(y=value,x=Date,colour=key)) + geom_ribbon(aes(ymax=upr,ymin=lwr,fill=\u0026#34;band\u0026#34;),alpha=0.1,linetype=\u0026#34;blank\u0026#34;) + geom_line(size=1) + ggtitle(\u0026#34;out-sample test\u0026#34;) ","date":1558828800,"expirydate":-62135596800,"kind":"page","lang":"ja","lastmod":1558828800,"objectID":"eff061ee8a24f8f74005b0514c080a17","permalink":"/post/post8/","publishdate":"2019-05-26T00:00:00Z","relpermalink":"/post/post8/","section":"post","summary":"æœ€è¿‘ç§ãŒæ³¨ç›®ã—ã¦ã„ã‚‹ã®ãŒã‚¬ã‚¦ã‚¹éç¨‹ã€‚ä»Šå›ã¯ãã®ã‚¬ã‚¦ã‚¹éç¨‹ã®ä¸­ã§ã‚‚ã€ä¸»æˆåˆ†åˆ†æã®ã‚ˆã†ã«ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã®æ¬¡å…ƒå‰Šæ¸›ã®ãŸã‚ã«ä½¿ç”¨ã•ã‚Œã‚‹Gaussian Process Latent Variable Modelï¼ˆGPLVMï¼‰ã®ç´¹ä»‹ã‚’ã—ã¾ã™ã€‚","tags":["R","ã‚¬ã‚¦ã‚¹éç¨‹","GPLVM"],"title":"GPLVMã§ãƒãƒ«ãƒãƒ•ã‚¡ã‚¯ã‚¿ãƒ¼ãƒ¢ãƒ‡ãƒ«ã‚’æ§‹ç¯‰ã—ã¦ã¿ãŸ","type":"post"},{"authors":null,"categories":["ä»•äº‹é–¢é€£"],"content":"ãŠã¯ã“ã‚“ã°ã‚“ã«ã¡ã¯ã€‚å‹¤ã‚å…ˆã§ã€ã‚¢ã‚»ãƒƒãƒˆã‚¢ãƒ­ã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã«é–¢ã™ã‚‹ãƒ¯ãƒ¼ã‚¯ã‚·ãƒ§ãƒƒãƒ—ã«å‚åŠ ã—ãŸã®ã§ã€ã“ã®åˆ†é‡ã¯å®Œå…¨ãªã‚‹å°‚é–€å¤–ã§ã™ãŒã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ã—ã¦ã¿ãŸã„ã¨æ€ã„ã¾ã™ã€‚ä»Šå›ã¯ã€æœ€å°åˆ†æ•£ãƒãƒ¼ãƒˆãƒ•ã‚©ãƒªã‚ª(minimum variance portfolio)ã‚’åŸºæœ¬ãƒãƒ¼ãƒˆãƒ•ã‚©ãƒªã‚ªã¨ã—ãŸã†ãˆã§ã€ãã®åˆ†æ•£å…±åˆ†æ•£è¡Œåˆ—ï¼ˆäºˆæ¸¬å€¤ï¼‰ã‚’ã©ã®ã‚ˆã†ã«æ¨è¨ˆã™ã‚‹ã®ã‹ã¨ã„ã†ç‚¹ã«ã¤ã„ã¦å…ˆè¡Œç ”ç©¶ã‚’å‚è€ƒã«ã‚¨ã‚¯ã‚µã‚µã‚¤ã‚ºã—ã¦ã„ããŸã„ã¨æ€ã„ã¾ã™ã€‚å…ˆè¡Œç ”ç©¶ã¯ä»¥ä¸‹ã®è«–æ–‡ã§ã™ï¼ˆã‚ªãƒšãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãƒªã‚µãƒ¼ãƒã®ã‚¸ãƒ£ãƒ¼ãƒŠãƒ«ã§ã—ãŸï¼‰ã€‚\nAsset Allocation with Correlation: A Composite Trade-Off\n1. æœ€å°åˆ†æ•£ãƒãƒ¼ãƒˆãƒ•ã‚©ãƒªã‚ª æœ€å°åˆ†æ•£ãƒãƒ¼ãƒˆãƒ•ã‚©ãƒªã‚ªã®è©³ã—ã„èª¬æ˜ã¯ã“ã“ã§ã¯å‰²æ„›ã—ã¾ã™ãŒã€è¦ã¯å„è³‡ç”£ï¼ˆå†…æ ªã€å¤–æ ªã€å†…å‚µã€å¤–å‚µã€ã‚ªãƒ«ã‚¿ãƒŠï¼‰ã®ãƒªã‚¿ãƒ¼ãƒ³ã®å¹³å‡ã¨åˆ†æ•£ã‚’è¨ˆç®—ã—ã€ãã‚Œã‚‰ã‚’ç¸¦è»¸å¹³å‡å€¤ã€æ¨ªè»¸åˆ†æ•£ã®äºŒæ¬¡å¹³é¢ã«ãƒ—ãƒ­ãƒƒãƒˆã—ãŸã†ãˆã§ã€æŠ•è³‡å¯èƒ½ç¯„å›²ã‚’è¨ˆç®—ã—ã€ãã®é›†åˆã®ä¸­ã§æœ€ã‚‚åˆ†æ•£ãŒå°ã•ããªã‚‹ãƒãƒ¼ãƒˆãƒ•ã‚©ãƒªã‚ªã®äº‹ã‚‰ã—ã„ã§ã™ï¼ˆä¸‹å›³å‚ç…§ï¼‰ã€‚\nå…ˆè¡Œç ”ç©¶ã®Carroll et. al. (2017)ã§ã¯ã€\n this paper focusses on minimum-variance portfolios requiring only estimates of asset covariance, hence bypassing the well-known problem of estimation error in forecasting expected asset returns.\n ã¨è¨˜è¼‰ã•ã‚Œã¦ãŠã‚Šã€ç¾çŠ¶ã§ã‚‚æœŸå¾…ãƒªã‚¿ãƒ¼ãƒ³ã®æ¨è¨ˆã¯é›£ã—ãã€ãã‚Œã‚’å¿…è¦ã¨ã—ãªã„æœ€å°åˆ†æ•£ãƒãƒ¼ãƒˆãƒ•ã‚©ãƒªã‚ªã¯æœ‰ç›Šã§å®Ÿè·µçš„ãªæ‰‹æ³•ã§ã‚ã‚‹ã¨ã„ãˆã¾ã™ã€‚æœ€å°åˆ†æ•£ãƒãƒ¼ãƒˆãƒ•ã‚©ãƒªã‚ªã®ç›®çš„é–¢æ•°ã¯ã€ãã®åã®é€šã‚Šã€Œåˆ†æ•£ã‚’æœ€å°åŒ–ã™ã‚‹ã“ã¨ã€ã§ã™ã€‚ä»Šã€å„è³‡ç”£ã®ãƒªã‚¿ãƒ¼ãƒ³ã‚’é›†ã‚ãŸãƒ™ã‚¯ãƒˆãƒ«ã‚’$r$ã€å„è³‡ç”£ã®ä¿æœ‰ã‚¦ã‚§ã‚¤ãƒˆã‚’$\\theta$ã€ãƒãƒ¼ãƒˆãƒ•ã‚©ãƒªã‚ªãƒªã‚¿ãƒ¼ãƒ³ã‚’$R_{p}$ã§è¡¨ã™ã“ã¨ã«ã™ã‚‹ã¨ã€ãƒãƒ¼ãƒˆãƒ•ã‚©ãƒªã‚ªå…¨ä½“ã®åˆ†æ•£$var(R_{p})$ã¯ä»¥ä¸‹ã®ã‚ˆã†ã«è¨˜è¿°ã§ãã¾ã™ã€‚\n$$ var(R_{p}) = var(r^{T}\\theta) = E( (r^{T}\\theta)(r^{T}\\theta)^{T}) = \\theta^{T}\\Sigma\\theta $$\nã“ã“ã§$\\Sigma$ã¯$r$ã®åˆ†æ•£å…±åˆ†æ•£è¡Œåˆ—ã§ã™ã€‚ã‚ˆã£ã¦ã€æœ€å°åŒ–å•é¡Œã¯ä»¥ä¸‹ã«ãªã‚Šã¾ã™ã€‚\n$$ \\min_{\\theta}(\\theta^{T}\\Sigma\\theta) \\\ns.t 1^{T}\\theta = 1 $$\nã“ã“ã§ã¯ã€ãƒ•ãƒ«ã‚¤ãƒ³ãƒ™ã‚¹ãƒˆãƒ¡ãƒ³ãƒˆã‚’åˆ¶ç´„æ¡ä»¶ã«åŠ ãˆã¦ã„ã¾ã™ã€‚ãƒ©ã‚°ãƒ©ãƒ³ã‚¸ãƒ¥æœªå®šä¹—æ•°æ³•ã‚’ç”¨ã„ã¦ã“ã®å•é¡Œã‚’è§£ã„ã¦ã¿ã¾ã—ã‚‡ã†ã€‚ãƒ©ã‚°ãƒ©ãƒ³ã‚¸ãƒ¥é–¢æ•°$L$ã¯ä»¥ä¸‹ã®ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚\n$$ L = \\theta^{T}\\Sigma\\theta + \\lambda(1^{T}\\theta - 1) $$\n1éšã®æ¡ä»¶ã¯ã€\n$$ \\displaystyle\\frac{\\partial L}{\\partial \\theta} = 2\\Sigma\\theta + 1\\lambda = 0 \\\n\\displaystyle \\frac{\\partial L}{\\partial \\lambda} = 1^{T} \\theta = 1 $$\n1æœ¬ç›®ã®å¼ã‚’$\\theta$ã«ã¤ã„ã¦è§£ãã¨ã€\n$$ \\theta = \\Sigma^{-1}1\\lambda^{*} $$\n\rã¨ãªã‚Šã¾ã™ã€‚ã“ã“ã§ã€$\\lambda^{*}=-1/2\\lambda$ã§ã™ã€‚ã“ã‚Œã‚’2æœ¬ç›®ã®å¼ã«ä»£å…¥ã—ã€$\\lambda^{*}$ã«ã¤ã„ã¦è§£ãã¾ã™ã€‚\r\r\r$$\r1^{T}\\Sigma1\\lambda^{*} = 1 \\\\\r\\displaystyle \\lambda^{*} = \\frac{1}{1^{T}\\Sigma^{-1}1}\r$$\r\r\r$\\theta = \\Sigma^{-1}1\\lambda^{*}$ã ã£ãŸã®ã§ã€$\\lambda^{*}$ã‚’æ¶ˆå»ã™ã‚‹ã¨ã€\r\r$$ \\displaystyle \\theta_{gmv} = \\frac{\\Sigma^{-1}1}{1^{T}\\Sigma^{-1}1} $$\nã¨ãªã‚Šã€æœ€é©ãªã‚¦ã‚§ã‚¤ãƒˆã‚’æ±‚ã‚ã‚‹ã“ã¨ãŒã§ãã¾ã—ãŸã€‚ã¨ã‚Šã‚ãˆãšã€ã“ã‚Œã‚’Rã§å®Ÿè£…ã—ã¦ãŠãã¾ã™ã€‚\ngmv \u0026lt;- function(r_dat,r_cov){ library(MASS) i \u0026lt;- matrix(1,NCOL(r_dat),1) r_weight \u0026lt;- (ginv(r_cov)%*%i)/as.numeric(t(i)%*%ginv(r_cov)%*%i) wr_dat \u0026lt;- r_dat*as.numeric(r_weight) portfolio \u0026lt;- apply(wr_dat,1,sum) pr_dat \u0026lt;- data.frame(wr_dat,portfolio) sd \u0026lt;- sd(portfolio) result \u0026lt;- list(r_weight,pr_dat,sd) names(result) \u0026lt;- c(\u0026#34;weight\u0026#34;,\u0026#34;return\u0026#34;,\u0026#34;portfolio risk\u0026#34;) return(result) } nlgmv \u0026lt;- function(r_dat,r_cov){ qp.out \u0026lt;- solve.QP(Dmat=r_cov,dvec=rep(0,NCOL(r_dat)),Amat=cbind(rep(1,NCOL(r_dat)),diag(NCOL(r_dat))), bvec=c(1,rep(0,NCOL(r_dat))),meq=1) r_weight \u0026lt;- qp.out$solution wr_dat \u0026lt;- r_dat*r_weight portfolio \u0026lt;- apply(wr_dat,1,sum) pr_dat \u0026lt;- data.frame(wr_dat,portfolio) sd \u0026lt;- sd(portfolio) result \u0026lt;- list(r_weight,pr_dat,sd) names(result) \u0026lt;- c(\u0026#34;weight\u0026#34;,\u0026#34;return\u0026#34;,\u0026#34;portfolio risk\u0026#34;) return(result) } å…¥åŠ›ã¯å„è³‡ç”£ã®ãƒªã‚¿ãƒ¼ãƒ³ã¨åˆ†æ•£å…±åˆ†æ•£è¡Œåˆ—ã«ãªã£ã¦ã„ã¾ã™ã€‚å‡ºåŠ›ã¯ã‚¦ã‚§ã‚¤ãƒˆã€ãƒªã‚¿ãƒ¼ãƒ³ã€ãƒªã‚¹ã‚¯ã§ã™ã€‚nlgmvã¯æœ€å°åˆ†æ•£ãƒãƒ¼ãƒˆãƒ•ã‚©ãƒªã‚ªã®ç©ºå£²ã‚Šåˆ¶ç´„ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã§ã™ã€‚è§£æçš„ãªè§£ã¯å¾—ã‚‰ã‚Œãªã„ã®ã§ã€æ•°å€¤çš„ã«è²·ã„ã‚’æ±‚ã‚ã¦ã„ã¾ã™ã€‚\n2. åˆ†æ•£å…±åˆ†æ•£è¡Œåˆ—ã‚’ã©ã®ã‚ˆã†ã«æ±‚ã‚ã‚‹ã‹ æœ€å°åˆ†æ•£ãƒãƒ¼ãƒˆãƒ•ã‚©ãƒªã‚ªã®è¨ˆç®—å¼ã¯æ±‚ã‚ã‚‹ã“ã¨ãŒã§ãã¾ã—ãŸã€‚æ¬¡ã¯ã€ãã®å…¥åŠ›ã§ã‚ã‚‹åˆ†æ•£å…±åˆ†æ•£è¡Œåˆ—ã‚’ã©ã†ã‚„ã£ã¦æ±‚ã‚ã‚‹ã®ã‹ã«ã¤ã„ã¦åˆ†æã—ãŸã„ã¨æ€ã„ã¾ã™ã€‚ä¸€ç•ªåŸå§‹çš„ãªæ–¹æ³•ã¯ãã®æ™‚ç‚¹ä»¥å‰ã«åˆ©ç”¨å¯èƒ½ãªãƒªã‚¿ãƒ¼ãƒ³ãƒ‡ãƒ¼ã‚¿ã‚’æ¨™æœ¬ã¨ã—ã¦åˆ†æ•£å…±åˆ†æ•£è¡Œåˆ—ã‚’æ±‚ã‚ã€ãã®å€¤ã‚’å›ºå®šã—ã¦æœ€å°åˆ†æ•£ãƒãƒ¼ãƒˆãƒ•ã‚©ãƒªã‚ªã‚’æ±‚ã‚ã‚‹ã¨ã„ã†ãƒ’ã‚¹ãƒˆãƒªã‚«ãƒ«ãªã‚¢ãƒ—ãƒ­ãƒ¼ãƒã‹ã¨æ€ã„ã¾ã™ï¼ˆã¤ã¾ã‚Šã‚¦ã‚§ã‚¤ãƒˆã‚‚å›ºå®šï¼‰ã€‚ãŸã ã€ã“ã‚Œã¯ã‚ãã¾ã§éå»ã®å¹³å‡å€¤ã‚’å°†æ¥ã®äºˆæƒ³å€¤ã«ä½¿ç”¨ã™ã‚‹ãŸã‚ã€ã„ã‚ã„ã‚å•é¡ŒãŒå‡ºã¦ãã‚‹ã‹ã¨æ€ã„ã¾ã™ã€‚å°‚é–€å¤–ã®ç§ãŒæ€ã„ã¤ãã‚‚ã®ã¨ã—ã¦ã¯ã€å‰æ—¥ã‚ã‚‹è³‡ç”£Aã®ãƒªã‚¿ãƒ¼ãƒ³ãŒå¤§ããä¸‹è½ã—ãŸã¨ã„ã†å ´é¢ã§æ˜æ—¥ã‚‚ã“ã®è³‡ç”£ã®åˆ†æ•£ã¯å¤§ãããªã‚‹ã“ã¨ãŒäºˆæƒ³ã•ã‚Œã‚‹ã«ã‚‚é–¢ã‚ã‚‰ãšã€å¹³å‡å€¤ã‚’ä½¿ç”¨ã™ã‚‹ãŸã‚æ˜¨æ—¥ã®åŠ¹æœãŒè–„ã‚ã‚‰ã‚Œã¦ã—ã¾ã†ã“ã¨ã§ã—ã‚‡ã†ã‹ã€‚ãã‚Œã«ã€ã‚¦ã‚§ã‚¤ãƒˆã‚’æœ€åˆã‹ã‚‰å¤‰æ›´ã—ãªã„ã¨ã„ã†ã®ã‚‚æ™‚é–“ãŒãŸã¤ã«ã¤ã‚Œã€æœ€é©ç‚¹ã‹ã‚‰é›¢ã‚Œã¦ã„ãæ°—ãŒã—ã¾ã™ã€‚ãŸã ã€ã§ã¯ã©ã†æ¨è¨ˆã™ã‚‹ã®ã‹ã¤ã„ã¦ã¯ã“ã®åˆ†é‡ã§ã‚‚è©¦è¡ŒéŒ¯èª¤ãŒè¡Œã‚ã‚Œã¦ã„ã‚‹ã‚ˆã†ã§ã™ã€‚Carroll et. al. (2017)ã§ã‚‚ã€\n The estimation of covariance matrices for portfolios with a large number of assets still remains a fundamental challenge in portfolio optimization.\n ã¨è¿°ã¹ã‚‰ã‚Œã¦ã„ã¾ã—ãŸã€‚ã“ã®è«–æ–‡ã§ã¯ä»¥ä¸‹ã®ã‚ˆã†ãªãƒ¢ãƒ‡ãƒ«ã‚’ç”¨ã„ã¦æ¨è¨ˆãŒè¡Œã‚ã‚Œã¦ã„ã¾ã™ã€‚ã„ãšã‚Œã‚‚ã€åˆ†æ•£å…±åˆ†æ•£è¡Œåˆ—ã‚’æ™‚å¤‰ã¨ã—ã¦ã„ã‚‹ã¨ã“ã‚ã«ç‰¹å¾´ãŒã‚ã‚Šã¾ã™ã€‚\nA. Constant conditional correlation (CCC) model å…ƒè«–æ–‡ã¯ã“ã¡ã‚‰ã€‚\nã¾ãšã€åˆ†æ•£å…±åˆ†æ•£è¡Œåˆ—ã¨ç›¸é–¢è¡Œåˆ—ã®é–¢ä¿‚æ€§ã‹ã‚‰ã€$\\Sigma_{t} = D_{t}R_{t}D_{t}$ã¨ãªã‚Šã¾ã™ã€‚ã“ã“ã§ã€$R_{t}$ã¯ç›¸é–¢è¡Œåˆ—ã€$D_{t}$ã¯$diag(\\sigma_{1,t},\u0026hellip;,\\sigma_{N,t})$ã§å„è³‡ç”£$tt$æœŸã®æ¨™æº–åå·®$\\sigma_{i,t}$ã‚’å¯¾è§’æˆåˆ†ã«ä¸¦ã¹ãŸè¡Œåˆ—ã§ã™ã€‚ã“ã“ã‹ã‚‰ã€$D_{t}$ã¨$R_{t}$ã‚’åˆ†ã‘ã¦æ¨è¨ˆã—ã¦ã„ãã¾ã™ã€‚ã¾ãšã€$D_{t}$ã§ã™ãŒã€ã“ã¡ã‚‰ã¯ä»¥ä¸‹ã®ã‚ˆã†ãªå¤šå¤‰é‡GARCHãƒ¢ãƒ‡ãƒ«(1,1)ã§æ¨è¨ˆã—ã¾ã™ã€‚\n$$ r_{t} = \\mu + u_{t} \\\nu_{t} = \\sigma_{t}\\epsilon \\\n\\sigma_{t}^{2} = \\alpha_{0} + \\alpha_{1}u_{t-1}^{2} + \\alpha_{2}\\sigma_{t-1}^{2} \\\n\\epsilon_{t} = NID(0,1) \\\nE(u_{t}|u_{t-1}) = 0 $$\nã“ã“ã§ã€$\\mu$ã¯ãƒªã‚¿ãƒ¼ãƒ³ã®æ¨™æœ¬å¹³å‡ã§ã™ã€‚$\\alpha_{i}$ã¯æ¨å®šã™ã¹ããƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã€‚$D_{t}$ã‚’GARCHã§æ¨è¨ˆã—ã¦ã„ã‚‹ã®ã§ã€ãƒªã‚¿ãƒ¼ãƒ³ã®åˆ†å¸ƒãŒæ­£è¦åˆ†å¸ƒã‚ˆã‚Šè£¾é‡ã®åšã„åˆ†å¸ƒã«å¾“ã„ã€ã¾ãŸãƒªã‚¿ãƒ¼ãƒ³ã®å¤‰åŒ–ã¯ä¸€å®šã§ã¯ãªãå‰æ—¥ã®åˆ†æ•£ã«ä¾å­˜ã™ã‚‹é–¢ä¿‚ã‚’ãƒ¢ãƒ‡ãƒ«åŒ–ã—ã¦ã„ã‚‹ã¨ã„ãˆã‚‹ã®ã§ã¯ãªã„ã§ã—ã‚‡ã†ã‹ã€‚ã¨ã‚Šã‚ãˆãšã“ã‚Œã§$D_{t}$ã®æ¨è¨ˆã¯ã§ããŸã¨ã„ã†ã“ã¨ã«ã—ã¾ã™ã€‚æ¬¡ã«$R_{t}$ã®æ¨è¨ˆã§ã™ãŒã€ã“ã®ãƒ¢ãƒ‡ãƒ«ã§ã¯ãƒªã‚¿ãƒ¼ãƒ³ã‚’æ¨™æœ¬ã¨ã—ã¦æ±‚ã‚ã‚‹ãƒ’ã‚¹ãƒˆãƒªã‚«ãƒ«ãªã‚¢ãƒ—ãƒ­ãƒ¼ãƒã‚’å–ã‚Šã¾ã™ã€‚ã¤ã¾ã‚Šã€$R_{t}$ã¯å®šæ•°ã§ã™ã€‚ã‚ˆã£ã¦ã€ãƒªã‚¿ãƒ¼ãƒ³å¤‰å‹•ã®å¤§ãã•ã¯æ™‚é–“ã«ã‚ˆã£ã¦å¤‰åŒ–ã™ã‚‹ãŒã€å„è³‡ç”£ã®ç›¸å¯¾çš„ãªé–¢ä¿‚æ€§ã¯ä¸å¤‰ã§ã‚ã‚‹ã¨ã„ã†ä»®å®šã‚’ç½®ã„ã¦ã„ã‚‹ã“ã¨ã«ãªã‚Šã¾ã™ã€‚\nB. Dynamic Conditional Correlation (DCC) model å…ƒè«–æ–‡ã¯ã“ã¡ã‚‰ã€‚\nã“ã¡ã‚‰ã®ãƒ¢ãƒ‡ãƒ«ã§ã¯ã€$D_{t}$ã‚’æ±‚ã‚ã‚‹ã¨ã“ã‚ã¾ã§ã¯â‘ ã¨åŒã˜ã§ã™ãŒã€[$R_{t}$ã®æ±‚ã‚æ–¹ãŒç•°ãªã£ã¦ãŠã‚Šã€ARMA(1,1)ã‚’ç”¨ã„ã¦æ¨è¨ˆã—ã¾ã™ã€‚ç›¸é–¢è¡Œåˆ—ã¯ã‚„ã¯ã‚Šå®šæ•°ã§ã¯ãªã„ã¨ã„ã†ã“ã¨ã§ã€$t$æœŸã¾ã§ã«åˆ©ç”¨å¯èƒ½ãªãƒªã‚¿ãƒ¼ãƒ³ã‚’ç”¨ã„ã¦æ¨è¨ˆã‚’ã‹ã‘ã‚ˆã†ã¨ã„ã†ã“ã¨ã«ãªã£ã¦ã„ã¾ã™ã€‚ã“ã®ãƒ¢ãƒ‡ãƒ«ã®ç›¸é–¢è¡Œåˆ—$R_{t}$ã¯ã€\n$$ R_{t} = diag(Q_{t})^{-1/2}Q_{t}diag(Q_{t})^{-1/2} $$\nã§ã™ã€‚ã“ã“ã§ã€$Q_{t}$ã¯$t$æœŸã§ã®æ¡ä»¶ä»˜åˆ†æ•£å…±åˆ†æ•£è¡Œåˆ—ã§ä»¥ä¸‹ã®ã‚ˆã†ã«å®šå¼åŒ–ã•ã‚Œã¾ã™ã€‚\n$$ Q_{t} = \\bar{Q}(1-a-b) + adiag(Q_{t-1})^{1/2}\\epsilon_{i,t-1}\\epsilon_{i,t-1}diag(Q_{t-1})^{1/2} + bQ_{t-1} $$\nã“ã“ã§ã€$\\bar{Q}$ã¯ãƒ’ã‚¹ãƒˆãƒªã‚«ãƒ«ãªæ–¹æ³•ã§è¨ˆç®—ã—ãŸåˆ†æ•£å…±åˆ†æ•£è¡Œåˆ—ã§ã‚ã‚Šã€$a,b$ã¯ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã§ã™ã€‚ã“ã®æ–¹æ³•ã§ã¯ã€å…ˆã»ã©ã¨ã¯ç•°ãªã‚Šã€ãƒªã‚¿ãƒ¼ãƒ³å¤‰å‹•ã®å¤§ãã•ãŒæ™‚é–“ã«ã‚ˆã£ã¦å¤‰åŒ–ã™ã‚‹ã ã‘ã§ãªãã€å„è³‡ç”£ã®ç›¸å¯¾çš„ãªé–¢ä¿‚æ€§ã‚‚é€šæ™‚çš„ã«å¤‰åŒ–ã—ã¦ã„ãã¨ã„ã†ä»®å®šã‚’ç½®ã„ã¦ã„ã‚‹ã“ã¨ã«ãªã‚Šã¾ã™ã€‚é‡‘èå±æ©Ÿæ™‚ã«ã¯å…¨è³‡ç”£ã®ãƒªã‚¿ãƒ¼ãƒ³ãŒä¸‹è½ã—ã€å„è³‡ç”£ã®ç›¸é–¢ãŒæ­£ã«ãªã‚‹äº‹è±¡ã‚‚è¦³æ¸¬ã•ã‚Œã¦ã„ã‚‹ã“ã¨ã‹ã‚‰ã€ã“ã®å®šå¼åŒ–ã¯é­…åŠ›çš„ã§ã‚ã‚‹ã¨ã„ã†ã“ã¨ãŒã§ãã‚‹ã®ã§ã¯ãªã„ã§ã—ã‚‡ã†ã‹ã€‚\nC. Dynamic Equicorrelation (DECO) model å…ƒè«–æ–‡ã¯ã“ã¡ã‚‰ã€‚\nã“ã®è«–æ–‡ã¯ã¾ã ãã£ã¡ã‚Šèª­ã‚ã¦ã„ãªã„ã®ã§ã™ãŒã€ç›¸é–¢è¡Œåˆ—$R_{t}$ã®å®šç¾©ã‹ã‚‰\n$$ R_{t} = (1-\\rho_{t})I_{N} + \\rho_{t}1 $$\nã¨ãªã‚‹ã‚ˆã†ã§ã™ã€‚ã“ã“ã§ã€$\\rho_{t}$ã¯ã‚¹ã‚«ãƒ©ãƒ¼ã§equicorrelationã®ç¨‹åº¦ã‚’è¡¨ã™ä¿‚æ•°ã§ã™ã€‚equicorrelationã¨ã¯å¹³å‡çš„ãªãƒšã‚¢ãƒ¯ã‚¤ã‚ºç›¸é–¢ã®äº‹ã§ã‚ã‚‹ã¨ç†è§£ã—ã¦ã„ã¾ã™ã€‚ã¤ã¾ã‚Šã¯æ¬ æå€¤ãŒãªã‘ã‚Œã°æ™®é€šã®ç›¸é–¢ã¨å¤‰ã‚ã‚Šãªã„ã‚“ã˜ã‚ƒãªã„ã‹ã¨ã€‚ãŸã ã€è³‡ç”£ãŒå¢—ãˆã‚Œã°ãã®ã‚ˆã†ãªå•é¡Œã«ã‚‚å¯¾å‡¦ã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã®ã§ãã®ç‚¹ã§ã¯ã‚ˆã„æ¨å®šé‡ã®ã‚ˆã†ã§ã™ã€‚$\\rho_{t}$ã¯ä»¥ä¸‹ã®ã‚ˆã†ã«æ±‚ã‚ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚\n$$ \\displaystyle \\rho_{t} = \\frac{1}{N(N-1)}(\\iota^{T}R_{t}^{DCC}\\iota - N) = \\frac{2}{N(N-1)}\\sum_{i\u0026gt;j}\\frac{q_{ij,t}}{\\sqrt{q_{ii,t} q_{jj,t}}} $$\nã“ã“ã§ã€$\\iota$ã¯NÃ—1ãƒ™ã‚¯ãƒˆãƒ«ã§è¦ç´ ã¯å…¨ã¦1ã§ã™ã€‚ã¾ãŸã€$q_{ij,t}$ã¯$Q_{t}$ã®i,jè¦ç´ ã§ã™ã€‚\nã•ã¦ã€åˆ†æ•£å…±åˆ†æ•£è¡Œåˆ—ã®ãƒ¢ãƒ‡ãƒ«åŒ–ãŒã§ããŸã¨ã“ã‚ã§ã€ã“ã“ã¾ã§ã‚’Rã§å®Ÿè£…ã—ã¦ãŠãã¾ã™ã€‚\ncarroll \u0026lt;- function(r_dat,FLG){ library(rmgarch) if(FLG == \u0026#34;benchmark\u0026#34;){ H \u0026lt;- cov(r_dat) }else{ #1. define variables N \u0026lt;- NCOL(r_dat) # the number of assets #2. estimate covariance matrix basic_garch = ugarchspec(mean.model = list(armaOrder = c(0, 0),include.mean=TRUE), variance.model = list(garchOrder = c(1,1), model = \u0026#39;sGARCH\u0026#39;), distribution.model = \u0026#39;norm\u0026#39;) multi_garch = multispec(replicate(N, basic_garch)) dcc_set = dccspec(uspec = multi_garch, dccOrder = c(1, 1), distribution = \u0026#34;mvnorm\u0026#34;,model = \u0026#34;DCC\u0026#34;) fit_dcc_garch = dccfit(dcc_set, data = r_dat, fit.control = list(eval.se = TRUE)) forecast_dcc_garch \u0026lt;- dccforecast(fit_dcc_garch) if (FLG == \u0026#34;CCC\u0026#34;){ #Constant conditional correlation (CCC) model D \u0026lt;- sigma(forecast_dcc_garch) R_ccc \u0026lt;- cor(r_dat) H \u0026lt;- diag(D[,,1])%*%R_ccc%*%diag(D[,,1]) colnames(H) \u0026lt;- colnames(r_dat) rownames(H) \u0026lt;- colnames(r_dat) } else{ #Dynamic Conditional Correlation (DCC) model H \u0026lt;- as.matrix(rcov(forecast_dcc_garch)[[1]][,,1]) if (FLG == \u0026#34;DECO\u0026#34;){ #Dynamic Equicorrelation (DECO) model one \u0026lt;- matrix(1,N,N) iota \u0026lt;- rep(1,N) Q_dcc \u0026lt;- rcor(forecast_dcc_garch,type=\u0026#34;Q\u0026#34;)[[1]][,,1] rho \u0026lt;- as.vector((N*(N-1))^(-1)*(t(iota)%*%Q_dcc%*%iota-N)) D \u0026lt;- sigma(forecast_dcc_garch) R_deco \u0026lt;- (1-rho)*diag(1,N,N) + rho*one H \u0026lt;- diag(D[,,1])%*%R_deco%*%diag(D[,,1]) colnames(H) \u0026lt;- colnames(r_dat) rownames(H) \u0026lt;- colnames(r_dat) } } } return(H) } æœ¬æ¥ã§ã‚ã‚Œã°ã€ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’ä½¿ç”¨ã™ã‚‹ã¹ãã§ã¯ãªã„ã®ã§ã™ãŒã€ä»Šæ—¥ã¯ã‚¨ã‚¯ã‚µã‚µã‚¤ã‚ºãªã®ã§æ¨è¨ˆçµæœã ã‘ã‚’è¿½ã„æ±‚ã‚ãŸã„ã¨æ€ã„ã¾ã™ã€‚GARCHã«ã¤ã„ã¦ã¯å†æ¥é€±ãã‚‰ã„ã«è¨˜äº‹ã‚’æ›¸ãäºˆå®šã§ã™ã€‚ ã“ã‚Œã§æº–å‚™ãŒã§ãã¾ã—ãŸã€‚ã“ã®é–¢æ•°ã«ãƒªã‚¿ãƒ¼ãƒ³ãƒ‡ãƒ¼ã‚¿ã‚’å…¥ã‚Œã¦ã€åˆ†æ•£å…±åˆ†æ•£è¡Œåˆ—ã‚’è¨ˆç®—ã—ã€ãã‚Œã‚’ç”¨ã„ã¦æœ€å°åˆ†æ•£ãƒãƒ¼ãƒˆãƒ•ã‚©ãƒªã‚ªã‚’è¨ˆç®—ã™ã‚‹ã“ã¨ãŒã§ãã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã—ãŸã€‚\n3. ãƒ†ã‚¹ãƒˆç”¨ãƒ‡ãƒ¼ã‚¿ã®åé›† ãƒ‡ãƒ¼ã‚¿ã¯ä»¥ä¸‹ã®è¨˜äº‹ã‚’å‚è€ƒã«ã—ã¾ã—ãŸã€‚\n(Introduction to Asset Allocation)[https://www.r-bloggers.com/introduction-to-asset-allocation/]\nä½¿ç”¨ã—ãŸã®ã¯ã€ä»¥ä¸‹ã®ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã«é€£å‹•ã™ã‚‹ETF(iShares)ã®åŸºæº–ä¾¡é¡ãƒ‡ãƒ¼ã‚¿ã§ã™ã€‚\n S\u0026amp;P500 NASDAQ100 MSCI Emerging Markets Russell 2000 MSCI EAFE US 20 Year Treasury(the Barclays Capital 20+ Year Treasury Index) U.S. Real Estate(the Dow Jones US Real Estate Index) gold bullion market  ã¾ãšã€ãƒ‡ãƒ¼ã‚¿é›†ã‚ã§ã™ã€‚\nlibrary(quantmod) #************************** # â˜…8 ASSETS SIMULATION # SPY - S\u0026amp;P 500  # QQQ - Nasdaq 100 # EEM - Emerging Markets # IWM - Russell 2000 # EFA - EAFE # TLT - 20 Year Treasury # IYR - U.S. Real Estate # GLD - Gold #************************** # load historical prices from Yahoo Finance symbol.names = c(\u0026#34;S\u0026amp;P 500\u0026#34;,\u0026#34;Nasdaq 100\u0026#34;,\u0026#34;Emerging Markets\u0026#34;,\u0026#34;Russell 2000\u0026#34;,\u0026#34;EAFE\u0026#34;,\u0026#34;20 Year Treasury\u0026#34;,\u0026#34;U.S. Real Estate\u0026#34;,\u0026#34;Gold\u0026#34;) symbols = c(\u0026#34;SPY\u0026#34;,\u0026#34;QQQ\u0026#34;,\u0026#34;EEM\u0026#34;,\u0026#34;IWM\u0026#34;,\u0026#34;EFA\u0026#34;,\u0026#34;TLT\u0026#34;,\u0026#34;IYR\u0026#34;,\u0026#34;GLD\u0026#34;) getSymbols(symbols, from = \u0026#39;1980-01-01\u0026#39;, auto.assign = TRUE) #gn dates for all symbols \u0026amp; convert to monthly hist.prices = merge(SPY,QQQ,EEM,IWM,EFA,TLT,IYR,GLD) month.ends = endpoints(hist.prices, \u0026#39;day\u0026#39;) hist.prices = Cl(hist.prices)[month.ends, ] colnames(hist.prices) = symbols # remove any missing data hist.prices = na.omit(hist.prices[\u0026#39;1995::\u0026#39;]) # compute simple returns hist.returns = na.omit( ROC(hist.prices, type = \u0026#39;discrete\u0026#39;) ) # compute historical returns, risk, and correlation ia = list() ia$expected.return = apply(hist.returns, 2, mean, na.rm = T) ia$risk = apply(hist.returns, 2, sd, na.rm = T) ia$correlation = cor(hist.returns, use = \u0026#39;complete.obs\u0026#39;, method = \u0026#39;pearson\u0026#39;) ia$symbols = symbols ia$symbol.names = symbol.names ia$n = length(symbols) ia$hist.returns = hist.returns # convert to annual, year = 12 months annual.factor = 12 ia$expected.return = annual.factor * ia$expected.return ia$risk = sqrt(annual.factor) * ia$risk rm(SPY,QQQ,EEM,IWM,EFA,TLT,IYR,GLD) ãƒªã‚¿ãƒ¼ãƒ³ã‚’ãƒ—ãƒ­ãƒƒãƒˆã™ã‚‹ã¨ã“ã‚“ãªæ„Ÿã˜ã§ã™ã€‚\nPerformanceAnalytics::charts.PerformanceSummary(hist.returns, main = \u0026#34;ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ã‚µãƒãƒªãƒ¼\u0026#34;) æ¬¡ã«ã€ãƒãƒƒã‚¯ãƒ†ã‚¹ãƒˆã®ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã‚’è¡Œã„ã¾ã™ã€‚ä¸€æ°—ã«ã‚³ãƒ¼ãƒ‰ã‚’å…¬é–‹ã—ã¾ã™ã€‚\n# BACK TEST backtest \u0026lt;- function(r_dat,FLG,start_date,span,learning_term,port){ #----------------------------------------- # BACKTEST # r_dat - return data(xts object)  # FLG - flag(CCC,DCC,DECO) # start_date - start date for backtest # span - rebalance frequency # learning_term - learning term (days) # port - method of portfolio optimization #----------------------------------------- library(stringi) initial_dat \u0026lt;- r_dat[stri_c(as.Date(start_date)-learning_term,\u0026#34;::\u0026#34;,as.Date(start_date))] for (i in NROW(initial_dat):NROW(r_dat)) { if (i == NROW(initial_dat)){ H \u0026lt;- carroll(initial_dat[1:(NROW(initial_dat)-1),],FLG) if (port == \u0026#34;nlgmv\u0026#34;){ result \u0026lt;- nlgmv(initial_dat,H) }else if (port == \u0026#34;risk parity\u0026#34;){ result \u0026lt;- risk_parity(initial_dat,H) } weight \u0026lt;- t(result$weight) colnames(weight) \u0026lt;- colnames(initial_dat) p_return \u0026lt;- initial_dat[NROW(initial_dat),]*result$weight } else { if (i %in% endpoints(r_dat,span)){ H \u0026lt;- carroll(test_dat[1:(NROW(test_dat)-1),],FLG) if (port == \u0026#34;nlgmv\u0026#34;){ result \u0026lt;- nlgmv(test_dat,H) }else if (port == \u0026#34;risk parity\u0026#34;){ result \u0026lt;- risk_parity(test_dat,H) } } weight \u0026lt;- rbind(weight,t(result$weight)) p_return \u0026lt;- rbind(p_return,test_dat[NROW(test_dat),]*result$weight) } if (i != NROW(r_dat)){ term \u0026lt;- stri_c(index(r_dat[i+1,])-learning_term,\u0026#34;::\u0026#34;,index(r_dat[i+1,])) test_dat \u0026lt;- r_dat[term] } } p_return$portfolio \u0026lt;- xts(apply(p_return,1,sum),order.by = index(p_return)) weight.xts \u0026lt;- xts(weight,order.by = index(p_return)) result \u0026lt;- list(p_return,weight.xts) names(result) \u0026lt;- c(\u0026#34;return\u0026#34;,\u0026#34;weight\u0026#34;) return(result) } CCC \u0026lt;- backtest(hist.returns,\u0026#34;CCC\u0026#34;,\u0026#34;2007-01-04\u0026#34;,\u0026#34;months\u0026#34;,365,\u0026#34;risk parity\u0026#34;) DCC \u0026lt;- backtest(hist.returns,\u0026#34;DCC\u0026#34;,\u0026#34;2007-01-04\u0026#34;,\u0026#34;months\u0026#34;,365,\u0026#34;risk parity\u0026#34;) DECO \u0026lt;- backtest(hist.returns,\u0026#34;DECO\u0026#34;,\u0026#34;2007-01-04\u0026#34;,\u0026#34;months\u0026#34;,365,\u0026#34;risk parity\u0026#34;) benchmark \u0026lt;- backtest(hist.returns,\u0026#34;benchmark\u0026#34;,\u0026#34;2007-01-04\u0026#34;,\u0026#34;months\u0026#34;,365,\u0026#34;risk parity\u0026#34;) result \u0026lt;- merge(CCC$return$portfolio,DCC$return$portfolio,DECO$return$portfolio,benchmark$return$portfolio) colnames(result) \u0026lt;- c(\u0026#34;CCC\u0026#34;,\u0026#34;DCC\u0026#34;,\u0026#34;DECO\u0026#34;,\u0026#34;benchmark\u0026#34;) è¨ˆç®—çµæœã‚’ã‚°ãƒ©ãƒ•ã«ã—ã¦ã¿ã¾ã™ã€‚\nPerformanceAnalytics::charts.PerformanceSummary(result,main = \u0026#34;BACKTEST\u0026#34;) ç©ºå£²ã‚Šåˆ¶ç´„ã‚’èª²ã—ãŸã®ã§ã€ä¸Šã§å®šç¾©ã—ãŸæœ€å°åˆ†æ•£ãƒãƒ¼ãƒˆãƒ•ã‚©ãƒªã‚ªã¯ä½¿ç”¨ã—ã¦ã„ã¾ã›ã‚“ã€‚ã©ã†ã‚„ã‚‰ã“ã‚Œã ã‘ã§è§£æçš„ã«è§£ãã®ã¯é›£ã—ã„ã‚‰ã—ãã€æ•°å€¤çš„ã«è§£ãã“ã¨ã«ã—ã¦ã„ã¾ã™ã€‚ãƒªãƒãƒ©ãƒ³ã‚¹æœŸé–“ã‚’é€±æ¬¡ã«ã—ãŸã®ã§ã€è‡ªå‰ã®PCã§ã¯è¨ˆç®—ã«æ™‚é–“ãŒã‹ã‹ã‚Šã¾ã—ãŸãŒã€çµæœãŒè¨ˆç®—ã§ãã¾ã—ãŸã€‚\nãƒªãƒ¼ãƒãƒ³ä»¥é™ã¯ã©ã†ã‚„ã‚‰ãƒ™ãƒ³ãƒãƒãƒ¼ã‚¯ã§ã‚ã‚‹ç­‰ã‚¦ã‚§ã‚¤ãƒˆãƒãƒ¼ãƒˆãƒ•ã‚©ãƒªã‚ªã‚ˆã‚Šã‚’ã‚¢ã‚¦ãƒˆãƒ‘ãƒ•ã‚©ãƒ¼ãƒ ã—ã¦ã„ã‚‹ã‚ˆã†ã§ã™ã€‚ç‰¹ã«ã€DECOã¯ã„ã„æ„Ÿã˜ã§ã™ã€‚ãã‚‚ãã‚‚DECOã¨DCCã¯ã»ã¼å¤‰ã‚ã‚‰ãªã„ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ã§ã‚ã‚‹ã¨æ€ã£ã¦ã„ãŸã®ã§ã™ãŒã€ã©ã†ã‚„ã‚‰è‡ªåˆ†ã®ç†è§£ãŒè¶³ã‚‰ãªã„ã‚‰ã—ãã€è«–æ–‡ã®èª­ã¿è¿”ã™å¿…è¦ãŒã‚ã‚‹ã‚ˆã†ã§ã™ã€‚Equicorrelationã®æ„å‘³ã‚’ã‚‚ã†ä¸€åº¦è€ƒãˆã¦ã¿ãŸã„ã¨æ€ã„ã¾ã™ã€‚ãã‚Œãã‚Œã®çµ„å…¥æ¯”ç‡ã®æ¨ç§»ã¯ä»¥ä¸‹ã®ã‚ˆã†ã«ãªã‚Šã¾ã—ãŸã€‚\n# plot allocation weighting d_allocation \u0026lt;- function(ggweight,title){ #install.packages(\u0026#34;tidyverse\u0026#34;) library(tidyverse) ggweight \u0026lt;- gather(ggweight,key=ASSET,value=weight,-Date,-method) ggplot(ggweight, aes(x=Date, y=weight,fill=ASSET)) + geom_area(colour=\u0026#34;black\u0026#34;,size=.1) + scale_y_continuous(limits = c(0,1)) + labs(title=title) + facet_grid(method~.) } gmv_weight \u0026lt;- rbind(data.frame(CCC$weight,method=\u0026#34;CCC\u0026#34;,Date=index(CCC$weight)),data.frame(DCC$weight,method=\u0026#34;DCC\u0026#34;,Date=index(DCC$weight)),data.frame(DECO$weight,method=\u0026#34;DECO\u0026#34;,Date=index(DECO$weight))) # plot allocation weighting d_allocation(gmv_weight,\u0026#34;GMV Asset Allocation\u0026#34;) ãƒªãƒ¼ãƒãƒ³ã®éš›ã«TLTã€ã¤ã¾ã‚Šç±³å›½å‚µã¸ã®æ¯”ç‡ã‚’å¢—ã‚„ã—ã¦ã„ã‚‹ã‚ˆã†ã§ã™ã€‚CCCã¨DCCã¯ãã‚Œä»¥å¤–ã®éƒ¨åˆ†ã§ã‚‚ç±³å›½å‚µã¸ã®æ¯”ç‡ãŒé«˜ãã€ã‚ˆãæŒ™ã’ã‚‰ã‚Œã‚‹æœ€å°åˆ†æ•£ãƒãƒ¼ãƒˆãƒ•ã‚©ãƒªã‚ªã®å•é¡Œç‚¹ãŒã“ã“ã§ã‚‚ç™ºç”Ÿã—ã¦ã„ã‚‹ã‚ˆã†ã§ã™ã€‚ä¸€æ–¹ã€DECOãŒã‚„ã¯ã‚Šå€‹æ€§çš„ãªçµ„å…¥æ¯”ç‡ã®æ¨ç§»ã‚’ã—ã¦ãŠã‚Šã€ã“ã“ã‚‰ã‚’è€ƒãˆã¦ã‚‚ã‚‚ã†ä¸€åº¦è«–æ–‡ã‚’èª­ã¿è¿”ã—ã¦ã¿ã‚‹å¿…è¦ãŒã‚ã‚Šãã†ã§ã™ã€‚\nè¿½è¨˜ï¼ˆ2019/3/3ï¼‰ ã“ã‚Œã¾ã§ã¯ã€æœ€å°åˆ†æ•£ãƒãƒ¼ãƒˆãƒ•ã‚©ãƒªã‚ªã§åˆ†æã‚’ã—ã¦ã„ã¾ã—ãŸãŒã€ãƒªã‚¹ã‚¯ãƒ‘ãƒªãƒ†ã‚£ã®çµæœã‚‚è¦‹ãŸã„ãªã¨è¨€ã†ã“ã¨ã§ã€ãã®ã‚³ãƒ¼ãƒ‰ã‚‚æ›¸ã„ã¦ã¿ã¾ã—ãŸã€‚\nrisk_parity \u0026lt;- function(r_dat,r_cov){ fn \u0026lt;- function(weight, r_cov) { N \u0026lt;- NROW(r_cov) risks \u0026lt;- weight * (r_cov %*% weight) g \u0026lt;- rep(risks, times = N) - rep(risks, each = N) return(sum(g^2)) } dfn \u0026lt;- function(weight,r_cov){ out \u0026lt;- weight for (i in 0:length(weight)) { up \u0026lt;- dn \u0026lt;- weight up[i] \u0026lt;- up[i]+.0001 dn[i] \u0026lt;- dn[i]-.0001 out[i] = (fn(up,r_cov) - fn(dn,r_cov))/.0002 } return(out) } std \u0026lt;- sqrt(diag(r_cov)) x0 \u0026lt;- 1/std/sum(1/std) res \u0026lt;- nloptr::nloptr(x0=x0, eval_f=fn, eval_grad_f=dfn, eval_g_eq=function(weight,r_cov) { sum(weight) - 1 }, eval_jac_g_eq=function(weight,r_cov) { rep(1,length(std)) }, lb=rep(0,length(std)),ub=rep(1,length(std)), opts = list(\u0026#34;algorithm\u0026#34;=\u0026#34;NLOPT_LD_SLSQP\u0026#34;,\u0026#34;print_level\u0026#34; = 0,\u0026#34;xtol_rel\u0026#34;=1.0e-8,\u0026#34;maxeval\u0026#34; = 1000), r_cov = r_cov) r_weight \u0026lt;- res$solution names(r_weight) \u0026lt;- colnames(r_cov) wr_dat \u0026lt;- r_dat*r_weight portfolio \u0026lt;- apply(wr_dat,1,sum) pr_dat \u0026lt;- data.frame(wr_dat,portfolio) sd \u0026lt;- sd(portfolio) result \u0026lt;- list(r_weight,pr_dat,sd) names(result) \u0026lt;- c(\u0026#34;weight\u0026#34;,\u0026#34;return\u0026#34;,\u0026#34;portfolio risk\u0026#34;) return(result) } CCC \u0026lt;- backtest(hist.returns,\u0026#34;CCC\u0026#34;,\u0026#34;2007-01-04\u0026#34;,\u0026#34;months\u0026#34;,365,\u0026#34;risk parity\u0026#34;) DCC \u0026lt;- backtest(hist.returns,\u0026#34;DCC\u0026#34;,\u0026#34;2007-01-04\u0026#34;,\u0026#34;months\u0026#34;,365,\u0026#34;risk parity\u0026#34;) DECO \u0026lt;- backtest(hist.returns,\u0026#34;DECO\u0026#34;,\u0026#34;2007-01-04\u0026#34;,\u0026#34;months\u0026#34;,365,\u0026#34;risk parity\u0026#34;) benchmark \u0026lt;- backtest(hist.returns,\u0026#34;benchmark\u0026#34;,\u0026#34;2007-01-04\u0026#34;,\u0026#34;months\u0026#34;,365,\u0026#34;risk parity\u0026#34;) result \u0026lt;- merge(CCC$return$portfolio,DCC$return$portfolio,DECO$return$portfolio,benchmark$return$portfolio) colnames(result) \u0026lt;- c(\u0026#34;CCC\u0026#34;,\u0026#34;DCC\u0026#34;,\u0026#34;DECO\u0026#34;,\u0026#34;benchmark\u0026#34;) çµæœã¯ã“ã‚“ãªæ„Ÿã˜ã€‚\nPerformanceAnalytics::charts.PerformanceSummary(result, main = \u0026#34;BACKTEST COMPARISON\u0026#34;) library(plotly) # plot allocation weighting riskparity_weight \u0026lt;- rbind(data.frame(CCC$weight,method=\u0026#34;CCC\u0026#34;,Date=index(CCC$weight)),data.frame(DCC$weight,method=\u0026#34;DCC\u0026#34;,Date=index(DCC$weight)),data.frame(DECO$weight,method=\u0026#34;DECO\u0026#34;,Date=index(DECO$weight)),data.frame(benchmark$weight,method=\u0026#34;benchmark\u0026#34;,Date=index(benchmark$weight))) PerformanceAnalytics::charts.PerformanceSummary(result, main = \u0026#34;BACKTEST COMPARISON\u0026#34;) riskparity_weight \u0026lt;- rbind(data.frame(CCC$weight,method=\u0026#34;CCC\u0026#34;,Date=index(CCC$weight)),data.frame(DCC$weight,method=\u0026#34;DCC\u0026#34;,Date=index(DCC$weight)),data.frame(DECO$weight,method=\u0026#34;DECO\u0026#34;,Date=index(DECO$weight)),data.frame(benchmark$weight,method=\u0026#34;benchmark\u0026#34;,Date=index(benchmark$weight))) # plot allocation weighting d_allocation(riskparity_weight, \u0026#34;Risk Parity Asset Allocation\u0026#34;) ã©ã®æ‰‹æ³•ã‚‚benchmarkã‚’ã‚¢ã‚¦ãƒˆãƒ‘ãƒ¼ãƒ•ã‚©ãƒ¼ãƒ ã§ãã¦ã„ã‚‹ã¨ã„ã†å¥½ã¾ã—ã„çµæœã«ãªã‚Šã¾ã—ãŸã€‚ ã‚„ã¯ã‚Šã€åˆ†æ•£å…±åˆ†æ•£è¡Œåˆ—ã®æ¨è¨ˆãŒã†ã¾ãã„ã£ã¦ã„ã‚‹ã‚ˆã†ã§ã™ã€‚ã¾ãŸã€DECOã®ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãŒã‚ˆã„ã®ã¯ã€ç›¸é–¢è¡Œåˆ—ã«å„è³‡ç”£ãƒšã‚¢ã®ç›¸é–¢ä¿‚æ•°ã®å¹³å‡å€¤ã‚’ç”¨ã„ã¦ã„ã‚‹ãŸã‚ã€ä»–ã®æ‰‹æ³•ã‚ˆã‚Šã‚‚ãƒªã‚¹ã‚¯è³‡ç”£ã®çµ„ã¿å…¥ã‚ŒãŒå¤šããªã£ãŸã‹ã‚‰ã ã¨æ€ã‚ã‚Œã¾ã™ã€‚ã‚¦ã‚§ã‚¤ãƒˆã¯ä»¥ä¸‹ã®é€šã‚Šã§ã™ã€‚\nã¨ã‚Šã‚ãˆãšã€ä»Šæ—¥ã¯ã“ã“ã¾ã§ã€‚\n","date":1550361600,"expirydate":-62135596800,"kind":"page","lang":"ja","lastmod":1551571200,"objectID":"0c6f6cbe96ac9b1239a629e09477d6d1","permalink":"/post/post2/","publishdate":"2019-02-17T00:00:00Z","relpermalink":"/post/post2/","section":"post","summary":"ç¤¾å†…ãƒ¯ãƒ¼ã‚¯ã‚·ãƒ§ãƒƒãƒ—ãŒã‚ã‚Šã€ä¼‘æ—¥ã¯å›½ä¼šå›³æ›¸é¤¨ã«ç± ã‚Šã€å…ˆè¡Œç ”ç©¶ã‚’æ¼ã£ãŸçµæœã€å¾®å¦™ãªã‚¢ã‚»ãƒƒãƒˆã‚¢ãƒ­ã‚±ãƒ¼ã‚·ãƒ§ãƒ³ãƒ¢ãƒ‡ãƒ«ã‚’æ§‹ç¯‰ã§ãã¾ã—ãŸã€‚","tags":["R"],"title":"Asset Allocation Modelã‚’Rã§çµ„ã‚“ã§ã¿ãŸã€‚","type":"post"},{"authors":null,"categories":["ãƒã‚¯ãƒ­çµŒæ¸ˆå­¦"],"content":"ãŠã¯ã“ã‚“ã°ã‚“ã«ã¡ã¯ã€‚ã‹ãªã‚Šä¹…ã—ã¶ã‚Šã®æŠ•ç¨¿ã¨ãªã£ã¦ã—ã¾ã„ã¾ã—ãŸã€‚æ±ºã—ã¦ç ”ç©¶ã‚’ã•ã¼ã£ã¦ã„ãŸã®ã§ã¯ãªãã€BVARã®ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã«æ‰‹ã“ãšã£ã¦ã„ã¾ã—ãŸã€‚ã‚ã¨å°‘ã—ã§å®Œæˆã—ã¾ã™ã€‚ã•ã¦ã€ä»Šå›ã¯BVARã‚„ã“ã®å‰ã®Giannnone et a (2008)ã®ã‚ˆã†ãªåˆ†æã§ã‚‚å¤§æ´»èºã®ã‚«ãƒ«ãƒãƒ³ãƒ•ã‚£ãƒ«ã‚¿ã‚’å®Ÿè£…ã—ã¦ã—ã¾ã„ãŸã„ã¨æ€ã„ã¾ã™ã€‚ã“ã®ãƒ–ãƒ­ã‚°ã§ã¯ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚½ãƒ•ãƒˆã«é ¼ã‚‰ãšã€åŸºæœ¬çš„ã«è‡ªåˆ†ã§ä¸€ã‹ã‚‰å®Ÿè£…ã‚’è¡Œã„ã€ç ”ç©¶ã™ã‚‹ã“ã¨ã‚’ãƒãƒªã‚·ãƒ¼ã¨ã—ã¦ã„ã¾ã™ã®ã§ã€ã“ã‚Œã‹ã‚‰é »ç¹ã«ä½¿ç”¨ã™ã‚‹ã§ã‚ã‚ã†ã‚«ãƒ«ãƒãƒ³ãƒ•ã‚£ãƒ«ã‚¿ã‚’é–¢æ•°ã¨ã—ã¦å®Ÿè£…ã—ã¦ã—ã¾ã†ã“ã¨ã¯éå¸¸ã«æœ‰ç›Šã§ã‚ã‚‹ã¨è€ƒãˆã¾ã™ã€‚ä»Šå›ã¯Rã§å®Ÿè£…ã‚’ã—ã¾ã—ãŸã®ã§ã€ãã®ã”å ±å‘Šã‚’ã—ã¾ã™ã€‚\n1. ã‚«ãƒ«ãƒãƒ³ãƒ•ã‚£ãƒ«ã‚¿ã¨ã¯ï¼Ÿ ã¾ãšã€ã‚«ãƒ«ãƒãƒ³ãƒ•ã‚£ãƒ«ã‚¿ã«é–¢ã™ã‚‹ç°¡å˜ãªèª¬æ˜ã‚’è¡Œã„ã¾ã™ã€‚éå¸¸ã«ã‚ã‹ã‚Šã‚„ã™ã„è¨˜äº‹ãŒã‚ã‚‹ã®ã§ã€ã“ã¡ã‚‰ã‚’èª­ã‚“ã§ã„ãŸã ã„ãŸã»ã†ãŒã‚ˆã‚Šåˆ†ã‹ã‚Šã‚„ã™ã„ã‹ã¨æ€ã„ã¾ã™ã€‚\nã‚«ãƒ«ãƒãƒ³ãƒ•ã‚£ãƒ«ã‚¿ã¨ã¯ã€çŠ¶æ…‹ç©ºé–“ãƒ¢ãƒ‡ãƒ«ã‚’è§£ãã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã®ä¸€ç¨®ã§ã™ã€‚çŠ¶æ…‹ç©ºé–“ãƒ¢ãƒ‡ãƒ«ã¨ã¯ã€æ‰‹å…ƒã®è¦³æ¸¬å¯èƒ½ãªå¤‰æ•°ã‹ã‚‰è¦³æ¸¬ã§ããªã„å¤‰æ•°ã‚’æ¨å®šã™ã‚‹ãƒ¢ãƒ‡ãƒ«ã§ã‚ã‚Šã€ä»¥ä¸‹ã®ã‚ˆã†ãªå½¢ã‚’ã—ã¦ã„ã¾ã™ã€‚\n$$ Y_{t} = Z_{t}\\alpha_{t} + d_{t} + S_{t}\\epsilon_{t} \\\n\\alpha_{t} = T_{t}\\alpha_{t-1} + c_{t} + R_{t}\\eta_{t} $$\n\rã“ã“ã§ã€$Y_{t}$ã¯$gÃ—1$ãƒ™ã‚¯ãƒˆãƒ«ã®è¦³æ¸¬å¯èƒ½ãªå¤‰æ•°(è¦³æ¸¬å¤‰æ•°)ã€$Z_{t}$ã¯$gÃ—k$ä¿‚æ•°è¡Œåˆ—ã€$\\alpha_{t}$ã¯$kÃ—1$ãƒ™ã‚¯ãƒˆãƒ«ã®è¦³æ¸¬ä¸å¯èƒ½ãªå¤‰æ•°(çŠ¶æ…‹å¤‰æ•°)ã€$T_{t}$ã¯$kÃ—k$ä¿‚æ•°è¡Œåˆ—ã§ã™ã€‚ã¾ãŸã€$\\epsilon_{t}$ã¯è¦³æ¸¬å¤‰æ•°ã®èª¤å·®é …ã€$\\eta_{t}$ã¯çŠ¶æ…‹å¤‰æ•°ã®èª¤å·®é …ã§ã™ã€‚ã“ã‚Œã‚‰ã®èª¤å·®é …ã¯ãã‚Œãã‚Œ$N(0,H_{t})$, `\\(N(0,Q_{t})\\)`ã«å¾“ã„ã¾ã™ï¼ˆ$H_{t},Q_{t}$ã¯åˆ†æ•£å…±åˆ†æ•£è¡Œåˆ—ï¼‰ã€‚$d_{t}$, `\\(c_{t}\\)`ã¯å®šæ•°é …ã§ã™ã€‚1æœ¬ç›®ã®å¼ã¯è¦³æ¸¬æ–¹ç¨‹å¼ã€2æœ¬ç›®ã®å¼ã¯é·ç§»æ–¹ç¨‹å¼ã¨å‘¼ã°ã‚Œã¾ã™ã€‚\rçŠ¶æ…‹ç©ºé–“ãƒ¢ãƒ‡ãƒ«ã‚’ä½¿ç”¨ã™ã‚‹ä¾‹ã¨ã—ã¦ã€ã—ã°ã—ã°æ± ã®é­šã®æ•°ã‚’æ¨å®šã™ã‚‹å•é¡ŒãŒä½¿ç”¨ã•ã‚Œã¾ã™ã€‚ä»Šã€æ± ã®ä¸­ã®é­šã®å…¨æ•°ãŒçŸ¥ã‚ŠãŸã„ã¨ã—ã¦ã€ãã®æ¨å®šã‚’è€ƒãˆã¾ã™ã€‚è¦³æ¸¬æ™‚ç‚¹æ¯ã«æ± ã®ä¸­ã®é­šã‚’ã™ã¹ã¦æ•ã¾ãˆã¦ãã®æ•°ã‚’èª¿ã¹ã‚‹ã®ã¯ç¾å®Ÿçš„ã«å›°é›£ãªã®ã§ã€ä¸€å®šæœŸé–“é‡£ã‚Šã‚’ã—ã¦é‡£ã‚ŒãŸé­šã‚’ã‚µãƒ³ãƒ—ãƒ«ã«å…¨æ•°ã‚’æ¨å®šã™ã‚‹ã“ã¨ã‚’è€ƒãˆã¾ã™ã€‚ã“ã“ã§ã€é‡£ã‚ŒãŸé­šã¯è¦³æ¸¬å¤‰æ•°ã€æ± ã«ã„ã‚‹é­šã®å…¨æ•°ã¯çŠ¶æ…‹å¤‰æ•°ã¨è€ƒãˆã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚ä»Šã€çµŒé¨“çš„ã«é‡£ã‚ŒãŸé­šã®æ•°ã¨å…¨æ•°ã®é–“ã«ä»¥ä¸‹ã®ã‚ˆã†ãªé–¢ä¿‚ãŒã‚ã‚‹ã¨ã—ã¾ã™ã€‚\r\r$$ Y_{t} = 0.01\\alpha_{t} + 5 + \\epsilon_{t} $$ ã“ã‚ŒãŒè¦³æ¸¬æ–¹ç¨‹å¼ã«ãªã‚Šã¾ã™ã€‚ã¾ãŸã€é­šã®å…¨æ•°ã¯éå»ã®å€¤ã‹ã‚‰ãã‚Œã»ã©æ€¥é€Ÿã«ã¯å¤‰åŒ–ã—ãªã„ã¨è€ƒãˆã‚‰ã‚Œã‚‹ãŸã‚ã€ä»¥ä¸‹ã®ã‚ˆã†ãªãƒ©ãƒ³ãƒ€ãƒ ã‚¦ã‚©ãƒ¼ã‚¯ã«å¾“ã†ã¨ä»®å®šã—ã¾ã™ã€‚\n$$ \\alpha_{t} = \\alpha_{t-1} + 500 + \\eta_{t} $$ ã“ã‚ŒãŒé·ç§»æ–¹ç¨‹å¼ã«ãªã‚Šã¾ã™ã€‚ã‚ã¨ã¯ã€ã“ã‚Œã‚’ã‚«ãƒ«ãƒãƒ³ãƒ•ã‚£ãƒ«ã‚¿ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã‚’ç”¨ã„ã¦è¨ˆç®—ã™ã‚Œã°ã€è¦³æ¸¬ã§ããªã„é­šã®å…¨æ•°ã‚’æ¨å®šã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚ ã“ã®ã‚ˆã†ã«çŠ¶æ…‹ç©ºé–“ãƒ¢ãƒ‡ãƒ«ã¯éå¸¸ã«ä¾¿åˆ©ãªãƒ¢ãƒ‡ãƒ«ã§ã‚ã‚Šã€ã¾ãŸå¿œç”¨ç¯„å›²ã‚‚åºƒã„ã§ã™ã€‚ä¾‹ãˆã°ã€è²©å£²é¡ã‹ã‚‰æ½œåœ¨é¡§å®¢æ•°ã‚’æ¨å®šã—ãŸã‚Šã€ã‚¯ãƒ¬ã‚¸ãƒƒãƒˆã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚„ãƒˆãƒ¼ãƒ“ãƒ³ã®Qç­‰çµŒæ¸ˆãƒ¢ãƒ‡ãƒ«ä¸Šã®æ¦‚å¿µã¨ã—ã¦å­˜åœ¨ã™ã‚‹å¤‰æ•°ã‚’æ¨å®šã™ã‚‹ã€BVARã®ã‚ˆã†ã«VARã‚„å›å¸°å¼ã®æ™‚å¤‰ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿æ¨å®šãªã©ã«ã‚‚ä½¿ç”¨ã•ã‚Œã¾ã™ã€‚\n2. ã‚«ãƒ«ãƒãƒ³ãƒ•ã‚£ãƒ«ã‚¿ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã®å°å‡º ã•ã¦ã€éå¸¸ã«ä¾¿åˆ©ãªçŠ¶æ…‹ç©ºé–“ãƒ¢ãƒ‡ãƒ«ã®èª¬æ˜ã¯ã“ã‚Œãã‚‰ã„ã«ã—ã¦ã€ã‚«ãƒ«ãƒãƒ³ãƒ•ã‚£ãƒ«ã‚¿ã®èª¬æ˜ã«ç§»ã‚ŠãŸã„ã¨æ€ã„ã¾ã™ã€‚ã‚«ãƒ«ãƒãƒ³ãƒ•ã‚£ãƒ«ã‚¿ã¯çŠ¶æ…‹ç©ºé–“ãƒ¢ãƒ‡ãƒ«ã‚’è§£ãã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã®ä¸€ç¨®ã§ã‚ã‚‹ã¨å…ˆè¿°ã—ã¾ã—ãŸã€‚ã¤ã¾ã‚Šã€ä»–ã«ã‚‚çŠ¶æ…‹ç©ºé–“ãƒ¢ãƒ‡ãƒ«ã‚’è§£ãã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã¯å­˜åœ¨ã—ã¾ã™ã€‚ã‚«ãƒ«ãƒãƒ³ãƒ•ã‚£ãƒ«ã‚¿ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã¯ä¸€èˆ¬ã«èª¤å·®é …ã®æ­£è¦æ€§ã®ä»®å®šã‚’å¿…è¦ã¨ã—ãªã„ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã§ã‚ã‚Šã€è¦³æ¸¬æ–¹ç¨‹å¼ã¨é·ç§»æ–¹ç¨‹å¼ã®ç·šå½¢æ€§ã®ä»®å®šã•ãˆã‚ã‚Œã°ã€ç·šå½¢æœ€å°åˆ†æ•£æ¨å®šé‡ã¨ãªã‚Šã¾ã™ã€‚ã‚«ãƒ«ãƒãƒ³ãƒ•ã‚£ãƒ«ã‚¿ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã®å°å‡ºã«ã¯ã„ãã¤ã‹ã®æ–¹æ³•ãŒã‚ã‚Šã¾ã™ãŒã€ä»Šå›ã¯ã“ã®ç·šå½¢æœ€å°åˆ†æ•£æ¨å®šé‡ã¨ã—ã¦ã®å°å‡ºã‚’è¡Œã„ã¾ã™ã€‚ã¾ãšã€ä»¥ä¸‹ã®ï¼“ã¤ã®ä»®å®šã‚’ç½®ãã¾ã™ã€‚\n åˆæœŸå€¤$\\alpha_{0}$ã¯æ­£è¦åˆ†å¸ƒ$N(a_{0},\\Sigma_{0})$ã«å¾“ã†ç¢ºç‡ãƒ™ã‚¯ãƒˆãƒ«ã§ã‚ã‚‹($a_{t}$ã¯$\\alpha_{t}$ã®æ¨å®šå€¤)ã€‚ èª¤å·®é …$\\epsilon_{t}$,$\\eta_{s}$ã¯å…¨ã¦ã®$t$,$s$ã§äº’ã„ã«ç‹¬ç«‹ã§ã€åˆæœŸå€¤ãƒ™ã‚¯ãƒˆãƒ«$\\alpha_{0}$ã¨ç„¡ç›¸é–¢ã§ã‚ã‚‹ï¼ˆ$E(\\epsilon_{t}\\eta_{s})=0$, $(E(\\epsilon_{t}\\alpha_{0})=0)$, $(E(\\eta_{t}\\alpha_{0})=0)$ï¼‰ã€‚ 2ã‚ˆã‚Šã€$E(\\epsilon_{t}\\alpha_{t}')=0$ã€$E(\\eta_{t}\\alpha_{t-1}')=0$ã€‚  ã¾ãšã€$t-1$æœŸã®æƒ…å ±é›†åˆ$\\Omega_{t-1}$ãŒæ—¢çŸ¥ã®çŠ¶æ…‹ã§ã®$\\alpha_{t}$ã¨$Y_{t}$ã®æœŸå¾…å€¤ï¼ˆäºˆæ¸¬å€¤ï¼‰ã‚’æ±‚ã‚ã¦ã¿ã¾ã—ã‚‡ã†ã€‚ä¸Šè¿°ã—ãŸçŠ¶æ…‹ç©ºé–“ãƒ¢ãƒ‡ãƒ«ã¨èª¤å·®é …ã®æœŸå¾…å€¤ãŒã©ã¡ã‚‰ã‚‚ã‚¼ãƒ­ã§ã‚ã‚‹äº‹å®Ÿã‚’ç”¨ã„ã‚‹ã¨ã€ä»¥ä¸‹ã®ã‚ˆã†ã«è¨ˆç®—ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚\n$$ E(\\alpha_{t}|\\Omega_{t-1}) = a_{t|t-1} = T_{t}a_{t-1|t-1} + c_{t} E(Y_{t}|\\Omega_{t-1}) = Y_{t|t-1} = Z_{t}a_{t|t-1} + d_{t} $$\nã“ã“ã§ã€æ¬¡ã«ã€ã“ã‚Œã‚‰ã®åˆ†æ•£ã‚’æ±‚ã‚ã¾ã™ã€‚\n\r$$\r\\begin{eqnarray}\rE( (\\alpha_{t}-a_{t|t-1})(\\alpha_{t}-a_{t|t-1})'|\\Omega_{t-1}) \u0026=\u0026 E( (T_{t}\\alpha_{t-1} + c_{t} + R_{t}\\eta_{t}-a_{t|t-1})(T_{t}\\alpha_{t-1} + c_{t} + R_{t}\\eta_{t}-a_{t|t-1})'|\\Omega_{t-1}) \\\\ \u0026=\u0026 E(T_{t}\\alpha_{t-1}\\alpha_{t-1}'T_{t}' + R_{t}\\eta_{t}\\eta_{t}'R_{t}'|\\Omega_{t-1}) \\\\\r\u0026=\u0026 E(T_{t}\\alpha_{t-1}\\alpha_{t-1}'T_{t}'|\\Omega_{t-1}) + E(R_{t}\\eta_{t}\\eta_{t}'R_{t}'|\\Omega_{t-1}) \\\\\r\u0026=\u0026 T_{t}E(\\alpha_{t-1}\\alpha_{t-1}'|\\Omega_{t-1})T_{t}' + R_{t}E(\\eta_{t}\\eta_{t}'|\\Omega_{t-1})R_{t}' \\\\\r\u0026=\u0026 T_{t}\\Sigma_{t-1|t-1}T_{t}' + R_{t}Q_{t}R_{t}' \\\\\r\u0026=\u0026 \\Sigma_{t|t-1}\r\\end{eqnarray}\r$$\r$$ \\begin{eqnarray} E( (Y_{t}-Y_{t|t-1})(Y_{t}-Y_{t|t-1})'|\\Omega_{t-1}) \u0026amp;=\u0026amp; E( (Z_{t}\\alpha_{t} + d_{t} + S_{t}\\epsilon_{t}-Y_{t|t-1})(Z_{t}\\alpha_{t} + d_{t} + S_{t}\\epsilon_{t}-Y_{t|t-1})'|\\Omega_{t-1}) \\\n\u0026amp;=\u0026amp; E(Z_{t}\\alpha_{t}\\alpha_{t}\u0026lsquo;Z_{t}\u0026rsquo; + S_{t}\\epsilon_{t}\\epsilon_{t}\u0026lsquo;S_{t}'|\\Omega_{t-1}) \\\n\u0026amp;=\u0026amp; E(Z_{t}\\alpha_{t}\\alpha_{t}\u0026lsquo;Z_{t}'|\\Omega_{t-1}) + E(S_{t}\\epsilon_{t}\\epsilon_{t}\u0026lsquo;S_{t}'|\\Omega_{t-1}) \\\n\u0026amp;=\u0026amp; Z_{t}E(\\alpha_{t}\\alpha_{t}'|\\Omega_{t-1})Z_{t}\u0026rsquo; + S_{t}E(\\epsilon_{t}\\epsilon_{t}'|\\Omega_{t-1})S_{t}\u0026rsquo; \\\n\u0026amp;=\u0026amp; Z_{t}\\Sigma_{t|t-1}Z_{t}\u0026rsquo; + S_{t}H_{t}S_{t}' \\\n\u0026amp;=\u0026amp; F_{t|t-1} \\end{eqnarray} $$\n\rã“ã“ã§ã€$t$æœŸã®æƒ…å ±é›†åˆ$\\Omega_{t}$ãŒå¾—ã‚‰ã‚ŒãŸã¨ã—ã¾ã™ï¼ˆã¤ã¾ã‚Šã€è¦³æ¸¬å€¤$Y_{t}$ã‚’å…¥æ‰‹ï¼‰ã€‚ã‚«ãƒ«ãƒãƒ³ãƒ•ã‚£ãƒ«ã‚¿ã§ã¯ã€$t$æœŸã®æƒ…å ±ã§ã‚ã‚‹è¦³æ¸¬å€¤$Y_{t}$ã‚’ç”¨ã„ã¦$a_{t|t-1}$ã‚’ä»¥ä¸‹ã®æ–¹ç¨‹å¼ã§æ›´æ–°ã—ã¾ã™ã€‚\n$$ E(\\alpha_{t}|\\Omega_{t}) = a_{t|t} = a_{t|t-1} + k_{t}(Y_{t} - Y_{t|t-1}) $$ ã¤ã¾ã‚Šã€è¦³æ¸¬å€¤ã¨$Y_{t}$ã®æœŸå¾…å€¤ï¼ˆäºˆæ¸¬å€¤ï¼‰ã®å·®ã‚’ã‚ã‚‹ã‚¦ã‚§ã‚¤ãƒˆ$k_{t}$ï¼ˆ$kÃ—g$è¡Œåˆ—ï¼‰ã§ã‹ã‘ãŸã‚‚ã®ã§è£œæ­£ã‚’ã‹ã‘ã‚‹ã‚ã‘ã§ã™ã€‚ã‚ˆã£ã¦ã€è¦³æ¸¬å€¤ã¨äºˆæ¸¬å€¤ãŒå®Œå…¨ã«ä¸€è‡´ã—ã¦ã„ãŸå ´åˆã¯è£œæ­£ã¯è¡Œã‚ã‚Œãªã„ã“ã¨ã«ãªã‚Šã¾ã™ã€‚ã“ã“ã§é‡è¦ãªã®ã¯ã€ã‚¦ã‚¨ã‚¤ãƒˆ$k_{t}$ã‚’ã©ã®ã‚ˆã†ã«æ±ºã‚ã‚‹ã®ã‹ã§ã™ã€‚$k_{t}$ã¯æ›´æ–°å¾Œã®çŠ¶æ…‹å¤‰æ•°ã®åˆ†æ•£$E( (\\alpha_{t} - a_{t|t})(\\alpha_{t} - a_{t|t})')= \\Sigma_{t|t}$ã‚’æœ€å°åŒ–ã™ã‚‹ã‚ˆã†æ±ºå®šã—ã¾ã™ã€‚ã“ã‚ŒãŒã€ã‚«ãƒ«ãƒãƒ³ãƒ•ã‚£ãƒ«ã‚¿ãŒç·šå½¢æœ€å°åˆ†æ•£æ¨å®šé‡ã§ã‚ã‚‹æ ¹æ‹ ã§ã™ã€‚æœ€å°åŒ–ã«ã‚ãŸã£ã¦ã¯ä»¥ä¸‹ã®ãƒ™ã‚¯ãƒˆãƒ«å¾®åˆ†ãŒå¿…è¦ã«ãªã‚Šã¾ã™ã®ã§ã€ãŠã•ã‚‰ã„ã‚’ã—ã¦ãŠãã¾ã—ã‚‡ã†ã€‚ä»Šå›ä½¿ç”¨ã™ã‚‹ã®ã¯ä»¥ä¸‹ã®äº‹å®Ÿã§ã™ã€‚\n$$ \\displaystyle \\frac{\\partial a\u0026rsquo;b}{\\partial b} = \\frac{\\partial b\u0026rsquo;a}{\\partial b} = a \\\n\\displaystyle \\frac{\\partial b\u0026rsquo;Ab}{\\partial b} = 2Ab $$\nã“ã“ã§ã€$a,b$ã¯ãƒ™ã‚¯ãƒˆãƒ«ï¼ˆãã‚Œãã‚Œ$nÃ—1$ãƒ™ã‚¯ãƒˆãƒ«ã€$1Ã—n$ãƒ™ã‚¯ãƒˆãƒ«ï¼‰ã€$A$ã¯$nÃ—n$ã®å¯¾ç§°è¡Œåˆ—ã§ã™ã€‚ã¾ãšã€ï¼‘ã¤ç›®ã‹ã‚‰è¨¼æ˜ã—ã¦ã„ãã¾ã™ã€‚$\\displaystyle y = a\u0026rsquo;b = b\u0026rsquo;a = \\sum_{i=1}^{n}a_{i}b_{i}$ã¨ã—ã¾ã™ã€‚ ã“ã®ã¨ãã€$\\frac{\\partial y}{\\partial b_{i}}=a_{i}$ãªã®ã§ã€\n$$ \\displaystyle \\frac{\\partial a\u0026rsquo;b}{\\partial b} = \\frac{\\partial b\u0026rsquo;a}{\\partial b} = a $$\næ¬¡ã«ï¼’ã¤ç›®ã§ã™ã€‚$y = b\u0026rsquo;Ab = \\sum_{i=1}^{n}\\sum_{j=1}^{n}a_{ij}b_{i}b_{j}$ã¨ã—ã¾ã™ã€‚ã“ã®ã¨ãã€\n$$ \\displaystyle \\frac{\\partial y}{\\partial b_{i}} = \\sum_{j=1}^{n}a_{ij}b_{j} + \\sum_{j=1}^{n}a_{ji}b_{j} = 2\\sum_{j=1}^{n}a_{ij}b_{j} = 2a_{i}\u0026lsquo;b $$ ã‚ˆã£ã¦ã€\n$$ \\displaystyle \\frac{\\partial y}{\\partial b} = \\left( \\begin{array}{cccc} \\frac{\\partial y}{\\partial b_{1}} \\\n\\vdots \\\n\\frac{\\partial y}{\\partial b_{n}} \\\n\\end{array} \\right) = 2 \\left( \\begin{array}{cccc} \\sum_{j=1}^{n}a_{1j}b_{j} \\\n\\vdots \\\n\\sum_{j=1}^{n}a_{nj}b_{j} \\\n\\end{array} \\right) = 2 \\left( \\begin{array}{cccc} a_{1}\u0026lsquo;b \\\n\\vdots \\\na_{n}\u0026lsquo;b \\\n\\end{array} \\right) = 2Ab $$ ã•ã¦ã€æº–å‚™ãŒã§ããŸã®ã§ã€æ›´æ–°å¾Œã®çŠ¶æ…‹å¤‰æ•°ã®åˆ†æ•£$E( (\\alpha_{t} - a_{t|t})(\\alpha_{t} - a_{t|t})')$ã‚’æ±‚ã‚ã¦ã¿ã¾ã—ã‚‡ã†ã€‚\n\r$$\r\\begin{eqnarray}\rE( (\\alpha_{t} - a_{t|t})(\\alpha_{t} - a_{t|t})') \u0026=\u0026 \\Sigma_{t|t} \\\\\r\u0026=\u0026 E\\{ (\\alpha_{t} - a_{t|t-1} + k_{t}(Y_{t} - Y_{t|t-1}))(\\alpha_{t} - a_{t|t-1} + k_{t}(Y_{t} - Y_{t|t-1}))'\\} \\\\\r\u0026=\u0026 E\\{ ( (\\alpha_{t} - a_{t|t-1}) - k_{t}(Z_{t}\\alpha_{t} + d_{t} + S_{t}\\epsilon_{t} - Z_{t}a_{t|t-1} - d_{t}) )( (\\alpha_{t} - a_{t|t-1}) - k_{t}(Z_{t}\\alpha_{t} + d_{t} + S_{t}\\epsilon_{t} - Z_{t}a_{t|t-1} - d_{t}) )\\} \\\\\r\u0026=\u0026 E\\{ ( (\\alpha_{t} - a_{t|t-1}) - k_{t}(Z_{t}\\alpha_{t} + S_{t}\\epsilon_{t} - Z_{t}a_{t|t-1}) )( (\\alpha_{t} - a_{t|t-1}) - k_{t}(Z_{t}\\alpha_{t} + S_{t}\\epsilon_{t} - Z_{t}a_{t|t-1}) )'\\} \\\\\r\u0026=\u0026 E\\{ ( (I - k_{t}Z_{t})\\alpha_{t} - k_{t}S_{t}\\epsilon_{t} - (I - k_{t}Z_{t})a_{t|t-1})( (I - k_{t}Z_{t})\\alpha_{t} - k_{t}S_{t}\\epsilon_{t} - (I - k_{t}Z_{t})a_{t|t-1})' \\} \\\\\r\u0026=\u0026 E\\{( (I - k_{t}Z_{t})(\\alpha_{t}-a_{t|t-1}) - k_{t}S_{t}\\epsilon_{t})( (I - k_{t}Z_{t})(\\alpha_{t}-a_{t|t-1}) - k_{t}S_{t}\\epsilon_{t})'\\} \\\\\r\u0026=\u0026 (I - k_{t}Z_{t})\\Sigma_{t|t-1}(I - k_{t}Z_{t})' + k_{t}S_{t}H_{t}S_{t}'k_{t}' \\\\\r\u0026=\u0026 (\\Sigma_{t|t-1} - k_{t}Z_{t}\\Sigma_{t|t-1})(I - k_{t}Z_{t})' + k_{t}S_{t}H_{t}S_{t}'k_{t}' \\\\\r\u0026=\u0026 \\Sigma_{t|t-1} - \\Sigma_{t|t-1}(k_{t}Z_{t})' - k_{t}Z_{t}\\Sigma_{t|t-1} + k_{t}Z_{t}\\Sigma_{t|t-1}Z_{t}'k_{t}' + k_{t}S_{t}H_{t}S_{t}'k_{t}' \\\\\r\u0026=\u0026 \\Sigma_{t|t-1} - \\Sigma_{t|t-1}Z_{t}'k_{t}' - k_{t}Z_{t}\\Sigma_{t|t-1} + k_{t}(Z_{t}\\Sigma_{t|t-1}Z_{t}' + S_{t}H_{t}S_{t}')k_{t}' \\\\\r\\end{eqnarray}\r$$\r\rï¼‘å›ç›®ã®å¼å¤‰å½¢ã§ã€$a_{t|t}$ã«ä¸Šè¿°ã—ãŸæ›´æ–°å¼ã‚’ä»£å…¥ã—ã€ï¼’å›ç›®ã®å¼å¤‰å½¢ã§è¦³æ¸¬æ–¹ç¨‹å¼ã¨ä¸Šã§è¨ˆç®—ã—ãŸ$E(Y_{t}|\\Omega_{t-1})$ã‚’ä»£å…¥ã—ã¦ã„ã¾ã™ã€‚ã•ã¦ã€æ›´æ–°å¾Œã®çŠ¶æ…‹å¤‰æ•°ã®åˆ†æ•£$\\Sigma_{t|t}$ã‚’$k_{t}$ã®é–¢æ•°ã¨ã—ã¦æ›¸ãè¡¨ã™ã“ã¨ãŒã§ããŸã®ã§ã€ã“ã‚Œã‚’$k_{t}$ã§å¾®åˆ†ã—ã€0ã¨ç½®ãã€$\\Sigma_{t|t}$ã‚’æœ€å°åŒ–ã™ã‚‹$k_{t}$ã‚’æ±‚ã‚ã¾ã™ã€‚å…ˆè¿°ã—ãŸå…¬å¼ã§ã€$a=\\Sigma_{t|t-1}Z_{t}'$ã€$b=k_{t}'$ã€$A=(Z_{t}\\Sigma_{t|t-1}Z_{t}\u0026rsquo; + S_{t}H_{t}S_{t}')$ã¨ã™ã‚‹ã¨ï¼ˆ$A$ã¯åˆ†æ•£å…±åˆ†æ•£è¡Œåˆ—ã®å’Œãªã®ã§å¯¾ç§°è¡Œåˆ—ï¼‰ã€\n$$ \\frac{\\partial \\Sigma_{t|t}}{\\partial k_{t}'} = -2(Z_{t}\\Sigma_{t|t-1})\u0026rsquo; + 2(Z_{t}\\Sigma_{t|t-1}Z_{t}\u0026rsquo; + S_{t}H_{t}S_{t}')k_{t} = 0 $$\nã“ã“ã‹ã‚‰ã€$k_{t}$ã‚’è§£ããªãŠã™ã¨ã€\n\r$$\r\\begin{eqnarray}\rk_{t} \u0026=\u0026 \\Sigma_{t|t-1}Z_{t}'(Z_{t}\\Sigma_{t|t-1}Z_{t}' + S_{t}H_{t}S_{t}')^{-1} \\\\\r\u0026=\u0026 \\Sigma_{t|t-1}Z_{t}'F_{t|t-1}^{-1}\r\\end{eqnarray}\r$$\r\rçªç„¶ã€$F_{t|t-1}$ãŒå‡ºã¦ãã¾ã—ãŸã€‚ã“ã‚Œã¯è¦³æ¸¬å¤‰æ•°ã®äºˆæ¸¬å€¤ã®åˆ†æ•£$E((Y_{t}-Y_{t|t-1})(Y_{t}-Y_{t|t-1})'|\\Omega_{t-1})$ã§ã—ãŸã€‚ä¸€æ–¹ã€$\\Sigma_{t|t-1}Z_{t}$ã¯çŠ¶æ…‹å¤‰æ•°ã®äºˆæ¸¬å€¤ã®åˆ†æ•£ã‚’è¦³æ¸¬å¤‰æ•°ã®ã‚¹ã‚±ãƒ¼ãƒ«ã«èª¿æ•´ã—ãŸã‚‚ã®ã§ã™ï¼ˆè¦³æ¸¬ç©ºé–“ã«å†™åƒã—ãŸã‚‚ã®ï¼‰ã€‚ã¤ã¾ã‚Šã€ã‚«ãƒ«ãƒãƒ³ã‚²ã‚¤ãƒ³$k_{t}$ã¯çŠ¶æ…‹å¤‰æ•°ã¨è¦³æ¸¬å¤‰æ•°ã®äºˆæ¸¬å€¤ã®åˆ†æ•£æ¯”ã¨ãªã£ã¦ã„ã‚‹ã®ã§ã™ã€‚è¦³æ¸¬å¤‰æ•°ã«ã¯ãƒã‚¤ã‚ºãŒã‚ã‚Šã€è¦³æ¸¬æ–¹ç¨‹å¼ã¯ã„ã¤ã‚‚èª¤å·®ï¼ã§æº€ãŸã•ã‚Œã‚‹ã‚ã‘ã§ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚ã¾ãŸã€çŠ¶æ…‹æ–¹ç¨‹å¼ã«ã‚‚èª¤å·®é …ãŒå­˜åœ¨ã—ã¾ã™ã€‚çŠ¶æ…‹ã®é·ç§»ã‚‚100%ãƒ¢ãƒ‡ãƒ«é€šã‚Šã«ã¯ã„ã‹ãªã„ã¨ã„ã†ã“ã¨ã§ã™ã€‚$t$æœŸã®è¦³æ¸¬å¤‰æ•°$Y_{t}$ãŒå¾—ã‚‰ã‚ŒãŸã¨ã—ã¦ã€ãã‚Œã‚’ã©ã‚Œã»ã©ä¿¡é ¼ã—ã¦çŠ¶æ…‹å¤‰æ•°ã‚’æ›´æ–°ã™ã‚‹ã‹ã¯è¦³æ¸¬å¤‰æ•°ã®ãƒã‚¤ã‚ºãŒçŠ¶æ…‹å¤‰æ•°ã®ãƒã‚¤ã‚ºã«æ¯”ã¹ã¦ã©ã‚Œã»ã©å°ã•ã„ã‹ã«ã‚ˆã‚Šã¾ã™ã€‚ã¤ã¾ã‚Šã€ç›¸å¯¾çš„ã«è¦³æ¸¬æ–¹ç¨‹å¼ãŒé·ç§»æ–¹ç¨‹å¼ã‚ˆã‚Šã‚‚ä¿¡é ¼ã§ãã‚‹å ´åˆã«ã¯çŠ¶æ…‹å¤‰æ•°ã‚’å¤§ããæ›´æ–°ã™ã‚‹ã®ã§ã™ã€‚ã“ã®ã‚ˆã†ã«ã€ã‚«ãƒ«ãƒãƒ³ãƒ•ã‚£ãƒ«ã‚¿ã§ã¯ã€è¦³æ¸¬æ–¹ç¨‹å¼ã¨é·ç§»æ–¹ç¨‹å¼ã®ç›¸å¯¾çš„ãªä¿¡é ¼åº¦ã«ã‚ˆã£ã¦ã€æ›´æ–°ã®åº¦åˆã„ã‚’æ¯æœŸèª¿æ•´ã—ã¦ã„ã¾ã™ã€‚ãã®åº¦åˆã„ãŒåˆ†æ•£æ¯”ã§ã‚ã‚Šã€ã‚«ãƒ«ãƒãƒ³ã‚²ã‚¤ãƒ³ã ã¨ã„ã†ã‚ã‘ã§ã™ã€‚ã¡ãªã¿ã«æ¬ æå€¤ãŒç™ºç”Ÿã—ãŸå ´åˆã«ã¯ã€è¦³æ¸¬å¤‰æ•°ã®åˆ†æ•£ã‚’ç„¡é™å¤§ã«ã—ã€çŠ¶æ…‹å¤‰æ•°ã®æ›´æ–°ã‚’å…¨ãè¡Œã‚ãªã„ã¨ã„ã†å¯¾å‡¦ã‚’è¡Œã„ã¾ã™ã€‚è¦³æ¸¬å¤‰æ•°ã«ä¿¡é ¼ãŒãªã„ã®ã§å½“ãŸã‚Šå‰ã®å‡¦ç½®ã§ã™ã€‚ã“ã®å ´åˆã¯é·ç§»æ–¹ç¨‹å¼ã‚’100%ä¿¡é ¼ã—ã¾ã™ã€‚ã“ã‚ŒãŒã‚«ãƒ«ãƒãƒ³ãƒ•ã‚£ãƒ«ã‚¿ã®ã‚³ã‚¢ã®è€ƒãˆæ–¹ã«ãªã‚Šã¾ã™ã€‚ æ›´æ–°å¾Œã®åˆ†æ•£ã‚’è¨ˆç®—ã—ã¦ãŠãã¾ã™ã€‚\n\r$$\r\\begin{eqnarray}\r\\Sigma_{t|t} \u0026=\u0026 \\Sigma_{t|t-1} - \\Sigma_{t|t-1}Z_{t}'k_{t}' - k_{t}Z_{t}\\Sigma_{t|t-1} + k_{t}F_{t|t-1}k_{t}' \\\\\r\u0026=\u0026 \\Sigma_{t|t-1} - \\Sigma_{t|t-1}Z_{t}'k_{t}' - k_{t}Z_{t}\\Sigma_{t|t-1} + (\\Sigma_{t|t-1}Z_{t}'F_{t|t-1}^{-1})F_{t|t-1}k_{t}' \\\\\r\u0026=\u0026 \\Sigma_{t|t-1} - \\Sigma_{t|t-1}Z_{t}'k_{t}' - k_{t}Z_{t}\\Sigma_{t|t-1} + \\Sigma_{t|t-1}Z_{t}'k_{t}' \\\\\r\u0026=\u0026 \\Sigma_{t|t-1} - k_{t}Z_{t}\\Sigma_{t|t-1} \\\\\r\u0026=\u0026 \\Sigma_{t|t-1} - k_{t}F_{t|t-1}F_{t|t-1}^{-1}Z_{t}\\Sigma_{t|t-1} \\\\\r\u0026=\u0026 \\Sigma_{t|t-1} - k_{t}F_{t|t-1}k_{t}'\r\\end{eqnarray}\r$$\r\rã§ã¯ã€æœ€çµ‚çš„ã«å°å‡ºã•ã‚ŒãŸã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã‚’ã¾ã¨ã‚ãŸã„ã¨æ€ã„ã¾ã™ã€‚\n\r$$\r\\begin{eqnarray}\ra_{t|t-1} \u0026=\u0026 T_{t}a_{t-1|t-1} + c_{t} \\\\\r\\Sigma_{t|t-1} \u0026=\u0026 T_{t}\\Sigma_{t-1|t-1}T_{t}' + R_{t}Q_{t}R_{t}' \\\\\rY_{t|t-1} \u0026=\u0026 Z_{t}a_{t|t-1} + d_{t} \\\\\rF_{t|t-1} \u0026=\u0026 Z_{t}\\Sigma_{t|t-1}Z_{t}' + S_{t}H_{t}S_{t}' \\\\\rk_{t} \u0026=\u0026 \\Sigma_{t|t-1}Z_{t}'F_{t|t-1}^{-1} \\\\\ra_{t|t} \u0026=\u0026 a_{t|t-1} + k_{t}(Y_{t} - Y_{t|t-1}) \\\\\r\\Sigma_{t|t} \u0026=\u0026 \\Sigma_{t|t-1} - k_{t}F_{t|t-1}k_{t}'\r\\end{eqnarray}\r$$\r\råˆæœŸå€¤$a_{0},\\Sigma_{0}$ãŒæ‰€ä¸ã®å…ƒã§ã€ã¾ãšçŠ¶æ…‹å¤‰æ•°ã®äºˆæ¸¬å€¤$a_{1|0},\\Sigma_{1|0}$ã‚’è¨ˆç®—ã—ã¾ã™ã€‚ãã®çµæœã‚’ç”¨ã„ã¦ã€æ¬¡ã¯è¦³æ¸¬å¤‰æ•°ã®äºˆæ¸¬å€¤$Y_{t|t-1},F_{t|t-1}$ã‚’è¨ˆç®—ã—ã€ã‚«ãƒ«ãƒãƒ³ã‚²ã‚¤ãƒ³$k_{t}$ã‚’å¾—ã¾ã™ã€‚$t$æœŸã®è¦³æ¸¬å¯èƒ½ãªãƒ‡ãƒ¼ã‚¿ã‚’å…¥æ‰‹ã—ãŸã‚‰ã€æ›´æ–°æ–¹ç¨‹å¼ã‚’ç”¨ã„ã¦$a_{t|t},\\Sigma_{t|t}$ã‚’æ›´æ–°ã—ã¾ã™ã€‚ã“ã‚Œã‚’ã‚µãƒ³ãƒ—ãƒ«æœŸé–“ç¹°ã‚Šè¿”ã—ã¦ã„ãã“ã¨ã«ãªã‚Šã¾ã™ã€‚ã¡ãªã¿ã«ã€é·ç§»æ–¹ç¨‹å¼ã®èª¤å·®é …$\\eta_{t}$ã¨å®šæ•°é …$c_{t}$ãŒãªãã€é·ç§»æ–¹ç¨‹å¼ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãŒå˜ä½è¡Œåˆ—ã®ã‚«ãƒ«ãƒãƒ³ãƒ•ã‚£ãƒ«ã‚¿ã¯é€æ¬¡æœ€å°è‡ªä¹—æ³•ã¨ä¸€è‡´ã—ã¾ã™ã€‚ã¤ã¾ã‚Šã€æ–°ã—ã„ã‚µãƒ³ãƒ—ãƒ«ã‚’å…¥æ‰‹ã™ã‚‹ãŸã³ã«`OLS`ã‚’ã‚„ã‚Šç›´ã™æ¨è¨ˆæ–¹æ³•ã¨ã„ã†ã“ã¨ã§ã™ï¼ˆä»Šå›ã¯ãã®è¨¼æ˜ã¯å‹˜å¼ã—ã¦ãã ã•ã„ï¼‰ã€‚\r3. Rã§å®Ÿè£…ã™ã‚‹ã€‚ ä»¥ä¸‹ãŒRã§ã®å®Ÿè£…ã‚³ãƒ¼ãƒ‰ã§ã™ã€‚\nkalmanfiter \u0026lt;- function(y,I,t,z,c=0,R=NA,Q=NA,d=0,S=NA,h=NA,a_int=NA,sig_int=NA){ #------------------------------------------------------------------- # Implemention of Kalman filter # y - observed variable # I - the number of unobserved variable # t - parameter of endogenous variable in state equation # z - parameter of endogenous variable in observable equation # c - constant in state equaion # R - parameter of exogenous variable in state equation # Q - var-cov matrix of exogenous variable in state equation # d - constant in observable equaion # S - parameter of exogenous variable in observable equation # h - var-cov matrix of exogenous variable in observable equation # a_int - initial value of endogenous variable # sig_int - initial value of variance of endogenous variable #------------------------------------------------------------------- library(MASS) # 1.Define Variable if (class(y)!=\u0026#34;matrix\u0026#34;){ y \u0026lt;- as.matrix(y) } N \u0026lt;- NROW(y) # sample size L \u0026lt;- NCOL(y) # the number of observable variable  a_pre \u0026lt;- array(0,dim = c(I,1,N)) # prediction of unobserved variable a_fil \u0026lt;- array(0,dim = c(I,1,N+1)) # filtered of unobserved variable sig_pre \u0026lt;- array(0,dim = c(I,I,N)) # prediction of var-cov mat. of unobserved variable sig_fil \u0026lt;- array(0,dim = c(I,I,N+1)) # filtered of var-cov mat. of unobserved variable y_pre \u0026lt;- array(0,dim = c(L,1,N)) # prediction of observed variable F_pre \u0026lt;- array(0,dim = c(L,L,N)) # prediction of var-cov mat. of observable variable  F_inv \u0026lt;- array(0,dim = c(L,L,N)) # inverse of F_pre k \u0026lt;- array(0,dim = c(I,L,N)) # kalman gain if (any(is.na(a_int))==TRUE){ a_int \u0026lt;- matrix(0,nrow = I,ncol = 1) } if (any(is.na(sig_int))==TRUE){ sig_int \u0026lt;- diag(1,nrow = I,ncol = I) } if (any(is.na(R))==TRUE){ R \u0026lt;- diag(1,nrow = I,ncol = I) } if (any(is.na(Q))==TRUE){ Q \u0026lt;- diag(1,nrow = I,ncol = I) } if (any(is.na(S))==TRUE){ S \u0026lt;- matrix(1,nrow = L,ncol = L) } if (any(is.na(h))==TRUE){ H \u0026lt;- array(0,dim = c(L,L,N)) for(i in 1:N){ diag(H[,,i]) = 1 } }else if (class(h)!=\u0026#34;array\u0026#34;){ H \u0026lt;- array(h,dim = c(NROW(h),NCOL(h),N)) } # fill infinite if observed data is NA for(i in 1:N){ miss \u0026lt;- is.na(y[i,]) diag(H[,,i])[miss] \u0026lt;- 1e+32 } y[is.na(y)] \u0026lt;- 0 # 2.Set Initial Value a_fil[,,1] \u0026lt;- a_int sig_fil[,,1] \u0026lt;- sig_int # 3.Implement Kalman filter for (i in 1:N){ if(class(z)==\u0026#34;array\u0026#34;){ Z \u0026lt;- z[,,i] }else{ Z \u0026lt;- z } a_pre[,,i] \u0026lt;- t%*%a_fil[,,i] + c sig_pre[,,i] \u0026lt;- t%*%sig_fil[,,i]%*%t(t) + R%*%Q%*%t(R) y_pre[,,i] \u0026lt;- Z%*%a_pre[,,i] + d F_pre[,,i] \u0026lt;- Z%*%sig_pre[,,i]%*%t(Z) + S%*%H[,,i]%*%t(S) k[,,i] \u0026lt;- sig_pre[,,i]%*%t(Z)%*%ginv(F_pre[,,i]) a_fil[,,i+1] \u0026lt;- a_pre[,,i] + k[,,i]%*%(y[i,]-y_pre[,,i]) sig_fil[,,i+1] \u0026lt;- sig_pre[,,i] - k[,,i]%*%F_pre[,,i]%*%t(k[,,i]) } # 4.Aggregate results result \u0026lt;- list(a_pre,a_fil,sig_pre,sig_fil,y_pre,k,t,z) names(result) \u0026lt;- c(\u0026#34;state prediction\u0026#34;, \u0026#34;state filtered\u0026#34;, \u0026#34;state var prediction\u0026#34;, \u0026#34;state var filtered\u0026#34;, \u0026#34;observable prediction\u0026#34;, \u0026#34;kalman gain\u0026#34;, \u0026#34;parameter of state eq\u0026#34;, \u0026#34;parameter of observable eq\u0026#34;) return(result) } æ¡ˆå¤–ç°¡å˜ã«æ›¸ã‘ã‚‹ã‚‚ã‚“ã§ã™ã­ã€‚ã“ã‚Œã‚’ä½¿ã£ã¦ã€Giannone et al (2008)ã‚’ã‚„ã‚Šç›´ã—ã¦ã¿ã¾ã™ã€‚ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã¯å‰å›è¨˜äº‹ã¨å¤‰ã‚ã‚Šã¾ã›ã‚“ã€‚\nä»¥ä¸‹ã€åˆ†æç”¨ã®Rã‚³ãƒ¼ãƒ‰ã§ã™ã€‚\n#------------------------ # Giannone et. al. 2008  #------------------------ library(MASS) library(xts) # ãƒ•ã‚¡ã‚¯ã‚¿ãƒ¼ã‚’è¨ˆç®— f \u0026lt;- 3 z \u0026lt;- scale(dataset1) for (i in 1:nrow(z)){ eval(parse(text = paste(\u0026#34;S_i \u0026lt;- z[i,]%*%t(z[i,])\u0026#34;,sep = \u0026#34;\u0026#34;))) if (i==1){ S \u0026lt;- S_i }else{ S \u0026lt;- S + S_i } } S \u0026lt;- (1/nrow(z))*S gamma \u0026lt;- eigen(S) D \u0026lt;- diag(gamma$values[1:f]) V \u0026lt;- gamma$vectors[,1:f] F_t \u0026lt;- matrix(0,nrow(z),f) for (i in 1:nrow(z)){ eval(parse(text = paste(\u0026#34;F_t[\u0026#34;,i,\u0026#34;,]\u0026lt;- z[\u0026#34;,i,\u0026#34;,]%*%V\u0026#34;,sep = \u0026#34;\u0026#34;))) } lambda_hat \u0026lt;- V psi \u0026lt;- diag(diag(S-V%*%D%*%t(V))) R \u0026lt;- diag(diag(cov(z-z%*%V%*%t(V)))) a \u0026lt;- matrix(0,f,f) b \u0026lt;- matrix(0,f,f) for(t in 2:nrow(z)){ a \u0026lt;- a + F_t[t,]%*%t(F_t[t-1,]) b \u0026lt;- b + F_t[t-1,]%*%t(F_t[t-1,]) } b_inv \u0026lt;- solve(b) A_hat \u0026lt;- a%*%b_inv e \u0026lt;- numeric(f) for (t in 2:nrow(F_t)){ e \u0026lt;- e + F_t[t,]-F_t[t-1,]%*%A_hat } H \u0026lt;- t(e)%*%e Q \u0026lt;- diag(1,f,f) Q[1:f,1:f] \u0026lt;- H p \u0026lt;- ginv(diag(nrow(kronecker(A_hat,A_hat)))-kronecker(A_hat,A_hat)) result1 \u0026lt;- kalmanfiter(z,f,A_hat,lambda_hat,c=0,R=NA,Q=Q,d=0,S=NA,h=R,a_int=F_t[1,],sig_int=matrix(p,f,f)) ãƒ—ãƒ­ãƒƒãƒˆã—ã¦ã¿ã¾ã™ã€‚\nlibrary(ggplot2) library(tidyverse) ggplot(gather(data.frame(factor1=result1$`state filtered`[1,1,-dim(result1$`state filtered`)[3]],factor2=result1$`state filtered`[2,1,-dim(result1$`state filtered`)[3]],factor3=result1$`state filtered`[3,1,-dim(result1$`state filtered`)[3]],time=as.Date(rownames(dataset1))),key = factor,value = value,-time),aes(x=time,y=value,colour=factor)) + geom_line() giannoneã®è¨˜äº‹ã‚’æ›¸ã„ãŸéš›ã¯ã€å…ƒè«–æ–‡ã®MATLABã‚³ãƒ¼ãƒ‰ã‚’å‚è€ƒã«Rã§æ›¸ã„ãŸã®ã§ã™ãŒã€é€šå¸¸ã®ã‚«ãƒ«ãƒãƒ³ãƒ•ã‚£ãƒ«ã‚¿ã¨ã¯è¦³æ¸¬å¤‰æ•°ã®åˆ†æ•£å…±åˆ†æ•£è¡Œåˆ—ã®é€†æ•°ã®è¨ˆç®—æ–¹æ³•ãŒé•ã†ã‚‰ã—ãã‚°ãƒ©ãƒ•ã®å½¢ãŒç•°ãªã£ã¦ã„ã¾ã™ã€‚ã¾ã‚ã§ã‚‚ã€æ¦‚å½¢ã¯ã»ã¨ã‚“ã©åŒã˜ã§ã™ãŒï¼ˆãªã®ã§ã€ã¡ã‚ƒã‚“ã¨å‹•ã„ã¦ã„ã‚‹ã¯ãšï¼‰ã€‚\n4. ã‚«ãƒ«ãƒãƒ³ã‚¹ãƒ ãƒ¼ã‚¸ãƒ³ã‚° ã‚«ãƒ«ãƒãƒ³ãƒ•ã‚£ãƒ«ã‚¿ã®å®Ÿè£…ã¯ä»¥ä¸Šã§çµ‚äº†ãªã®ã§ã™ãŒã€èª¤å·®é …ã®æ­£è¦æ€§ã‚’ä»®å®šã™ã‚Œã°$T$æœŸã¾ã§ã®æƒ…å ±é›†åˆ$\\Omega_{T}$ã‚’ç”¨ã„ã¦ã€$a_{i|i}, \\Sigma_{i|i}(i = 1:T)$ã‚’$a_{i|T}, \\Sigma_{i|T}(i = 1:T)$ã¸æ›´æ–°ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚ã“ã‚Œã‚’ã‚«ãƒ«ãƒãƒ³ã‚¹ãƒ ãƒ¼ã‚¸ãƒ³ã‚°ã¨å‘¼ã³ã¾ã™ã€‚ã“ã‚Œã‚’å°å‡ºã—ã¦ã¿ã¾ã—ã‚‡ã†ã€‚ãã®æº–å‚™ã¨ã—ã¦ã€ä»¥ä¸‹ã®ã‚ˆã†ãª$\\alpha_{t|t}$ã¨$\\alpha_{t+1|t}$ã®æ··åˆåˆ†å¸ƒã‚’è¨ˆç®—ã—ã¦ãŠãã¾ã™ã€‚\n\r$$\r\\begin{eqnarray}\r(\\alpha_{t|t},\\alpha_{t+1|t}) \u0026=\u0026 N(\r\\left(\r\\begin{array}{cccc}\rE(\\alpha_{t|t}) \\\\\rE(\\alpha_{t+1|t})\r\\end{array}\r\\right),\r\\left(\r\\begin{array}{cccc}\rVar(\\alpha_{t|t}), Cov(\\alpha_{t|t},\\alpha_{t+1|t}) \\\\\rCov(\\alpha_{t+1|t},\\alpha_{t|t}), Var(\\alpha_{t+1|t})\r\\end{array}\r\\right)\r) \\\\\r\u0026=\u0026 N(\r\\left(\r\\begin{array}{cccc}\ra_{t|t} \\\\\ra_{t+1|t}\r\\end{array}\r\\right),\r\\left(\r\\begin{array}{cccc}\r\\Sigma_{t|t}, \\Sigma_{t|t}T_{t}' \\\\\rT_{t}\\Sigma_{t|t}, \\Sigma_{t+1|t} \\end{array}\r\\right)\r)\r\\end{eqnarray}\r$$\r\rã“ã“ã§ã€$Cov(\\alpha_{t|t},\\alpha_{t+1|t})$ã¯\n\r$$\r\\begin{eqnarray}\rCov(\\alpha_{t+1|t},\\alpha_{t|t}) \u0026=\u0026 Cov(T_{t}\\alpha_{t-1} + c_{t} + R_{t}\\eta_{t}, \\alpha_{t|t}) \\\\\r\u0026=\u0026 T_{t}Cov(\\alpha_{t|t},\\alpha_{t|t}) + Cov(c_{t},\\alpha_{t|t}) + Cov(R_{t}\\eta_{t},\\alpha_{t|t}) \\\\\r\u0026=\u0026 T_{t}Var(\\alpha_{t|t}) = T_{t}\\Sigma_{t|t}\r\\end{eqnarray}\r$$\r\rã“ã“ã§ã€æ¡ä»¶ä»˜ãå¤šå¤‰é‡æ­£è¦åˆ†å¸ƒã¯ä»¥ä¸‹ã®ã‚ˆã†ãªåˆ†å¸ƒã‚’ã—ã¦ã„ã‚‹ã“ã¨ã‚’æ€ã„å‡ºã—ã¾ã—ã‚‡ã†ï¼ˆ å‚è€ƒ ï¼‰ã€‚\n$$ (X_{1},X_{2}) = N( \\left( \\begin{array}{cccc} \\mu_{1} \\\n\\mu_{2} \\end{array} \\right), \\left( \\begin{array}{cccc} \\Sigma_{11}, \\Sigma_{12} \\\n\\Sigma_{21}, \\Sigma_{22} \\end{array} \\right) ) \\\n$$ $$ (X_{1}|X_{2}=x_{2}) = N(\\mu_{1} + \\Sigma_{12}\\Sigma_{22}^{-1}(x_{2}-\\mu_{2}),\\Sigma_{11}-\\Sigma_{12}\\Sigma_{22}^{-1}\\Sigma_{21}) $$\nã“ã‚Œã‚’ç”¨ã„ã¦ã€$(\\alpha_{t|t}|\\alpha_{t+1|t}=a_{t+1})$ã‚’è¨ˆç®—ã—ã¦ã¿ã¾ã—ã‚‡ã†ã€‚\n\r$$\r\\begin{eqnarray}\r(\\alpha_{t|t}|\\alpha_{t+1|t}=a_{t+1}) \u0026=\u0026 N(a_{t|t} + \\Sigma_{t|t}T_{t}'\\Sigma_{t+1|t}^{-1}(a_{t+1}-a_{t+1|t}), \\Sigma_{t|t}-\\Sigma_{t|t}T_{t}'\\Sigma_{t+1|t}^{-1}T_{t}\\Sigma_{t|t}) \\\\\r\u0026=\u0026N(a_{t|t} + L_{t}(a_{t+1}-a_{t+1|t}), \\Sigma_{t|t}-L_{t}\\Sigma_{t+1|t}L_{t}')\r\\end{eqnarray}\r$$\r\rãŸã ã—ã€$a_{t+1}$ã®å€¤ã¯è¦³æ¸¬ä¸å¯èƒ½ãªã®ã§ã€ä¸Šå¼ã‚’ç”¨ã„ã¦çŠ¶æ…‹å¤‰æ•°ã‚’æ›´æ–°ã™ã‚‹ã“ã¨ã¯ã§ãã¾ã›ã‚“ã€‚ä»Šã€ã‚ã‹ã‚‹ã®ã¯$T$æœŸã«ãŠã‘ã‚‹$a_{t+1|T}$ã®åˆ†å¸ƒã®ã¿ã§ã™ã€‚ã¨ã„ã†ã“ã¨ã§ã€$a_{t+1}$ã‚’$a_{t+1|T}$ã§ä»£ç”¨ã—ã€$\\alpha_{t|T}$ã®åˆ†å¸ƒã‚’æ±‚ã‚ã¦ã¿ã¾ã™ã€‚ã§ã¯ã€è¨ˆç®—ã—ã¦ã„ãã¾ã™ã€‚$\\alpha_{t|T} = N(E(\\alpha_{t|T}),Var(\\alpha_{t|T}))$ã§ã™ãŒã€\n\r$$\r\\begin{eqnarray}\rE(\\alpha_{t|T}) \u0026=\u0026 E_{\\alpha_{t+1|T}}(E(\\alpha_{t|t}|\\alpha_{t+1|t}=\\alpha_{t+1|T})) \\\\\rVar(\\alpha_{t|T}) \u0026=\u0026 E_{\\alpha_{t+1|T}}(Var(\\alpha_{t|t}|\\alpha_{t+1|t} = \\alpha_{t+1|T})) + Var_{\\alpha_{t+1|T}}(E(\\alpha_{t|t}|\\alpha_{t+1|t}=\\alpha_{t+1|T}))\r\\end{eqnarray}\r$$\r\rã¨ã„ã†ã‚ˆã†ã«ã€$\\alpha_{t+1|T}$ã‚‚ç¢ºç‡å¤‰æ•°ã¨ãªã‚‹ã®ã§ã€ç¹°ã‚Šè¿”ã—æœŸå¾…å€¤ã®æ³•å‰‡ã¨ç¹°ã‚Šè¿”ã—åˆ†æ•£ã®æ³•å‰‡ã‚’ä½¿ç”¨ã—ã¾ã™ï¼ˆã“ã¡ã‚‰ã‚’å‚ç…§ï¼‰ã€‚\n  ç¹°ã‚Šè¿”ã—æœŸå¾…å€¤ã®æ³•å‰‡\n$E(x) = E_{Z}(E(X|Y=Z))$\n  ç¹°ã‚Šè¿”ã—åˆ†æ•£ã®æ³•å‰‡\n$Var(X) = E_{Z}(Var(X|Y=Z))+Var_{Z}(E(X|Y=Z))$\n  ã‚ˆã£ã¦ã€\n\r$$\r\\begin{eqnarray}\rE(\\alpha_{t|T}) \u0026=\u0026 E_{\\alpha_{t+1|T}}(E(\\alpha_{t|t}|\\alpha_{t+1|t}=\\alpha_{t+1|T})) \\\\\r\u0026=\u0026 a_{t|t} + L_{t}(a_{t+1|T}-a_{t+1|t}) \\\\\rVar(\\alpha_{t|T}) \u0026=\u0026 E_{\\alpha_{t+1|T}}(Var(\\alpha_{t|t}|\\alpha_{t+1|t}=\\alpha_{t+1|T})) + Var_{\\alpha_{t+1|T}}(E(\\alpha_{t|t}|\\alpha_{t+1|t}=\\alpha_{t+1|T})) \\\\\r\u0026=\u0026 \\Sigma_{t|t} - L_{t}\\Sigma_{t+1|t}L_{t}' + E( (a_{t|t} + L_{t}(\\alpha_{t+1|T}-a_{t+1|t}) - a_{t|t} - L_{t}(a_{t+1|T}-a_{t+1|t}))(a_{t|t} + L_{t}(\\alpha_{t+1|T}-a_{t+1|t}) - a_{t|t} - L_{t}(a_{t+1|T}-a_{t+1|t}))') \\\\\r\u0026=\u0026 \\Sigma_{t|t} - L_{t}\\Sigma_{t+1|t}L_{t}' + E( (L_{t}(\\alpha_{t+1|T}-a_{t+1|t}) - L_{t}(a_{t+1|T}-a_{t+1|t}))(L_{t}(\\alpha_{t+1|T}-a_{t+1|t}) - L_{t}(a_{t+1|T}-a_{t+1|t}))') \\\\\r\u0026=\u0026 \\Sigma_{t|t} - L_{t}\\Sigma_{t+1|t}L_{t}' + E( (L_{t}\\alpha_{t+1|T} - L_{t}a_{t+1|T})(L_{t}\\alpha_{t+1|T} - L_{t}(a_{t+1|T})') \\\\\r\u0026=\u0026 \\Sigma_{t|t} - L_{t}\\Sigma_{t+1|t}L_{t}' + E( L_{t}(\\alpha_{t+1|T} - a_{t+1|T})(\\alpha_{t+1|T} - a_{t+1|T})'L_{t}') \\\\\r\u0026=\u0026 \\Sigma_{t|t} - L_{t}\\Sigma_{t+1|t}L_{t}' + L_{t}E( (\\alpha_{t+1|T} - a_{t+1|T})(\\alpha_{t+1|T} - a_{t+1|T})')L_{t}' \\\\\r\u0026=\u0026 \\Sigma_{t|t} - L_{t}\\Sigma_{t+1|t}L_{t}' + L_{t}\\Sigma_{t+1|T}L_{t}'\r\\end{eqnarray}\r$$\r\rã¨ãªã‚Šã¾ã™ã€‚ã‚«ãƒ«ãƒãƒ³ã‚¹ãƒ ãƒ¼ã‚¸ãƒ³ã‚°ã®ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã‚’ã¾ã¨ã‚ã¦ãŠãã¾ã™ã€‚\n\r$$\r\\begin{eqnarray}\rL_{t} \u0026=\u0026 \\Sigma_{t|t}T_{t}\\Sigma_{t+1|t}^{-1} \\\\\ra_{t|T} \u0026=\u0026 a_{t|t} + L_{t}(a_{t+1|T} - a_{t+1|t}) \\\\\r\\Sigma_{t|T} \u0026=\u0026 \\Sigma_{t+1|t} + L_{t}(\\Sigma_{t+1|T}-\\Sigma_{t+1|t})L_{t}'\r\\end{eqnarray}\r$$\r\rã‚«ãƒ«ãƒãƒ³ã‚¹ãƒ ãƒ¼ã‚¸ãƒ³ã‚°ã®ç‰¹å¾´çš„ãªç‚¹ã¯å¾Œã‚å‘ãã«è¨ˆç®—ã‚’ã—ã¦ã„ãç‚¹ã§ã™ã€‚ã¤ã¾ã‚Šã€$T$æœŸã‹ã‚‰1æœŸã«å‘ã‘ã¦è¨ˆç®—ã‚’è¡Œã£ã¦ã„ãã¾ã™ã€‚$L_{t}$ã«é–¢ã—ã¦ã¯ãã‚‚ãã‚‚ã‚«ãƒ«ãƒãƒ³ãƒ•ã‚£ãƒ«ã‚¿ã‚’å›ã—ãŸæ™‚ç‚¹ã§è¨ˆç®—å¯èƒ½ã§ã™ãŒã€$\\alpha_{t|T}$ã¯$T$æœŸã¾ã§ã®ãƒ‡ãƒ¼ã‚¿ãŒæ‰‹å…ƒã«ãªã„ã¨è¨ˆç®—ã§ãã¾ã›ã‚“ã€‚ä»Šã€$T$æœŸã¾ã§è¦³æ¸¬å¯èƒ½ãªãƒ‡ãƒ¼ã‚¿ãŒå…¥æ‰‹ã§ããŸã¨ã—ã¾ã—ã‚‡ã†ã€‚ã™ã‚‹ã¨ã€ï¼’ç•ªç›®ã®æ–¹ç¨‹å¼ã‚’ç”¨ã„ã¦ã€$a_{T-1|T}$ã‚’è¨ˆç®—ã—ã¾ã™ã€‚ã¡ãªã¿ã«$a_{T|T}$ã¯ã‚«ãƒ«ãƒãƒ³ãƒ•ã‚£ãƒ«ã‚¿ã‚’å›ã—ãŸæ™‚ç‚¹ã§ã™ã§ã«æ‰‹ã«å…¥ã£ã¦ã„ã‚‹ã®ã§ã€è¨ˆç®—ã™ã‚‹å¿…è¦ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚åŒæ™‚ã«ã€ï¼“ç•ªç›®ã®å¼ã‚’ç”¨ã„ã¦$\\Sigma_{T-1|T}$ã‚’è¨ˆç®—ã—ã¾ã™ã€‚ãã—ã¦ã€$a_{T-1|T},\\Sigma_{T-1|T}$ã¨$L_{T-1}$ã‚’ç”¨ã„ã¦$a_{T-2|T},\\Sigma_{T-2|T}$ã‚’è¨ˆç®—ã€ã¨ã„ã†ã‚ˆã†ã«1æœŸã«å‘ã‘ã¦å¾Œã‚å‘ãã«è¨ˆç®—ã‚’ã—ã¦ã„ãã®ã§ã™ã€‚ã•ãã»ã©ã€é·ç§»æ–¹ç¨‹å¼ã®èª¤å·®é …$\\eta_{t}$ã¨å®šæ•°é …$c_{t}$ãŒãªãã€é·ç§»æ–¹ç¨‹å¼ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãŒå˜ä½è¡Œåˆ—ã®ã‚«ãƒ«ãƒãƒ³ãƒ•ã‚£ãƒ«ã‚¿ã¯é€æ¬¡æœ€å°è‡ªä¹—æ³•ã¨ä¸€è‡´ã™ã‚‹ã¨æ›¸ãã¾ã—ãŸãŒã€ã‚«ãƒ«ãƒãƒ³ã‚¹ãƒ ãƒ¼ã‚¸ãƒ³ã‚°ã®å ´åˆã¯$T$æœŸã¾ã§ã®ã‚µãƒ³ãƒ—ãƒ«ã§OLSã‚’è¡Œã£ãŸçµæœã¨ä¸€è‡´ã—ã¾ã™ã€‚ Rã§å®Ÿè£…ã—ã¦ã¿ã¾ã™ã€‚\nkalmansmoothing \u0026lt;- function(filter){ #------------------------------------------------------------------- # Implemention of Kalman smoothing # t - parameter of endogenous variable in state equation # z - parameter of endogenous variable in observable equation # a_pre - prediction of state # a_fil - filtered value of state # sig_pre - prediction of var of state # sig_fil - filtered value of state #------------------------------------------------------------------- library(MASS) # 1.Define variable a_pre \u0026lt;- filter$`state prediction` a_fil \u0026lt;- filter$`state filtered` sig_pre \u0026lt;- filter$`state var prediction` sig_fil \u0026lt;- filter$`state var filtered` t \u0026lt;- filter$`parameter of state eq` C \u0026lt;- array(0,dim = dim(sig_pre)) a_sm \u0026lt;- array(0,dim = dim(a_pre)) sig_sm \u0026lt;- array(0,dim = dim(sig_pre)) N \u0026lt;- dim(C)[3] a_sm[,,N] \u0026lt;- a_fil[,,N] sig_sm[,,N] \u0026lt;- sig_fil[,,N] for (i in N:2){ C[,,i-1] \u0026lt;- sig_fil[,,i-1]%*%t(t)%*%ginv(sig_pre[,,i]) a_sm[,,i-1] \u0026lt;- a_fil[,,i-1] + C[,,i-1]%*%(a_sm[,,i]-a_pre[,,i]) sig_sm[,,i-1] \u0026lt;- sig_fil[,,i-1] + C[,,i-1]%*%(sig_sm[,,i]-sig_pre[,,i])%*%t(C[,,i-1]) } result \u0026lt;- list(a_sm,sig_sm,C) names(result) \u0026lt;- c(\u0026#34;state smoothed\u0026#34;, \u0026#34;state var smoothed\u0026#34;, \u0026#34;c\u0026#34;) return(result) } å…ˆã»ã©ã®ã‚³ãƒ¼ãƒ‰ã®ç¶šãã§Rã‚³ãƒ¼ãƒ‰ã‚’æ›¸ã„ã¦ã¿ã¾ã™ã€‚\nresult2 \u0026lt;- kalmansmoothing(result1) ã‹ãªã‚Šã‚·ãƒ³ãƒ—ãƒ«ã§ã™ã­ã€‚ã¡ãªã¿ã«ã‚°ãƒ©ãƒ•ã«ã—ã¾ã—ãŸãŒã€ï¼‘å€‹ç›®ã¨ã»ã¼å¤‰ã‚ã‚Šã¾ã›ã‚“ã§ã—ãŸã€‚ã¨ã‚Šã‚ãˆãšã€ä»Šæ—¥ã¯ã“ã“ã¾ã§ã€‚\n","date":1549756800,"expirydate":-62135596800,"kind":"page","lang":"ja","lastmod":1549756800,"objectID":"d084acea3d1051f530a6486b095c70b4","permalink":"/post/post3/","publishdate":"2019-02-10T00:00:00Z","relpermalink":"/post/post3/","section":"post","summary":"æ™‚ç³»åˆ—è§£æã«ã¯æ¬ ã‹ã›ãªã„ã‚«ãƒ«ãƒãƒ³ãƒ•ã‚£ãƒ«ã‚¿ã€‚Rã§ã‚‚ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ãŒç”¨æ„ã•ã‚Œã¦ã„ã¦éå¸¸ã«ä¾¿åˆ©ã§ã™ãŒã€ã“ã“ã§ã¯ã„ã£ãŸã‚“ç†è§£ã‚’å„ªå…ˆã—ã€ã‚«ãƒ«ãƒãƒ³ãƒ•ã‚£ãƒ«ã‚¿ã®å®Ÿè£…ã‚’è¡Œã£ã¦ã¿ãŸã„ã¨æ€ã„ã¾ã™ã€‚","tags":["ã‚«ãƒ«ãƒãƒ³ãƒ•ã‚£ãƒ«ã‚¿","R"],"title":"ã‚«ãƒ«ãƒãƒ³ãƒ•ã‚£ãƒ«ã‚¿ã®å®Ÿè£…","type":"post"},{"authors":[],"categories":[],"content":"Create slides in Markdown with Academic Academic | Documentation\n Features  Efficiently write slides in Markdown 3-in-1: Create, Present, and Publish your slides Supports speaker notes Mobile friendly slides   Controls  Next: Right Arrow or Space Previous: Left Arrow Start: Home Finish: End Overview: Esc Speaker notes: S Fullscreen: F Zoom: Alt + Click PDF Export: E   Code Highlighting Inline code: variable\nCode block:\nporridge = \u0026#34;blueberry\u0026#34; if porridge == \u0026#34;blueberry\u0026#34;: print(\u0026#34;Eating...\u0026#34;)  Math In-line math: $x + y = z$\nBlock math:\n$$ f\\left( x \\right) = ;\\frac{{2\\left( {x + 4} \\right)\\left( {x - 4} \\right)}}{{\\left( {x + 4} \\right)\\left( {x + 1} \\right)}} $$\n Fragments Make content appear incrementally\n{{% fragment %}} One {{% /fragment %}}\r{{% fragment %}} **Two** {{% /fragment %}}\r{{% fragment %}} Three {{% /fragment %}}\rPress Space to play!\nOne  Two  Three \n A fragment can accept two optional parameters:\n class: use a custom style (requires definition in custom CSS) weight: sets the order in which a fragment appears   Speaker Notes Add speaker notes to your presentation\n{{% speaker_note %}} - Only the speaker can read these notes - Press `S` key to view {{% /speaker_note %}} Press the S key to view the speaker notes!\n Only the speaker can read these notes Press S key to view    Themes  black: Black background, white text, blue links (default) white: White background, black text, blue links league: Gray background, white text, blue links beige: Beige background, dark text, brown links sky: Blue background, thin dark text, blue links    night: Black background, thick white text, orange links serif: Cappuccino background, gray text, brown links simple: White background, black text, blue links solarized: Cream-colored background, dark green text, blue links   Custom Slide Customize the slide style and background\n{{\u0026lt; slide background-image=\u0026#34;/media/boards.jpg\u0026#34; \u0026gt;}} {{\u0026lt; slide background-color=\u0026#34;#0000FF\u0026#34; \u0026gt;}} {{\u0026lt; slide class=\u0026#34;my-style\u0026#34; \u0026gt;}}  Custom CSS Example Let\u0026rsquo;s make headers navy colored.\nCreate assets/css/reveal_custom.css with:\n.reveal section h1, .reveal section h2, .reveal section h3 { color: navy; }  Questions? Ask\nDocumentation\n","date":1549324800,"expirydate":-62135596800,"kind":"page","lang":"ja","lastmod":1549324800,"objectID":"0e6de1a61aa83269ff13324f3167c1a9","permalink":"/slides/example/","publishdate":"2019-02-05T00:00:00Z","relpermalink":"/slides/example/","section":"slides","summary":"An introduction to using Academic's Slides feature.","tags":[],"title":"Slides","type":"slides"},{"authors":null,"categories":["ãƒã‚¯ãƒ­çµŒæ¸ˆå­¦"],"content":"ã€€ãŠã¯ã“ã‚“ã°ã‚“ã«ã¡ã¯ã€‚æ˜¨æ—¥ã€Bayesian Vector Autoregressionã®è¨˜äº‹ã‚’æ›¸ãã¾ã—ãŸã€‚\nãã®ä¸­ã§ãƒã‚¤ãƒ‘ãƒ¼ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã®ãƒãƒ¥ãƒ¼ãƒ‹ãƒ³ã‚°ã®è©±ãŒå‡ºã¦ãã¦ã€ãªã«ã‹åŠ¹ç‡çš„ã«ãƒãƒ¥ãƒ¼ãƒ‹ãƒ³ã‚°ã‚’è¡Œã†æ–¹æ³•ã¯ãªã„ã‹ã¨æ¢ã—ã¦ã„ãŸéš›ã«Bayesian Optimizationã‚’ç™ºè¦‹ã—ã¾ã—ãŸã€‚æ—¥æ¬¡GDPã§ã‚‚æ©Ÿæ¢°å­¦ç¿’ã®æ‰‹æ³•ã‚’åˆ©ç”¨ã—ã‚ˆã†ã¨æ€ã£ã¦ã„ã‚‹ã®ã§ã€Bayesian Optimizationã¯ã‹ãªã‚Šä½¿ãˆã‚‹æ‰‹æ³•ã§ã¯ãªã„ã‹ã¨æ€ã„ã€æ˜¨æ—¥å¾¹å¤œã§ç†è§£ã—ã¾ã—ãŸã€‚\nãã®å†…å®¹ã‚’ã“ã“ã§å®Ÿè£…ã—ã‚ˆã†ã¨ã¯æ€ã†ã®ã§ã™ãŒã€Bayesian Optimizationã§ã¯ã‚¬ã‚¦ã‚¹å›å¸°ï¼ˆGaussian Pocess Regression,ä»¥ä¸‹GPRï¼‰ã‚’ä½¿ç”¨ã—ã¦ãŠã‚Šã€ã¾ãšãã®å®Ÿè£…ã‚’è¡ŒãŠã†ã¨æŒã£ãŸã®ãŒã“ã®ã‚¨ãƒ³ãƒˆãƒªã‚’æ›¸ã„ãŸå‹•æ©Ÿã§ã™ã€‚Bayesian Optimizationã®å®Ÿè£…ã¯ã“ã®ã‚¨ãƒ³ãƒˆãƒªã®å¾Œã«ã§ã‚‚æ›¸ã“ã†ã‹ãªã¨æ€ã£ã¦ã„ã¾ã™ã€‚\n1. GPRã¨ã¯ ã€€GRPã¨ã¯ç°¡å˜ã«è¨€ã£ã¦ã—ã¾ãˆã°ã€Œãƒ™ã‚¤ã‚ºæ¨å®šã‚’ç”¨ã„ãŸéç·šå½¢å›å¸°æ‰‹æ³•ã®ï¼‘ç¨®ã€ã§ã™ã€‚ãƒ¢ãƒ‡ãƒ«è‡ªä½“ã¯ç·šå½¢ã§ã™ãŒã€ã‚«ãƒ¼ãƒãƒ«ãƒˆãƒªãƒƒã‚¯ã‚’ç”¨ã„ã¦å…¥åŠ›å¤‰æ•°ã‚’ç„¡é™å€‹éç·šå½¢å¤‰æ›ã—ãŸã‚‚ã®ã‚’èª¬æ˜å¤‰æ•°ã¨ã—ã¦æ¨å®šã§ãã‚‹ã¨ã“ã‚ãŒç‰¹å¾´ã§ã™ï¼ˆã‚«ãƒ¼ãƒãƒ«ã«ãªã«ã‚’é¸æŠã™ã‚‹ã‹ã«ã‚ˆã‚Šã¾ã™ï¼‰ã€‚\nGPRãŒæƒ³å®šã—ã¦ã„ã‚‹ã®ã¯ã€å­¦ç¿’ãƒ‡ãƒ¼ã‚¿ã¨ã—ã¦å…¥åŠ›ãƒ‡ãƒ¼ã‚¿ã¨æ•™å¸«ãƒ‡ãƒ¼ã‚¿ãŒãã‚Œãã‚ŒNå€‹å¾—ã‚‰ã‚Œã¦ãŠã‚Šã€ã¾ãŸå…¥åŠ›ãƒ‡ãƒ¼ã‚¿ã«é–¢ã—ã¦ã¯$N+1$å€‹ç›®ã®ãƒ‡ãƒ¼ã‚¿ã‚‚å¾—ã‚‰ã‚Œã¦ã„ã‚‹çŠ¶æ³ã§ã™ã€‚ã“ã®çŠ¶æ³ã‹ã‚‰ã€$N+1$å€‹ç›®ã®æ•™å¸«ãƒ‡ãƒ¼ã‚¿ã‚’äºˆæ¸¬ã—ã¾ã™ã€‚\næ•™å¸«ãƒ‡ãƒ¼ã‚¿ã«ã¯ãƒã‚¤ã‚ºãŒå«ã¾ã‚Œã¦ãŠã‚Šã€ä»¥ä¸‹ã®ã‚ˆã†ãªç¢ºç‡ãƒ¢ãƒ‡ãƒ«ã«å¾“ã„ã¾ã™ã€‚\n$$ t_{i} = y_{i} + \\epsilon_{i} $$\nã“ã“ã§ã€$t_{i}$ã¯$i$ç•ªç›®ã®è¦³æ¸¬å¯èƒ½ãªæ•™å¸«ãƒ‡ãƒ¼ã‚¿ï¼ˆã‚¹ã‚«ãƒ©ãƒ¼ï¼‰ã€$y_{i}$ã¯è¦³æ¸¬ã§ããªã„å‡ºåŠ›ãƒ‡ãƒ¼ã‚¿ï¼ˆã‚¹ã‚«ãƒ©ãƒ¼ï¼‰ã€$\\epsilon_{i}$ã¯æ¸¬å®šèª¤å·®ã§æ­£è¦åˆ†å¸ƒ$N(0,\\beta^{-1})$ã«å¾“ã„ã¾ã™ã€‚$y_{i}$ã¯ä»¥ä¸‹ã®ã‚ˆã†ãªç¢ºç‡ãƒ¢ãƒ‡ãƒ«ã«å¾“ã„ã¾ã™ã€‚\n$$ \\displaystyle y_{i} = \\textbf{w}^{T}\\phi(x_{i}) $$\nã“ã“ã§ã€$x_{i}$ã¯iç•ªç›®ã®å…¥åŠ›ãƒ‡ãƒ¼ã‚¿ãƒ™ã‚¯ãƒˆãƒ«ã€$\\phi(ãƒ»)$ã¯éç·šå½¢é–¢æ•°ã€$(\\textbf{w}^{T})$ã¯å„å…¥åŠ›ãƒ‡ãƒ¼ã‚¿ã«å¯¾ã™ã‚‹é‡ã¿ä¿‚æ•°ï¼ˆå›å¸°ä¿‚æ•°ï¼‰ãƒ™ã‚¯ãƒˆãƒ«ã§ã™ã€‚éç·šå½¢é–¢æ•°ã¨ã—ã¦ã¯ã€$\\phi(x_{i}) = (x_{1,i}, x_{1,i}^{2},\u0026hellip;,x_{1,i}x_{2,i},\u0026hellip;)$ã‚’æƒ³å®šã—ã¦ã„ã¾ã™ï¼ˆ$x_{1,i}$ã¯$i$ç•ªç›®ã®å…¥åŠ›ãƒ‡ãƒ¼ã‚¿$x_{i}$ã®ï¼‘ç•ªç›®ã®å¤‰æ•°ï¼‰ã€‚æ•™å¸«ãƒ‡ãƒ¼ã‚¿ã®ç¢ºç‡ãƒ¢ãƒ‡ãƒ«ã‹ã‚‰ã€$i$ç•ªç›®ã®å‡ºåŠ›ãƒ‡ãƒ¼ã‚¿$y_{i}$ãŒå¾—ã‚‰ã‚ŒãŸã†ãˆã§$t_{i}$ãŒå¾—ã‚‰ã‚Œã‚‹æ¡ä»¶ä»˜ç¢ºç‡ã¯ã€\n$$ p(t_{i}|y_{i}) = N(t_{i}|y_{i},\\beta^{-1}) $$\nã¨ãªã‚Šã¾ã™ã€‚$\\displaystyle \\textbf{t} = (t_{1},\u0026hellip;,t_{n})^{T}$ã€$\\displaystyle \\textbf{y} = (y_{1},\u0026hellip;,y_{n})^{T}$ã¨ã™ã‚‹ã¨ã€ä¸Šå¼ã‚’æ‹¡å¼µã™ã‚‹ã“ã¨ã§\n$$ \\displaystyle p(\\textbf{t}|\\textbf{y}) = N(\\textbf{t}|\\textbf{y},\\beta^{-1}\\textbf{I}_{N}) $$\nã¨æ›¸ã‘ã¾ã™ã€‚ã¾ãŸã€äº‹å‰åˆ†å¸ƒã¨ã—ã¦$\\textbf{w}$ã®æœŸå¾…å€¤ã¯0ã€åˆ†æ•£ã¯å…¨ã¦$\\alpha$ã¨ä»®å®šã—ã¾ã™ã€‚$\\displaystyle \\textbf{y}$ã¯ã‚¬ã‚¦ã‚¹éç¨‹ã«å¾“ã†ã¨ä»®å®šã—ã¾ã™ã€‚ã‚¬ã‚¦ã‚¹éç¨‹ã¨ã¯ã€$\\displaystyle \\textbf{y}$ã®åŒæ™‚åˆ†å¸ƒãŒå¤šå¤‰é‡ã‚¬ã‚¦ã‚¹åˆ†å¸ƒã«å¾“ã†ã‚‚ã®ã®ã“ã¨ã§ã™ã€‚ã‚³ãƒ¼ãƒ‰ã§æ›¸ãã¨ä»¥ä¸‹ã®ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚\n# Define Kernel function Kernel_Mat \u0026lt;- function(X,sigma,beta){ N \u0026lt;- NROW(X) K \u0026lt;- matrix(0,N,N) for (i in 1:N) { for (k in 1:N) { if(i==k) kdelta = 1 else kdelta = 0 K[i,k] \u0026lt;- K[k,i] \u0026lt;- exp(-t(X[i,]-X[k,])%*%(X[i,]-X[k,])/(2*sigma^2)) + beta^{-1}*kdelta } } return(K) } N \u0026lt;- 10 # max value of X M \u0026lt;- 1000 # sample size X \u0026lt;- matrix(seq(1,N,length=M),M,1) # create X testK \u0026lt;- Kernel_Mat(X,0.5,1e+18) # calc kernel matrix library(MASS) P \u0026lt;- 6 # num of sample path Y \u0026lt;- matrix(0,M,P) # define Y for(i in 1:P){ Y[,i] \u0026lt;- mvrnorm(n=1,rep(0,M),testK) # sample Y } # Plot matplot(x=X,y=Y,type = \u0026#34;l\u0026#34;,lwd = 2) ã€€Kernel_Matã«ã¤ã„ã¦ã¯å¾Œè¿°ã—ã¾ã™ãŒã€$\\displaystyle \\textbf{y}$ã®å„è¦ç´ $\\displaystyle y_{i} = \\textbf{w}^{T}\\phi(x_{i})$ã®é–“ã®å…±åˆ†æ•£è¡Œåˆ—$K$ã‚’å…¥åŠ›$x$ã‹ã‚‰ã‚«ãƒ¼ãƒãƒ«æ³•ã‚’ç”¨ã„ã¦è¨ˆç®—ã—ã¦ã„ã¾ã™ã€‚ãã—ã¦ã€ã“ã®$K$ã¨å¹³å‡0ã‹ã‚‰ã€å¤šå¤‰é‡æ­£è¦ä¹±æ•°ã‚’6ç³»åˆ—ç”Ÿæˆã—ã€ãã‚Œã‚’ãƒ—ãƒ­ãƒƒãƒˆã—ã¦ã„ã¾ã™ã€‚\nã€€ã“ã‚Œã‚‰ã®ç³»åˆ—ã¯å…±åˆ†æ•£è¡Œåˆ—ã‹ã‚‰è¨ˆç®—ã•ã‚Œã‚‹ã®ã§ã€å„è¦ç´ ã®å…±åˆ†æ•£ãŒæ­£ã«å¤§ãããªã‚Œã°ãªã‚‹ã»ã©åŒã˜å€¤ã‚’ã¨ã‚Šã‚„ã™ããªã‚‹ã‚ˆã†ãƒ¢ãƒ‡ãƒªãƒ³ã‚°ã•ã‚Œã¦ã„ã‚‹ã“ã¨ã«ãªã‚Šã¾ã™ã€‚ã¾ãŸã€ã‚°ãƒ©ãƒ•ã‚’è¦‹ã‚Œã°ã‚ã‹ã‚‹ã‚ˆã†ã«éå¸¸ã«ãªã‚ã‚‰ã‹ãªã‚°ãƒ©ãƒ•ãŒç”Ÿæˆã•ã‚Œã¦ãŠã‚Šã€ã‹ã¤éå¸¸ã«æŸ”è»Ÿãªé–¢æ•°ã‚’è¡¨ç¾ã§ãã¦ã„ã‚‹ã“ã¨ãŒã‚ã‹ã‚Šã¾ã™ã€‚ã‚³ãƒ¼ãƒ‰ã§ã¯è¨ˆç®—ã‚³ã‚¹ãƒˆã®é–¢ä¿‚ä¸Šã€å…¥åŠ›ã‚’0ã‹ã‚‰10ã«é™å®šã—ã¦1000å€‹ã®å…¥åŠ›ç‚¹ã‚’ã‚µãƒ³ãƒ—ãƒ«ã—ã€ä½œå›³ã‚’è¡Œã£ã¦ã„ã¾ã™ãŒã€åŸç†çš„ã«ã¯$x$ã¯å®Ÿæ•°ç©ºé–“ã§å®šç¾©ã•ã‚Œã‚‹ã‚‚ã®ã§ã‚ã‚‹ã®ã§ã€$p(\\textbf{y})$ã¯ç„¡é™æ¬¡å…ƒã®å¤šå¤‰é‡æ­£è¦åˆ†å¸ƒã«å¾“ã„ã¾ã™ã€‚ ä»¥ä¸Šã®ã‚ˆã†ã«ã€$\\displaystyle \\textbf{y}$ã¯ã‚¬ã‚¦ã‚¹éç¨‹ã«å¾“ã†ã¨ä»®å®šã™ã‚‹ã®ã§åŒæ™‚ç¢ºç‡$p(\\textbf{y})$ã¯å¹³å‡0ã€åˆ†æ•£å…±åˆ†æ•£è¡Œåˆ—ãŒ$K$ã®å¤šå¤‰é‡æ­£è¦åˆ†å¸ƒ$N(\\textbf{y}|0,K)$ã«å¾“ã„ã¾ã™ã€‚ã“ã“ã§ã€$K$ã®å„è¦ç´ $K_{i,j}$ã¯ã€\n\r$$\r\\begin{eqnarray}\rK_{i,j} \u0026=\u0026 cov[y_{i},y_{j}] = cov[\\textbf{w}\\phi(x_{i}),\\textbf{w}\\phi(x_{j})] \\\\\r\u0026=\u0026\\phi(x_{i})\\phi(x_{j})cov[\\textbf{w},\\textbf{w}]=\\phi(x_{i})\\phi(x_{j})\\alpha\r\\end{eqnarray}\r$$\r\rã§ã™ã€‚ã“ã“ã§ã€$\\phi(x_{i})\\phi(x_{j})\\alpha$ã¯$\\phi(x_{i})$ã®**æ¬¡å…ƒãŒå¤§ãããªã‚Œã°ãªã‚‹ã»ã©è¨ˆç®—é‡ãŒå¤šã**ãªã‚Šã¾ã™ï¼ˆã¤ã¾ã‚Šã€éç·šå½¢å¤‰æ›ã‚’ã‹ã‘ã‚Œã°ã‹ã‘ã‚‹ã»ã©è¨ˆç®—ãŒçµ‚ã‚ã‚‰ãªã„ï¼‰ã€‚ã—ã‹ã—ã€ã‚«ãƒ¼ãƒãƒ«é–¢æ•°$k(x,x')$ã‚’ç”¨ã„ã‚‹ã¨ã€è¨ˆç®—é‡ã¯é«˜ã€…å…¥åŠ›ãƒ‡ãƒ¼ã‚¿$x_{i},x_{j}$ã®ã‚µãƒ³ãƒ—ãƒ«ã‚µã‚¤ã‚ºã®æ¬¡å…ƒã«ãªã‚‹ã®ã§ã€è¨ˆç®—ãŒã—ã‚„ã™ããªã‚Šã¾ã™ã€‚ã‚«ãƒ¼ãƒãƒ«é–¢æ•°ã‚’ç”¨ã„ã¦$K_{i,j} = k(x_{i},x_{j})$ã¨ãªã‚Šã¾ã™ã€‚ã‚«ãƒ¼ãƒãƒ«é–¢æ•°ã¨ã—ã¦ã¯ã„ãã¤ã‹ç¨®é¡ãŒã‚ã‚Šã¾ã™ãŒã€ä»¥ä¸‹ã®ã‚¬ã‚¦ã‚¹ã‚«ãƒ¼ãƒãƒ«ãŒã‚ˆãä½¿ç”¨ã•ã‚Œã¾ã™ã€‚\n$$ k(x,x') = a \\exp(-b(x-x')^{2}) $$\n$(\\displaystyle \\textbf{y})$ã®åŒæ™‚ç¢ºç‡ãŒå®šç¾©ã§ããŸã®ã§ã€$\\displaystyle \\textbf{t}$ã®åŒæ™‚ç¢ºç‡ã‚’æ±‚ã‚ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚\n\r$$\r\\begin{eqnarray}\r\\displaystyle p(\\textbf{t}) \u0026=\u0026 \\int p(\\textbf{t}|\\textbf{y})p(\\textbf{y}) d\\textbf{y} \\\\\r\\displaystyle \u0026=\u0026 \\int N(\\textbf{t}|\\textbf{y},\\beta^{-1}\\textbf{I}_{N})N(\\textbf{y}|0,K)d\\textbf{y} \\\\\r\u0026=\u0026 N(\\textbf{y}|0,\\textbf{C}_{N})\r\\end{eqnarray}\r$$\r\rã“ã“ã§ã€$\\textbf{C}{N} = K +\\beta^{-1}\\textbf{I}{N}$ã§ã™ã€‚ãªãŠã€æœ€å¾Œã®å¼å±•é–‹ã¯æ­£è¦åˆ†å¸ƒã®å†ç”Ÿæ€§ã‚’åˆ©ç”¨ã—ã¦ã„ã¾ã™ï¼ˆè¨¼æ˜ã¯æ­£è¦åˆ†å¸ƒã®ç©ç‡æ¯é–¢æ•°ã‹ã‚‰å®¹æ˜“ã«å°ã‘ã¾ã™ï¼‰ã€‚è¦ã¯ã€ä¸¡è€…ã¯ç‹¬ç«‹ãªã®ã§å…±åˆ†æ•£ã¯2ã¤ã®åˆ†å¸ƒã®å…±åˆ†æ•£ã®å’Œã¨ãªã‚‹ã¨è¨€ã£ã¦ã„ã‚‹ã ã‘ã§ã™ã€‚å€‹äººçš„ã«ã¯ã€$p(\\textbf{y})$ãŒå…ˆã»ã©èª¬æ˜ã—ãŸã‚¬ã‚¦ã‚¹éç¨‹ã®äº‹å‰åˆ†å¸ƒã§ã‚ã‚Šã€$p(\\textbf{t}|\\textbf{y})$ãŒå°¤åº¦é–¢æ•°ã§ã€$p(\\textbf{t})$ã¯äº‹å¾Œåˆ†å¸ƒã‚’ã¨ã„ã†ã‚ˆã†ãªã‚¤ãƒ¡ãƒ¼ã‚¸ã§ã™ã€‚äº‹å‰åˆ†å¸ƒ$p(\\textbf{y})$ã¯åˆ¶ç´„ã®ç·©ã„åˆ†å¸ƒã§ãªã‚ã‚‰ã‹ã§ã‚ã‚‹ã“ã¨ã®ã¿ãŒå”¯ä¸€ã®åˆ¶ç´„ã§ã™ã€‚ $N$å€‹ã®è¦³æ¸¬å¯èƒ½ãªæ•™å¸«ãƒ‡ãƒ¼ã‚¿$\\textbf{t}$ã¨$t_{N+1}$ã®åŒæ™‚ç¢ºç‡ã¯ã€\n$$ p(\\textbf{t},t_{N+1}) = N(\\textbf{t},t_{N+1}|0,\\textbf{C}_{N+1}) $$\nã“ã“ã§ã€$\\textbf{C}_{N+1}$ã¯ã€\n\r$$\r\\textbf{C}_{N+1} = \\left(\r\\begin{array}{cccc}\r\\textbf{C}_{N} \u0026 \\textbf{k} \\\\\r\\textbf{k}^{T} \u0026 c \\\\\r\\end{array}\r\\right)\r$$\r\rã§ã™ã€‚ã“ã“ã§ã€$\\textbf{k} = (k(x_{1},x_{N+1}),\u0026hellip;,k(x_{N},x_{N+1}))$ã€$c = k(x_{N+1},x_{N+1})$ã§ã™ã€‚$\\textbf{t}$ã¨$t_{N+1}$ã®åŒæ™‚åˆ†å¸ƒã‹ã‚‰æ¡ä»¶ä»˜åˆ†å¸ƒ$p(t_{N+1}|\\textbf{t})$ã‚’æ±‚ã‚ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚\n$$ p(t_{N+1}|\\textbf{t}) = N(t_{N+1}|\\textbf{k}^{T}\\textbf{C}_{N+1}^{-1}\\textbf{t},c-\\textbf{k}^{T}\\textbf{C}_{N+1}^{-1}\\textbf{k}) $$\næ¡ä»¶ä»˜åˆ†å¸ƒã®è¨ˆç®—ã«ãŠã„ã¦ã¯ã€æ¡ä»¶ä»˜å¤šå¤‰é‡æ­£è¦åˆ†å¸ƒã®æ€§è³ªã‚’åˆ©ç”¨ã—ã¦ã„ã¾ã™ã€‚ä¸Šå¼ã‚’è¦‹ã‚Œã°ã‚ã‹ã‚‹ã‚ˆã†ã«ã€æ¡ä»¶ä»˜åˆ†å¸ƒ$p(t_{N+1}|\\textbf{t})$ã¯$N+1$å€‹ã®å…¥åŠ›ãƒ‡ãƒ¼ã‚¿ã€$N$å€‹ã®æ•™å¸«ãƒ‡ãƒ¼ã‚¿ã€ã‚«ãƒ¼ãƒãƒ«é–¢æ•°ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿$a,b$ãŒæ—¢çŸ¥ã§ã‚ã‚Œã°è¨ˆç®—å¯èƒ½ã¨ãªã£ã¦ã„ã¾ã™ã®ã§ã€ä»»æ„ã®ç‚¹ã‚’å…¥åŠ›ãƒ‡ãƒ¼ã‚¿ã¨ã—ã¦ä¸ãˆã¦ã‚„ã‚Œã°ã€å…ƒã®Data Generating Processã‚’è¿‘ä¼¼ã™ã‚‹ã“ã¨ãŒå¯èƒ½ã«ãªã‚Šã¾ã™ã€‚GPRã®è‰¯ã„ã¨ã“ã‚ã¯ä¸Šã§å®šç¾©ã—ãŸç¢ºç‡ãƒ¢ãƒ‡ãƒ«$\\displaystyle y_{i} = \\textbf{w}^{T}\\phi(x_{i})$ã‚’ç›´æ¥æ¨å®šã—ãªãã¦ã‚‚äºˆæ¸¬å€¤ãŒå¾—ã‚‰ã‚Œã‚‹ã¨ã“ã‚ã§ã™ã€‚ç¢ºç‡ãƒ¢ãƒ‡ãƒ«ã«ã¯$\\phi(x_{i})$ãŒã‚ã‚Šã€éç·šå½¢å¤‰æ›ã«ã‚ˆã‚Šå…¥åŠ›ãƒ‡ãƒ¼ã‚¿ã‚’é«˜æ¬¡å…ƒãƒ™ã‚¯ãƒˆãƒ«ã¸å¤‰æ›ã—ã¦ã„ã¾ã™ã€‚ã‚ˆã£ã¦ã€æ¬¡å…ƒãŒé«˜ããªã‚Œã°ãªã‚‹ã»ã©$\\phi(x_{i})\\phi(x_{j})\\alpha$ã®è¨ˆç®—é‡ã¯å¤§ãããªã£ã¦ã„ãã¾ã™ãŒã€GPRã§ã¯ã‚«ãƒ¼ãƒãƒ«ãƒˆãƒªãƒƒã‚¯ã‚’ç”¨ã„ã¦ã„ã‚‹ã®ã§é«˜ã€…å…¥åŠ›ãƒ‡ãƒ¼ã‚¿ãƒ™ã‚¯ãƒˆãƒ«ã®ã‚µãƒ³ãƒ—ãƒ«ã‚µã‚¤ã‚ºã®æ¬¡å…ƒã®è¨ˆç®—é‡ã§äº‹è¶³ã‚Šã‚‹ã“ã¨ã«ãªã‚Šã¾ã™ã€‚\n2. GPRã®å®Ÿè£… ã€€ã¨ã‚Šã‚ãˆãšã“ã“ã¾ã§ã‚’Rã§å®Ÿè£…ã—ã¦ã¿ã¾ã—ã‚‡ã†ã€‚PRMLã®ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ã§å®Ÿè£…ã—ã¦ã„ã‚‹ã‚‚ã®ãŒã‚ã£ãŸã®ã§ã€ãã‚Œã‚’ãƒ™ãƒ¼ã‚¹ã«ã„ã˜ã£ã¦ã¿ã¾ã—ãŸã€‚\nlibrary(ggplot2) library(grid) # 1.Gaussian Process Regression # PRML\u0026#39;s synthetic data set curve_fitting \u0026lt;- data.frame( x=c(0.000000,0.111111,0.222222,0.333333,0.444444,0.555556,0.666667,0.777778,0.888889,1.000000), t=c(0.349486,0.830839,1.007332,0.971507,0.133066,0.166823,-0.848307,-0.445686,-0.563567,0.261502)) f \u0026lt;- function(beta, sigma, xmin, xmax, input, train) { kernel \u0026lt;- function(x1, x2) exp(-(x1-x2)^2/(2*sigma^2)); # define Kernel function K \u0026lt;- outer(input, input, kernel); # calc gram matrix C_N \u0026lt;- K + diag(length(input))/beta m \u0026lt;- function(x) (outer(x, input, kernel) %*% solve(C_N) %*% train) # coditiona mean  m_sig \u0026lt;- function(x)(kernel(x,x) - diag(outer(x, input, kernel) %*% solve(C_N) %*% t(outer(x, input, kernel)))) #conditional variance x \u0026lt;- seq(xmin,xmax,length=100) output \u0026lt;- ggplot(data.frame(x1=x,m=m(x),sig1=m(x)+1.96*sqrt(m_sig(x)),sig2=m(x)-1.96*sqrt(m_sig(x)), tx=input,ty=train), aes(x=x1,y=m)) + geom_line() + geom_ribbon(aes(ymin=sig1,ymax=sig2),alpha=0.2) + geom_point(aes(x=tx,y=ty)) return(output) } grid.newpage() # make a palet pushViewport(viewport(layout=grid.layout(2, 2))) # divide the palet into 2 by 2 print(f(100,0.1,0,1,curve_fitting$x,curve_fitting$t), vp=viewport(layout.pos.row=1, layout.pos.col=1)) print(f(4,0.10,0,1,curve_fitting$x,curve_fitting$t), vp=viewport(layout.pos.row=1, layout.pos.col=2)) print(f(25,0.30,0,1,curve_fitting$x,curve_fitting$t), vp=viewport(layout.pos.row=2, layout.pos.col=1)) print(f(25,0.030,0,1,curve_fitting$x,curve_fitting$t), vp=viewport(layout.pos.row=2, layout.pos.col=2)) $(\\beta^{-1})$ã¯æ¸¬å®šèª¤å·®ã‚’è¡¨ã—ã¦ã„ã¾ã™ã€‚$\\beta$ãŒå¤§ãã„ï¼ˆã¤ã¾ã‚Šã€æ¸¬å®šèª¤å·®ãŒå°ã•ã„ï¼‰ã¨ã™ã§ã«å¾—ã‚‰ã‚Œã¦ã„ã‚‹ãƒ‡ãƒ¼ã‚¿ã¨ã®èª¤å·®ãŒå°‘ãªããªã‚‹ã‚ˆã†ã«äºˆæ¸¬å€¤ã‚’ã¯ã˜ãå‡ºã™ã®ã§ã€over fitting ã—ã‚„ã™ããªã‚Šã¾ã™ã€‚ ä¸Šå›³ã®å·¦ä¸ŠãŒãã†ãªã£ã¦ã„ã¾ã™ã€‚å·¦ä¸Šã¯$\\beta=400$ã§ã€ç¾æ™‚ç‚¹ã§å¾—ã‚‰ã‚Œã¦ã„ã‚‹ãƒ‡ãƒ¼ã‚¿ã«éåº¦ã«fitã—ã¦ã„ã‚‹ã“ã¨ãŒã‚ã‹ã‚Šã¾ã™ã€‚é€†ã«$\\beta$ãŒå°ã•ã„ã¨æ•™å¸«ãƒ‡ãƒ¼ã‚¿ã¨ã®èª¤å·®ã‚’ç„¡è¦–ã™ã‚‹ã‚ˆã†ã«äºˆæ¸¬å€¤ã‚’ã¯ã˜ãå‡ºã—ã¾ã™ãŒã€æ±åŒ–æ€§èƒ½ã¯å‘ä¸Šã™ã‚‹ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ã€‚å³ä¸Šã®å›³ãŒãã‚Œã§ã™ã€‚$\\beta=4$ã§ã€å¾—ã‚‰ã‚Œã¦ã„ã‚‹ãƒ‡ãƒ¼ã‚¿ç‚¹ã‚’å¹³å‡ã¯ã»ã¨ã‚“ã©é€šã£ã¦ã„ã¾ã›ã‚“ã€‚$b$ã¯ç¾æ™‚ç‚¹ã§å¾—ã‚‰ã‚Œã¦ã„ã‚‹ãƒ‡ãƒ¼ã‚¿ãŒå‘¨ã‚Šã«åŠã¼ã™å½±éŸ¿ã®åºƒã•ã‚’è¡¨ã—ã¦ã„ã¾ã™ã€‚$b$ãŒå°ã•ã„ã¨ã€éš£æ¥ã™ã‚‹ç‚¹ãŒäº’ã„ã«å¼·ãå½±éŸ¿ã‚’åŠã¼ã—åˆã†ãŸã‚ã€ç²¾åº¦ã¯ä¸‹ãŒã‚‹ãŒæ±åŒ–æ€§èƒ½ã¯ä¸ŠãŒã‚‹ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ã€‚é€†ã«ã€$b$ãŒå¤§ãã„ã¨ã€å€‹ã€…ã®ç‚¹ã«ã®ã¿ãƒ•ã‚£ãƒƒãƒˆã™ã‚‹ä¸è‡ªç„¶ãªçµæœã«ãªã‚Šã¾ã™ã€‚ã“ã‚Œã¯å³ä¸‹ã®å›³ã«ãªã‚Šã¾ã™ï¼ˆ$b=\\frac{1}{0.03},\\beta=25$ï¼‰ã€‚å¾¡è¦§ã®é€šã‚Šã€$\\beta$ãŒå¤§ãã„ã®ã§overfittingæ°—å‘³ã§ã‚ã‚Šã€ãªãŠã‹ã¤$b$ã‚‚å¤§ãã„ã®ã§å€‹ã€…ã®ç‚¹ã®ã¿ã«fitã—ã€ç„¡èŒ¶è‹¦èŒ¶ãªã‚°ãƒ©ãƒ•ã«ãªã£ã¦ã„ã¾ã™ã€‚å·¦ä¸‹ã®ã‚°ãƒ©ãƒ•ãŒæœ€ã‚‚ã‚ˆã•ãã†ã§ã™ã€‚$b=\\frac{1}{0.3},\\beta=2$ã¨ãªã£ã¦ã„ã¾ã™ã€‚è©¦ã—ã«ã€ã“ã®ã‚°ãƒ©ãƒ•ã®xåŒºé–“ã‚’[0,2]ã¸ä¼¸ã°ã—ã¦ã¿ã¾ã—ã‚‡ã†ã€‚ã™ã‚‹ã¨ã€ä»¥ä¸‹ã®ã‚ˆã†ãªã‚°ãƒ©ãƒ•ãŒã‹ã‘ã¾ã™ã€‚\ngrid.newpage() # make a palet pushViewport(viewport(layout=grid.layout(2, 2))) # divide the palet into 2 by 2 print(f(100,0.1,0,2,curve_fitting$x,curve_fitting$t), vp=viewport(layout.pos.row=1, layout.pos.col=1)) print(f(4,0.10,0,2,curve_fitting$x,curve_fitting$t), vp=viewport(layout.pos.row=1, layout.pos.col=2)) print(f(25,0.30,0,2,curve_fitting$x,curve_fitting$t), vp=viewport(layout.pos.row=2, layout.pos.col=1)) print(f(25,0.030,0,2,curve_fitting$x,curve_fitting$t), vp=viewport(layout.pos.row=2, layout.pos.col=2)) ã“ã‚Œã‚’è¦‹ã‚Œã°ã‚ã‹ã‚‹ã‚ˆã†ã«ã€å·¦ä¸‹ä»¥å¤–ã®ã‚°ãƒ©ãƒ•ã¯ã™ãã«95%ä¿¡é ¼åŒºé–“ã®ãƒãƒ³ãƒ‰ãŒåºƒãŒã‚Šã€ãƒ‡ãƒ¼ã‚¿ç‚¹ãŒãªã„ã¨ã“ã‚ã§ã¯ã¾ã£ãŸãä½¿ã„ç‰©ã«ãªã‚‰ãªã„ã“ã¨ãŒã‚ã‹ã‚Šã¾ã™ã€‚ä¸€æ–¹ã€å·¦ä¸‹ã®ã‚°ãƒ©ãƒ•ã¯1.3~1.4ãã‚‰ã„ã¾ã§ã¯ãã“ãã“ã®ãƒãƒ³ãƒ‰ãŒã‹ã‘ã¦ãŠã‚Šã€æˆ‘ã€…ãŒç›´æ„Ÿçš„ã«ç†è§£ã™ã‚‹é–¢æ•°ã¨ã‚‚æ•´åˆçš„ãªç‚¹ã‚’å¹³å‡å€¤ãŒé€šã£ã¦ã„ã‚‹ã‚ˆã†ã«æ€ãˆã¾ã™ã€‚ã¾ãŸã€è¦³æ¸¬å¯èƒ½ãªãƒ‡ãƒ¼ã‚¿ç‚¹ã‹ã‚‰é›¢ã‚Œã™ãã‚‹ã¨ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã«ä½•ã‚’ä¸ãˆã‚ˆã†ã¨å¹³å‡ï¼ã€åˆ†æ•£ï¼‘ã®æ­£è¦åˆ†å¸ƒã«ãªã‚‹ã“ã¨ã‚‚ã‚ã‹ã‚‹ãŒã‚ã‹ã‚Šã¾ã™ã€‚ ã•ã¦ã€ã“ã®ã‚ˆã†ã«ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã®å€¤ã«å¿œã˜ã¦ã€ã‚¢ã‚¦ãƒˆã‚µãƒ³ãƒ—ãƒ«ã®äºˆæ¸¬ç²¾åº¦ãŒç•°ãªã‚‹ã“ã¨ã‚’ç¤ºã—ãŸã‚ã‘ã§ã™ãŒã€ã“ã“ã§å•é¡Œã¨ãªã‚‹ã®ã¯ã“ã‚Œã‚‰ãƒã‚¤ãƒ‘ãƒ¼ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’ã©ã®ã‚ˆã†ã«ã—ã¦æ¨è¨ˆã™ã‚‹ã‹ã§ã™ã€‚ã“ã‚Œã¯å¯¾æ•°å°¤åº¦é–¢æ•°$\\ln p(\\textbf{t}|a,b)$ã‚’æœ€å¤§ã«ã™ã‚‹ãƒã‚¤ãƒ‘ãƒ¼ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’å‹¾é…æ³•ã«ã‚ˆã‚Šæ±‚ã‚ã¾ã™(($\\beta$ã¯å°‘ã—ã‚¿ã‚¤ãƒ—ãŒç•°ãªã‚‹ã‚ˆã†ã§ã€ç™ºå±•çš„ãªè­°è«–ã§ã¯ä»–ã®ãƒãƒ¥ãƒ¼ãƒ‹ãƒ³ã‚°æ–¹æ³•ã‚’ã¨ã‚‹æ¨¡æ§˜ã€‚ã¾ã ã€ãã®ãƒ¬ãƒ™ãƒ«ã«ã¯ã„ã‘ã¦ã„ãªã„ã®ã§ã“ã“ã§ã¯ã‚«ãƒªãƒ–ãƒ¬ãƒ¼ãƒˆã™ã‚‹ã“ã¨ã«ã—ã¾ã™ã€‚))ã€‚$p(\\textbf{t}) = N(\\textbf{y}|0,\\textbf{C}_{N})$ãªã®ã§ã€å¯¾æ•°å°¤åº¦é–¢æ•°ã¯\n\r$$\r\\displaystyle \\ln p(\\textbf{t}|a,b,\\beta) = -\\frac{1}{2}\\ln|\\textbf{C}_{N}| - \\frac{N}{2}\\ln(2\\pi) - \\frac{1}{2}\\textbf{t}^{T}\\textbf{C}_{N}^{-1}\\textbf{k}\r$$\r\rã¨ãªã‚Šã¾ã™ã€‚ã‚ã¨ã¯ã€ã“ã‚Œã‚’ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã§å¾®åˆ†ã—ã€å¾—ã‚‰ã‚ŒãŸé€£ç«‹æ–¹ç¨‹å¼ã‚’è§£ãã“ã¨ã§æœ€å°¤æ¨å®šé‡ãŒå¾—ã‚‰ã‚Œã¾ã™ã€‚ã§ã¯ã¾ãšå°é–¢æ•°ã‚’å°å‡ºã—ã¦ã¿ã¾ã™ã€‚\n$$ \\displaystyle \\frac{\\partial}{\\partial \\theta_{i}} \\ln p(\\textbf{t}|\\theta) = -\\frac{1}{2}Tr(\\textbf{C}_{N}^{-1}\\frac{\\partial \\textbf{C}_{N}}{\\partial \\theta_{i}}) + \\frac{1}{2}\\textbf{t}^{T}\\textbf{C}_{N}^{-1} \\frac{\\partial\\textbf{C}_{N}}{\\partial\\theta_{i}}\\textbf{C}_{N}^{-1}\\textbf{t} $$\nã“ã“ã§ã€$\\theta$ã¯ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã§ã€$\\theta_{i}$ã¯$i$ç•ªç›®ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’è¡¨ã—ã¦ã„ã¾ã™ã€‚ã“ã®å°é–¢æ•°ãŒç†è§£ã§ããªã„æ–¹ã¯ã“ã¡ã‚‰ã®è£œè«–ã«ã‚ã‚‹(C.21)å¼ã¨(C.22)å¼ã‚’ã”è¦§ã«ãªã‚‹ã¨è‰¯ã„ã¨æ€ã„ã¾ã™ã€‚ä»Šå›ã¯ã‚¬ã‚¦ã‚¹ã‚«ãƒ¼ãƒãƒ«ã‚’ç”¨ã„ã¦ã„ã‚‹ãŸã‚ã€\n$$ \\displaystyle \\frac{\\partial k(x,x')}{\\partial a} = \\exp(-b(x-x')^{2}) \\\n\\displaystyle \\frac{\\partial k(x,x')}{\\partial b} = -a(x-x')^{2}\\exp(-b(x-x')^{2}) $$\nã‚’ä¸Šå¼ã«ä»£å…¥ã™ã‚Œã°è‰¯ã„ã ã‘ã§ã™ã€‚ãŸã ã€ä»Šå›ã¯å‹¾é…æ³•ã«ã‚ˆã‚Šæœ€é©ãªãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’æ±‚ã‚ã¾ã™ã€‚ä»¥ä¸‹ã€å®Ÿè£…ã®ã‚³ãƒ¼ãƒ‰ã§ã™ï¼ˆã‹ãªã‚Šè¿·èµ°ã—ã¦ã„ã¾ã™ï¼‰ã€‚\ng \u0026lt;- function(xmin, xmax, input, train){ # initial value beta = 100 b = 1 a = 1 learning_rate = 0.1 itermax \u0026lt;- 1000 if (class(input) == \u0026#34;numeric\u0026#34;){ N \u0026lt;- length(input) } else { N \u0026lt;- NROW(input) } kernel \u0026lt;- function(x1, x2) a*exp(-0.5*b*(x1-x2)^2); # define kernel derivative_a \u0026lt;- function(x1,x2) exp(-0.5*b*(x1-x2)^2) derivative_b \u0026lt;- function(x1,x2) -0.5*a*(x1-x2)^2*exp(-0.5*b*(x1-x2)^2) dloglik_a \u0026lt;- function(C_N,y,x1,x2) { -sum(diag(solve(C_N)%*%outer(input, input, derivative_a)))+t(y)%*%solve(C_N)%*%outer(input, input, derivative_a)%*%solve(C_N)%*%y } dloglik_b \u0026lt;- function(C_N,y,x1,x2) { -sum(diag(solve(C_N)%*%outer(input, input, derivative_b)))+t(y)%*%solve(C_N)%*%outer(input, input, derivative_b)%*%solve(C_N)%*%y } # loglikelihood function likelihood \u0026lt;- function(b,a,x,y){ kernel \u0026lt;- function(x1, x2) a*exp(-0.5*b*(x1-x2)^2) K \u0026lt;- outer(x, x, kernel) C_N \u0026lt;- K + diag(N)/beta itermax \u0026lt;- 1000 l \u0026lt;- -1/2*log(det(C_N)) - N/2*(2*pi) - 1/2*t(y)%*%solve(C_N)%*%y return(l) } K \u0026lt;- outer(input, input, kernel) C_N \u0026lt;- K + diag(N)/beta for (i in 1:itermax){ kernel \u0026lt;- function(x1, x2) a*exp(-b*(x1-x2)^2) derivative_b \u0026lt;- function(x1,x2) -0.5*a*(x1-x2)^2*exp(-0.5*b*(x1-x2)^2) dloglik_b \u0026lt;- function(C_N,y,x1,x2) { -sum(diag(solve(C_N)%*%outer(input, input, derivative_b)))+t(y)%*%solve(C_N)%*%outer(input, input, derivative_b)%*%solve(C_N)%*%y } K \u0026lt;- outer(input, input, kernel) # calc gram matrix C_N \u0026lt;- K + diag(N)/beta l \u0026lt;- 0 if(abs(l-likelihood(b,a,input,train))\u0026lt;0.0001\u0026amp;i\u0026gt;2){ break }else{ a \u0026lt;- as.numeric(a + learning_rate*dloglik_a(C_N,train,input,input)) b \u0026lt;- as.numeric(b + learning_rate*dloglik_b(C_N,train,input,input)) } l \u0026lt;- likelihood(b,a,input,train) } K \u0026lt;- outer(input, input, kernel) C_N \u0026lt;- K + diag(length(input))/beta m \u0026lt;- function(x) (outer(x, input, kernel) %*% solve(C_N) %*% train) m_sig \u0026lt;- function(x)(kernel(x,x) - diag(outer(x, input, kernel) %*% solve(C_N) %*% t(outer(x, input, kernel)))) x \u0026lt;- seq(xmin,xmax,length=100) output \u0026lt;- ggplot(data.frame(x1=x,m=m(x),sig1=m(x)+1.96*sqrt(m_sig(x)),sig2=m(x)-1.96*sqrt(m_sig(x)), tx=input,ty=train), aes(x=x1,y=m)) + geom_line() + geom_ribbon(aes(ymin=sig1,ymax=sig2),alpha=0.2) + geom_point(aes(x=tx,y=ty)) return(output) } print(g(0,1,curve_fitting$x,curve_fitting$t), vp=viewport(layout.pos.row=1, layout.pos.col=1)) ãŸã—ã‹ã«ã€è‰¯ã•ãã†ãªæ„Ÿã˜ãŒã—ã¾ã™ï¼ˆç¬‘ï¼‰ ã¨ã‚Šã‚ãˆãšã€ä»Šæ—¥ã¯ã“ã“ã¾ã§ã€‚\n","date":1543708800,"expirydate":-62135596800,"kind":"page","lang":"ja","lastmod":1543708800,"objectID":"fe859c6266641600992fd6a0d6f11947","permalink":"/post/post1/","publishdate":"2018-12-02T00:00:00Z","relpermalink":"/post/post1/","section":"post","summary":"ä¸‡èƒ½ã™ãã¦é€†ã«é¢ç™½ããªã„ã¨è©±é¡Œã®ã‚¬ã‚¦ã‚¹å›å¸°ã‚’å®Ÿè£…ã—ã¦ã¿ã¾ã—ãŸã€‚","tags":["R"],"title":"ã‚¬ã‚¦ã‚¹å›å¸°ã®å®Ÿè£…ã‚’ã‚„ã£ã¦ã¿ãŸ","type":"post"},{"authors":null,"categories":["ãƒã‚¯ãƒ­çµŒæ¸ˆå­¦"],"content":"ãŠã¯ã“ã‚“ã°ã‚“ã«ã¡ã¯ã€‚ å‰å›ã€çµ±è¨ˆãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã‹ã‚‰APIæ¥ç¶šã§çµ±è¨ˆãƒ‡ãƒ¼ã‚¿ã‚’è½ã¨ã™ã¨ã„ã†è¨˜äº‹ã‚’æŠ•ç¨¿ã—ã¾ã—ãŸã€‚ ä»Šå›ã¯ãã®ãƒ‡ãƒ¼ã‚¿ã‚’ã€Gianonne et. al. (2008)ã®ãƒãƒ«ãƒãƒ•ã‚¡ã‚¯ã‚¿ãƒ¼ãƒ¢ãƒ‡ãƒ«ã«ã‹ã‘ã€å››åŠæœŸGDPã®äºˆæ¸¬ã‚’è¡Œã„ãŸã„ã¨æ€ã„ã¾ã™ã€‚\n1. Gianonne et. al. (2008)ç‰ˆãƒãƒ«ãƒãƒ•ã‚¡ã‚¯ã‚¿ãƒ¼ãƒ¢ãƒ‡ãƒ« å…ƒè«–æ–‡\nå‰å›ã®æŠ•ç¨¿ã§ã‚‚æ›¸ãã¾ã—ãŸãŒã€ã“ã®è«–æ–‡ã¯Giannoneã‚‰ãŒ2008å¹´ã«ãƒ‘ãƒ–ãƒªãƒƒã‚·ãƒ¥ã—ãŸè«–æ–‡ã§ã™(JME)ã€‚å½¼ã‚‰ã¯ã‚¢ãƒ¡ãƒªã‚«ã®çµŒæ¸ˆæŒ‡æ¨™ã‚’ç”¨ã„ã¦å››åŠæœŸGDPã‚’æ—¥æ¬¡ã§æ¨è¨ˆã—ã€äºˆæ¸¬æŒ‡æ¨™ã¨ã—ã¦ã®æœ‰ç”¨æ€§ã‚’ç¤ºã—ã¾ã—ãŸã€‚æŒ‡æ¨™é–“ã®é€£å‹•æ€§(colinearity)ã‚’åˆ©ç”¨ã—ã¦ã€å¤šæ•°ã‚ã‚‹çµŒæ¸ˆæŒ‡æ¨™ã‚’2ã¤ã®ãƒ•ã‚¡ã‚¯ã‚¿ãƒ¼ã«åœ§ç¸®ã—ã€ãã®ãƒ•ã‚¡ã‚¯ã‚¿ãƒ¼ã‚’å››åŠæœŸGDPã«ãƒ•ã‚£ãƒƒãƒ†ã‚£ãƒ³ã‚°ã•ã›ã‚‹ã“ã¨ã«ã‚ˆã£ã¦é«˜ã„äºˆæ¸¬æ€§ã‚’å®Ÿç¾ã—ã¦ã„ã¾ã™ã€‚ ã¾ãšã€ã“ã®ãƒ¢ãƒ‡ãƒ«ã«ã¤ã„ã¦ã”ç´¹ä»‹ã—ã¾ã™ã€‚ã“ã®ãƒ¢ãƒ‡ãƒ«ã§ã¯2æ®µéšæ¨è¨ˆã‚’è¡Œã„ã¾ã™ã€‚ã¾ãšä¸»æˆåˆ†åˆ†æã«ã‚ˆã‚ŠçµŒæ¸ˆçµ±è¨ˆã‚’çµ±è¨ˆé–“ã®ç›¸é–¢ãŒ0ã¨ãªã‚‹ãƒ•ã‚¡ã‚¯ã‚¿ãƒ¼ã¸å¤‰æ›ã—ã¾ã™ï¼ˆå‚è€ƒï¼‰ã€‚ãã—ã¦ã€ãã®å¾Œã®çŠ¶æ…‹ç©ºé–“ãƒ¢ãƒ‡ãƒ«ã§ã®æ¨è¨ˆã§å¿…è¦ã«ãªã‚‹ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’OLSæ¨è¨ˆã—ã€ãã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’ä½¿ç”¨ã—ã¦ã‚«ãƒ«ãƒãƒ³ãƒ•ã‚£ãƒ«ã‚¿ï¼†ã‚«ãƒ«ãƒãƒ³ã‚¹ãƒ ãƒ¼ã‚¶ãƒ¼ã‚’å›ã—ã€ãƒ•ã‚¡ã‚¯ã‚¿ãƒ¼ã‚’æ¨è¨ˆã—ã¦ã„ã¾ã™ã€‚ã§ã¯ã€å…·ä½“çš„ãªèª¬æ˜ã«ç§»ã‚Šã¾ã™ã€‚ çµ±è¨ˆãƒ‡ãƒ¼ã‚¿ã‚’$x_{i,t|v_j}$ã¨å®šç¾©ã—ã¾ã™ã€‚ã“ã“ã§ã€$i=1,\u0026hellip;,n$ã¯çµŒæ¸ˆçµ±è¨ˆã‚’è¡¨ã—ï¼ˆã¤ã¾ã‚Š$n$ãŒå…¨çµ±è¨ˆæ•°ï¼‰ã€$t=1,\u0026hellip;,T_{iv_j}$ã¯çµ±è¨ˆ$i$ã®ã‚µãƒ³ãƒ—ãƒ«æœŸé–“ã®æ™‚ç‚¹ã‚’è¡¨ã—ã¦ã„ã¾ã™ï¼ˆã¤ã¾ã‚Šã€$T_{iv_j}$ã¯çµ±è¨ˆ$i$ã®ãã®æ™‚ç‚¹ã§ã®æœ€æ–°ãƒ‡ãƒ¼ã‚¿æ—¥ä»˜ã‚’è¡¨ã™ï¼‰ã€‚ã¾ãŸã€$v_j$ã¯ã‚ã‚‹æ™‚ç‚¹$j$ï¼ˆ2005å¹´ãªã©ï¼‰ã§å¾—ã‚‰ã‚Œã‚‹æƒ…å ±é›†åˆï¼ˆvintageï¼‰ã‚’è¡¨ã—ã¦ã„ã¾ã™ã€‚çµ±è¨ˆãƒ‡ãƒ¼ã‚¿$x_{i,t|v_j}$ã¯ä»¥ä¸‹ã®ã‚ˆã†ã«ãƒ•ã‚¡ã‚¯ã‚¿ãƒ¼$f_{r,t}$ã®ç·šå½¢çµåˆã§è¡¨ã™ã“ã¨ãŒã§ãã¾ã™ï¼ˆã“ã“ã§$r$ã¯ãƒ•ã‚¡ã‚¯ã‚¿ãƒ¼ã®æ•°ã‚’è¡¨ã™ï¼‰ã€‚\n$$ x_{i,t|v_j} = \\mu_i + \\lambda_{i1}f_{1,t} + \u0026hellip; + \\lambda_{ir}f_{r,t} + \\xi_{i,t|v_j} \\tag{1} $$\n$(\\mu_i)$ã¯å®šæ•°é …ã€$\\lambda_{ir}$ã¯ãƒ•ã‚¡ã‚¯ã‚¿ãƒ¼ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã€$\\xi_{i,t|v_j}$ã¯ãƒ›ãƒ¯ã‚¤ãƒˆãƒã‚¤ã‚ºã®èª¤å·®é …ã‚’è¡¨ã—ã¦ã„ã¾ã™ã€‚ã“ã‚Œã‚’è¡Œåˆ—å½¢å¼ã§æ›¸ãã¨ä»¥ä¸‹ã®ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚\n$$ x_{t|v_j} = \\mu + \\Lambda F_t + \\xi_{t|v_j} = \\mu + \\chi_t + \\xi_{t|v_j} \\tag{2} $$\nã“ã“ã§ã€$x_{t|v_j} = (x_{1,t|v_j}, \u0026hellip;, x_{n,t|v_j} )^{\\mathrm{T}}$ã€$\\xi_{t|v_j}=(\\xi_{1,t|v_j}, \u0026hellip;, \\xi_{n,t|v_j})^{\\mathrm{T}}$ã€$F_t = (f_{1,t}, \u0026hellip;, f_{r,t})^{\\mathrm{T}}$ã§ã‚ã‚Šã€$\\Lambda$ã¯å„è¦ç´ ãŒ$ \\lambda_{ij}$ã®$n\\times r$è¡Œåˆ—ã®ãƒ•ã‚¡ã‚¯ã‚¿ãƒ¼ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã‚’è¡¨ã—ã¦ã„ã¾ã™ã€‚ã¾ãŸã€$\\chi_t = \\Lambda F_t$ã§ã™ã€‚ã‚ˆã£ã¦ã€ãƒ•ã‚¡ã‚¯ã‚¿ãƒ¼$ F_t$ã‚’æ¨å®šã™ã‚‹ãŸã‚ã«ã¯ã€ãƒ‡ãƒ¼ã‚¿$x_{i,t|v_j}$ã‚’ä»¥ä¸‹ã®ã‚ˆã†ã«åŸºæº–åŒ–ã—ãŸã†ãˆã§ã€åˆ†æ•£å…±åˆ†æ•£è¡Œåˆ—ã‚’è¨ˆç®—ã—ã€ãã®å›ºæœ‰å€¤å•é¡Œã‚’è§£ã‘ã°ã‚ˆã„ã¨ã„ã†äº‹ã«ãªã‚Šã¾ã™ã€‚\n$$ \\displaystyle z_{it} = \\frac{1}{\\hat{\\sigma}_i}(x_{it} - \\hat{\\mu}_{it}) \\tag{3} $$\n\rã“ã“ã§ã€$\\displaystyle \\hat{\\mu}_{it} = 1/T \\sum_{t=1}^T x_{it}$ã§ã‚ã‚Šã€$\\hat{\\sigma}_i = \\sqrt{1/T \\sum_{t=1}^T (x_{it}-\\hat{\\mu_{it}})^2}$ã§ã™ï¼ˆã“ã“ã§$T$ã¯ã‚µãƒ³ãƒ—ãƒ«æœŸé–“ï¼‰ã€‚åˆ†æ•£å…±åˆ†æ•£è¡Œåˆ—$S$ã‚’ä»¥ä¸‹ã®ã‚ˆã†ã«å®šç¾©ã—ã¾ã™ã€‚\r\r$$ \\displaystyle S = \\frac{1}{T} \\sum_{t=1}^T z_t z_t^{\\mathrm{T}} \\tag{4} $$ æ¬¡ã«ã€$S$ã®ã†ã¡ã€å›ºæœ‰å€¤ã‚’å¤§ãã„é †ã«$r$å€‹å–ã‚Šå‡ºã—ã€ãã‚Œã‚’è¦ç´ ã«ã—ãŸ$ r \\times r$å¯¾è§’è¡Œåˆ—ã‚’$ D$ã€ãã‚Œã«å¯¾å¿œã™ã‚‹å›ºæœ‰ãƒ™ã‚¯ãƒˆãƒ«ã‚’$n \\times r$è¡Œåˆ—ã«ã—ãŸã‚‚ã®ã‚’$ V$ã¨å®šç¾©ã—ã¾ã™ã€‚ãƒ•ã‚¡ã‚¯ã‚¿ãƒ¼$ \\tilde{F}_t$ã¯ä»¥ä¸‹ã®ã‚ˆã†ã«æ¨è¨ˆã§ãã¾ã™ã€‚\n$$ \\tilde{F}_t = V^{\\mathrm{T}} z_t \\tag{5} $$ ãƒ•ã‚¡ã‚¯ã‚¿ãƒ¼ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°$\\Lambda$ã¨èª¤å·®é …ã®å…±åˆ†æ•£è¡Œåˆ—$\\Psi = \\mathop{\\mathbb{E}} [\\xi_t\\xi^{\\mathrm{T}}_t]$ã¯$\\tilde{F}_t$ã‚’$z_t$ã«å›å¸°ã™ã‚‹ã“ã¨ã§æ¨è¨ˆã—ã¾ã™ã€‚\n$$ \\displaystyle \\hat{\\Lambda} = \\sum_{t=1}^T z_t \\tilde{F}^{\\mathrm{T}}_t (\\sum_{t=1}^T\\tilde{F}_t\\tilde{F}^{\\mathrm{T}}_t)^{-1} = V \\tag{6} $$\n$$ \\hat{\\Psi} = diag(S - VDV) \\tag{7} $$\næ³¨æ„ã—ã¦é ‚ããŸã„ã®ã¯ã€ã“ã“ã§æ¨è¨ˆã—ãŸ$\\tilde{F}_t$ã¯ã€ä»¥ä¸‹ã®çŠ¶æ…‹ç©ºé–“ãƒ¢ãƒ‡ãƒ«ã§ã®æ¨è¨ˆã«å¿…è¦ãªãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’è¨ˆç®—ã™ã‚‹ãŸã‚ã®ä¸€æ™‚çš„ãªæ¨è¨ˆå€¤ã§ã‚ã‚‹ã¨ã„ã†äº‹ã§ã™ï¼ˆï¼’æ®µéšæ¨è¨ˆã®ï¼‘æ®µéšç›®ã¨ã„ã†äº‹ï¼‰ã€‚\n$$ x_{t|v_j} = \\mu + \\Lambda F_t + \\xi_{t|v_j} = \\mu + \\chi_t + \\xi_{t|v_j} \\tag{2} $$\n$$ F_t = AF_{t-1} + u_t \\tag{8} $$ ã“ã“ã§ã€$u_t$ã¯å¹³å‡0ã€åˆ†æ•£$H$ã®ãƒ›ãƒ¯ã‚¤ãƒˆãƒã‚¤ã‚ºã§ã™ã€‚å†æ²ã—ã¦ã„ã‚‹(2)å¼ãŒè¦³æ¸¬æ–¹ç¨‹å¼ã€(8)å¼ãŒé·ç§»æ–¹ç¨‹å¼ã¨ãªã£ã¦ã„ã¾ã™ã€‚æ¨å®šã™ã¹ããƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã¯$\\Lambda$ã€$\\Psi$ä»¥å¤–ã«$A$ã¨$H$ãŒã‚ã‚Šã¾ã™ï¼ˆ$\\mu=0$ã¨ã—ã¦ã„ã¾ã™ï¼‰ã€‚$A$ã¯ä¸»æˆåˆ†åˆ†æã«ã‚ˆã‚Šè¨ˆç®—ã—ãŸ$\\tilde{F}_t$ã‚’$VAR(1)$ã«ã‹ã‘ã‚‹ã“ã¨ã§æ¨å®šã—ã¾ã™ã€‚\n$$ \\hat{A} = \\sum_{t=2}^T\\tilde{F}_t\\tilde{F}_{t-1}^{\\mathrm{T}} (\\sum_{t=2}^T\\tilde{F}_{t-1}\\tilde{F}_{t-1}^{\\mathrm{T}})^{-1} \\tag{9} $$ $H$ã¯ä»Šæ¨è¨ˆã—ãŸ$VAR(1)$ã®èª¤å·®é …ã®å…±åˆ†æ•£è¡Œåˆ—ã‹ã‚‰è¨ˆç®—ã—ã¾ã™ã€‚ã“ã‚Œã§å¿…è¦ãªãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã®æ¨å®šãŒçµ‚ã‚ã‚Šã¾ã—ãŸã€‚æ¬¡ã«ã‚«ãƒ«ãƒãƒ³ãƒ•ã‚£ãƒ«ã‚¿ã‚’å›ã—ã¾ã™ã€‚ã‚«ãƒ«ãƒãƒ³ãƒ•ã‚£ãƒ«ã‚¿ã«é–¢ã—ã¦ã¯ã“ã¡ã‚‰ã‚’å‚è€ƒã«ã—ã¦ãã ã•ã„ã€‚ã‚ã‹ã‚Šã‚„ã™ã„ã§ã™ã€‚ã“ã‚Œã§æœ€çµ‚çš„ã«$\\hat{F}_{t|v_j}$ã®æ¨è¨ˆãŒã§ãã‚‹ã‚ã‘ã§ã™ã€‚ GDPãŒã“ã‚Œã‚‰ã®ãƒ•ã‚¡ã‚¯ã‚¿ãƒ¼ã§èª¬æ˜å¯èƒ½ã§ã‚ã‚Šï¼ˆã¤ã¾ã‚Šå›ºæœ‰ã®å¤‰å‹•ãŒãªã„ï¼‰ã€GDPã¨æœˆæ¬¡çµŒæ¸ˆæŒ‡æ¨™ãŒjointly normalã§ã‚ã‚Œã°ä»¥ä¸‹ã®ã‚ˆã†ãªå˜ç´”ãªOLSæ¨è¨ˆã§GDPã‚’äºˆæ¸¬ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚ã‚‚ã¡ã‚ã‚“æœˆæ¬¡çµŒæ¸ˆæŒ‡æ¨™ã®æ–¹ãŒæ—©ãå…¬è¡¨ã•ã‚Œã‚‹ã®ã§ã€å†…ç”Ÿæ€§ã®å•é¡Œã¯ãªã„ã¨è€ƒãˆã‚‰ã‚Œã¾ã™ã€‚\n\r$$\r\\hat{y}_{3k|v_j} = \\alpha + \\beta^{\\mathrm{T}} \\hat{F}_{3k|v_j} \\tag{10}\r$$\r\r\rã“ã“ã§ã€$3k$ã¯å››åŠæœŸã®æœ€çµ‚æœˆã‚’ç¤ºã—ã¦ã„ã¾ã™ï¼ˆ3æœˆã€6æœˆãªã©ï¼‰$\\hat{y}_{3k|v_j}$ã¯$j$æ™‚ç‚¹ã§å¾—ã‚‰ã‚Œã‚‹æƒ…å ±é›†åˆ$v_j$ã§ã®å››åŠæœŸGDPã‚’è¡¨ã—ã¦ãŠã‚Šã€$\\hat{F}_{3k|v_j}$ã¯ãã®æ™‚ç‚¹ã§æ¨å®šã—ãŸãƒ•ã‚¡ã‚¯ã‚¿ãƒ¼ã‚’è¡¨ã—ã¦ã„ã¾ã™ï¼ˆå››åŠæœŸæœ€çµ‚æœˆã®å€¤ã ã‘ã‚’ä½¿ç”¨ã—ã¦ã„ã‚‹ç‚¹ã«æ³¨æ„ï¼‰ã€‚ã“ã‚Œã§æ¨è¨ˆæ–¹æ³•ã®èª¬æ˜ã¯çµ‚ã‚ã‚Šã§ã™ã€‚\r\r2. Rã§å®Ÿè£…ã™ã‚‹ ã§ã¯å®Ÿè£…ã—ã¾ã™ã€‚å‰å›è¨˜äº‹ã§å¾—ã‚‰ã‚ŒãŸãƒ‡ãƒ¼ã‚¿ï¼ˆdatasetï¼‰ãŒèª­ã¿è¾¼ã¾ã‚Œã¦ã„ã‚‹çŠ¶æ…‹ã‹ã‚‰ã‚¹ã‚¿ãƒ¼ãƒˆã—ã¾ã™ã€‚ã¾ãšã€ä¸»æˆåˆ†åˆ†æã§ãƒ•ã‚¡ã‚¯ã‚¿ãƒ¼ã‚’è¨ˆç®—ã—ã¾ã™ã€‚ãªãŠã€å‰å›ã®è¨˜äº‹ã§3ãƒ•ã‚¡ã‚¯ã‚¿ãƒ¼ã®ç´¯ç©å¯„ä¸åº¦ãŒ80%ã‚’è¶…ãˆãŸãŸã‚ã€ä»Šå›ã‚‚ãƒ•ã‚¡ã‚¯ã‚¿ãƒ¼æ•°ã¯3ã«ã—ã¦ã„ã¾ã™ã€‚\n#------------------------ # Giannone et. al. 2008  #------------------------ library(xts) library(MASS) library(tidyverse) # ä¸»æˆåˆ†åˆ†æã§ãƒ•ã‚¡ã‚¯ã‚¿ãƒ¼ã‚’è¨ˆç®— f \u0026lt;- 3 # ãƒ•ã‚¡ã‚¯ã‚¿ãƒ¼æ•°ã‚’å®šç¾© a \u0026lt;- which(dataset1$publication == \u0026#34;2012-04-01\u0026#34;) # ã‚µãƒ³ãƒ—ãƒ«é–‹å§‹æœŸé–“ã‚’2012å¹´ã«è¨­å®šã€‚ dataset2 \u0026lt;- dataset1[a:nrow(dataset1),] rownames(dataset2) \u0026lt;- dataset2$publication dataset2 \u0026lt;- dataset2[,-2] z \u0026lt;- scale(dataset2) # zã¯åŸºæº–åŒ–ã•ã‚ŒãŸã‚µãƒ³ãƒ—ãƒ«ãƒ‡ãƒ¼ã‚¿ for (i in 1:nrow(z)){ eval(parse(text = paste(\u0026#34;S_i \u0026lt;- z[i,]%*%t(z[i,])\u0026#34;,sep = \u0026#34;\u0026#34;))) if (i==1){ S \u0026lt;- S_i }else{ S \u0026lt;- S + S_i } } S \u0026lt;- (1/nrow(z))*S # åˆ†æ•£å…±åˆ†æ•£è¡Œåˆ—ã‚’è¨ˆç®— (4)å¼ gamma \u0026lt;- eigen(S) D \u0026lt;- diag(gamma$values[1:f]) V \u0026lt;- gamma$vectors[,1:f] F_t \u0026lt;- matrix(0,nrow(z),f) for (i in 1:nrow(z)){ eval(parse(text = paste(\u0026#34;F_t[\u0026#34;,i,\u0026#34;,]\u0026lt;- z[\u0026#34;,i,\u0026#34;,]%*%V\u0026#34;,sep = \u0026#34;\u0026#34;))) # (5)å¼ã‚’å®Ÿè¡Œ } F_t.xts \u0026lt;- xts(F_t,order.by = as.Date(row.names(z))) plot.zoo(F_t.xts,col = c(\u0026#34;red\u0026#34;,\u0026#34;blue\u0026#34;,\u0026#34;green\u0026#34;,\u0026#34;yellow\u0026#34;,\u0026#34;purple\u0026#34;),plot.type = \u0026#34;single\u0026#34;) # æ™‚ç³»åˆ—ãƒ—ãƒ­ãƒƒãƒˆ lambda_hat \u0026lt;- V psi \u0026lt;- diag(S-V%*%D%*%t(V)) # (7)å¼ R \u0026lt;- diag(diag(cov(z-z%*%V%*%t(V)))) æ¨è¨ˆã—ãŸãƒ•ã‚¡ã‚¯ã‚¿ãƒ¼$\\tilde{F}_t$ã®æ™‚ç³»åˆ—ãƒ—ãƒ­ãƒƒãƒˆã¯ä»¥ä¸‹ã®ã‚ˆã†ã«ãªã‚Šã€å‰å›princompé–¢æ•°ã§è¨ˆç®—ã—ãŸãƒ•ã‚¡ã‚¯ã‚¿ãƒ¼ã¨å®Œå…¨ä¸€è‡´ã—ã¾ã™ï¼ˆã˜ã‚ƒã‚princompã§ã„ã„ã‚„ã‚“ã¨æ€ã‚ã‚Œã‚‹ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ãŒå®Ÿè£…ã—ãªã„ã¨å‹‰å¼·ã«ãªã‚Šã¾ã›ã‚“ã®ã§ï¼‰ã€‚\næ¬¡ã«ã€$VAR(1)$ã‚’æ¨è¨ˆã—ã€ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’å–ã‚Šå‡ºã—ã¾ã™ã€‚\n# VAR(1)ãƒ¢ãƒ‡ãƒ«ã‚’æ¨è¨ˆ a \u0026lt;- matrix(0,f,f) b \u0026lt;- matrix(0,f,f) for(t in 2:nrow(z)){ a \u0026lt;- a + F_t[t,]%*%t(F_t[t-1,]) b \u0026lt;- b + F_t[t-1,]%*%t(F_t[t-1,]) } b_inv \u0026lt;- solve(b) A_hat \u0026lt;- a%*%b_inv # (9)å¼ e \u0026lt;- numeric(f) for (t in 2:nrow(F_t)){ e \u0026lt;- e + F_t[t,]-F_t[t-1,]%*%A_hat } H \u0026lt;- t(e)%*%e Q \u0026lt;- diag(1,f,f) Q[1:f,1:f] \u0026lt;- H $VAR(1)$ã«é–¢ã—ã¦ã‚‚varé–¢æ•°ã¨ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã®æ•°å€¤ãŒä¸€è‡´ã™ã‚‹ã“ã¨ã‚’ç¢ºèªæ¸ˆã¿ã§ã™ã€‚ã„ã‚ˆã„ã‚ˆã‚«ãƒ«ãƒãƒ³ãƒ•ã‚£ãƒ«ã‚¿ã‚’å®Ÿè¡Œã—ã¾ã™ã€‚\n# ã‚«ãƒ«ãƒãƒ³ãƒ•ã‚£ãƒ«ã‚¿ã‚’å®Ÿè¡Œ RR \u0026lt;- array(0,dim = c(ncol(z),ncol(z),nrow(z))) # RRã¯è¦³æ¸¬å€¤ã®åˆ†æ•£è¡Œåˆ—ï¼ˆç›¸é–¢ã¯ãªã„ã¨ä»®å®šï¼‰ for(i in 1:nrow(z)){ miss \u0026lt;- is.na(z[i,]) R_temp \u0026lt;- diag(R) R_temp[miss] \u0026lt;- 1e+32 # æ¬ æå€¤ã®åˆ†æ•£ã¯ç„¡é™å¤§ã«ã™ã‚‹ RR[,,i] \u0026lt;- diag(R_temp) } zz \u0026lt;- z; zz[is.na(z)] \u0026lt;- 0 # æ¬ æå€¤ï¼ˆNAï¼‰ã«0ã‚’ä»£å…¥ï¼ˆè¨ˆç®—çµæœã«ã¯ã»ã¨ã‚“ã©å½±éŸ¿ã—ãªã„ï¼‰ã€‚ a_t \u0026lt;- matrix(0,nrow(zz),f) # a_tã¯çŠ¶æ…‹å¤‰æ•°ã®äºˆæ¸¬å€¤ a_tt \u0026lt;- matrix(0,nrow(zz),f) # a_ttã¯çŠ¶æ…‹å¤‰æ•°ã®æ›´æ–°å¾Œã®å€¤ a_tt[1,] \u0026lt;- F_t[1,] # çŠ¶æ…‹å¤‰æ•°ã®åˆæœŸå€¤ã«ã¯ä¸»æˆåˆ†åˆ†æã§æ¨è¨ˆã—ãŸãƒ•ã‚¡ã‚¯ã‚¿ãƒ¼ã‚’ä½¿ç”¨ sigma_t \u0026lt;- array(0,dim = c(f,f,nrow(zz))) # sigma_tã¯çŠ¶æ…‹å¤‰æ•°ã®åˆ†æ•£ã®äºˆæ¸¬å€¤ sigma_tt \u0026lt;- array(0,dim = c(f,f,nrow(zz))) # sigma_tã¯çŠ¶æ…‹å¤‰æ•°ã®åˆ†æ•£ã®æ›´æ–°å€¤ p \u0026lt;- ginv(diag(nrow(kronecker(A_hat,A_hat)))-kronecker(A_hat,A_hat)) sigma_tt[,,1] \u0026lt;- matrix(p,3,3) # çŠ¶æ…‹å¤‰æ•°ã®åˆ†æ•£ã®åˆæœŸå€¤ã¯VAR(1)ã®æ¨è¨ˆå€¤ã‹ã‚‰è¨ˆç®— y_t \u0026lt;- matrix(0,nrow(zz),ncol(zz)) # y_tã¯è¦³æ¸¬å€¤ã®äºˆæ¸¬å€¤ K_t \u0026lt;- array(0,dim = c(f,ncol(zz),nrow(zz))) # K_tã¯ã‚«ãƒ«ãƒãƒ³ã‚²ã‚¤ãƒ³ data.m \u0026lt;- as.matrix(dataset2) # ã‚«ãƒ«ãƒãƒ³ãƒ•ã‚£ãƒ«ã‚¿ã‚’å®Ÿè¡Œ for (t in 2:nrow(zz)){ a_t[t,] \u0026lt;- A_hat%*%a_tt[t-1,] sigma_t[,,t] \u0026lt;- A_hat%*%sigma_tt[,,t-1]%*%t(A_hat) + Q y_t[t,] \u0026lt;- as.vector(V%*%a_t[t,]) S_t \u0026lt;- V%*%sigma_tt[,,t-1]%*%t(V)+RR[,,t] GG \u0026lt;- t(V)%*%diag(1/diag(RR[,,t]))%*%V Sinv \u0026lt;- diag(1/diag(RR[,,t])) - diag(1/diag(RR[,,t]))%*%V%*%ginv(diag(nrow(A_hat))+sigma_t[,,t]%*%GG)%*%sigma_t[,,t]%*%t(V)%*%diag(1/diag(RR[,,t])) K_t[,,t] \u0026lt;- sigma_t[,,t]%*%t(V)%*%Sinv a_tt[t,] \u0026lt;- a_t[t,] + K_t[,,t]%*%(zz[t,]-y_t[t,]) sigma_tt[,,t] \u0026lt;- sigma_t[,,t] - K_t[,,t]%*%V%*%sigma_tt[,,t-1]%*%t(V)%*%t(K_t[,,t]) } F.xts \u0026lt;- xts(a_tt,order.by = as.Date(rownames(data.m))) plot.zoo(F.xts, col = c(\u0026#34;red\u0026#34;,\u0026#34;blue\u0026#34;,\u0026#34;green\u0026#34;,\u0026#34;yellow\u0026#34;,\u0026#34;purple\u0026#34;),plot.type = \u0026#34;single\u0026#34;) # å¾—ã‚‰ã‚ŒãŸæ¨è¨ˆå€¤ã‚’æ™‚ç³»åˆ—ãƒ—ãƒ­ãƒƒãƒˆ ã‚«ãƒ«ãƒãƒ³ãƒ•ã‚£ãƒ«ã‚¿ã«ã‚ˆã‚Šæ¨è¨ˆã—ãŸãƒ•ã‚¡ã‚¯ã‚¿ãƒ¼ã®æ™‚ç³»åˆ—ãƒ—ãƒ­ãƒƒãƒˆãŒä»¥ä¸‹ã§ã™ã€‚é·ç§»æ–¹ç¨‹å¼ãŒAR(1)ã ã£ãŸã‹ã‚‰ã‹ã‹ãªã‚Šå¹³æº–åŒ–ã•ã‚ŒãŸå€¤ã¨ãªã£ã¦ã„ã¾ã™ã€‚\nã§ã¯ã€ã“ã®å¾—ã‚‰ã‚ŒãŸãƒ•ã‚¡ã‚¯ã‚¿ãƒ¼ã‚’OLSã«ã‹ã‘ã¾ã™ã€‚\n# å¾—ã‚‰ã‚ŒãŸãƒ•ã‚¡ã‚¯ã‚¿ãƒ¼ã¨GDPã‚’OLSã«ã‹ã‘ã‚‹ F_q \u0026lt;- as.data.frame(a_tt[seq(3,nrow(a_tt),3),]) # å››åŠæœŸã®çµ‚ã‚ã‚Šæœˆã®å€¤ã ã‘ã‚’å¼•ã£å¼µã£ã¦ãã‚‹  colnames(F_q) \u0026lt;- c(\u0026#34;factor1\u0026#34;,\u0026#34;factor2\u0026#34;,\u0026#34;factor3\u0026#34;) colnames(GDP) \u0026lt;- c(\u0026#34;publication\u0026#34;,\u0026#34;GDP\u0026#34;) t \u0026lt;- which(GDP$publication==\u0026#34;2012-04-01\u0026#34;) t2 \u0026lt;- which(GDP$publication==\u0026#34;2015-01-01\u0026#34;) # 2012-2q~2015-1qã¾ã§ã®ãƒ‡ãƒ¼ã‚¿ãŒå­¦ç¿’ãƒ‡ãƒ¼ã‚¿ã€ãã‚Œä»¥é™ãŒãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ GDP_q \u0026lt;- GDP[t:nrow(GDP),] dataset.q \u0026lt;- cbind(GDP_q[1:(t2-t),],F_q[1:(t2-t),]) test \u0026lt;- lm(GDP~factor1 + factor2 + factor3,data=dataset.q) summary(test) ## ## Call:\r## lm(formula = GDP ~ factor1 + factor2 + factor3, data = dataset.q)\r## ## Residuals:\r## Min 1Q Median 3Q Max ## -1079.4 -779.4 -265.2 905.9 1280.0 ## ## Coefficients:\r## Estimate Std. Error t value Pr(\u0026gt;|t|) ## (Intercept) 129440.3 3784.8 34.200 4.74e-09 ***\r## factor1 -776.3 846.0 -0.918 0.389 ## factor2 -699.0 2358.8 -0.296 0.776 ## factor3 552.3 1588.2 0.348 0.738 ## ---\r## Signif. codes: 0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\r## ## Residual standard error: 1109 on 7 degrees of freedom\r## Multiple R-squared: 0.6667,\tAdjusted R-squared: 0.5239 ## F-statistic: 4.668 on 3 and 7 DF, p-value: 0.04279\rout_of_sample \u0026lt;- cbind(GDP_q[(t2-t+1):nrow(GDP_q),],F_q[(t2-t+1):nrow(GDP_q),]) # out of sampleã®ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã‚’ä½œæˆ test.pred \u0026lt;- predict(test, out_of_sample, interval=\u0026#34;prediction\u0026#34;) pred.GDP.xts \u0026lt;- xts(cbind(test.pred[,1],out_of_sample$GDP),order.by = out_of_sample$publication) plot.zoo(pred.GDP.xts,col = c(\u0026#34;red\u0026#34;,\u0026#34;blue\u0026#34;),plot.type = \u0026#34;single\u0026#34;) # äºˆæ¸¬å€¤ã¨å®Ÿç¸¾å€¤ã‚’æ™‚ç³»åˆ—ãƒ—ãƒ­ãƒƒãƒˆ OLSã®æ¨è¨ˆçµæœã¯factor1ï¼ˆèµ¤ï¼‰ã¨factor2ï¼ˆé’ï¼‰ãŒæœ‰æ„ã¨ã®çµæœã€‚å‰å›ã®æŠ•ç¨¿ã§ã‚‚è¨€åŠã—ãŸã‚ˆã†ã«ã€factor1ï¼ˆèµ¤ï¼‰ã¯ãƒªã‚¹ã‚¯ã‚»ãƒ³ãƒãƒ¡ãƒ³ãƒˆã‚’è¡¨ã—ã¦ã„ãã†ãªã®ã§ã€ä¿‚æ•°ã®ç¬¦å·ãŒè² ã§ã‚ã‚‹ã“ã¨ã¯é ·ã‘ã‚‹ã€‚ãŸã ã—ã€factor2ï¼ˆé’ï¼‰ã‚‚ç¬¦å·ãŒè² ãªã®ã§ã¯ãªãœãªã®ã‹â€¦ã€‚ã“ã®ãƒ•ã‚¡ã‚¯ã‚¿ãƒ¼ã¯ç”Ÿç”£å¹´é½¢äººå£ãªã©çµŒæ¸ˆã®æ½œåœ¨èƒ½åŠ›ã‚’è¡¨ã—ã¦ã„ã‚‹ã¨æ€ã£ã¦ã„ãŸã®ã«ã€‚ã‹ãªã‚Šè¬ã€‚ã¾ã‚ã¨ã‚Šã‚ãˆãšäºˆæ¸¬ã«ç§»ã‚Šã¾ã—ã‚‡ã†ã€‚ã“ã®ãƒ¢ãƒ‡ãƒ«ã‚’ä½¿ç”¨ã—ãŸGDPã®äºˆæ¸¬å€¤ã¨å®Ÿç¸¾å€¤ã®æ¨ç§»ã¯ã„ã‹ã®ã‚ˆã†ã«ãªã‚Šã¾ã—ãŸã€‚ç›´è¿‘ã®ç²¾åº¦ã¯æ‚ªããªã„ï¼Ÿ\nã¨ã„ã†ã‹ã€ã“ã‚Œå®Œå…¨ã«å˜ä½æ ¹ã®å•é¡Œã‚’ç„¡è¦–ã—ã¦OLSã—ã¦ã—ã¾ã£ã¦ã„ã‚‹ãªã€‚ãƒ•ã‚¡ã‚¯ã‚¿ãƒ¼ã‚‚GDPã‚‚å®Œå…¨ã«å˜ä½æ ¹ã‚’æŒã¤ã‘ã©å¿µã®ãŸã‚å˜ä½æ ¹æ¤œå®šã‚’ã‹ã‘ã¦ã¿ã¾ã™ã€‚\nlibrary(tseries) adf.test(F_q$factor1) ## ## Augmented Dickey-Fuller Test\r## ## data: F_q$factor1\r## Dickey-Fuller = -2.832, Lag order = 2, p-value = 0.2554\r## alternative hypothesis: stationary\radf.test(F_q$factor2) ## ## Augmented Dickey-Fuller Test\r## ## data: F_q$factor2\r## Dickey-Fuller = -2.5433, Lag order = 2, p-value = 0.3654\r## alternative hypothesis: stationary\radf.test(F_q$factor3) ## ## Augmented Dickey-Fuller Test\r## ## data: F_q$factor3\r## Dickey-Fuller = -2.5795, Lag order = 2, p-value = 0.3516\r## alternative hypothesis: stationary\radf.test(GDP_q$GDP) ## ## Augmented Dickey-Fuller Test\r## ## data: GDP_q$GDP\r## Dickey-Fuller = -0.25589, Lag order = 3, p-value = 0.9867\r## alternative hypothesis: stationary\rã¯ã„ã€‚å…¨éƒ¨å˜ä½æ ¹ã‚‚ã£ã¦ã¾ã—ãŸâ€¦ã€‚éšå·®ã‚’ã¨ã£ãŸã®ã¡ã€å˜ä½æ ¹æ¤œå®šã‚’è¡Œã„ã¾ã™ã€‚\nGDP_q \u0026lt;- GDP_q %\u0026gt;% mutate(growth.rate=(GDP/lag(GDP)-1)*100) F_q \u0026lt;- F_q %\u0026gt;% mutate(f1.growth.rate=(factor1/lag(factor1)-1)*100, f2.growth.rate=(factor2/lag(factor2)-1)*100, f3.growth.rate=(factor3/lag(factor3)-1)*100) adf.test(GDP_q$growth.rate[2:NROW(GDP_q$growth.rate)]) ## ## Augmented Dickey-Fuller Test\r## ## data: GDP_q$growth.rate[2:NROW(GDP_q$growth.rate)]\r## Dickey-Fuller = -2.5299, Lag order = 3, p-value = 0.368\r## alternative hypothesis: stationary\radf.test(F_q$f1.growth.rate[2:NROW(F_q$f1.growth.rate)]) ## ## Augmented Dickey-Fuller Test\r## ## data: F_q$f1.growth.rate[2:NROW(F_q$f1.growth.rate)]\r## Dickey-Fuller = -2.5185, Lag order = 2, p-value = 0.3748\r## alternative hypothesis: stationary\radf.test(F_q$f2.growth.rate[2:NROW(F_q$f2.growth.rate)]) ## ## Augmented Dickey-Fuller Test\r## ## data: F_q$f2.growth.rate[2:NROW(F_q$f2.growth.rate)]\r## Dickey-Fuller = -2.498, Lag order = 2, p-value = 0.3827\r## alternative hypothesis: stationary\radf.test(F_q$f3.growth.rate[2:NROW(F_q$f3.growth.rate)]) ## ## Augmented Dickey-Fuller Test\r## ## data: F_q$f3.growth.rate[2:NROW(F_q$f3.growth.rate)]\r## Dickey-Fuller = -3.3479, Lag order = 2, p-value = 0.08501\r## alternative hypothesis: stationary\rfactor1ã ã‘ã¯5%æœ‰æ„æ°´æº–ã§å¸°ç„¡ä»®èª¬ã‚’æ£„å´ã§ããªã„â€¦ã€‚å›°ã‚Šã¾ã—ãŸã€‚æœ‰æ„æ°´æº–ã‚’10%ã¨ã„ã†ã“ã¨ã«ã—ã¦ã€ã¨ã‚Šã‚ãˆãšéšå·®ã§OLSã—ã¦ã¿ã¾ã™ã€‚\ndataset.q \u0026lt;- cbind(GDP_q[1:(t2-t),],F_q[1:(t2-t),]) colnames(dataset.q) \u0026lt;- c(\u0026#34;publication\u0026#34;,\u0026#34;GDP\u0026#34;,\u0026#34;growth.rate\u0026#34;,\u0026#34;factor1\u0026#34;,\u0026#34;factor2\u0026#34;,\u0026#34;factor3\u0026#34;,\u0026#34;f1.growth.rate\u0026#34;,\u0026#34;f2.growth.rate\u0026#34;,\u0026#34;f3.growth.rate\u0026#34;) test1 \u0026lt;- lm(growth.rate~f1.growth.rate + f2.growth.rate + f3.growth.rate,data=dataset.q) summary(test1) ## ## Call:\r## lm(formula = growth.rate ~ f1.growth.rate + f2.growth.rate + ## f3.growth.rate, data = dataset.q)\r## ## Residuals:\r## Min 1Q Median 3Q Max ## -1.1822 -0.2944 -0.1403 0.3495 1.2200 ## ## Coefficients:\r## Estimate Std. Error t value Pr(\u0026gt;|t|)\r## (Intercept) -0.1900410 0.3956316 -0.480 0.648\r## f1.growth.rate -0.0138647 0.0122615 -1.131 0.301\r## f2.growth.rate -0.0044379 0.0036015 -1.232 0.264\r## f3.growth.rate -0.0007179 0.0006337 -1.133 0.300\r## ## Residual standard error: 0.7832 on 6 degrees of freedom\r## ( 1 å€‹ã®è¦³æ¸¬å€¤ãŒæ¬ æã®ãŸã‚å‰Šé™¤ã•ã‚Œã¾ã—ãŸ )\r## Multiple R-squared: 0.3447,\tAdjusted R-squared: 0.01705 ## F-statistic: 1.052 on 3 and 6 DF, p-value: 0.4357\ræ¨è¨ˆçµæœãŒã‚ã‚‹ããªã‚Šã¾ã—ãŸâ€¦ã€‚äºˆæ¸¬å€¤ã‚’è¨ˆç®—ã—ã€å®Ÿç¸¾å€¤ã¨ãƒ—ãƒ­ãƒƒãƒˆã—ã¦ã¿ã¾ã™ã€‚\nout_of_sample1 \u0026lt;- cbind(GDP_q[(t2-t+1):nrow(GDP_q),],F_q[(t2-t+1):nrow(GDP_q),]) # out of sampleã®ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã‚’ä½œæˆ test1.pred \u0026lt;- predict(test1, out_of_sample1, interval=\u0026#34;prediction\u0026#34;) pred1.GDP.xts \u0026lt;- xts(cbind(test1.pred[,1],out_of_sample1$growth.rate),order.by = out_of_sample1$publication) plot.zoo(pred1.GDP.xts,col = c(\u0026#34;red\u0026#34;,\u0026#34;blue\u0026#34;),plot.type = \u0026#34;single\u0026#34;) # äºˆæ¸¬å€¤ã¨å®Ÿç¸¾å€¤ã‚’æ™‚ç³»åˆ—ãƒ—ãƒ­ãƒƒãƒˆ ã‚“ï½ã€ã“ã‚Œã¯ã‚„ã‚Šç›´ã—ã§ã™ã­ã€‚ä»Šæ—¥ã¯ã“ã“ã¾ã§ã§å‹˜å¼ã—ã¦ãã ã•ã„â€¦ã€‚\n","date":1531699200,"expirydate":-62135596800,"kind":"page","lang":"ja","lastmod":1531699200,"objectID":"53a087908899411dab3858677c03ade5","permalink":"/post/post6/","publishdate":"2018-07-16T00:00:00Z","relpermalink":"/post/post6/","section":"post","summary":"å‰å›é›†ã‚ãŸçµŒæ¸ˆãƒ‡ãƒ¼ã‚¿ã‚’Giannone et al (2008)ã®ãƒãƒ«ãƒãƒ•ã‚¡ã‚¯ã‚¿ãƒ¼ãƒ¢ãƒ‡ãƒ«ã§æ¨å®šã—ã€å››åŠæœŸGDPã‚’äºˆæ¸¬ã—ãŸã„ã¨æ€ã„ã¾ã™ã€‚","tags":["R","ã‚«ãƒ«ãƒãƒ³ãƒ•ã‚£ãƒ«ã‚¿"],"title":"Gianonne et. al. (2008)ã®ãƒãƒ«ãƒãƒ•ã‚¡ã‚¯ã‚¿ãƒ¼ãƒ¢ãƒ‡ãƒ«ã§å››åŠæœŸGDPã‚’äºˆæƒ³ã—ã¦ã¿ãŸ","type":"post"},{"authors":null,"categories":["ãƒã‚¯ãƒ­çµŒæ¸ˆå­¦","Webã‚¹ã‚¯ãƒ¬ã‚¤ãƒ”ãƒ³ã‚°"],"content":"ãŠã¯ã“ã‚“ã°ã‚“ã¡ã‚ã€‚\næœ€è¿‘ã€ç«¶é¦¬ã°ã£ã‹ã‚Šã‚„ã£ã¦ã¾ã—ãŸãŒã€ãã‚ãã‚æœ¬æ¥­ã®ãƒã‚¯ãƒ­ã®æ–¹ã‚‚ã‚„ã‚‰ãªã„ã¨ãªã¨ã„ã†ã“ã¨ã§ä»Šå›ã¯æ—¥æ¬¡GDPæ¨è¨ˆã«ä½¿ç”¨ã™ã‚‹ãƒ‡ãƒ¼ã‚¿ã‚’ç·å‹™çœãŒå…¬é–‹ã—ã¦ã„ã‚‹çµ±è¨ˆãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã‹ã‚‰å–ã£ã¦ãã¾ã—ãŸã€‚ ãã‚‚ãã‚‚ã€å‰ã®è¨˜äº‹ã§ã¯å››åŠæœŸGDPé€Ÿå ±ã®ç²¾åº¦ãŒä½ã„ã“ã¨ã‚’ãƒ¢ãƒãƒ™ãƒ¼ã‚·ãƒ§ãƒ³ã«é«˜é »åº¦ãƒ‡ãƒ¼ã‚¿ã‚’ç”¨ã„ã¦ã‚ˆã‚Šç²¾åº¦ã®é«˜ã„äºˆæ¸¬å€¤ã‚’ã¯ã˜ãå‡ºã™ãƒ¢ãƒ‡ãƒ«ã‚’ä½œã‚Œãªã„ã‹ã¨ã„ã†ãƒ†ãƒ¼ãƒã§ç ”ç©¶ã‚’é€²ã‚ã¦ã„ã¾ã—ãŸã€‚ã—ã‹ã—ã€å…ˆè¡Œç ”ç©¶ã‚’é€²ã‚ã¦ã„ãã†ã¡ã«ã€ã©ã†ã‚„ã‚‰å¤§è¦æ¨¡ãªçµŒæ¸ˆæŒ‡æ¨™ã‚’åˆ©ç”¨ã™ã‚‹ã“ã¨ã§æ—¥æ¬¡ã§å››åŠæœŸGDPã®äºˆæ¸¬å€¤ã‚’è¨ˆç®—ã™ã‚‹ã“ã¨ãŒå¯èƒ½ã§ã‚ã‚‹ã“ã¨ãŒåˆ¤æ˜ã—ã¾ã—ãŸã€‚ã—ã‹ã‚‚ã€ç²¾åº¦ã‚‚è‰¯ã„(ç±³å›½ã§ã™ãŒ)ã¨ã„ã†ã“ã¨ã§ã€ãªã‚“ã¨ã‹ã“ã®æ–¹å‘ã§ç ”ç©¶ã‚’é€²ã‚ã¦ã„ã‘ãªã„ã‹ã¨ã„ã†ã“ã¨ã«ãªã‚Šã¾ã—ãŸã€‚\n1. å…ˆè¡Œç ”ç©¶ã¨å…·ä½“çš„ã«ã‚„ã‚ŠãŸã„ã“ã¨ å…ˆè¡Œç ”ç©¶\nGiannoneã‚‰ãŒ2008å¹´ã«ãƒ‘ãƒ–ãƒªãƒƒã‚·ãƒ¥ã—ãŸè«–æ–‡ã§ã™(JME)ã€‚å½¼ã‚‰ã¯ã‚¢ãƒ¡ãƒªã‚«ã®çµŒæ¸ˆæŒ‡æ¨™ã‚’ç”¨ã„ã¦å››åŠæœŸGDPã‚’æ—¥æ¬¡ã§æ¨è¨ˆã—ã€äºˆæ¸¬æŒ‡æ¨™ã¨ã—ã¦ã®æœ‰ç”¨æ€§ã‚’ç¤ºã—ã¾ã—ãŸã€‚æŒ‡æ¨™é–“ã®é€£å‹•æ€§(colinearity)ã‚’åˆ©ç”¨ã—ã¦ã€å¤šæ•°ã‚ã‚‹çµŒæ¸ˆæŒ‡æ¨™ã‚’ã„ãã¤ã‹ã®ãƒ•ã‚¡ã‚¯ã‚¿ãƒ¼ã«åœ§ç¸®ã—ã€ãã®ãƒ•ã‚¡ã‚¯ã‚¿ãƒ¼ã‚’å››åŠæœŸGDPã«ãƒ•ã‚£ãƒƒãƒ†ã‚£ãƒ³ã‚°ã•ã›ã‚‹ã“ã¨ã«ã‚ˆã£ã¦é«˜ã„äºˆæ¸¬æ€§ã‚’å®Ÿç¾ã—ã¾ã—ãŸã€‚ãªãŠã€ãƒ•ã‚¡ã‚¯ã‚¿ãƒ¼ã®è¨ˆç®—ã«ã¯ã‚«ãƒ«ãƒãƒ³ã‚¹ãƒ ãƒ¼ã‚¸ãƒ³ã‚°ã‚’ç”¨ã„ã¦ã„ã¾ã™(è©³ã—ã„æ¨è¨ˆæ–¹æ³•ã¯è«–æ–‡\u0026amp;Technical Appendixã‚’å‚ç…§)ã€‚ç†è«–çš„ãªå®šå¼åŒ–ã¯ç„¡ã„ã®ã§ã™ãŒã€ãªã‹ãªã‹å½“ãŸã‚Šã¾ã™ã€‚ãã‚‚ãã‚‚ç§ãŒã“ã®ç ”ç©¶ã«èˆˆå‘³ã‚’æŒã£ãŸã®ã¯ã€ä»¥ä¸‹ã®æœ¬ã‚’ç«‹ã¡èª­ã¿ã—ãŸéš›ã«å‚è€ƒæ–‡çŒ®ã¨ã—ã¦å‡ºã¦ããŸã‹ã‚‰ã§ã€ã„ã‚ˆã„ã‚ˆé‹ç”¨æ©Ÿé–¢ãªã©ã§ã‚‚ä½¿ç”¨ã•ã‚Œå§‹ã‚ã‚‹ã®ã‹ã¨æ€ã„ã€ã‚„ã£ã¦ãŠã“ã†ã¨æ€ã£ãŸæ¬¡ç¬¬ã§ã™ã€‚\nå®Ÿè·µ é‡‘èãƒ‡ãƒ¼ã‚¿ã‚µã‚¤ã‚¨ãƒ³ã‚¹ éš ã‚ŒãŸæ§‹é€ ã‚’ã‚ã¶ã‚Šå‡ºã™6ã¤ã®ã‚¢ãƒ—ãƒ­ãƒ¼ãƒ ã¨ã‚Šã‚ãˆãšã¯Giannoneã®æ—¥æœ¬ç‰ˆã‚’ã‚„ã‚ã†ã‹ãªã¨æ€ã£ã¦ã„ã¾ã™ã€‚å®Ÿã¯ã“ã®å¾Œã«ã€ãƒ•ã‚¡ã‚¯ã‚¿ãƒ¼ãƒ¢ãƒ‡ãƒ«ã¨DSGEã‚’çµ„ã¿åˆã‚ã›ãŸãƒ¢ãƒ‡ãƒ«ãŒã‚ã‚Šã¾ã—ã¦ãã“ã¾ã§ç™ºå±•ã•ã›ãŸã„ãªãƒ¼ãªã‚“ã¦æ€ã£ã¦ãŠã‚Šã¾ã™ãŒã€‚ã¨ã«ã‹ãã€ãƒ•ã‚¡ã‚¯ã‚¿ãƒ¼ã‚’è¨ˆç®—ã™ã‚‹ãŸã‚ã®çµŒæ¸ˆçµ±è¨ˆãŒå¿…è¦ã§ã™ã®ã§ã€ä»Šå›ã¯ãã‚Œã‚’é›†ã‚ã¦ããŸã¨ã„ã†ã®ãŒã“ã®è¨˜äº‹ã®è¶£æ—¨ã§ã™ã€‚\n2. çµ±è¨ˆãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã‹ã‚‰ã®ãƒ‡ãƒ¼ã‚¿ã®åé›† æ”¿åºœã‚„æ—¥éŠ€ãŒå…¬è¡¨ã—ã¦ã„ã‚‹ãƒ‡ãƒ¼ã‚¿ã®ä¸€éƒ¨ã¯çµ±è¨ˆãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã‹ã‚‰è½ã¨ã™ã“ã¨ãŒã§ãã¾ã™ã€‚ã“ã‚Œã¯ç·å‹™çœçµ±è¨ˆå±€ãŒæä¾›ã—ã¦ã„ã‚‹ã‚‚ã®ã§ã€ã“ã‚Œã¾ã§åˆ©ç”¨ã—ã«ãã‹ã£ãŸçµŒæ¸ˆçµ±è¨ˆã‚’ã‚ˆã‚Šèº«è¿‘ã«ä½¿ç”¨ã—ã¦ã‚‚ã‚‰ãŠã†ã¨ã„ã†ã®ãŒä¸€å¿œã®ã‚³ãƒ³ã‚»ãƒ—ãƒˆã¨ãªã£ã¦ã„ã¾ã™ã€‚ä¼¼ãŸã‚‚ã®ã«ç·å‹™çœçµ±è¨ˆå±€ãŒæä¾›ã—ã¦ã„ã‚‹estatãŒã‚ã‚Šã¾ã™ãŒã€æ—¥éŠ€ã®å…¬è¡¨ãƒ‡ãƒ¼ã‚¿ãŒãªã‹ã£ãŸã‚Šã€ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ã®ç™»éŒ²ãŒå¿…è¦ã ã£ãŸã‚Šã¨éå¸¸ã«ä½¿ã„å‹æ‰‹ãŒæ‚ªã„ã§ã™(å€‹äººçš„æ„Ÿæƒ³)ã€‚ãŸã ã€estatã«ã¯estatapiã¨ã„ã†Rãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ãŒã‚ã‚Šã€ãƒ‡ãƒ¼ã‚¿ã‚’æ•´å½¢ã™ã‚‹ã®ã¯æ¯”è¼ƒçš„å®¹æ˜“ã§ã‚ã‚‹ã¨è¨€ãˆã¾ã™ã€‚ä»Šå›ã€çµ±è¨ˆãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã‚’é¸æŠã—ãŸç†ç”±ã¯ãã†ã¯è¨€ã£ã¦ã‚‚æ—¥éŠ€ã®ãƒ‡ãƒ¼ã‚¿ãŒãªã„ã®ã¯ãƒ€ãƒ¡ã ã‚ã†ã¨ã„ã†ç†ç”±ã§ã€ãƒ‡ãƒ¼ã‚¿ã®æ•´å½¢ã«é–¢ã—ã¦ã¯é–¢æ•°ã‚’çµ„ã¿ã¾ã—ãŸã€‚ ãã‚‚ãã‚‚çµ±è¨ˆãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã¯çµŒæ¸ˆçµ±è¨ˆã‚’ã‚°ãƒ©ãƒ•ãªã©ã§è¦‹ã¦æ¥½ã—ã‚€ï¼Ÿã‚‚ã®ã§ã™ãŒã€ç§ã®ã‚ˆã†ãªç ”ç©¶ã‚’ã—ãŸã„è€…ã‚’å¯¾è±¡ã«APIã‚’æä¾›ã—ã¦ãã‚Œã¦ã„ã¾ã™ã€‚å–å¾—ã§ãã‚‹ãƒ‡ãƒ¼ã‚¿ã¯å¤§ããåˆ†ã‘ã¦6ã¤ã‚ã‚Šã¾ã™ã€‚\nã‚„ã‚Šæ–¹ã¯ç°¡å˜ã§ã€ãƒ™ãƒ¼ã‚¹ã®urlã¨æ¬²ã—ã„çµ±è¨ˆã®IDã‚’GETé–¢æ•°ã§æ¸¡ã™ã“ã¨ã«ã‚ˆã£ã¦ã€ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚å…¬å¼ã«ã‚‚ä»¥ä¸‹ã®ã‚ˆã†ã«æ›¸ã‹ã‚Œã¦ã„ã¾ã™ã€‚\n åŸºæœ¬çš„ãªä½¿ã„æ–¹ã¨ã—ã¦ã¯ã€ã¾ãšâ‘ ã€Œçµ±è¨ˆãƒ¡ã‚¿æƒ…å ±ï¼ˆç³»åˆ—ï¼‰å–å¾—ã€ã§å–å¾—ã—ãŸã„ãƒ‡ãƒ¼ã‚¿ã®[ç³»åˆ—ã‚³ãƒ¼ãƒ‰]ã‚’æ¤œç´¢ã—ã€ ãã®å¾Œâ‘¥ã€Œçµ±è¨ˆãƒ‡ãƒ¼ã‚¿å–å¾—ã€ã§[ç³»åˆ—ã‚³ãƒ¼ãƒ‰]ã‚’æ¤œç´¢æ¡ä»¶ã«æŒ‡å®šã—ã€ãã®ç³»åˆ—ã®æƒ…å ±ã‚’å–å¾—ã—ã¾ã™ã€‚ ï¼ˆâ‘¡â‘¢â‘£â‘¤ã¯è£œåŠ©çš„ãªæƒ…å ±ã¨ã—ã¦ç‹¬ç«‹ã—ã¦å–å¾—ã§ãã‚‹ã‚ˆã†ã«ã—ã¦ã„ã¾ã™ã€‚ãƒ‡ãƒ¼ã‚¿ã®ã¿å¿…è¦ãªå ´åˆã¯å½“è©²æ©Ÿèƒ½ã¯ä¸è¦ã§ã™ã€‚ï¼‰ å…·ä½“çš„ãªä½¿ã„æ–¹ã¯ã€ä»¥ä¸‹ã®ã€ŒWebAPIã®è©³ç´°ä»•æ§˜ã€ã«è¨˜è¼‰ã™ã‚‹[ãƒ™ãƒ¼ã‚¹URL]ã«æ¤œç´¢æ¡ä»¶ã¨ãªã‚‹[ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿]ã‚’\u0026quot;\u0026amp;\u0026ldquo;ã§é€£çµã—ã€HTTPãƒªã‚¯ã‚¨ã‚¹ãƒˆï¼ˆGETï¼‰ã‚’é€ä¿¡ã™ã‚‹ã“ã¨ã§ç›®çš„ã®ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—ã§ãã¾ã™ã€‚ å„ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã¯ã€Œãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿å=å€¤ã€ã®ã‚ˆã†ã«åç§°ã¨å€¤ã‚’'=\u0026lsquo;ã§çµåˆã—ã€è¤‡æ•°ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’æŒ‡å®šã™ã‚‹å ´åˆã¯ã€Œãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿å=å€¤\u0026amp;ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿å=å€¤\u0026amp;â€¦ã€ã®ã‚ˆã†ã«ãã‚Œãã‚Œã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿æŒ‡å®šã‚’\u0026rsquo;\u0026amp;\u0026lsquo;ã§çµåˆã—ã¦ãã ã•ã„ã€‚ ã¾ãŸã€ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿å€¤ã¯å¿…ãšURLã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰(æ–‡å­—ã‚³ãƒ¼ãƒ‰UTF-8)ã—ã¦ã‹ã‚‰çµåˆã—ã¦ãã ã•ã„ã€‚\n ä»Šå›ã‚‚ä»¥ä¸‹ã®æ–‡çŒ®ã‚’å‚è€ƒã«ãƒ‡ãƒ¼ã‚¿ã‚’å–ã£ã¦ããŸã„ã¨æ€ã„ã¾ã™ã€‚\nRã«ã‚ˆã‚‹ã‚¹ã‚¯ãƒ¬ã‚¤ãƒ”ãƒ³ã‚°å…¥é–€ ã¾ãšã€æœ€åˆã«ã“ã®APIã‹ã‚‰ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—ã—ã€å¾—ã‚‰ã‚ŒãŸçµæœã‚’åˆ†æã—ã‚„ã™ã„ã‚ˆã†ã«æ•´å½¢ã™ã‚‹é–¢æ•°ã‚’å®šç¾©ã—ãŸã„ã¨æ€ã„ã¾ã™ã€‚\nlibrary(httr) library(estatapi) library(dplyr) library(XML) library(stringr) library(xts) library(GGally) library(ggplot2) library(seasonal) library(dlm) library(vars) library(MASS) # é–¢æ•°ã‚’å®šç¾© get_dashboard \u0026lt;- function(ID){ base_url \u0026lt;- \u0026#34;https://dashboard.e-stat.go.jp/api/1.0/JsonStat/getData?\u0026#34; res \u0026lt;- GET( url = base_url, query = list( IndicatorCode=ID ) ) result \u0026lt;- content(res) x \u0026lt;- result$link$item[[1]]$value x \u0026lt;- t(do.call(\u0026#34;data.frame\u0026#34;,x)) date_x \u0026lt;- result$link$item[[1]]$dimension$Time$category$label date_x \u0026lt;- t(do.call(\u0026#34;data.frame\u0026#34;,date_x)) date_x \u0026lt;- str_replace_all(date_x, pattern=\u0026#34;å¹´\u0026#34;, replacement=\u0026#34;/\u0026#34;) date_x \u0026lt;- str_replace_all(date_x, pattern=\u0026#34;æœˆ\u0026#34;, replacement=\u0026#34;\u0026#34;) date_x \u0026lt;- as.Date(gsub(\u0026#34;([0-9]+)/([0-9]+)\u0026#34;, \u0026#34;\\\\1/\\\\2/1\u0026#34;, date_x)) date_x \u0026lt;- as.Date(date_x, format = \u0026#34;%m/%d/%Y\u0026#34;) date_x \u0026lt;- as.numeric(date_x) date_x \u0026lt;- as.Date(date_x, origin=\u0026#34;1970-01-01\u0026#34;) #x \u0026lt;- cbind(x,date_x) x \u0026lt;- data.frame(x) x[,1] \u0026lt;- as.character(x[,1])%\u0026gt;%as.numeric(x[,1]) colnames(x) \u0026lt;- c(result$link$item[[1]]$label) x \u0026lt;- x %\u0026gt;% mutate(\u0026#34;publication\u0026#34; = date_x) return(x) } ã¾ãšãƒ™ãƒ¼ã‚¹ã®urlã‚’å®šç¾©ã—ã¦ã„ã¾ã™ã€‚ä»Šå›ã¯ãƒ‡ãƒ¼ã‚¿ãŒæ¬²ã—ã„ã®ã§â‘¥çµ±è¨ˆãƒ‡ãƒ¼ã‚¿ã®ãƒ™ãƒ¼ã‚¹urlã‚’ä½¿ç”¨ã—ã¾ã™ï¼ˆ å‚è€ƒï¼‰ã€‚æ¬¡ã«ãƒ™ãƒ¼ã‚¹urlã¨çµ±è¨ˆIDï¼ˆIndicatorCodeï¼‰ã‚’GETé–¢æ•°ã§æ¸¡ã—ã€çµæœã‚’å–å¾—ã—ã¦ã„ã¾ã™ã€‚çµ±è¨ˆIDã«ã¤ã„ã¦ã¯ã‚¨ã‚¯ã‚»ãƒ«ãƒ•ã‚¡ã‚¤ãƒ«ã§å…¬é–‹ã•ã‚Œã¦ã„ã¾ã™ã€‚å¾—ã‚‰ã‚ŒãŸçµæœã®ä¸­èº«ï¼ˆãƒªã‚¹ãƒˆå½¢å¼ï¼‰ã‚’resultã«æ ¼ç´ã—ã€ãƒªã‚¹ãƒˆã®æ·±å±¤ã«ã‚ã‚‹åŸæ•°å€¤ãƒ‡ãƒ¼ã‚¿ï¼ˆvalueï¼‰ã‚’xã«æ ¼ç´ã—ã¾ã™ã€‚åŸæ•°å€¤ãƒ‡ãƒ¼ã‚¿ã‚‚ãƒªã‚¹ãƒˆå½¢å¼ãªã®ã§ã€ãã‚Œã‚’do.callã§ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ¬ãƒ¼ãƒ ã«å¤‰æ›ã—ã¦ã„ã¾ã™ã€‚æ¬¡ã«ã€ãƒ‡ãƒ¼ã‚¿æ—¥ä»˜ã‚’å–å¾—ã—ã¾ã™ã€‚resultã®ä¸­ã‚’æ·±ããŸã©ã‚‹ã¨Timeâ†’categoryâ†’labelã¨ã„ã†ãƒ‡ãƒ¼ã‚¿ãŒã‚ã‚Šã€ãã“ã«æ—¥ä»˜ãƒ‡ãƒ¼ã‚¿ãŒä¿å­˜ã•ã‚Œã¦ã„ã‚‹ã®ã§ã€ãã‚Œã‚’date_xã«æ ¼ç´ã—ã€åŒã˜ã‚ˆã†ã«ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ¬ãƒ¼ãƒ ã¸å¤‰æ›ã—ã¾ã™ã€‚ãƒ‡ãƒ¼ã‚¿ã®ä»•æ§˜ä¸Šã€æ—¥ä»˜ã¯ã€Œyyyyå¹´mmæœˆã€ã«ãªã£ã¦ã„ã¾ã™ãŒã€ã“ã‚Œã ã¨Rã¯æ—¥ä»˜ãƒ‡ãƒ¼ã‚¿ã¨ã—ã¦èª­ã¿å–ã£ã¦ãã‚Œãªã„ã®ã§ã€str_replace_allç­‰ã§å¤‰æ›ã—ãŸã®ã¡ã€Dateå‹ã«å¤‰æ›ã—ã¦ã„ã¾ã™ã€‚åˆ—åã«ãƒ‡ãƒ¼ã‚¿åï¼ˆresultâ†’linkâ†’item[[1]]â†’labelï¼‰ã‚’ã¤ã‘ã€ãƒ‡ãƒ¼ã‚¿æ—¥ä»˜ã‚’xã«è¿½åŠ ã—ãŸã‚‰å®Œæˆã§ã™ã€‚ ãã®ã»ã‹ã€data_connectã¨ã„ã†é–¢æ•°ã‚‚å®šç¾©ã—ã¦ã„ã¾ã™ã€‚ã“ã‚Œã¯ãƒ‡ãƒ¼ã‚¿ç³»åˆ—ã«ã‚ˆã‚Œã°ã€ãŸã¨ãˆã°æ¨è¨ˆæ–¹æ³•ã®å¤‰æ›´ãªã©ã§1980å¹´ï½2005å¹´ã®ç³»åˆ—ã¨2003å¹´ï½2018å¹´ã¾ã§ã®ç³»åˆ—ã®2ç³»åˆ—ãŒã‚ã‚‹ã‚ˆã†ãªãƒ‡ãƒ¼ã‚¿ã‚‚å­˜åœ¨ã—ã€ã“ã®2ç³»åˆ—ã‚’æ¥ç¶šã™ã‚‹ãŸã‚ã®é–¢æ•°ã§ã™ã€‚ã“ã‚Œã¯å˜ç´”ã«æ¥ç¶šã—ã¦ã„ã‚‹ã ã‘ãªã®ã§ã€èª¬æ˜ã¯çœç•¥ã—ã¾ã™ã€‚\ndata_connect \u0026lt;- function(x){ a \u0026lt;- min(which(x[,ncol(x)] != \u0026#34;NA\u0026#34;)) b \u0026lt;- x[a,ncol(x)]/x[a,1] c \u0026lt;- x[1:a-1,1]*b return(c) } ã§ã¯ã€å®Ÿéš›ã«ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—ã—ã¦ã„ãã¾ã™ã€‚ä»Šå›å–å¾—ã™ã‚‹ãƒ‡ãƒ¼ã‚¿ã¯æœˆæ¬¡ãƒ‡ãƒ¼ã‚¿ã¨ãªã£ã¦ã„ã¾ã™ã€‚ã“ã‚Œã¯çµ±è¨ˆdashboardãŒæœˆæ¬¡ä»¥ä¸‹ã®ãƒ‡ãƒ¼ã‚¿ãŒã¨ã‚Œãªã„ã‹ã‚‰ã§ã™ã€‚ãªã®ã§ã€ä¾‹ãˆã°æ—¥çµŒå¹³å‡ãªã©ã¯æœˆæœ«ã®çµ‚å€¤ã‚’å¼•ã£å¼µã£ã¦ã„ã¾ã™ã€‚ãŸã ã—ã€GDPã¯å››åŠæœŸãƒ‡ãƒ¼ã‚¿ã¨ãªã£ã¦ã„ã¾ã™ã€‚ã•ãã»ã©å®šç¾©ã—ãŸget_dashboardã®ä½¿ç”¨æ–¹æ³•ã¯ç°¡å˜ã§ã€å¼•æ•°ã«çµ±è¨ˆãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã§å…¬é–‹ã•ã‚Œã¦ã„ã‚‹çµ±è¨ˆIDã‚’å…¥åŠ›ã™ã‚‹ã ã‘ã§ãƒ‡ãƒ¼ã‚¿ãŒå–ã‚Œã¾ã™ã€‚ä»Šå›ä½¿ç”¨ã™ã‚‹ãƒ‡ãƒ¼ã‚¿ã‚’ä»¥ä¸‹ã®è¡¨ã«ã¾ã¨ã‚ã¾ã—ãŸã€‚\n# ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾— Nikkei \u0026lt;- get_dashboard(\u0026#34;0702020501000010010\u0026#34;) callrate \u0026lt;- get_dashboard(\u0026#34;0702020300000010010\u0026#34;) TOPIX \u0026lt;- get_dashboard(\u0026#34;0702020590000090010\u0026#34;) kikai \u0026lt;- get_dashboard(\u0026#34;0701030000000010010\u0026#34;) kigyo.bukka \u0026lt;- get_dashboard(\u0026#34;0703040300000090010\u0026#34;) money.stock1 \u0026lt;- get_dashboard(\u0026#34;0702010201000010030\u0026#34;) money.stock2 \u0026lt;- get_dashboard(\u0026#34;0702010202000010030\u0026#34;) money.stock \u0026lt;- dplyr::full_join(money.stock1,money.stock2,by=\u0026#34;publication\u0026#34;) c \u0026lt;- data_connect(money.stock) a \u0026lt;- min(which(money.stock[,ncol(money.stock)] != \u0026#34;NA\u0026#34;)) money.stock[1:a-1,ncol(money.stock)] \u0026lt;- c money.stock \u0026lt;- money.stock[,c(2,3)] cpi \u0026lt;- get_dashboard(\u0026#34;0703010401010090010\u0026#34;) export.price \u0026lt;- get_dashboard(\u0026#34;0703050301000090010\u0026#34;) import.price \u0026lt;- get_dashboard(\u0026#34;0703060301000090010\u0026#34;) import.price$`è¼¸å‡ºç‰©ä¾¡æŒ‡æ•°ï¼ˆç·å¹³å‡ï¼‰ï¼ˆå††ãƒ™ãƒ¼ã‚¹ï¼‰2015å¹´åŸºæº–` \u0026lt;- NULL public.expenditure1 \u0026lt;- get_dashboard(\u0026#34;0802020200000010010\u0026#34;) public.expenditure2 \u0026lt;- get_dashboard(\u0026#34;0802020201000010010\u0026#34;) public.expenditure \u0026lt;- dplyr::full_join(public.expenditure1,public.expenditure2,by=\u0026#34;publication\u0026#34;) c \u0026lt;- data_connect(public.expenditure) a \u0026lt;- min(which(public.expenditure[,ncol(public.expenditure)] != \u0026#34;NA\u0026#34;)) public.expenditure[1:a-1,ncol(public.expenditure)] \u0026lt;- c public.expenditure \u0026lt;- public.expenditure[,c(2,3)] export.service \u0026lt;- get_dashboard(\u0026#34;1601010101000010010\u0026#34;) working.population \u0026lt;- get_dashboard(\u0026#34;0201010010000010020\u0026#34;) yukoukyuujinn \u0026lt;- get_dashboard(\u0026#34;0301020001000010010\u0026#34;) hours_worked \u0026lt;- get_dashboard(\u0026#34;0302010000000010000\u0026#34;) nominal.wage \u0026lt;- get_dashboard(\u0026#34;0302020000000010000\u0026#34;) iip \u0026lt;- get_dashboard(\u0026#34;0502070101000090010\u0026#34;) shukka.shisu \u0026lt;- get_dashboard(\u0026#34;0502070102000090010\u0026#34;) zaiko.shisu \u0026lt;- get_dashboard(\u0026#34;0502070103000090010\u0026#34;) sanji.sangyo \u0026lt;- get_dashboard(\u0026#34;0603100100000090010\u0026#34;) retail.sells \u0026lt;- get_dashboard(\u0026#34;0601010201010010000\u0026#34;) GDP1 \u0026lt;- get_dashboard(\u0026#34;0705020101000010000\u0026#34;) GDP2 \u0026lt;- get_dashboard(\u0026#34;0705020301000010000\u0026#34;) GDP \u0026lt;- dplyr::full_join(GDP1,GDP2,by=\u0026#34;publication\u0026#34;) c \u0026lt;- data_connect(GDP) a \u0026lt;- min(which(GDP[,ncol(GDP)] != \u0026#34;NA\u0026#34;)) GDP[1:a-1,ncol(GDP)] \u0026lt;- c GDP \u0026lt;- GDP[,c(2,3)] yen \u0026lt;- get_dashboard(\u0026#34;0702020401000010010\u0026#34;) household.consumption \u0026lt;- get_dashboard(\u0026#34;0704010101000010001\u0026#34;) JGB10y \u0026lt;- get_dashboard(\u0026#34;0702020300000010020\u0026#34;) ä»Šå–å¾—ã—ãŸãƒ‡ãƒ¼ã‚¿ã¯åŸæ•°å€¤ç³»åˆ—ã®ãƒ‡ãƒ¼ã‚¿ãŒå¤šã„ã®ã§ã€ãã‚Œã‚‰ã¯å­£ç¯€èª¿æ•´ã‚’ã‹ã‘ã¾ã™ã€‚ãªãœå­£ç¯€èª¿æ•´æ¸ˆã¿ã®ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—ã—ãªã„ã®ã‹ã¨ã„ã†ã¨ãã‚Œã‚‰ã®ãƒ‡ãƒ¼ã‚¿ã¯ä½•æ•…ã‹æ¥µç«¯ã«ã‚µãƒ³ãƒ—ãƒ«æœŸé–“ãŒçŸ­ããªã£ã¦ã—ã¾ã†ã‹ã‚‰ã§ã™ã€‚ã“ã“ã‚‰ã¸ã‚“ã¯ä½¿ã„å‹æ‰‹ãŒæ‚ªã„ã§ã™ã€‚\n# å­£ç¯€èª¿æ•´ã‚’ã‹ã‘ã‚‹ Sys.setenv(X13_PATH = \u0026#34;C:\\\\Program Files\\\\WinX13\\\\x13as\u0026#34;) checkX13() seasoning \u0026lt;- function(data,i,start.y,start.m){ timeseries \u0026lt;- ts(data[,i],frequency = 12,start=c(start.y,start.m)) m \u0026lt;- seas(timeseries) summary(m$data) return(m$series$s11) } k \u0026lt;- seasoning(kikai,1,2005,4) kikai$`æ©Ÿæ¢°å—æ³¨é¡ï¼ˆèˆ¹èˆ¶ãƒ»é›»åŠ›ã‚’é™¤ãæ°‘éœ€ï¼‰` \u0026lt;- as.numeric(k) k \u0026lt;- seasoning(kigyo.bukka,1,1960,1) kigyo.bukka$`å›½å†…ä¼æ¥­ç‰©ä¾¡æŒ‡æ•°ï¼ˆç·å¹³å‡ï¼‰2015å¹´åŸºæº–` \u0026lt;- as.numeric(k) k \u0026lt;- seasoning(cpi,1,1970,1) cpi$`æ¶ˆè²»è€…ç‰©ä¾¡æŒ‡æ•°ï¼ˆç”Ÿé®®é£Ÿå“ã‚’é™¤ãç·åˆï¼‰2015å¹´åŸºæº–` \u0026lt;- as.numeric(k) k \u0026lt;- seasoning(export.price,1,1960,1) export.price$`è¼¸å‡ºç‰©ä¾¡æŒ‡æ•°ï¼ˆç·å¹³å‡ï¼‰ï¼ˆå††ãƒ™ãƒ¼ã‚¹ï¼‰2015å¹´åŸºæº–` \u0026lt;- as.numeric(k) k \u0026lt;- seasoning(import.price,1,1960,1) import.price$`è¼¸å…¥ç‰©ä¾¡æŒ‡æ•°ï¼ˆç·å¹³å‡ï¼‰ï¼ˆå††ãƒ™ãƒ¼ã‚¹ï¼‰2015å¹´åŸºæº–` \u0026lt;- as.numeric(k) k \u0026lt;- seasoning(public.expenditure,2,2004,4) public.expenditure$å…¬å…±å·¥äº‹å—æ³¨é¡ \u0026lt;- as.numeric(k) k \u0026lt;- seasoning(export.service,1,1996,1) export.service$`è²¿æ˜“ãƒ»ã‚µãƒ¼ãƒ“ã‚¹åæ”¯` \u0026lt;- as.numeric(k) k \u0026lt;- seasoning(yukoukyuujinn,1,1963,1) yukoukyuujinn$æœ‰åŠ¹æ±‚äººå€ç‡ \u0026lt;- as.numeric(k) k \u0026lt;- seasoning(hours_worked,1,1990,1) hours_worked$ç·å®ŸåŠ´åƒæ™‚é–“ \u0026lt;- as.numeric(k) k \u0026lt;- seasoning(nominal.wage,1,1990,1) nominal.wage$ç¾é‡‘çµ¦ä¸ç·é¡ \u0026lt;- as.numeric(k) k \u0026lt;- seasoning(iip,1,1978,1) iip$`é‰±å·¥æ¥­ç”Ÿç”£æŒ‡æ•°ã€€2010å¹´åŸºæº–` \u0026lt;- as.numeric(k) k \u0026lt;- seasoning(shukka.shisu,1,1990,1) shukka.shisu$`é‰±å·¥æ¥­å‡ºè·æŒ‡æ•°ã€€2010å¹´åŸºæº–` \u0026lt;- as.numeric(k) k \u0026lt;- seasoning(zaiko.shisu,1,1990,1) zaiko.shisu$`é‰±å·¥æ¥­åœ¨åº«æŒ‡æ•°ã€€2010å¹´åŸºæº–` \u0026lt;- as.numeric(k) k \u0026lt;- seasoning(sanji.sangyo,1,1988,1) sanji.sangyo$`ç¬¬ï¼“æ¬¡ç”£æ¥­æ´»å‹•æŒ‡æ•°ã€€2010å¹´åŸºæº–` \u0026lt;- as.numeric(k) k \u0026lt;- seasoning(retail.sells,1,1980,1) retail.sells$`å°å£²æ¥­è²©å£²é¡ï¼ˆåç›®ï¼‰` \u0026lt;- as.numeric(k) k \u0026lt;- seasoning(household.consumption,1,2010,1) household.consumption$`äºŒäººä»¥ä¸Šã®ä¸–å¸¯ã€€æ¶ˆè²»æ”¯å‡ºï¼ˆé™¤ãä½å±…ç­‰ï¼‰` \u0026lt;- as.numeric(k) GDP.ts \u0026lt;- ts(GDP[,2],frequency = 4,start=c(1980,1)) m \u0026lt;- seas(GDP.ts) GDP$`å›½å†…ç·ç”Ÿç”£ï¼ˆæ”¯å‡ºå´ï¼‰ï¼ˆå®Ÿè³ªï¼‰2011å¹´åŸºæº–` \u0026lt;- m$series$s11 ã“ã“ã§ã¯è©³ã—ãå­£ç¯€èª¿æ•´ã®ã‹ã‘æ–¹ã¯èª¬æ˜ã—ã¾ã›ã‚“ã€‚x13arimaã‚’ä½¿ç”¨ã—ã¦ã„ã¾ã™ã€‚ä¸Šè¿°ã®ã‚³ãƒ¼ãƒ‰ã‚’å›ã™éš›ã¯x13arimaãŒã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã¦ã„ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚ä»¥ä¸‹ã®è¨˜äº‹ã‚’å‚è€ƒã«ã—ã¦ãã ã•ã„ã€‚\n[http://sinhrks.hatenablog.com/entry/2014/11/09/003632]\nã§ã¯ã€ãƒ‡ãƒ¼ã‚¿æ—¥ä»˜ã‚’åŸºæº–ã«è½ã¨ã—ã¦ããŸãƒ‡ãƒ¼ã‚¿ã‚’çµåˆã—ã€ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã‚’ä½œæˆã—ã¾ã™ã€‚\n# ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã«çµåˆ dataset \u0026lt;- dplyr::full_join(kigyo.bukka,callrate,by=\u0026#34;publication\u0026#34;) dataset \u0026lt;- dplyr::full_join(dataset,kikai,by=\u0026#34;publication\u0026#34;) dataset \u0026lt;- dplyr::full_join(dataset,Nikkei,by=\u0026#34;publication\u0026#34;) dataset \u0026lt;- dplyr::full_join(dataset,money.stock,by=\u0026#34;publication\u0026#34;) dataset \u0026lt;- dplyr::full_join(dataset,cpi,by=\u0026#34;publication\u0026#34;) dataset \u0026lt;- dplyr::full_join(dataset,export.price,by=\u0026#34;publication\u0026#34;) dataset \u0026lt;- dplyr::full_join(dataset,import.price,by=\u0026#34;publication\u0026#34;) dataset \u0026lt;- dplyr::full_join(dataset,public.expenditure,by=\u0026#34;publication\u0026#34;) dataset \u0026lt;- dplyr::full_join(dataset,export.service,by=\u0026#34;publication\u0026#34;) dataset \u0026lt;- dplyr::full_join(dataset,working.population,by=\u0026#34;publication\u0026#34;) dataset \u0026lt;- dplyr::full_join(dataset,yukoukyuujinn,by=\u0026#34;publication\u0026#34;) dataset \u0026lt;- dplyr::full_join(dataset,hours_worked,by=\u0026#34;publication\u0026#34;) dataset \u0026lt;- dplyr::full_join(dataset,nominal.wage,by=\u0026#34;publication\u0026#34;) dataset \u0026lt;- dplyr::full_join(dataset,iip,by=\u0026#34;publication\u0026#34;) dataset \u0026lt;- dplyr::full_join(dataset,shukka.shisu,by=\u0026#34;publication\u0026#34;) dataset \u0026lt;- dplyr::full_join(dataset,zaiko.shisu,by=\u0026#34;publication\u0026#34;) dataset \u0026lt;- dplyr::full_join(dataset,sanji.sangyo,by=\u0026#34;publication\u0026#34;) dataset \u0026lt;- dplyr::full_join(dataset,retail.sells,by=\u0026#34;publication\u0026#34;) dataset \u0026lt;- dplyr::full_join(dataset,yen,by=\u0026#34;publication\u0026#34;) colnames(dataset) \u0026lt;- c(\u0026#34;DCGPI\u0026#34;,\u0026#34;publication\u0026#34;,\u0026#34;callrate\u0026#34;,\u0026#34;Machinery_Orders\u0026#34;, \u0026#34;Nikkei225\u0026#34;,\u0026#34;money_stock\u0026#34;,\u0026#34;CPI\u0026#34;,\u0026#34;export_price\u0026#34;, \u0026#34;import_price\u0026#34;,\u0026#34;public_works_order\u0026#34;, \u0026#34;trade_service\u0026#34;,\u0026#34;working_population\u0026#34;, \u0026#34;active_opening_ratio\u0026#34;,\u0026#34;hours_worked\u0026#34;, \u0026#34;wage\u0026#34;,\u0026#34;iip_production\u0026#34;,\u0026#34;iip_shipment\u0026#34;,\u0026#34;iip_inventory\u0026#34;, \u0026#34;ITIA\u0026#34;,\u0026#34;retail_sales\u0026#34;,\u0026#34;yen\u0026#34;) æœ€å¾Œã«åˆ—åã‚’ã¤ã‘ã¦ã„ã¾ã™ã€‚datasetã¯ãã‚Œãã‚Œã®ãƒ‡ãƒ¼ã‚¿ã®å…¬è¡¨é–‹å§‹æ™‚æœŸãŒç•°ãªã‚‹ãŸã‚ã«å¤§é‡ã®NAã‚’å«ã‚€ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ¬ãƒ¼ãƒ ã¨ãªã£ã¦ã„ã‚‹ã®ã§ã€NAã‚’å‰Šé™¤ã™ã‚‹ãŸã‚ã«æœ€ã‚‚ãƒ‡ãƒ¼ã‚¿ã®é–‹å§‹æ™‚æœŸãŒé…ã„æ©Ÿæ¢°å—æ³¨çµ±è¨ˆã«åˆã‚ã›ã¦ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã‚’å†æ§‹ç¯‰ã—ã¾ã™ã€‚\na \u0026lt;- min(which(dataset$Machinery_Orders != \u0026#34;NA\u0026#34;)) dataset1 \u0026lt;- dataset[a:nrow(dataset),] dataset1 \u0026lt;- na.omit(dataset1) rownames(dataset1) \u0026lt;- dataset1$publication dataset1 \u0026lt;- dataset1[,-2] dataset1.xts \u0026lt;- xts(dataset1,order.by = as.Date(rownames(dataset1))) ã“ã‚Œã§ã¨ã‚Šã‚ãˆãšãƒ‡ãƒ¼ã‚¿ã®åé›†ã¯çµ‚ã‚ã‚Šã¾ã—ãŸã€‚\n3. å¾—ã‚‰ã‚ŒãŸãƒ‡ãƒ¼ã‚¿ã‚’ä¸»æˆåˆ†åˆ†æã«ã‹ã‘ã¦ã¿ã‚‹ æœ¬æ ¼çš„ãªåˆ†æã¯ã¾ãŸä»Šå¾Œã«ã—ãŸã„ã®ã§ã™ãŒã€ãƒ‡ãƒ¼ã‚¿ã‚’é›†ã‚ã‚‹ã ã‘ã§ã¯é¢ç™½ããªã„ã®ã§ã€Gianonneã‚‰ã®ã‚ˆã†ã«ä¸»æˆåˆ†åˆ†æã‚’è¡Œã„ãŸã„ã¨æ€ã„ã¾ã™ã€‚ä¸»æˆåˆ†åˆ†æã‚’ã“ã‚Œã¾ã§ã«å­¦ã‚“ã ã“ã¨ã®ãªã„æ–¹ã¯ä»¥ä¸‹ã‚’å‚è€ƒã«ã—ã¦ãã ã•ã„ã€‚å€‹äººçš„ã«ã¯ã‚ã‹ã‚Šã‚„ã™ã„ã¨æ€ã£ã¦ã„ã¾ã™ã€‚\nä¸»æˆåˆ†åˆ†æ(Principal Component Analysis, PCA)ï½ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã®è¦‹ãˆã‚‹åŒ–ãƒ»å¯è¦–åŒ–ã¨ã„ã£ãŸã‚‰ã¾ãšã¯ã“ã‚Œï¼ï½\nã§ã¯ä¸»æˆåˆ†åˆ†æã‚’å®Ÿè¡Œã—ã¦ã¿ã¾ã™ã€‚Rã§ã¯prcompé–¢æ•°ã‚’ä½¿ç”¨ã™ã‚‹ã“ã¨ã§éå¸¸ã«ç°¡å˜ã«ä¸»æˆåˆ†åˆ†æã‚’è¡Œã†ã“ã¨ãŒã§ãã¾ã™ã€‚\n# ä¸»æˆåˆ†åˆ†æã‚’å®Ÿè¡Œ factor.pca \u0026lt;- prcomp(x=dataset1, cor = TRUE) # cor = TRUEã§ãƒ‡ãƒ¼ã‚¿ã®åŸºæº–åŒ–ã‚’è‡ªå‹•ã§è¡Œã£ã¦ãã‚Œã‚‹ã€‚ summary(factor.pca) ## Importance of components:\r## PC1 PC2 PC3 PC4 PC5 PC6\r## Standard deviation 1.855e+06 4.268e+05 1.777e+05 1.204e+05 3.967e+04 3733\r## Proportion of Variance 9.374e-01 4.963e-02 8.610e-03 3.950e-03 4.300e-04 0\r## Cumulative Proportion 9.374e-01 9.870e-01 9.956e-01 9.996e-01 1.000e+00 1\r## PC7 PC8 PC9 PC10 PC11 PC12 PC13 PC14 PC15\r## Standard deviation 1347 1063 134.4 4.338 3.66 2.088 1.757 0.8261 0.7207\r## Proportion of Variance 0 0 0.0 0.000 0.00 0.000 0.000 0.0000 0.0000\r## Cumulative Proportion 1 1 1.0 1.000 1.00 1.000 1.000 1.0000 1.0000\r## PC16 PC17 PC18 PC19 PC20 PC21\r## Standard deviation 0.5309 0.3752 0.2632 0.1085 0.01238 0.01038\r## Proportion of Variance 0.0000 0.0000 0.0000 0.0000 0.00000 0.00000\r## Cumulative Proportion 1.0000 1.0000 1.0000 1.0000 1.00000 1.00000\rscreeplot(factor.pca) pc.xts \u0026lt;- xts(factor.pca$x[,1:3], order.by = as.Date(rownames(dataset1))) plot.zoo(pc.xts,col=c(\u0026#34;red\u0026#34;,\u0026#34;blue\u0026#34;,\u0026#34;green\u0026#34;,\u0026#34;purple\u0026#34;,\u0026#34;yellow\u0026#34;),plot.type = \u0026#34;single\u0026#34;) # ä¸»æˆåˆ†ã‚’æ™‚ç³»åˆ—ãƒ—ãƒ­ãƒƒãƒˆ ç¬¬3ä¸»æˆåˆ†ã¾ã§ã§ãƒ‡ãƒ¼ã‚¿ã®ç´„80ï¼…ãŒèª¬æ˜ã§ãã‚‹çµæœã‚’å¾—ãŸã®ã§ã€ç¬¬3ä¸»æˆåˆ†ã¾ã§ã®ãƒ—ãƒ­ãƒƒãƒˆã‚’ãŠè¦‹ã›ã—ã¾ã™ã€‚ç¬¬1ä¸»æˆåˆ†ï¼ˆèµ¤ï¼‰ã¯ãƒˆãƒ¬ãƒ³ãƒ‰ã‚’è¡¨ã—ã¦ãŠã‚Šã€ã“ã‚Œã‹ã‚‰æ™¯æ°—ã®è¶¨å‹¢ã‚’èª­ã¿å–ã‚Œã‚‹ã¨æ€ã„ã¾ã™ã€‚ç¬¬2ä¸»æˆåˆ†ï¼ˆé’ï¼‰ã¯æ™¯æ°—å¾ªç’°é …ã§ã—ã‚‡ã†ã‹ã€‚å‘¨æœŸçš„ãªå‹•ããŒèª­ã¿å–ã‚Œã¾ã™ã€‚ç¬¬3ä¸»æˆåˆ†ï¼ˆç·‘ï¼‰ã¯2014å¹´ã«å¤§ããä¸Šæ˜‡ã—ã¦ã„ã¾ã™ãŒã€ãã‚Œä»¥å¤–ã¯ç‰¹ã«ç›®ç«‹ã£ãŸå‹•ãã¯ã‚ã‚Šã¾ã›ã‚“ã€‚è¬ã§ã™ã­ã€‚ã¨ã‚Šã‚ãˆãšä»Šæ—¥ã¯ã“ã‚Œã¾ã§ã€‚æ™‚ç³»åˆ—ãƒ‡ãƒ¼ã‚¿ã‚’ãƒˆãƒ¬ãƒ³ãƒ‰é …ã€å¾ªç’°é …ã€èª¤å·®é …ã«åˆ†è§£ã—ãŸã‚ˆã†ãªçµæœã§ã—ãŸã€‚æ¬¡å›ã¯Gianonne et. al.(2008)ã®æ—¥æœ¬ç‰ˆã®å†ç¾ã‚’è¡Œã„ãŸã„ã¨æ€ã„ã¾ã™ã€‚\n","date":1531526400,"expirydate":-62135596800,"kind":"page","lang":"ja","lastmod":1531526400,"objectID":"0f37a544ce2716192b081086f7f67b23","permalink":"/post/post7/","publishdate":"2018-07-14T00:00:00Z","relpermalink":"/post/post7/","section":"post","summary":"Rã§ãƒ‡ãƒ¼ã‚¿é›†ã‚ã‚’ã—ã¾ã™ã€‚ãƒ‡ãƒ¼ã‚¿åˆ†æã¯ãƒ‡ãƒ¼ã‚¿é›†ã‚ã¨å‰å‡¦ç†ãŒ7å‰²ã‚’å ã‚ã‚‹ã¨ã„ã‚ã‚Œã‚‹ä¸­ã€ãƒ‡ãƒ¼ã‚¿é›†ã‚ã‚’è‡ªå‹•åŒ–ã™ã¹ãã‚¦ã‚§ãƒ–ã‚¹ã‚¯ãƒ¬ã‚¤ãƒ”ãƒ³ã‚°ã‚’è¡Œã„ã¾ã—ãŸã€‚","tags":["R","API"],"title":"æ—¥æ¬¡GDPæ¨è¨ˆã«ä½¿ç”¨ã™ã‚‹çµŒæ¸ˆçµ±è¨ˆã‚’çµ±è¨ˆãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã‹ã‚‰é›†ã‚ã¦ã¿ãŸ","type":"post"},{"authors":null,"categories":["ç«¶é¦¬","Webã‚¹ã‚¯ãƒ¬ã‚¤ãƒ”ãƒ³ã‚°"],"content":"ã¿ãªã•ã‚“ã€ãŠã¯ã“ã‚“ã°ã‚“ã«ã¡ã¯ã€‚\nç«¶é¦¬ã®ãƒ¬ãƒ¼ã‚¹çµæœã‚’çš„ä¸­ã•ã›ã‚‹ãƒ¢ãƒ‡ãƒ«ã‚’ä½œã‚ã†ã¨ã„ã†ã“ã¨ã§ç ”ç©¶ã‚’ã¯ã˜ã‚ã¾ã—ãŸãŒã€ã¾ãšã¯ãƒ‡ãƒ¼ã‚¿ã‚’è‡ªåˆ†ã§å–ã£ã¦ãã‚‹ã¨ã“ã‚ã‹ã‚‰ã‚„ã‚ã†ã¨ãŠã‚‚ã„ã¾ã™ã€‚ã©ã“ã‹ã‚‰ãƒ‡ãƒ¼ã‚¿ã‚’å–ã£ã¦ãã‚‹ã®ã‹ã¨ã„ã†ç‚¹ãŒé‡è¦ã«ãªã‚‹ã‚ã‘ã§ã™ãŒã€ãƒ‡ãƒ¼ã‚¿å…ˆã¨ã—ã¦ã¯datascisotistã•ã‚“ãŒã¾ã¨ã‚ã‚‰ã‚ŒãŸéå¸¸ã«ã‚ã‹ã‚Šã‚„ã™ã„è¨˜äº‹ãŒã‚ã‚Šã¾ã™ã€‚ã©ã“ã‹ã‚‰ãƒ‡ãƒ¼ã‚¿ãŒå–ã‚Œã‚‹ã®ã‹ã¨ã„ã†ã¨å¤§ããåˆ†ã‘ã¦äºŒã¤ã§ã€â‘ JRAæä¾›ã®JRA-VANã‚„é›»å­ç«¶é¦¬æ–°èã§ãŠãªã˜ã¿ã®ï¼ŸJRJDã¨ã„ã£ãŸãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã€â‘¡netkeibaã€yahooç«¶é¦¬ã¨ã¨ã„ã£ãŸç«¶é¦¬æƒ…å ±ã‚µã‚¤ãƒˆã€ã¨ãªã£ã¦ã„ã¾ã™ã€‚â‘¡ã®å ´åˆã¯è‡ªåˆ†ã§ã‚³ãƒ¼ãƒ‰ã‚’æ›¸ãã€ã‚¯ãƒ­ãƒ¼ãƒªãƒ³ã‚°ã‚’è¡Œã†å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚ä»Šå›ã¯â‘¡ã‚’é¸æŠã—ã€yahooç«¶é¦¬ã®ãƒ‡ãƒ¼ã‚¿ã‚’ã‚¯ãƒ­ãƒ¼ãƒªãƒ³ã‚°ã§è½ã¨ã—ã¦ããŸã„ã¨æ€ã„ã¾ã™ã€‚Rã§ã‚¯ãƒ­ãƒ¼ãƒªãƒ³ã‚°ã‚’è¡Œã†ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã¨ã—ã¦ã¯ã€rvest, httr, XMLãŒã‚ã‚Šã¾ã™ãŒã€ä»Šå›ã¯1ç•ªç°¡å˜ã«ä½¿ãˆã‚‹rvestã‚’ç”¨ã„ã¾ã™ã€‚yahooç«¶é¦¬ã§ã¯ä»¥ä¸‹ã®ã‚ˆã†ã«å„ãƒ¬ãƒ¼ã‚¹çµæœãŒè¡¨ã«ã¾ã¨ã‚ã‚‰ã‚Œã¦ã„ã¾ã™ï¼ˆ5æœˆã®æ—¥æœ¬ãƒ€ãƒ¼ãƒ“ãƒ¼ã®çµæœï¼‰ã€‚\nyahooç«¶é¦¬\nå„é¦¬ã®ã–ã£ãã‚Šã¨ã—ãŸç‰¹å¾´ã‚„ãƒ¬ãƒ¼ã‚¹çµæœï¼ˆé€šéé †ä½ç­‰å«ã‚€ï¼‰ã€ã‚ªãƒƒã‚ºãŒæ²è¼‰ã•ã‚Œã¦ã„ã¾ã™ã€‚ã¨ã‚Šã‚ãˆãšã€ã“ã®ãã‚‰ã„æƒ…å ±ãŒã‚ã‚Œã°è‰¯ã„ã®ã§ã¯ãªã„ã‹ã¨æ€ã„ã¾ã™ï¼ˆã‚ªãƒƒã‚ºã®æƒ…å ±ã¯ã‚‚ã†å°‘ã—æ¬²ã—ã„ã®ã§ã™ãŒï¼‰ã€‚ãŸã ã€ä»Šå¾Œã¯å°‘ã—ãšã¤å¿…è¦ã«ãªã£ãŸæƒ…å ±ã‚’æ‹¡å……ã—ã¦ã„ã“ã†ã¨ã‚‚æ€ã£ã¦ã„ã¾ã™ã€‚1986å¹´ã¾ã§ã®ãƒ¬ãƒ¼ã‚¹çµæœãŒæ ¼ç´ã•ã‚Œã¦ãŠã‚Šã€å…¨ãƒ‡ãƒ¼ã‚¿æ•°ã¯50ä¸‡ä»¶ã‚’è¶…ãˆã‚‹ã®ã§ã¯ãªã„ã‹ã¨æ€ã£ã¦ã„ã¾ã™ã€‚ãŸã ã€å˜å‹ã‚ªãƒƒã‚ºãŒåˆ©ç”¨ã§ãã‚‹ã®ã¯1994å¹´ã‹ã‚‰ã®ã‚ˆã†ãªã®ã§ä»Šå›ã¯1994å¹´ã‹ã‚‰ç›´è¿‘ã¾ã§ã®ãƒ‡ãƒ¼ã‚¿ã‚’è½ã¨ã—ã¦ãã¾ã™ã€‚ä»Šå›ã®ã‚´ãƒ¼ãƒ«ã¯ã€ã“ã®ãƒ‡ãƒ¼ã‚¿ã‚’csvãƒ•ã‚¡ã‚¤ãƒ« or SQLã«æ ¼ç´ã™ã‚‹ã“ã¨ã§ã™ã€‚\n1. Rvestã¨ã¯ Rvestã¨ã¯ã€webã‚¹ã‚¯ãƒ¬ã‚¤ãƒ”ãƒ³ã‚°ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®ä¸€ç¨®ã§dplyrã§ãŠãªã˜ã¿ã®Hadley Wickhamã•ã‚“ã«ã‚ˆã£ã¦ä½œæˆã•ã‚ŒãŸãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã§ã™ã€‚ãŸã£ãŸæ•°è¡Œã§webã‚¹ã‚¯ãƒ¬ã‚¤ãƒ”ãƒ³ã‚°ãŒã§ãã‚‹å„ªã‚Œã‚‚ã®ã¨ãªã£ã¦ãŠã‚Šã€æ“ä½œãŒéå¸¸ã«ç°¡å˜ã§ã‚ã‚‹ã®ãŒç‰¹å¾´ã§ã™ã€‚ä»Šå›ã¯ä»¥ä¸‹ã®æœ¬ã‚’å‚è€ƒã«ã—ã¾ã—ãŸã€‚\nRã«ã‚ˆã‚‹ã‚¹ã‚¯ãƒ¬ã‚¤ãƒ”ãƒ³ã‚°å…¥é–€ ãã‚‚ãã‚‚ã€htmlã‚‚å¤§å­¦1å¹´ç”Ÿã«ã‚„ã£ãŸç¨‹åº¦ã§ã»ã¨ã‚“ã©å¿˜ã‚Œã¦ã„ãŸã®ã§ã™ãŒã€ã“ã®æœ¬ã¯ãã“ã‚‚éå¸¸ã«ã‚ã‹ã‚Šã‚„ã™ãè§£èª¬ã•ã‚Œã¦ãŠã‚Šã€éå¸¸ã«å®Ÿè·µçš„ãªæœ¬ã ã¨æ€ã„ã¾ã™ã€‚\n2. ãƒ¬ãƒ¼ã‚¹çµæœã‚’ã‚¹ã‚¯ãƒ¬ã‚¤ãƒ”ãƒ³ã‚°ã—ã¦ã¿ã‚‹ å®Ÿéš›ã«yahooç«¶é¦¬ã‹ã‚‰ãƒ‡ãƒ¼ã‚¿ã‚’è½ã¨ã—ã¦ã¿ãŸã„ã¨æ€ã„ã¾ã™ã€‚ã‚³ãƒ¼ãƒ‰ã¯ä»¥ä¸‹ã®ã‚ˆã†ã«ãªã£ã¦ã„ã¾ã™ã€‚ã”ç•™æ„é ‚ããŸã„ã®ã¯ã“ã®ã‚³ãƒ¼ãƒ‰ã‚’ãã®ã¾ã¾ä½¿ç”¨ã—ã¦ã‚¹ã‚¯ãƒ¬ã‚¤ãƒ”ãƒ³ã‚°ã‚’è¡Œã†ã“ã¨ã¯ã”é æ…®ã„ãŸã ããŸã„ã¨ã„ã†äº‹ã§ã™ã€‚webã‚¹ã‚¯ãƒ¬ã‚¤ãƒ”ãƒ³ã‚°ã¯é«˜é€Ÿã§ã‚µã‚¤ãƒˆã«ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹ãŸã‚ã€ã‚µã‚¤ãƒˆã¸ã®è² è·ãŒå¤§ãããªã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚ã‚¹ã‚¯ãƒ¬ã‚¤ãƒ”ãƒ³ã‚°ã‚’è¡Œã†éš›ã¯ã€æ™‚é–“ã‚’ç©ºã‘ã‚‹ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã™ã‚‹ãªã©ãã®ç‚¹ã«ç•™æ„ã‚’ã—ã¦è¡Œã£ã¦ãã ã•ã„ï¼ˆæœ€æ‚ªè¨´ãˆã‚‰ã‚Œã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ãŒã€ã“ã¡ã‚‰ã¯ä¸€åˆ‡ã®è²¬ä»»ã‚’å–ã‚Šã¾ã›ã‚“ï¼‰ã€‚\n# rvestã«ã‚ˆã‚‹ç«¶é¦¬ãƒ‡ãƒ¼ã‚¿ã®webã‚¹ã‚¯ãƒ¬ã‚¤ãƒ”ãƒ³ã‚° #install.packages(\u0026#34;rvest\u0026#34;) #if (!require(\u0026#34;pacman\u0026#34;)) install.packages(\u0026#34;pacman\u0026#34;) pacman::p_load(qdapRegex) library(rvest) library(stringr) library(dplyr) ä½¿ç”¨ã™ã‚‹ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã¯qdapRegexã€rvestã€stringrã€dplyrã§ã™ã€‚qdapRegexã¯ã‚«ãƒƒã‚³å†…ã®æ–‡å­—ã‚’å–ã‚Šå‡ºã™ãŸã‚ã«ä½¿ç”¨ã—ã¦ã„ã¾ã™ã€‚\nkeiba.yahoo \u0026lt;- read_html(str_c(\u0026#34;https://keiba.yahoo.co.jp/schedule/list/2016/?month=\u0026#34;,k)) race_url \u0026lt;- keiba.yahoo %\u0026gt;% html_nodes(\u0026#34;a\u0026#34;) %\u0026gt;% html_attr(\u0026#34;href\u0026#34;) # å…¨urlã‚’å–å¾— # ãƒ¬ãƒ¼ã‚¹çµæœã®ã‚’urlã‚’å–å¾— race_url \u0026lt;- race_url[str_detect(race_url, pattern=\u0026#34;result\u0026#34;)==1] # ã€Œresultã€ãŒå«ã¾ã‚Œã‚‹urlã‚’æŠ½å‡º ã¾ãšã€read_htmlã§yahooç«¶é¦¬ã®ãƒ¬ãƒ¼ã‚¹çµæœä¸€è¦§ã®htmlæ§‹é€ ã‚’å¼•ã£å¼µã£ã¦ãã¾ã™ï¼ˆãƒªãƒ³ã‚¯ã¯2016å¹´1æœˆã®å…¨ãƒ¬ãƒ¼ã‚¹ï¼‰ã€‚ã“ã“ã§ã€kã¨å‡ºã¦ã„ã‚‹ã®ã¯æœˆã‚’è¡¨ã—ã€k=1ã§ã‚ã‚Œã°2016å¹´1æœˆã®ãƒ¬ãƒ¼ã‚¹çµæœã‚’å¼•ã£å¼µã£ã¦ãã‚‹ã¨ã„ã†ã“ã¨ã§ã™ã€‚keiba.yahooã‚’è¦—ã„ã¦ã¿ã‚‹ã¨ä»¥ä¸‹ã®ã‚ˆã†ã«ãã®ãƒšãƒ¼ã‚¸å…¨ä½“ã®htmlæ§‹é€ ãŒæ ¼ç´ã•ã‚Œã¦ã„ã‚‹ã®ãŒåˆ†ã‹ã‚Šã¾ã™ã€‚\nkeiba.yahoo ## {html_document}\r## \u0026lt;html xmlns=\u0026quot;http://www.w3.org/1999/xhtml\u0026quot;\u0026gt;\r## [1] \u0026lt;head\u0026gt;\\n\u0026lt;!---äº¬---\u0026gt;\u0026lt;meta http-equiv=\u0026quot;Content-Type\u0026quot; content=\u0026quot;text/html; cha ...\r## [2] \u0026lt;body\u0026gt;\\n\u0026lt;noscript\u0026gt;\\n \u0026lt;iframe src=\u0026quot;//b.yjtag.jp/iframe?c=QXMP4c3\u0026quot; width=\u0026quot; ...\rrace_urlã«ã¯yahoo.keibaã®ã†ã¡ã®2016å¹´kæœˆã«ã‚ã£ãŸå…¨ãƒ¬ãƒ¼ã‚¹çµæœã®ãƒªãƒ³ã‚¯ã‚’æ ¼ç´ã—ã¦ã„ã¾ã™ã€‚html_nodeã¨ã¯htmlæ§‹é€ ã®ã†ã¡ã©ã®è¦ç´ ã‚’å¼•ã£å¼µã‚‹ã‹ã‚’æŒ‡å®šã—ã€ãã‚Œã‚’å¼•ã£å¼µã‚‹é–¢æ•°ã§ã€ç°¡å˜ã«è¨€ãˆã°ã»ã—ã„ãƒ‡ãƒ¼ã‚¿ã®ä½æ‰€ã‚’å…¥åŠ›ã™ã‚‹é–¢æ•°ã§ã‚ã‚‹ã¨èªè­˜ã—ã¦ã„ã¾ã™ï¼ˆãŠãã‚‰ãæ­£ã—ããªã„ï¼‰ã€‚ã“ã“ã§ã¯aè¦ç´ ã‚’å¼•ã£å¼µã‚‹ã“ã¨ã«ã—ã¦ã„ã¾ã™ã€‚æ³¨æ„ã™ã¹ãã“ã¨ã¯ã€html_nodeã¯æ¬²ã—ã„æƒ…å ±ã‚’htmlå½¢å¼ã§å¼•ã£å¼µã‚‹ã“ã¨ã§ã™ã€‚ãªã®ã§ã€ãƒ†ã‚­ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ã¨ã—ã¦ãƒªãƒ³ã‚¯ã‚’ä¿å­˜ã™ã‚‹ãŸã‚ã«ã¯html_attrã‚’ä½¿ç”¨ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚html_attrã®å¼•æ•°ã¨ã—ã¦ã€ãƒªãƒ³ã‚¯å±æ€§ã‚’è¡¨ã™hrefã‚’æ¸¡ã—ã¦ã„ã¾ã™ã€‚ã“ã‚Œã§ãƒ¬ãƒ¼ã‚¹çµæœã®urlãŒå–ã‚ŒãŸã¨æ€ã„ãã‚„ã€å®Ÿã¯ã“ã‚Œã§ã¯ä»–ã®ãƒªãƒ³ã‚¯ã‚‚ã¨ã£ã¦ã—ã¾ã£ã¦ã„ã¾ã™ã€‚ä¸€ç•ªã‚ã‹ã‚Šã‚„ã™ã„ã®ãŒåºƒå‘Šã®ãƒªãƒ³ã‚¯ã§ã™ã€‚ã“ã†ã„ã£ãŸãƒªãƒ³ã‚¯ã¯é™¤å¤–ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚ãƒ¬ãƒ¼ã‚¹çµæœã®urlã«ã¯\u0026quot;result\u0026quot;ãŒå«ã¾ã‚Œã¦ã„ã‚‹ã®ã§ã€ã“ã®æ–‡å­—ãŒå…¥ã£ã¦ã„ã‚‹è¦ç´ ã ã‘ã‚’æŠ½å‡ºã—ãŸã®ãŒä¸€ç•ªæœ€å¾Œã®ã‚³ãƒ¼ãƒ‰ã§ã™ã€‚\nfor (i in 1:length(race_url)){ race1 \u0026lt;- read_html(str_c(\u0026#34;https://keiba.yahoo.co.jp\u0026#34;,race_url[i])) # ãƒ¬ãƒ¼ã‚¹çµæœã®urlã‚’å–å¾— # ãƒ¬ãƒ¼ã‚¹çµæœã‚’ã‚¹ã‚¯ãƒ¬ã‚¤ãƒ”ãƒ³ã‚° race_result \u0026lt;- race1 %\u0026gt;% html_nodes(xpath = \u0026#34;//table[@id = \u0026#39;raceScore\u0026#39;]\u0026#34;) %\u0026gt;% html_table() race_result \u0026lt;- do.call(\u0026#34;data.frame\u0026#34;,race_result) # ãƒªã‚¹ãƒˆã‚’ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ¬ãƒ¼ãƒ ã«å¤‰æ›´ colnames(race_result) \u0026lt;- c(\u0026#34;order\u0026#34;,\u0026#34;frame_number\u0026#34;,\u0026#34;horse_number\u0026#34;,\u0026#34;horse_name/age\u0026#34;,\u0026#34;time/margin\u0026#34;,\u0026#34;passing_rank/last_3F\u0026#34;,\u0026#34;jockey/weight\u0026#34;,\u0026#34;popularity/odds\u0026#34;,\u0026#34;trainer\u0026#34;) #ã€€åˆ—åå¤‰æ›´ ã•ã¦ã€ã„ã‚ˆã„ã‚ˆãƒ¬ãƒ¼ã‚¹çµæœã®ã‚¹ã‚¯ãƒ¬ã‚¤ãƒ”ãƒ³ã‚°ã‚’è¡Œã„ã¾ã™ã€‚ã•ãã»ã©å–å¾—ã—ãŸãƒªãƒ³ã‚¯å…ˆã®htmlæ§‹é€ ã‚’ä¸€ã¤ä¸€ã¤å–å¾—ã—ã€ãã®ä¸­ã§å¿…è¦ãªãƒ†ã‚­ã‚¹ãƒˆæƒ…å ±ã‚’å¼•ã£å¼µã‚‹ã¨ã„ã†ä½œæ¥­ã‚’Rã«å®Ÿè¡Œã•ã›ã¾ã™ï¼ˆãªã®ã§ãƒ«ãƒ¼ãƒ—ã‚’ä½¿ã†ï¼‰ã€‚race_1ã«ã¯ã‚ã‚‹ãƒ¬ãƒ¼ã‚¹çµæœãƒšãƒ¼ã‚¸ã®htmlæ§‹é€ ãŒæ ¼ç´ã•ã‚ŒãŠã‚Šã€race_resultã«ã¯ãã®çµæœãŒå…¥ã£ã¦ã„ã¾ã™ã€‚html_nodesã®å¼•æ•°ã«å…¥ã£ã¦ã„ã‚‹xpathã§ã™ãŒã€ã“ã‚Œã¯XLMãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‹ã‚‰åŠ¹ç‡çš„ã«è¦ç´ ã‚’æŠœãå‡ºã™è¨€èªã§ã™ã€‚å…ˆã»ã©èª¬æ˜ã—ãŸä½æ‰€ã®ã‚ˆã†ãªã‚‚ã®ã¨æ€ã£ã¦ã„ãŸã ã‘ã‚Œã°è‰¯ã„ã¨æ€ã„ã¾ã™ã€‚ãã®æ¨ªã«æ›¸ã„ã¦ã‚ã‚‹//table[@id = 'raceScore']ãŒä½æ‰€ã§ã™ã€‚ã“ã‚Œã¯webãƒ–ãƒ©ã‚¦ã‚¶ã‹ã‚‰ç°¡å˜ã«æ¢ã™ã“ã¨ãŒã§ãã¾ã™ã€‚Firefoxã®èª¬æ˜ã«ãªã‚Šã¾ã™ãŒã€ã»ã‹ã®ãƒ–ãƒ©ã‚¦ã‚¶ã§ã‚‚åŒã˜ã‚ˆã†ãªæ©Ÿèƒ½ãŒã‚ã‚‹ã¨æ€ã„ã¾ã™ã€‚ã‚¹ã‚¯ãƒ¬ã‚¤ãƒ—ã—ãŸã„ç”»é¢ã§Ctrl+Shift+Cã‚’æŠ¼ã™ã¨ä¸‹ã®ã‚ˆã†ãªç”»é¢ãŒè¡¨ç¤ºã•ã‚Œã¾ã™ã€‚\nã“ã®ã‚¤ãƒ³ã‚¹ãƒšã‚¯ã‚¿ãƒ¼ã®æ¨ªã®ãƒãƒ¼ã‚¯ã‚’ã‚¯ãƒªãƒƒã‚¯ã™ã‚‹ã¨ã€ã‚«ãƒ¼ã‚½ãƒ«ã§æŒ‡ã—ãŸéƒ¨åˆ†ã®htmlæ§‹é€ ï¼ˆä½æ‰€ï¼‰ãŒè¡¨ç¤ºã•ã‚Œã¾ã™ã€‚ã“ã®å ´åˆã ã¨ã€ãƒ¬ãƒ¼ã‚¹çµæœã¯tableå±æ€§ã®idãŒraceScoreã®å ´æ‰€ã«æ ¼ç´ã•ã‚Œã¦ã„ã‚‹ã“ã¨ãŒåˆ†ã‹ã‚Šã¾ã™ã€‚ãªã®ã§ã€ä¸Šã®ã‚³ãƒ¼ãƒ‰ã§ã¯xpath=ã®ã¨ã“ã‚ã«ãã‚Œã‚’è¨˜è¿°ã—ã¦ã„ã‚‹ã®ã§ã™ã€‚ãã—ã¦ã€ãƒ¬ãƒ¼ã‚¹çµæœã¯è¡¨ï¼ˆtableï¼‰å½¢å¼ã§ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆåŒ–ã•ã‚Œã¦ã„ã‚‹ã®ã§ã€html_tableã§ã”ã£ãã‚Šã¨ã‚¹ã‚¯ãƒ¬ã‚¤ãƒ—ã—ã¾ã—ãŸã€‚åŸºæœ¬çš„ã«ãƒªã‚¹ãƒˆå½¢å¼ã§è¿”ã•ã‚Œã‚‹ã®ã§ã€ãã‚Œã‚’ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ¬ãƒ¼ãƒ ã«å¤‰æ›ã—ã€é©å½“ã«åˆ—åã‚’ã¤ã‘ã¦ã„ã¾ã™ã€‚\n# é€šéé †ä½ã¨ä¸Šã‚Š3Fã®ã‚¿ã‚¤ãƒ  race_result \u0026lt;- dplyr::mutate(race_result,passing_rank=as.character(str_extract_all(race_result$`passing_rank/last_3F`,\u0026#34;(\\\\d{2}-\\\\d{2}-\\\\d{2}-\\\\d{2})|(\\\\d{2}-\\\\d{2}-\\\\d{2})|(\\\\d{2}-\\\\d{2})\u0026#34;))) race_result \u0026lt;- dplyr::mutate(race_result,last_3F=as.character(str_extract_all(race_result$`passing_rank/last_3F`,\u0026#34;\\\\d{2}\\\\.\\\\d\u0026#34;))) race_result \u0026lt;- race_result[-6] # ã‚¿ã‚¤ãƒ ã¨ç€å·® race_result \u0026lt;- dplyr::mutate(race_result,time=as.character(str_extract_all(race_result$`time/margin`,\u0026#34;\\\\d\\\\.\\\\d{2}\\\\.\\\\d|\\\\d{2}\\\\.\\\\d\u0026#34;))) race_result \u0026lt;- dplyr::mutate(race_result,margin=as.character(str_extract_all(race_result$`time/margin`,\u0026#34;./.é¦¬èº«|.é¦¬èº«|.[:space:]./.é¦¬èº«|[ã‚¢-ãƒ³-]+\u0026#34;))) race_result \u0026lt;- race_result[-5] # é¦¬åã€é¦¬é½¢ã€é¦¬ä½“é‡ race_result \u0026lt;- dplyr::mutate(race_result,horse_name=as.character(str_extract_all(race_result$`horse_name/age`,\u0026#34;[ã‚¡-ãƒ´ãƒ¼ãƒ»]+\u0026#34;))) race_result \u0026lt;- dplyr::mutate(race_result,horse_age=as.character(str_extract_all(race_result$`horse_name/age`,\u0026#34;ç‰¡\\\\d+|ç‰\\\\d+|ã›ã‚“\\\\d+\u0026#34;))) race_result \u0026lt;- dplyr::mutate(race_result,horse_weight=as.character(str_extract_all(race_result$`horse_name/age`,\u0026#34;\\\\d{3}\u0026#34;))) race_result \u0026lt;- dplyr::mutate(race_result,horse_weight_change=as.character(str_extract_all(race_result$`horse_name/age`,\u0026#34;\\\\([\\\\+|\\\\-]\\\\d+\\\\)|\\\\([\\\\d+]\\\\)\u0026#34;))) race_result$horse_weight_change \u0026lt;- sapply(rm_round(race_result$horse_weight_change, extract=TRUE), paste, collapse=\u0026#34;\u0026#34;) race_result \u0026lt;- race_result[-4] # ã‚¸ãƒ§ãƒƒã‚­ãƒ¼ race_result \u0026lt;- dplyr::mutate(race_result,jockey=as.character(str_extract_all(race_result$`jockey/weight`,\u0026#34;[ã-ã‚“ä¸€-é¾ ]+\\\\s[ã-ã‚“ä¸€-é¾ ]+|[:upper:].[ã‚¡-ãƒ¶ãƒ¼]+\u0026#34;))) race_result \u0026lt;- race_result[-4] # ã‚ªãƒƒã‚ºã¨äººæ°— race_result \u0026lt;- dplyr::mutate(race_result,odds=as.character(str_extract_all(race_result$`popularity/odds`,\u0026#34;\\\\(.+\\\\)\u0026#34;))) race_result \u0026lt;- dplyr::mutate(race_result,popularity=as.character(str_extract_all(race_result$`popularity/odds`,\u0026#34;\\\\d+[^(\\\\d+.\\\\d)]\u0026#34;))) race_result$odds \u0026lt;- sapply(rm_round(race_result$odds, extract=TRUE), paste, collapse=\u0026#34;\u0026#34;) race_result \u0026lt;- race_result[-4] ã“ã“ã¾ã§ã§ãƒ‡ãƒ¼ã‚¿ã¯å–å¾—ã§ããŸã‚ã‘ãªã®ã§ã™ãŒã€ãã®ãƒ‡ãƒ¼ã‚¿ã¯ç¶ºéº—ãªã‚‚ã®ã«ã¯ãªã£ã¦ã„ã¾ã›ã‚“ã€‚ ä¸Šã®ã‚³ãƒ¼ãƒ‰ã§ã¯ã€ãã®æ•´å½¢ä½œæ¥­ã‚’è¡Œã£ã¦ã„ã¾ã™ã€‚ç¾åœ¨ã€å–å¾—ã—ãŸãƒ‡ãƒ¼ã‚¿ã¯ä»¥ä¸‹ã®ã‚ˆã†ã«ãªã£ã¦ã„ã¾ã™ã€‚\nhead(race_result) {\"columns\":[{\"label\":[\"\"],\"name\":[\"_rn_\"],\"type\":[\"\"],\"align\":[\"left\"]},{\"label\":[\"order\"],\"name\":[1],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"frame_number\"],\"name\":[2],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"horse_number\"],\"name\":[3],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"trainer\"],\"name\":[4],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"passing_rank\"],\"name\":[5],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"last_3F\"],\"name\":[6],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"time\"],\"name\":[7],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"margin\"],\"name\":[8],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"horse_name\"],\"name\":[9],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"horse_age\"],\"name\":[10],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"horse_weight\"],\"name\":[11],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"horse_weight_change\"],\"name\":[12],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"jockey\"],\"name\":[13],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"odds\"],\"name\":[14],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"popularity\"],\"name\":[15],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"race_date\"],\"name\":[16],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"race_name\"],\"name\":[17],\"type\":[\"chr\"],\"align\":[\"left\"]}],\"data\":[{\"1\":\"1\",\"2\":\"2\",\"3\":\"2\",\"4\":\"æ²³é‡ é€šæ–‡\",\"5\":\"06-07-06-06\",\"6\":\"35.1\",\"7\":\"3.19.7\",\"8\":\"character(0)\",\"9\":\"ã‚»ãƒ³ã‚´ã‚¯ã‚·ãƒ«ãƒãƒ¼\",\"10\":\"ç‰¡6\",\"11\":\"478\",\"12\":\"+2\",\"13\":\"ç”°ä¸­ å‹æ˜¥\",\"14\":\"2.3\",\"15\":\"1\",\"16\":\"1994å¹´1æœˆ31æ—¥\",\"17\":\"ç¬¬44å›ãƒ€ã‚¤ãƒ¤ãƒ¢ãƒ³ãƒ‰ã‚¹ãƒ†ãƒ¼ã‚¯ã‚¹ï¼ˆGIIIï¼‰\",\"_rn_\":\"1\"},{\"1\":\"2\",\"2\":\"6\",\"3\":\"9\",\"4\":\"æ­¦ é‚¦å½¦\",\"5\":\"06-05-04-04\",\"6\":\"35.7\",\"7\":\"3.19.9\",\"8\":\"1 1/4é¦¬èº«\",\"9\":\"ã‚¸ãƒ£ãƒ ã‚·ãƒ¼ãƒ‰\",\"10\":\"ç‰¡6\",\"11\":\"480\",\"12\":\"0\",\"13\":\"æŸ´ç”° æ”¿äºº\",\"14\":\"14\",\"15\":\"7\",\"16\":\"1994å¹´1æœˆ31æ—¥\",\"17\":\"ç¬¬44å›ãƒ€ã‚¤ãƒ¤ãƒ¢ãƒ³ãƒ‰ã‚¹ãƒ†ãƒ¼ã‚¯ã‚¹ï¼ˆGIIIï¼‰\",\"_rn_\":\"2\"},{\"1\":\"3\",\"2\":\"7\",\"3\":\"10\",\"4\":\"ç™½äº• å¯¿æ˜­\",\"5\":\"08-07-06-06\",\"6\":\"35.7\",\"7\":\"3.20.1\",\"8\":\"1 1/2é¦¬èº«\",\"9\":\"ãƒ›ã‚¯ã‚»ãƒ„ã‚®ãƒ³ã‚¬\",\"10\":\"ç‰¡6\",\"11\":\"500\",\"12\":\"+4\",\"13\":\"å°å±‹æ•· æ˜­\",\"14\":\"7.5\",\"15\":\"3\",\"16\":\"1994å¹´1æœˆ31æ—¥\",\"17\":\"ç¬¬44å›ãƒ€ã‚¤ãƒ¤ãƒ¢ãƒ³ãƒ‰ã‚¹ãƒ†ãƒ¼ã‚¯ã‚¹ï¼ˆGIIIï¼‰\",\"_rn_\":\"3\"},{\"1\":\"4\",\"2\":\"7\",\"3\":\"11\",\"4\":\"çŸ¢é‡ é€²\",\"5\":\"03-03-03-02\",\"6\":\"36.3\",\"7\":\"3.20.4\",\"8\":\"1 3/4é¦¬èº«\",\"9\":\"ã‚µãƒãƒ¼ãƒ¯ã‚¤ãƒ³\",\"10\":\"ç‰5\",\"11\":\"422\",\"12\":\"-4\",\"13\":\"æœ¨å¹¡ åˆåºƒ\",\"14\":\"32.6\",\"15\":\"9\",\"16\":\"1994å¹´1æœˆ31æ—¥\",\"17\":\"ç¬¬44å›ãƒ€ã‚¤ãƒ¤ãƒ¢ãƒ³ãƒ‰ã‚¹ãƒ†ãƒ¼ã‚¯ã‚¹ï¼ˆGIIIï¼‰\",\"_rn_\":\"4\"},{\"1\":\"5\",\"2\":\"1\",\"3\":\"1\",\"4\":\"ç§‹å±± å²éƒ\",\"5\":\"12-12-12-12\",\"6\":\"35.6\",\"7\":\"3.20.5\",\"8\":\"1/2é¦¬èº«\",\"9\":\"ãƒ€ã‚¤ãƒ¯ã‚¸ã‚§ãƒ¼ãƒ ã‚¹\",\"10\":\"ç‰¡6\",\"11\":\"472\",\"12\":\"+6\",\"13\":\"å¤§å¡š æ „ä¸‰éƒ\",\"14\":\"5.9\",\"15\":\"2\",\"16\":\"1994å¹´1æœˆ31æ—¥\",\"17\":\"ç¬¬44å›ãƒ€ã‚¤ãƒ¤ãƒ¢ãƒ³ãƒ‰ã‚¹ãƒ†ãƒ¼ã‚¯ã‚¹ï¼ˆGIIIï¼‰\",\"_rn_\":\"5\"},{\"1\":\"6\",\"2\":\"5\",\"3\":\"7\",\"4\":\"é ˆè² å½¦ä¸‰\",\"5\":\"11-10-06-06\",\"6\":\"36.1\",\"7\":\"3.20.5\",\"8\":\"ãƒãƒŠ\",\"9\":\"ã‚·ã‚²ãƒãƒ©ãƒ³ãƒœãƒ¼\",\"10\":\"ç‰¡7\",\"11\":\"438\",\"12\":\"-6\",\"13\":\"é ˆè² å°šä»‹\",\"14\":\"8.7\",\"15\":\"4\",\"16\":\"1994å¹´1æœˆ31æ—¥\",\"17\":\"ç¬¬44å›ãƒ€ã‚¤ãƒ¤ãƒ¢ãƒ³ãƒ‰ã‚¹ãƒ†ãƒ¼ã‚¯ã‚¹ï¼ˆGIIIï¼‰\",\"_rn_\":\"6\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\r\r\rã”è¦§ã®ã‚ˆã†ã«ã€\\nãŒå…¥ã£ã¦ã„ãŸã‚Šã€é€šéé †ä½ã¨ä¸Šã‚Š3ãƒãƒ­ãƒ³ã®ã‚¿ã‚¤ãƒ ãŒä¸€ã¤ã®ã‚»ãƒ«ã«å…¥ã£ã¦ã„ãŸã‚Šã¨ã“ã®ã¾ã¾ã§ã¯åˆ†æãŒã§ãã¾ã›ã‚“ã€‚ä¸è¦ãªã‚‚ã®ã‚’å–ã‚Šé™¤ã„ãŸã‚Šã€ãƒ‡ãƒ¼ã‚¿ã‚’äºŒã¤ã«åˆ†å‰²ã™ã‚‹ä½œæ¥­ãŒå¿…è¦ã«ãªã‚Šã¾ã™ã€‚ä»Šå›ã®è¨˜äº‹ã§ã¯ã“ã®éƒ¨åˆ†ã«ã¤ã„ã¦è©³ã—ãã¯èª¬æ˜ã—ã¾ã›ã‚“ã€‚ã“ã®éƒ¨åˆ†ã¯æ­£è¦è¡¨ç¾ã‚’é§†ä½¿ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ãŒã€ç§è‡ªèº«å…¨ãè©³ã—ããªã„ã‹ã‚‰ã§ã™ã€‚ä»Šå›ã‚‚æ‰‹æ¢ã‚Šã§ã‚„ã‚Šã¾ã—ãŸã€‚\n# ãƒ¬ãƒ¼ã‚¹æƒ…å ± race_date \u0026lt;- race1 %\u0026gt;% html_nodes(xpath = \u0026#34;//div[@id = \u0026#39;raceTitName\u0026#39;]/p[@id = \u0026#39;raceTitDay\u0026#39;]\u0026#34;) %\u0026gt;% html_text() race_name \u0026lt;- race1 %\u0026gt;% html_nodes(xpath = \u0026#34;//div[@id = \u0026#39;raceTitName\u0026#39;]/h1[@class = \u0026#39;fntB\u0026#39;]\u0026#34;) %\u0026gt;% html_text() race_result \u0026lt;- dplyr::mutate(race_result,race_date=as.character(str_extract_all(race_date,\u0026#34;\\\\d+å¹´\\\\d+æœˆ\\\\d+æ—¥\u0026#34;))) race_result \u0026lt;- dplyr::mutate(race_result,race_name=as.character(str_replace_all(race_name,\u0026#34;\\\\s\u0026#34;,\u0026#34;\u0026#34;))) # ãƒ•ã‚¡ã‚¤ãƒ«æ ¼ç´ if (k ==1 \u0026amp;\u0026amp; i == 1){ dataset \u0026lt;- race_result } else { dataset \u0026lt;- rbind(dataset,race_result) }# ifæ–‡ã®çµ‚ã‚ã‚Š } # iãƒ«ãƒ¼ãƒ—ã®çµ‚ã‚ã‚Š write.csv(race_result,\u0026#34;race_result.csv\u0026#34;) æœ€å¾Œã«ã€ãƒ¬ãƒ¼ã‚¹æ—¥æ™‚ã¨ãƒ¬ãƒ¼ã‚¹åã‚’æŠœãå‡ºã—ã€ãƒ‡ãƒ¼ã‚¿ã‚’ä¸€æ™‚çš„ã«æ ¼ç´ã™ã‚‹ã‚³ãƒ¼ãƒ‰ã¨csvãƒ•ã‚¡ã‚¤ãƒ«ã«æ›¸ãå‡ºã™ã‚³ãƒ¼ãƒ‰ã‚’æ›¸ã„ã¦çµ‚äº†ã§ã™ã€‚å®Œæˆãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã¯ä»¥ä¸‹ã®ã‚ˆã†ãªçŠ¶æ…‹ã«ãªã£ã¦ã„ã¾ã™ã€‚\nhead(dataset) {\"columns\":[{\"label\":[\"\"],\"name\":[\"_rn_\"],\"type\":[\"\"],\"align\":[\"left\"]},{\"label\":[\"order\"],\"name\":[1],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"frame_number\"],\"name\":[2],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"horse_number\"],\"name\":[3],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"trainer\"],\"name\":[4],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"passing_rank\"],\"name\":[5],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"last_3F\"],\"name\":[6],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"time\"],\"name\":[7],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"margin\"],\"name\":[8],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"horse_name\"],\"name\":[9],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"horse_age\"],\"name\":[10],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"horse_weight\"],\"name\":[11],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"horse_weight_change\"],\"name\":[12],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"jockey\"],\"name\":[13],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"odds\"],\"name\":[14],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"popularity\"],\"name\":[15],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"race_date\"],\"name\":[16],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"race_name\"],\"name\":[17],\"type\":[\"chr\"],\"align\":[\"left\"]}],\"data\":[{\"1\":\"1\",\"2\":\"8\",\"3\":\"11\",\"4\":\"æ£®å®‰ å¼˜æ˜­\",\"5\":\"01-01-01-01\",\"6\":\"35.7\",\"7\":\"2.00.7\",\"8\":\"character(0)\",\"9\":\"ãƒ’ãƒ€ã‚«ãƒãƒ¤ãƒˆ\",\"10\":\"ç‰¡8\",\"11\":\"488\",\"12\":\"-2\",\"13\":\"å¤§å¡š æ „ä¸‰éƒ\",\"14\":\"29\",\"15\":\"10\",\"16\":\"1994å¹´1æœˆ5æ—¥\",\"17\":\"ç¬¬43å›æ—¥åˆŠã‚¹ãƒãƒ¼ãƒ„è³é‡‘æ¯ï¼ˆGIIIï¼‰\",\"_rn_\":\"1\"},{\"1\":\"2\",\"2\":\"5\",\"3\":\"6\",\"4\":\"çŸ¢é‡ é€²\",\"5\":\"06-06-04-03\",\"6\":\"35.3\",\"7\":\"2.00.8\",\"8\":\"3/4é¦¬èº«\",\"9\":\"ã‚¹ãƒ†ãƒ¼ã‚¸ãƒãƒ£ãƒ³ãƒ—\",\"10\":\"ç‰¡5\",\"11\":\"462\",\"12\":\"+14\",\"13\":\"å²¡éƒ¨ å¹¸é›„\",\"14\":\"3.2\",\"15\":\"1\",\"16\":\"1994å¹´1æœˆ5æ—¥\",\"17\":\"ç¬¬43å›æ—¥åˆŠã‚¹ãƒãƒ¼ãƒ„è³é‡‘æ¯ï¼ˆGIIIï¼‰\",\"_rn_\":\"2\"},{\"1\":\"3\",\"2\":\"4\",\"3\":\"4\",\"4\":\"æ–°é–¢ åŠ›\",\"5\":\"03-03-02-02\",\"6\":\"35.8\",\"7\":\"2.01.1\",\"8\":\"1 3/4é¦¬èº«\",\"9\":\"ãƒã‚­ãƒãƒˆã‚¦ã‚·ãƒ§ã‚¦\",\"10\":\"ç‰¡5\",\"11\":\"502\",\"12\":\"+6\",\"13\":\"çš„å ´ å‡\",\"14\":\"6.9\",\"15\":\"4\",\"16\":\"1994å¹´1æœˆ5æ—¥\",\"17\":\"ç¬¬43å›æ—¥åˆŠã‚¹ãƒãƒ¼ãƒ„è³é‡‘æ¯ï¼ˆGIIIï¼‰\",\"_rn_\":\"3\"},{\"1\":\"4\",\"2\":\"8\",\"3\":\"12\",\"4\":\"å¤§å’Œç”° ç¨”\",\"5\":\"02-02-03-03\",\"6\":\"35.7\",\"7\":\"2.01.1\",\"8\":\"ãƒãƒŠ\",\"9\":\"ãƒšã‚¬ã‚µã‚¹\",\"10\":\"ç‰¡5\",\"11\":\"464\",\"12\":\"+4\",\"13\":\"å®‰ç”° å¯Œç”·\",\"14\":\"5.7\",\"15\":\"2\",\"16\":\"1994å¹´1æœˆ5æ—¥\",\"17\":\"ç¬¬43å›æ—¥åˆŠã‚¹ãƒãƒ¼ãƒ„è³é‡‘æ¯ï¼ˆGIIIï¼‰\",\"_rn_\":\"4\"},{\"1\":\"5\",\"2\":\"7\",\"3\":\"9\",\"4\":\"ç”°ä¸­ å’Œå¤«\",\"5\":\"07-07-07-05\",\"6\":\"35.8\",\"7\":\"2.01.6\",\"8\":\"3é¦¬èº«\",\"9\":\"ã‚·ãƒ£ãƒãƒ¼ãƒ‰ã‚·ãƒ³ãƒœãƒª\",\"10\":\"ç‰¡7\",\"11\":\"520\",\"12\":\"+4\",\"13\":\"ç”°ä¸­ å‰›\",\"14\":\"29.6\",\"15\":\"12\",\"16\":\"1994å¹´1æœˆ5æ—¥\",\"17\":\"ç¬¬43å›æ—¥åˆŠã‚¹ãƒãƒ¼ãƒ„è³é‡‘æ¯ï¼ˆGIIIï¼‰\",\"_rn_\":\"5\"},{\"1\":\"6\",\"2\":\"3\",\"3\":\"3\",\"4\":\"ä¸­å³¶ æ•æ–‡\",\"5\":\"09-10-10-09\",\"6\":\"35.5\",\"7\":\"2.01.7\",\"8\":\"3/4é¦¬èº«\",\"9\":\"ãƒ¢ãƒ³ã‚¿ãƒŸãƒ¼ãƒ«\",\"10\":\"ç‰¡7\",\"11\":\"474\",\"12\":\"+4\",\"13\":\"è“‘ç”° æ—©äºº\",\"14\":\"10.4\",\"15\":\"6\",\"16\":\"1994å¹´1æœˆ5æ—¥\",\"17\":\"ç¬¬43å›æ—¥åˆŠã‚¹ãƒãƒ¼ãƒ„è³é‡‘æ¯ï¼ˆGIIIï¼‰\",\"_rn_\":\"6\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\r\r\rä»¥ä¸Šã§ã™ã€‚æ¬¡å›ã¯ã“ã®ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã‚’ä½¿ç”¨ã—ã¦ã€åˆ†æã‚’è¡Œã£ã¦ã„ãã¾ã™ã€‚æ¬¡å›ã¾ã§ã«ã¯1994å¹´ã‹ã‚‰ã®ãƒ‡ãƒ¼ã‚¿ã‚’å…¨ã¦ã‚¹ã‚¯ãƒ¬ã‚¤ãƒ”ãƒ³ã‚°ã—ã¦ãã¾ã™ã€‚\nã€è¿½è¨˜ï¼ˆ2018/6/10ï¼‰ã€‘\nä¸Šè¿°ã—ãŸã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’ç”¨ã„ã¦ã€ã‚¹ã‚¯ãƒ¬ã‚¤ãƒ”ãƒ³ã‚°ã‚’è¡Œã£ãŸã¨ã“ã‚ã‚¨ãƒ©ãƒ¼ãŒå‡ºã¾ã—ãŸã€‚ã©ã†ã‚„ã‚‰ãƒ¬ãƒ¼ã‚¹çµæœã®ä¸­ã«ã¯å¼·é¢¨ãªã©ã§ä¸­æ­¢ã«ãªã£ãŸã‚‚ã®ã‚‚å«ã¾ã‚Œã¦ã„ã‚‹ã‚‰ã—ãã€ãã“ã§ã‚¨ãƒ©ãƒ¼ãŒå‡ºã‚‹æ§˜å­ï¼ˆrace_resultãŒcharacter(0)ã«ãªã£ã¦ã—ã¾ã†ï¼‰ã€‚ãªã®ã§ã€ã“ã®éƒ¨åˆ†ã‚’ä¿®æ­£ã—ãŸã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’ä»¥ä¸‹ã§å…¬é–‹ã—ã¦ãŠãã¾ã™ã€‚ã“ã¡ã‚‰ã¯ç§ã® PCç’°å¢ƒã§ã¯æ­£å¸¸ã«ä½œå‹•ã—ã¦ã„ã¾ã™ã€‚\n# rvestã«ã‚ˆã‚‹ç«¶é¦¬ãƒ‡ãƒ¼ã‚¿ã®webã‚¹ã‚¯ãƒ¬ã‚¤ãƒ”ãƒ³ã‚° #install.packages(\u0026#34;rvest\u0026#34;) #if (!require(\u0026#34;pacman\u0026#34;)) install.packages(\u0026#34;pacman\u0026#34;) install.packages(\u0026#34;beepr\u0026#34;) pacman::p_load(qdapRegex) library(rvest) library(stringr) library(dplyr) library(beepr) # pathã®è¨­å®š setwd(\u0026#34;C:/Users/assiy/Dropbox/ç«¶é¦¬çµ±è¨ˆè§£æ\u0026#34;) for(year in 1994:2018){ # yahooç«¶é¦¬ã®ãƒ¬ãƒ¼ã‚¹çµæœä¸€è¦§ãƒšãƒ¼ã‚¸ã®å–å¾— for (k in 1:12){ keiba.yahoo \u0026lt;- read_html(str_c(\u0026#34;https://keiba.yahoo.co.jp/schedule/list/\u0026#34;, year,\u0026#34;/?month=\u0026#34;,k)) race_url \u0026lt;- keiba.yahoo %\u0026gt;% html_nodes(\u0026#34;a\u0026#34;) %\u0026gt;% html_attr(\u0026#34;href\u0026#34;) # å…¨urlã‚’å–å¾— # ãƒ¬ãƒ¼ã‚¹çµæœã®ã‚’urlã‚’å–å¾— race_url \u0026lt;- race_url[str_detect(race_url, pattern=\u0026#34;result\u0026#34;)==1] # ã€Œresultã€ãŒå«ã¾ã‚Œã‚‹urlã‚’æŠ½å‡º for (i in 1:length(race_url)){ Sys.sleep(10) print(str_c(\u0026#34;ç¾åœ¨ã€\u0026#34;, year, \u0026#34;å¹´\u0026#34;, k, \u0026#34;æœˆ\u0026#34;, i,\u0026#34;ç•ªç›®ã®ãƒ¬ãƒ¼ã‚¹ã®ä¿å­˜ä¸­ã§ã™\u0026#34;)) race1 \u0026lt;- read_html(str_c(\u0026#34;https://keiba.yahoo.co.jp\u0026#34;,race_url[i])) # ãƒ¬ãƒ¼ã‚¹çµæœã®urlã‚’å–å¾— # ãƒ¬ãƒ¼ã‚¹ãŒä¸­æ­¢ã§ãªã‘ã‚Œã°å‡¦ç†ã‚’å®Ÿè¡Œ if (identical(race1 %\u0026gt;% html_nodes(xpath = \u0026#34;//div[@class = \u0026#39;resultAtt mgnBL fntSS\u0026#39;]\u0026#34;) %\u0026gt;% html_text(),character(0)) == TRUE){ # ãƒ¬ãƒ¼ã‚¹çµæœã‚’ã‚¹ã‚¯ãƒ¬ã‚¤ãƒ”ãƒ³ã‚° race_result \u0026lt;- race1 %\u0026gt;% html_nodes(xpath = \u0026#34;//table[@id = \u0026#39;raceScore\u0026#39;]\u0026#34;) %\u0026gt;% html_table() race_result \u0026lt;- do.call(\u0026#34;data.frame\u0026#34;,race_result) # ãƒªã‚¹ãƒˆã‚’ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ¬ãƒ¼ãƒ ã«å¤‰æ›´ colnames(race_result) \u0026lt;- c(\u0026#34;order\u0026#34;,\u0026#34;frame_number\u0026#34;,\u0026#34;horse_number\u0026#34;,\u0026#34;horse_name/age\u0026#34;,\u0026#34;time/margin\u0026#34;,\u0026#34;passing_rank/last_3F\u0026#34;,\u0026#34;jockey/weight\u0026#34;,\u0026#34;popularity/odds\u0026#34;,\u0026#34;trainer\u0026#34;) #ã€€åˆ—åå¤‰æ›´ # é€šéé †ä½ã¨ä¸Šã‚Š3Fã®ã‚¿ã‚¤ãƒ  race_result \u0026lt;- dplyr::mutate(race_result,passing_rank=as.character(str_extract_all(race_result$`passing_rank/last_3F`,\u0026#34;(\\\\d{2}-\\\\d{2}-\\\\d{2}-\\\\d{2})|(\\\\d{2}-\\\\d{2}-\\\\d{2})|(\\\\d{2}-\\\\d{2})\u0026#34;))) race_result \u0026lt;- dplyr::mutate(race_result,last_3F=as.character(str_extract_all(race_result$`passing_rank/last_3F`,\u0026#34;\\\\d{2}\\\\.\\\\d\u0026#34;))) race_result \u0026lt;- race_result[-6] # ã‚¿ã‚¤ãƒ ã¨ç€å·® race_result \u0026lt;- dplyr::mutate(race_result,time=as.character(str_extract_all(race_result$`time/margin`,\u0026#34;\\\\d\\\\.\\\\d{2}\\\\.\\\\d|\\\\d{2}\\\\.\\\\d\u0026#34;))) race_result \u0026lt;- dplyr::mutate(race_result,margin=as.character(str_extract_all(race_result$`time/margin`,\u0026#34;./.é¦¬èº«|.é¦¬èº«|.[:space:]./.é¦¬èº«|[ã‚¢-ãƒ³-]+\u0026#34;))) race_result \u0026lt;- race_result[-5] # é¦¬åã€é¦¬é½¢ã€é¦¬ä½“é‡ race_result \u0026lt;- dplyr::mutate(race_result,horse_name=as.character(str_extract_all(race_result$`horse_name/age`,\u0026#34;[ã‚¡-ãƒ´ãƒ¼ãƒ»]+\u0026#34;))) race_result \u0026lt;- dplyr::mutate(race_result,horse_age=as.character(str_extract_all(race_result$`horse_name/age`,\u0026#34;ç‰¡\\\\d+|ç‰\\\\d+|ã›ã‚“\\\\d+\u0026#34;))) race_result \u0026lt;- dplyr::mutate(race_result,horse_weight=as.character(str_extract_all(race_result$`horse_name/age`,\u0026#34;\\\\d{3}\u0026#34;))) race_result \u0026lt;- dplyr::mutate(race_result,horse_weight_change=as.character(str_extract_all(race_result$`horse_name/age`,\u0026#34;\\\\([\\\\+|\\\\-]\\\\d+\\\\)|\\\\([\\\\d+]\\\\)\u0026#34;))) race_result$horse_weight_change \u0026lt;- sapply(rm_round(race_result$horse_weight_change, extract=TRUE), paste, collapse=\u0026#34;\u0026#34;) race_result \u0026lt;- race_result[-4] # ã‚¸ãƒ§ãƒƒã‚­ãƒ¼ race_result \u0026lt;- dplyr::mutate(race_result,jockey=as.character(str_extract_all(race_result$`jockey/weight`,\u0026#34;[ã-ã‚“ä¸€-é¾ ]+\\\\s[ã-ã‚“ä¸€-é¾ ]+|[:upper:].[ã‚¡-ãƒ¶ãƒ¼]+\u0026#34;))) race_result \u0026lt;- race_result[-4] # ã‚ªãƒƒã‚ºã¨äººæ°— race_result \u0026lt;- dplyr::mutate(race_result,odds=as.character(str_extract_all(race_result$`popularity/odds`,\u0026#34;\\\\(.+\\\\)\u0026#34;))) race_result \u0026lt;- dplyr::mutate(race_result,popularity=as.character(str_extract_all(race_result$`popularity/odds`,\u0026#34;\\\\d+[^(\\\\d+.\\\\d)]\u0026#34;))) race_result$odds \u0026lt;- sapply(rm_round(race_result$odds, extract=TRUE), paste, collapse=\u0026#34;\u0026#34;) race_result \u0026lt;- race_result[-4] # ãƒ¬ãƒ¼ã‚¹æƒ…å ± race_date \u0026lt;- race1 %\u0026gt;% html_nodes(xpath = \u0026#34;//div[@id = \u0026#39;raceTitName\u0026#39;]/p[@id = \u0026#39;raceTitDay\u0026#39;]\u0026#34;) %\u0026gt;% html_text() race_name \u0026lt;- race1 %\u0026gt;% html_nodes(xpath = \u0026#34;//div[@id = \u0026#39;raceTitName\u0026#39;]/h1[@class = \u0026#39;fntB\u0026#39;]\u0026#34;) %\u0026gt;% html_text() race_result \u0026lt;- dplyr::mutate(race_result,race_date=as.character(str_extract_all(race_date,\u0026#34;\\\\d+å¹´\\\\d+æœˆ\\\\d+æ—¥\u0026#34;))) race_result \u0026lt;- dplyr::mutate(race_result,race_name=as.character(str_replace_all(race_name,\u0026#34;\\\\s\u0026#34;,\u0026#34;\u0026#34;))) ## ãƒ•ã‚¡ã‚¤ãƒ«è²¯ã‚ã‚‹ã®ã‹ã if (k == 1 \u0026amp;\u0026amp; i == 1 \u0026amp;\u0026amp; year == 1994){ dataset \u0026lt;- race_result } else { dataset \u0026lt;- rbind(dataset,race_result) } # ifæ–‡2ã®çµ‚ã‚ã‚Š } # ifæ–‡1ã®çµ‚ã‚ã‚Š } # iãƒ«ãƒ¼ãƒ—ã®çµ‚ã‚ã‚Š } # kãƒ«ãƒ¼ãƒ—ã®çµ‚ã‚ã‚Š beep() } # yearãƒ«ãƒ¼ãƒ—ã®çµ‚ã‚ã‚Š write.csv(dataset,\u0026#34;race_result.csv\u0026#34;, row.names = FALSE) ã“ã‚Œã‚’å›ã™ã®ã«16æ™‚é–“ã‹ã‹ã‚Šã¾ã—ãŸï¼ˆç¬‘ï¼‰ãƒ‡ãƒ¼ã‚¿æ•°ã¯æƒ³å®šã—ã¦ã„ãŸã‚ˆã‚Šã¯å°‘ãªãã€97939ã«ãªã‚Šã¾ã—ãŸã€‚\n","date":1526688000,"expirydate":-62135596800,"kind":"page","lang":"ja","lastmod":1528588800,"objectID":"6b14675d44e331e53c790a5322187755","permalink":"/post/post9/","publishdate":"2018-05-19T00:00:00Z","relpermalink":"/post/post9/","section":"post","summary":"ä»Šã€ç«¶é¦¬Ã—ãƒ‡ãƒ¼ã‚¿ã‚µã‚¤ã‚¨ãƒ³ã‚¹ãŒç†±ã„ã§ã™ã€‚ã‚¦ãƒãƒŠãƒªãƒ†ã‚£ã‚¯ã‚¹ãªã‚‹ã‚‚ã®ãŒã‚ã‚Šã€ã“ã‚Œã¾ã§ã®ãƒ¬ãƒ¼ã‚¹çµæœã‹ã‚‰ãªã‚“ã‚‰ã‹ã®ãƒ¢ãƒ‡ãƒ«ã‚’ä½œæˆã—ã€é †ä½äºˆæƒ³ã‚„å›åç‡ã‚’é«˜ã‚ã‚‹é¦¬åˆ¸è³¼å…¥æ–¹æ³•ã‚’è€ƒãˆã‚ˆã†ã¨ã™ã‚‹äººãŒä¸€å®šæ•°ã„ã‚‹ã‚ˆã†ã§ã™ã€‚ä»Šå›ã¯ç«¶é¦¬ã‚’ãƒ‡ãƒ¼ã‚¿è§£æã™ã‚‹ãŸã‚ã®ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—ã—ã¾ã™ã€‚rvestã‚’ç”¨ã„ã¦ã€ã”ã‚Šã”ã‚Šã«ã‚¯ãƒ­ãƒ¼ãƒªãƒ³ã‚°ã‚’è¡Œã„ã¾ã—ãŸã€‚","tags":["å‰å‡¦ç†","R"],"title":"rvestã§yahooç«¶é¦¬ã«ã‚ã‚‹éå»ã®ãƒ¬ãƒ¼ã‚¹çµæœã‚’ã‚¯ãƒ­ãƒ¼ãƒªãƒ³ã‚°ã—ã¦ã¿ãŸ","type":"post"},{"authors":null,"categories":[],"content":"ã©ã†ã‚‚ã¯ã˜ã‚ã¾ã—ã¦ã€‚ æ±äº¬ã«ã‚ã‚‹è³‡ç”£é‹ç”¨ä¼šç¤¾ã«å‹¤ã‚ã‚‹æ–°å’1å¹´ç›®ã®è‘¦åŸå½©äººã¨ç”³ã—ã¾ã™ã€‚\nç°¡å˜ã«è‡ªå·±ç´¹ä»‹ã‚’ã—ãŸã„ã¨æ€ã„ã¾ã™ã€‚ å¤§å­¦é™¢å’ã®24æ­³ã§ã™ã€‚ å°‚æ”»ã¯ãƒã‚¯ãƒ­çµŒæ¸ˆå­¦ã§ç‰¹ã«DSGEãƒ¢ãƒ‡ãƒ«ã€çŠ¶æ…‹ç©ºé–“ãƒ¢ãƒ‡ãƒ«ã€ã‚«ãƒ«ãƒãƒ³ãƒ•ã‚£ãƒ«ã‚¿ã€ãƒ™ã‚¤ã‚ºæ¨å®šã€MCMCãªã‚“ã‹ã‚’ã‚„ã£ã¦ã„ã¾ã—ãŸã€‚ æŒ‡å°æ•™å®˜ã®ç ”ç©¶ã‚µãƒãƒ¼ãƒˆã¨ã—ã¦è‡ªç„¶è¨€èªå‡¦ç†ã‚’ã‚„ã£ãŸã“ã¨ã‚‚ã‚ã‚Šã¾ã™ã€‚ ã‚‚ã¨ã‚‚ã¨å­¦è€…å¿—æœ›ã§ã—ãŸãŒé‡‘éŠ­çš„ãªå•é¡Œã§å°±è·ã™ã‚‹ã“ã¨ã«ãªã‚Šã¾ã—ãŸã€‚ ä»Šã¯å–¶æ¥­ã‚µãƒãƒ¼ãƒˆã®ä¸‹åƒãã‚’ã—ã¦ã„ã¾ã™ã€‚\nã“ã®ãƒ–ãƒ­ã‚°ã¯ç ”ç©¶ã¸ã®èˆˆå‘³é–¢å¿ƒã‚’æ¨ã¦ã‚‹ã“ã¨ãŒã§ããªã„ç§ãŒè¶£å‘³ã¨ã—ã¦ç ”ç©¶ã‚’é€²ã‚ã¦ã„ãéš›ã®å‚™å¿˜éŒ²ã¨ã„ã†ä½ç½®ä»˜ã‘ã«ãªã‚‹ã®ã ã¨æ€ã„ã¾ã™ã€‚\nç¾åœ¨é€²ã‚ã¦ã„ã‚‹ç ”ç©¶ã¯ä»¥ä¸‹ã®ï¼’ã¤ã§ã™ã€‚\n é¦¬åˆ¸ç‰ˆãƒ•ã‚¡ã‚¯ã‚¿ãƒ¼ãƒ¢ãƒ‡ãƒ« å››åŠæœŸGDPäºˆæ¸¬ãƒ¢ãƒ‡ãƒ«  1ã¯ã€é¦¬åˆ¸å¸‚å ´ãŒæ ªå¼å¸‚å ´ã‚ˆã‚Šã‚‚æŠ•æ©Ÿçš„ã«é­…åŠ›ã®ã‚ã‚‹å¸‚å ´ã§ã‚ã‚‹ã¨ã„ã†è¦³ç‚¹ã‹ã‚‰ã€å›åç‡100%è¶…ãˆã‚’ç›®æŒ‡ã™é¦¬åˆ¸ãƒãƒ¼ãƒˆãƒ•ã‚©ãƒªã‚ªã‚’æ§‹ç¯‰ã™ã‚‹ãƒ¢ãƒ‡ãƒ«ã‚’ä½œæˆã§ããªã„ã‹ã¨ã„ã†ã‚‚ã®ã§ã™ã€‚æ ªå¼ã«ã¯ãƒ•ã‚¡ãƒ¼ãƒãƒ•ãƒ¬ãƒ³ãƒã®ã‚ˆã†ãªãƒ•ã‚¡ã‚¯ã‚¿ãƒ¼ãƒ¢ãƒ‡ãƒ«ãŒã‚ã‚Šã¾ã™ãŒã€ãã‚Œã‚’å¿œç”¨ã—ã¦é¦¬åˆ¸ç‰ˆãƒ•ã‚¡ã‚¯ã‚¿ãƒ¼ãƒ¢ãƒ‡ãƒ«ãªã‚‹ã‚‚ã®ã‚’ä½œã‚Œãªã„ã‹ã¨æ€ã£ã¦ã„ã¾ã™ã€‚\n2ã¯æœ€è¿‘ã®å››åŠæœŸGDPé€Ÿå ±ã®ç²¾åº¦ãŒä½ã„ã¨ã„ã†å•é¡Œæ„è­˜ã‹ã‚‰ã€ç²¾åº¦ã®é«˜ã„äºˆæ¸¬ãƒ¢ãƒ‡ãƒ«ã‚’æ–°ãŸã«æ§‹ç¯‰ã§ããªã„ã‹ã¨ã„ã†ã‚‚ã®ã§ã™ã€‚ç‰¹ã«ã“ã‚Œã¾ã§ã®ã‚ˆã†ãªãƒã‚¯ãƒ­çµŒæ¸ˆç†è«–ã«åŸºã¥ã„ãŸãƒ¢ãƒ‡ãƒ«ã§ã¯ãªãã€æ©Ÿæ¢°å­¦ç¿’ã‚’ç”¨ã„ã€é€šå¸¸ãƒã‚¯ãƒ­çµŒæ¸ˆå­¦ã®ç ”ç©¶ã§ä½¿ç”¨ã—ãªã„ã‚ˆã†ãªãƒ‡ãƒ¼ã‚¿ã‚’ç¹”ã‚Šè¾¼ã‚“ã ãƒ¢ãƒ‡ãƒ«ã‚’ä½œæˆã™ã‚‹æ–¹å‘ã§ç ”ç©¶ã‚’é€²ã‚ã¦ã„ããŸã„ã¨æ€ã£ã¦ã„ã¾ã™ã€‚\nã¾ã ã€ç ”ç©¶ã¯å§‹ã‚ãŸã°ã‹ã‚Šãªã®ã§ã™ãŒã€ èˆˆå‘³ã‚’æŒã£ã¦ã‚‚ã‚‰ãˆã‚‹ã‚ˆã†ã«é ‘å¼µã‚ŠãŸã„ã¨æ€ã„ã¾ã™â€¦ ã§ã¯ã€æœ€åˆã¯ã“ã®è¾ºã§ã€‚\nã‚ˆã‚ã—ããŠé¡˜ã„ã—ã¾ã™ã€‚\n","date":1526601600,"expirydate":-62135596800,"kind":"page","lang":"ja","lastmod":1526601600,"objectID":"122591be03ff19b49a97c0378f58bb18","permalink":"/post/post4/","publishdate":"2018-05-18T00:00:00Z","relpermalink":"/post/post4/","section":"post","summary":"ã©ã†ã‚‚ã¯ã˜ã‚ã¾ã—ã¦ã€‚ã“ã®ãƒ–ãƒ­ã‚°ã‚’å§‹ã‚ã‚‹ã«å½“ãŸã£ã¦ã¾ãšã¯è‡ªå·±ç´¹ä»‹ã‚’ã—ãŸã„ã¨æ€ã„ã¾ã™ã€‚","tags":[],"title":"ã¯ã˜ã‚ã¾ã—ã¦","type":"post"},{"authors":["Ayato Ashihara"],"categories":null,"content":"\rClick the Cite button above to get Bibtex and Cite ME !!\r\r\r","date":1522454400,"expirydate":-62135596800,"kind":"page","lang":"ja","lastmod":1522454400,"objectID":"8eb0b83c007669e1fcaec626e70937a6","permalink":"/publication/%E7%B4%80%E8%A6%812019/","publishdate":"2018-03-31T00:00:00Z","relpermalink":"/publication/%E7%B4%80%E8%A6%812019/","section":"publication","summary":"Japan  has  experienced  a  long-lasting  stagnation  since  the  early  1990s.  According  to  the  Reference Dates of Business Cycle, the Cabinet Office of Japan, there are four recession periods between 1987 and 2010,  and  three  of  them  are  considered  to  be  financially-related.  This  implies  that  the  stagnation  wastriggered by financial factors. Nonetheless, many studies using Dynamic Stochastic General Equilibrium models claim that a decline in Total Factor Productivity is the main driver of the stagnation. To resolve this contradiction,  this study estimates the Japanese economy by a New-Keynesian  DSGE  model augmented with  financial  friction  used  in  Christiano,  Motto  and  Rostagno  (2014),  where â€œrisk  shockâ€  is newly incorporated into the model that refers to uncertainty in the financial market. According to our estimationresults, the estimated risk shock can explain the overall fluctuations of GDP and investment, and thus it isconsidered to be the main driver of the stagnation. We also find that it is highly correlated with the Business condition  Diffusion  Index,  the  Financial  Position  Diffusion  Index  and  the  Lending  Attitude  Index  of  Financial Institutions in Tankan released by the Bank of Japan. Therefore, we conclude that the estimated risk  shock  can  be  interpreted  as  the  firmsâ€™   distrust  toward  their  business  conditions,  and  it  delayed  theirinvestment decisions, then causing the prolonged economic contraction.","tags":"","title":"Does Financial Risk Explain Japanâ€™s Great Stagnation?","type":"publication"},{"authors":["Ayato Ashihara"],"categories":null,"content":"\rClick the Cite button above to get Bibtex and Cite ME !!\r\r\r","date":1488844800,"expirydate":-62135596800,"kind":"page","lang":"ja","lastmod":1488844800,"objectID":"e1ffa3282e6f7fc6edad66690c0b404c","permalink":"/publication/ael2018/","publishdate":"2017-03-07T00:00:00Z","relpermalink":"/publication/ael2018/","section":"publication","summary":"Using Japanese financial data that provide enough observations under the good and bad regimes of financial conditions, we find that fiscal multipliers are smaller in the bad regime than in the good regime.","tags":[""],"title":"Is fiscal expansion more effective in a financial crisis?","type":"publication"},{"authors":null,"categories":null,"content":"","date":1461715200,"expirydate":-62135596800,"kind":"page","lang":"ja","lastmod":1461715200,"objectID":"d1311ddf745551c9e117aa4bb7e28516","permalink":"/project/external-project/","publishdate":"2016-04-27T00:00:00Z","relpermalink":"/project/external-project/","section":"project","summary":"An example of linking directly to an external project website using `external_link`.","tags":["Demo"],"title":"External Project","type":"project"},{"authors":null,"categories":null,"content":"Lorem ipsum dolor sit amet, consectetur adipiscing elit. Duis posuere tellus ac convallis placerat. Proin tincidunt magna sed ex sollicitudin condimentum. Sed ac faucibus dolor, scelerisque sollicitudin nisi. Cras purus urna, suscipit quis sapien eu, pulvinar tempor diam. Quisque risus orci, mollis id ante sit amet, gravida egestas nisl. Sed ac tempus magna. Proin in dui enim. Donec condimentum, sem id dapibus fringilla, tellus enim condimentum arcu, nec volutpat est felis vel metus. Vestibulum sit amet erat at nulla eleifend gravida.\nNullam vel molestie justo. Curabitur vitae efficitur leo. In hac habitasse platea dictumst. Sed pulvinar mauris dui, eget varius purus congue ac. Nulla euismod, lorem vel elementum dapibus, nunc justo porta mi, sed tempus est est vel tellus. Nam et enim eleifend, laoreet sem sit amet, elementum sem. Morbi ut leo congue, maximus velit ut, finibus arcu. In et libero cursus, rutrum risus non, molestie leo. Nullam congue quam et volutpat malesuada. Sed risus tortor, pulvinar et dictum nec, sodales non mi. Phasellus lacinia commodo laoreet. Nam mollis, erat in feugiat consectetur, purus eros egestas tellus, in auctor urna odio at nibh. Mauris imperdiet nisi ac magna convallis, at rhoncus ligula cursus.\nCras aliquam rhoncus ipsum, in hendrerit nunc mattis vitae. Duis vitae efficitur metus, ac tempus leo. Cras nec fringilla lacus. Quisque sit amet risus at ipsum pharetra commodo. Sed aliquam mauris at consequat eleifend. Praesent porta, augue sed viverra bibendum, neque ante euismod ante, in vehicula justo lorem ac eros. Suspendisse augue libero, venenatis eget tincidunt ut, malesuada at lorem. Donec vitae bibendum arcu. Aenean maximus nulla non pretium iaculis. Quisque imperdiet, nulla in pulvinar aliquet, velit quam ultrices quam, sit amet fringilla leo sem vel nunc. Mauris in lacinia lacus.\nSuspendisse a tincidunt lacus. Curabitur at urna sagittis, dictum ante sit amet, euismod magna. Sed rutrum massa id tortor commodo, vitae elementum turpis tempus. Lorem ipsum dolor sit amet, consectetur adipiscing elit. Aenean purus turpis, venenatis a ullamcorper nec, tincidunt et massa. Integer posuere quam rutrum arcu vehicula imperdiet. Mauris ullamcorper quam vitae purus congue, quis euismod magna eleifend. Vestibulum semper vel augue eget tincidunt. Fusce eget justo sodales, dapibus odio eu, ultrices lorem. Duis condimentum lorem id eros commodo, in facilisis mauris scelerisque. Morbi sed auctor leo. Nullam volutpat a lacus quis pharetra. Nulla congue rutrum magna a ornare.\nAliquam in turpis accumsan, malesuada nibh ut, hendrerit justo. Cum sociis natoque penatibus et magnis dis parturient montes, nascetur ridiculus mus. Quisque sed erat nec justo posuere suscipit. Donec ut efficitur arcu, in malesuada neque. Nunc dignissim nisl massa, id vulputate nunc pretium nec. Quisque eget urna in risus suscipit ultricies. Pellentesque odio odio, tincidunt in eleifend sed, posuere a diam. Nam gravida nisl convallis semper elementum. Morbi vitae felis faucibus, vulputate orci placerat, aliquet nisi. Aliquam erat volutpat. Maecenas sagittis pulvinar purus, sed porta quam laoreet at.\n","date":1461715200,"expirydate":-62135596800,"kind":"page","lang":"ja","lastmod":1461715200,"objectID":"8f66d660a9a2edc2d08e68cc30f701f7","permalink":"/project/internal-project/","publishdate":"2016-04-27T00:00:00Z","relpermalink":"/project/internal-project/","section":"project","summary":"An example of using the in-built project page.","tags":["Deep Learning"],"title":"Internal Project","type":"project"}]