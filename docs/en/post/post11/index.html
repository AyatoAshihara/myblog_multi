<!DOCTYPE html><html lang="en-us" >

<head>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  
  
  
  <meta name="generator" content="Wowchemy 4.8.0 for Hugo">
  

  

  
  

  
  
  
  
  
    
    
    
  
  

  <meta name="author" content="Ayato Ashihara">

  
  
  
    
  
  <meta name="description" content="I found some data missing from the last data collection, so I scraped it again.">

  
  <link rel="alternate" hreflang="ja" href="../../../post/post11/">
  
  <link rel="alternate" hreflang="en-us" href="../../../en/post/post11/">

  







  




  
  
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  

  
  
  
  <meta name="theme-color" content="#2962ff">
  

  
  
  
  <script src="../../../js/mathjax-config.js"></script>
  

  
  
  
  
    
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.14.0/css/all.min.css" integrity="sha256-FMvZuGapsJLjouA6k7Eo2lusoAX9i0ShlWFG6qt7SLc=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.css" integrity="sha256-Vzbj7sDDS/woiFS3uNKo8eIuni59rjyNGtXfstRzStA=" crossorigin="anonymous">

    
    
    
      
    
    
      
      
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.0/styles/xcode.min.css" crossorigin="anonymous" title="hl-light">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.0/styles/xcode.min.css" crossorigin="anonymous" title="hl-dark" disabled>
      
    

    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/leaflet.min.css" integrity="sha512-1xoFisiGdy9nvho8EgXuXvnpR5GAMSjFwp40gSRE3NwdUdIMIKuPa7bqoUhLD0O/5tPNhteAsE5XyyMi5reQVA==" crossorigin="anonymous">
    

    

    
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/lazysizes/5.2.2/lazysizes.min.js" integrity="sha512-TmDwFLhg3UA4ZG0Eb4MIyT1O1Mb+Oww5kFG0uHqXsdbyZz9DcvYQhKpGgNkamAI6h2lGGZq2X8ftOJvF/XjTUg==" crossorigin="anonymous" async></script>
      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js" integrity="" crossorigin="anonymous" async></script>
      
    
      

      
      

      
    
      

      
      

      
    

  

  
  
  
    
      
      
      <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Montserrat:400,700%7CRoboto:400,400italic,700%7CRoboto+Mono&display=swap">
    
  

  
  
  
  
  <link rel="stylesheet" href="../../../css/wowchemy.css">

  





<script async src="https://www.googletagmanager.com/gtag/js?id=UA-140804055-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];

  function gtag() {
      dataLayer.push(arguments);
  }

  function trackOutboundLink(url, target) {
    gtag('event', 'click', {
         'event_category': 'outbound',
         'event_label': url,
         'transport_type': 'beacon',
         'event_callback': function () {
           if (target !== '_blank') {
             document.location = url;
           }
         }
    });
    console.debug("Outbound link clicked: " + url);
  }

  function onClickCallback(event) {
    if ((event.target.tagName !== 'A') || (event.target.host === window.location.host)) {
      return;
    }
    trackOutboundLink(event.target, event.target.getAttribute('target'));  
  }

  gtag('js', new Date());
  gtag('config', 'UA-140804055-1', {});

  
  document.addEventListener('click', onClickCallback, false);
</script>


  


  
  

  

  <link rel="manifest" href="../../../en/index.webmanifest">
  <link rel="icon" type="image/png" href="../../../images/icon_hu0b7a4cb9992c9ac0e91bd28ffd38dd00_9727_32x32_fill_lanczos_center_2.png">
  <link rel="apple-touch-icon" type="image/png" href="../../../images/icon_hu0b7a4cb9992c9ac0e91bd28ffd38dd00_9727_192x192_fill_lanczos_center_2.png">

  <link rel="canonical" href="../../../en/post/post11/">

  
  
  
  
  
  
  
    
  
  
  <meta property="twitter:card" content="summary_large_image">
  
  <meta property="og:site_name" content="東京の資産運用会社で働く社会人が研究に没頭するブログ">
  <meta property="og:url" content="/en/post/post11/">
  <meta property="og:title" content="Scraping past race results on yahoo horse racing on rvest (for the second time) | 東京の資産運用会社で働く社会人が研究に没頭するブログ">
  <meta property="og:description" content="I found some data missing from the last data collection, so I scraped it again."><meta property="og:image" content="/en/post/post11/featured.png">
  <meta property="twitter:image" content="/en/post/post11/featured.png"><meta property="og:locale" content="en-us">
  
    
      <meta property="article:published_time" content="2019-07-13T00:00:00&#43;00:00">
    
    <meta property="article:modified_time" content="2019-07-13T00:00:00&#43;00:00">
  

  


    






  




<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "/en/post/post11/"
  },
  "headline": "Scraping past race results on yahoo horse racing on rvest (for the second time)",
  
  "image": [
    "/en/post/post11/featured.png"
  ],
  
  "datePublished": "2019-07-13T00:00:00Z",
  "dateModified": "2019-07-13T00:00:00Z",
  
  "author": {
    "@type": "Person",
    "name": "Ayato Ashihara"
  },
  
  "publisher": {
    "@type": "Organization",
    "name": "東京の資産運用会社で働く社会人が研究に没頭するブログ",
    "logo": {
      "@type": "ImageObject",
      "url": "/images/icon_hu0b7a4cb9992c9ac0e91bd28ffd38dd00_9727_192x192_fill_lanczos_center_2.png"
    }
  },
  "description": "I found some data missing from the last data collection, so I scraped it again."
}
</script>

  

  


  


  





  <title>Scraping past race results on yahoo horse racing on rvest (for the second time) | 東京の資産運用会社で働く社会人が研究に没頭するブログ</title>

</head>


<body id="top" data-spy="scroll" data-offset="70" data-target="#TableOfContents" class=" ">

  
  
  
    <script>window.wcDarkLightEnabled = true;</script>
  
  
    <script>const isSiteThemeDark = false;</script>
  
  
  <script src="../../../js/load-theme.js"></script>

  <aside class="search-results" id="search">
  <div class="container">
    <section class="search-header">

      <div class="row no-gutters justify-content-between mb-3">
        <div class="col-6">
          <h1>Search</h1>
        </div>
        <div class="col-6 col-search-close">
          <a class="js-search" href="#"><i class="fas fa-times-circle text-muted" aria-hidden="true"></i></a>
        </div>
      </div>

      <div id="search-box">
        
        <input name="q" id="search-query" placeholder="Search..." autocapitalize="off"
        autocomplete="off" autocorrect="off" spellcheck="false" type="search" class="form-control">
        
      </div>

    </section>
    <section class="section-search-results">

      <div id="search-hits">
        
      </div>

    </section>
  </div>
</aside>


  












<nav class="navbar navbar-expand-lg navbar-light compensate-for-scrollbar" id="navbar-main">
  <div class="container">

    
    <div class="d-none d-lg-inline-flex">
      <a class="navbar-brand" href="../../../en">東京の資産運用会社で働く社会人が研究に没頭するブログ</a>
    </div>
    

    
    <button type="button" class="navbar-toggler" data-toggle="collapse"
            data-target="#navbar-content" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
    <span><i class="fas fa-bars"></i></span>
    </button>
    

    
    <div class="navbar-brand-mobile-wrapper d-inline-flex d-lg-none">
      <a class="navbar-brand" href="../../../en">東京の資産運用会社で働く社会人が研究に没頭するブログ</a>
    </div>
    

    
    
    <div class="navbar-collapse main-menu-item collapse justify-content-start" id="navbar-content">

      
      <ul class="navbar-nav d-md-inline-flex">
        

        

        
        
        
          
        

        

        
        
        
        

        
          
            
            
          
          
            
            
            
              
            
            
          
        

        <li class="nav-item">
          <a class="nav-link " href="../../../en/#about"><span>About</span></a>
        </li>

        
        

        

        
        
        
          
        

        

        
        
        
        

        
          
            
            
          
          
        

        <li class="nav-item">
          <a class="nav-link  active" href="../../../en/post"><span>Posts</span></a>
        </li>

        
        

        

        
        
        
          
        

        

        
        
        
        

        
          
            
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="../../../en/publication"><span>Publications</span></a>
        </li>

        
        

        

        
        
        
          
        

        

        
        
        
        

        
          
            
            
          
          
            
            
            
              
            
            
          
        

        <li class="nav-item">
          <a class="nav-link " href="../../../en/#contact"><span>Contact</span></a>
        </li>

        
        

      

        
      </ul>
    </div>

    <ul class="nav-icons navbar-nav flex-row ml-auto d-flex pl-md-2">
      
      
      <li class="nav-item">
        <a class="nav-link js-search" href="#" aria-label="Search"><i class="fas fa-search" aria-hidden="true"></i></a>
      </li>
      

      
      
      <li class="nav-item dropdown theme-dropdown">
        <a href="#" class="nav-link" data-toggle="dropdown" aria-haspopup="true">
          <i class="fas fa-moon" aria-hidden="true"></i>
        </a>
        <div class="dropdown-menu">
          <a href="#" class="dropdown-item js-set-theme-light">
            <span>Light</span>
          </a>
          <a href="#" class="dropdown-item js-set-theme-dark">
            <span>Dark</span>
          </a>
          <a href="#" class="dropdown-item js-set-theme-auto">
            <span>Automatic</span>
          </a>
        </div>
      </li>
      

      
      <li class="nav-item dropdown i18n-dropdown">
        <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown" aria-haspopup="true">
          <i class="fas fa-globe mr-1" aria-hidden="true"></i><span class="d-none d-lg-inline">English</span></a>
        <div class="dropdown-menu">
          <div class="dropdown-item dropdown-item-active">
            <span>English</span>
          </div>
          
          <a class="dropdown-item" href="../../../post/post11/">
            <span>日本語</span>
          </a>
          
        </div>
      </li>
      

    </ul>

  </div>
</nav>



  <article class="article">

  




















  
  


<div class="article-container pt-3">
  <h1>Scraping past race results on yahoo horse racing on rvest (for the second time)</h1>

  

  


<div class="article-metadata">

  
  

  
  <span class="article-date">
    
    
      
    
    Jul 13, 2019
  </span>
  

  

  
  <span class="middot-divider"></span>
  <span class="article-reading-time">
    9 min read
  </span>
  

  
  
  
  <span class="middot-divider"></span>
  <a href="../../../en/post/post11/#disqus_thread"></a>
  

  
  
  <span class="middot-divider"></span>
  <span class="article-categories">
    <i class="fas fa-folder mr-1"></i><a href="../../../en/category/%E7%AB%B6%E9%A6%AC/">競馬</a></span>
  

</div>

  














</div>


<div class="article-header container featured-image-wrapper mt-4 mb-4" style="max-width: 1024px; max-height: 517px;">
  <div style="position: relative">
    <img src="../../../en/post/post11/featured.png" alt="" class="featured-image">
    
  </div>
</div>



  <div class="article-container">

    <div class="article-style">
      
<script src="index_files/header-attrs/header-attrs.js"></script>

<div id="TOC">
<ul>
<li><a href="#script">1. Script</a></li>
</ul>
</div>

<p>For the second time, I’d like to drop past race results in rvest again. If you haven’t seen the past articles, I suggest you look at that one first.</p>
<p>The reason I decided to take back the data this time is because I wanted to add more items to the explanatory variables when analyzing horse racing. So this time I created the program as an addition to the previous R script. The 14 new data items I added are as follows</p>
<ol style="list-style-type: decimal">
<li>grass or dirt.</li>
<li>right-handed or left-handed.</li>
<li>race conditions (good or slight)</li>
<li>weather</li>
<li>the color of the horse’s coat (chestnut, deer hair, etc.)</li>
<li>horse owner</li>
<li>producers</li>
<li>place of origin</li>
<li>date of birth</li>
<li>the father’s horse</li>
<li>the mother’s horse</li>
<li>winnings up to that race (available from 2003)</li>
<li>jockey’s weight.</li>
<li>increase or decrease in the weight of the jockey.</li>
</ol>
<p>Actually, I haven’t finished collecting data yet, and the R program has been running for a long time (I’ve been running it for about 3 days). However, the program itself is running tightly and I’ll try to introduce the script. Maybe I’ll write the results in a postscript.</p>
<div id="script" class="section level2">
<h2>1. Script</h2>
<p>The first step is to call the package.</p>
<pre class="r"><code># Web scraping of horse racing data by rvest

#install.packages(&quot;rvest&quot;)
#if (!require(&quot;pacman&quot;)) install.packages(&quot;pacman&quot;)
#install.packages(&quot;beepr&quot;)
#install.packages(&quot;RSQLite&quot;)
pacman::p_load(qdapRegex)
library(rvest)
library(stringr)
library(dplyr)
library(beepr)
library(RSQLite)</code></pre>
<p>I’m pretty much warnning out, so I’m banning it and connecting to SQLite</p>
<pre class="r"><code># warning prohibition
options(warn=-1)

# Connecting to SQLite
con = dbConnect(SQLite(), &quot;horse_data.db&quot;, synchronous=&quot;off&quot;)</code></pre>
<p>Since the odds are only available since 1994, the data is taken from 1994 up to the most recent date. yahoo horse racing has races organized by month, so the data is taken using that as a variable. Basically, you go to <a href="https://keiba.yahoo.co.jp/schedule/list/2018/?month=7">List of race results for the relevant year and month</a> and then go to <a href="https://keiba.yahoo.co.jp/race/list/18020106/">Timetable for each day of the race</a> for each day on that page. Since there are roughly a dozen or so races at each individual track, get the link and go to the <a href="https://keiba.yahoo.co.jp/race/result/1802010601/">race results page</a> for each race. Then you will get the race results. The first step is to get a link to the timetable for each individual racecourse for each day.</p>
<pre class="r"><code>for(year in 1994:2019){
  start.time &lt;- Sys.time() # calculate time
  # Retrieve the race results page on Yahoo!
  for (k in 1:12){ # K is for the month.
    
    tryCatch(
      {
        keiba.yahoo &lt;- read_html(str_c(&quot;https://keiba.yahoo.co.jp/schedule/list/&quot;, year,&quot;/?month=&quot;,k)) # Access to the list of race results for a given year and month
        Sys.sleep(2)
        race_lists &lt;- keiba.yahoo %&gt;%
          html_nodes(&quot;a&quot;) %&gt;% 
          html_attr(&quot;href&quot;) # Retrieve all URLs
        
        # Get the list of races for each day by track
        race_lists &lt;- race_lists[str_detect(race_lists, pattern=&quot;race/list/\\d+/&quot;)==1] # Extracts URLs containing &quot;results&quot;.
      }
      , error = function(e){signal &lt;- 1}
    )</code></pre>
<p>Here, we only extract the links we get that contain the word result in the url. In essence, it is a link to the race tables of each racecourse. From here, we use the links to the race tables of the tracks to access that page and get the links to the pages that contain the results of all 12 races.</p>
<pre class="r"><code>    for (j in 1:length(race_lists)){ # where j is the link to the race table for the year in question.
      
      tryCatch(
        {
          race_list &lt;- read_html(str_c(&quot;https://keiba.yahoo.co.jp&quot;,race_lists[j]))
          race_url &lt;- race_list %&gt;% html_nodes(&quot;a&quot;) %&gt;% html_attr(&quot;href&quot;) # 全urlを取得
          
          # Get the URL of the race results
          race_url &lt;- race_url[str_detect(race_url, pattern=&quot;result&quot;)==1] # Extracts URLs containing &quot;results&quot;.
        }
        , error = function(e){signal &lt;- 1}
      )</code></pre>
<p>Now that we have the links to the results of each race, it’s time to get the race results and the formatting part of the code. It’s quite a long and complicated code. The race results are stored in the following table attributes, so we’ll simply pull them first.</p>
<pre class="r"><code>      for (i in 1:length(race_url)){ # where i is the race that was held at the racecourse in question
        
        print(str_c(year, &quot;/&quot;, k, &quot;/&quot;,j, &quot; group &quot;, i,&quot; order&quot;))
        
        tryCatch(
          {
            race1 &lt;-  read_html(str_c(&quot;https://keiba.yahoo.co.jp&quot;,race_url[i])) # Get the URL of the race results
            signal &lt;- 0
            Sys.sleep(2)
          }
          , error = function(e){signal &lt;- 1}
        )
        
        # If the race is aborted or there are no errors in the process so far, run the process
        if (identical(race1 %&gt;%
                      html_nodes(xpath = &quot;//div[@class = &#39;resultAtt mgnBL fntSS&#39;]&quot;) %&gt;%
                      html_text(),character(0)) == TRUE &amp;&amp; signal == 0){
          
          # Scraping the race results
          race_result &lt;- race1 %&gt;% html_nodes(xpath = &quot;//table[@id = &#39;raceScore&#39;]&quot;) %&gt;%
            html_table()
          race_result &lt;- do.call(&quot;data.frame&quot;,race_result) # Change the list to a data frame.
          
          colnames(race_result) &lt;- c(&quot;order&quot;,&quot;frame_number&quot;,&quot;horse_number&quot;,&quot;horse_name/age&quot;,&quot;time/margin&quot;,&quot;passing_rank/last_3F&quot;,&quot;jockey/weight&quot;,&quot;popularity/odds&quot;,&quot;trainer&quot;) #　column renaming</code></pre>
<p>If you just get a table, it will not be useful for analysis because of the following or multiple information in one cell. So, we need to mold the data into a form.</p>
<pre class="r"><code>          # Passing order and time for 3 furlongs uphill
          race_result &lt;- dplyr::mutate(race_result,passing_rank=as.character(str_extract_all(race_result$`passing_rank/last_3F`,&quot;(\\d{2}-\\d{2}-\\d{2}-\\d{2})|(\\d{2}-\\d{2}-\\d{2})|(\\d{2}-\\d{2})&quot;)))
          race_result &lt;- dplyr::mutate(race_result,last_3F=as.character(str_extract_all(race_result$`passing_rank/last_3F`,&quot;\\d{2}\\.\\d&quot;)))
          race_result &lt;- race_result[-6]
          
          # Time and Difference
          race_result &lt;- dplyr::mutate(race_result,time=as.character(str_extract_all(race_result$`time/margin`,&quot;\\d\\.\\d{2}\\.\\d|\\d{2}\\.\\d&quot;)))
          race_result &lt;- dplyr::mutate(race_result,margin=as.character(str_extract_all(race_result$`time/margin`,&quot;./.馬身|.馬身|.[:space:]./.馬身|[ア-ン-]+&quot;)))
          race_result$margin[race_result$order==1] &lt;- &quot;トップ&quot;
          race_result$margin[race_result$margin==&quot;character(0)&quot;] &lt;- &quot;大差&quot;
          race_result$margin[race_result$order==0] &lt;- NA
          race_result &lt;- race_result[-5]
          
          # Horse&#39;s name, age and weight
          race_result &lt;- dplyr::mutate(race_result,horse_name=as.character(str_extract_all(race_result$`horse_name/age`,&quot;[ァ-ヴー・]+&quot;)))
          race_result &lt;- dplyr::mutate(race_result,horse_age=as.character(str_extract_all(race_result$`horse_name/age`,&quot;牡\\d+|牝\\d+|せん\\d+&quot;)))
          race_result$horse_sex &lt;- str_extract(race_result$horse_age, pattern = &quot;牡|牝|せん&quot;)
          race_result$horse_age &lt;- str_extract(race_result$horse_age, pattern = &quot;\\d&quot;)
          race_result &lt;- dplyr::mutate(race_result,horse_weight=as.character(str_extract_all(race_result$`horse_name/age`,&quot;\\d{3}&quot;)))
          race_result &lt;- dplyr::mutate(race_result,horse_weight_change=as.character(str_extract_all(race_result$`horse_name/age`,&quot;\\([\\+|\\-]\\d+\\)|\\([\\d+]\\)&quot;)))
          race_result$horse_weight_change &lt;- sapply(rm_round(race_result$horse_weight_change, extract=TRUE), paste, collapse=&quot;&quot;)
          race_result &lt;- dplyr::mutate(race_result,brinker=as.character(str_extract_all(race_result$`horse_name/age`,&quot;B&quot;)))
          race_result$brinker[race_result$brinker!=&quot;B&quot;] &lt;- &quot;N&quot;
          race_result &lt;- race_result[-4]
          
          # jockey
          race_result &lt;- dplyr::mutate(race_result,jockey=as.character(str_extract_all(race_result$`jockey/weight`,&quot;[ぁ-ん一-龠]+\\s[ぁ-ん一-龠]+|[:upper:].[ァ-ヶー]+&quot;)))
          race_result &lt;- dplyr::mutate(race_result,jockey_weight=as.character(str_extract_all(race_result$`jockey/weight`,&quot;\\d{2}&quot;)))
          race_result$jockey_weight_change &lt;- 0
          race_result$jockey_weight_change[str_detect(race_result$`jockey/weight`,&quot;☆&quot;)==1] &lt;- 1
          race_result$jockey_weight_change[str_detect(race_result$`jockey/weight`,&quot;△&quot;)==1] &lt;- 2
          race_result$jockey_weight_change[str_detect(race_result$`jockey/weight`,&quot;△&quot;)==1] &lt;- 3
          race_result &lt;- race_result[-4]
          
          # Odds and popularity
          race_result &lt;- dplyr::mutate(race_result,odds=as.character(str_extract_all(race_result$`popularity/odds`,&quot;\\(.+\\)&quot;)))
          race_result &lt;- dplyr::mutate(race_result,popularity=as.character(str_extract_all(race_result$`popularity/odds`,&quot;\\d+[^(\\d+.\\d)]&quot;)))
          race_result$odds &lt;- sapply(rm_round(race_result$odds, extract=TRUE), paste, collapse=&quot;&quot;)
          race_result &lt;- race_result[-4]</code></pre>
<p>Next, we’ll import information other than the table we just retrieved. Specifically, race names, weather conditions, track conditions, dates, racecourses, etc. These information are listed at the top of the race results page.</p>
<pre class="r"><code>          # Race Information
          race_date &lt;- race1 %&gt;% html_nodes(xpath = &quot;//div[@id = &#39;raceTitName&#39;]/p[@id = &#39;raceTitDay&#39;]&quot;) %&gt;%
            html_text()
          race_name &lt;- race1 %&gt;% html_nodes(xpath = &quot;//div[@id = &#39;raceTitName&#39;]/h1[@class = &#39;fntB&#39;]&quot;) %&gt;%
            html_text()
          race_distance &lt;- race1 %&gt;% html_nodes(xpath = &quot;//p[@id = &#39;raceTitMeta&#39;]&quot;) %&gt;%
            html_text()
        
          race_result &lt;- dplyr::mutate(race_result,race_date=as.character(str_extract_all(race_date,&quot;\\d+年\\d+月\\d+日&quot;)))
          race_result$race_date &lt;- str_replace_all(race_result$race_date,&quot;年&quot;,&quot;/&quot;)
          race_result$race_date &lt;- str_replace_all(race_result$race_date,&quot;月&quot;,&quot;/&quot;)
          race_result$race_date &lt;- as.Date(race_result$race_date)
          race_course &lt;- as.character(str_extract_all(race_date,pattern = &quot;札幌|函館|福島|新潟|東京|中山|中京|京都|阪神|小倉&quot;))
          race_result$race_course &lt;- race_course
          race_result &lt;- dplyr::mutate(race_result,race_name=as.character(str_replace_all(race_name,&quot;\\s&quot;,&quot;&quot;)))
          race_result &lt;- dplyr::mutate(race_result,race_distance=as.character(str_extract_all(race_distance,&quot;\\d+m&quot;)))
          race_type=as.character(str_extract_all(race_distance,pattern = &quot;芝|ダート&quot;))
          race_result$type &lt;- race_type
          race_turn &lt;- as.character(str_extract_all(race_distance,pattern = &quot;右|左&quot;))
          race_result$race_turn &lt;- race_turn
          
          if(length(race1 %&gt;% html_nodes(xpath = &quot;//img[@class = &#39;spBg ryou&#39;]&quot;)) == 1){
            race_result$race_condition &lt;- &quot;良&quot;
          } else if (length(race1 %&gt;% 
                            html_nodes(xpath = &quot;//img[@class = &#39;spBg yayaomo&#39;]&quot;)) == 1){
            race_result$race_condition &lt;- &quot;稍重&quot;
          } else if (length(race1 %&gt;%
                            html_nodes(xpath = &quot;//img[@class = &#39;spBg omo&#39;]&quot;)) == 1){
            race_result$race_condition &lt;- &quot;重&quot;
          } else if (length(race1 %&gt;% 
                            html_nodes(xpath = &quot;//img[@class = &#39;spBg furyou&#39;]&quot;)) == 1){
            race_result$race_condition &lt;- &quot;不良&quot;
          } else race_result$race_condition &lt;- &quot;NA&quot;
          
          if (length(race1 %&gt;% html_nodes(xpath = &quot;//img[@class = &#39;spBg hare&#39;]&quot;)) == 1){
            race_result$race_weather &lt;- &quot;晴れ&quot;
          } else if (length(race1 %&gt;% html_nodes(xpath = &quot;//img[@class = &#39;spBg ame&#39;]&quot;)) == 1){
            race_result$race_weather &lt;- &quot;曇り&quot;
          } else if (length(race1 %&gt;% html_nodes(xpath = &quot;//img[@class = &#39;spBg kumori&#39;]&quot;)) == 1){
            race_result$race_weather &lt;- &quot;雨&quot;
          } else race_result$race_weather &lt;- &quot;その他&quot;</code></pre>
<p>The next step is to get information about each horse. In fact, the horse’s name in the table we got earlier is a link, and if you follow the link, you can get [information about each horse] (<a href="https://keiba.yahoo.co.jp/directory/horse/2015105508/" class="uri">https://keiba.yahoo.co.jp/directory/horse/2015105508/</a>) (such as coat color and date of birth).</p>
<pre class="r"><code>          horse_url &lt;- race1 %&gt;% html_nodes(&quot;a&quot;) %&gt;% html_attr(&quot;href&quot;) 
          horse_url &lt;- horse_url[str_detect(horse_url, pattern=&quot;directory/horse&quot;)==1] # Extract only links to horse information.
          
          for (l in 1:length(horse_url)){
            tryCatch(
              {
                horse1 &lt;-  read_html(str_c(&quot;https://keiba.yahoo.co.jp&quot;,horse_url[l]))
                Sys.sleep(0.5)
                horse_name &lt;- horse1 %&gt;% html_nodes(xpath = &quot;//div[@id = &#39;dirTitName&#39;]/h1[@class = &#39;fntB&#39;]&quot;) %&gt;% 
                  html_text()
                horse &lt;- horse1 %&gt;% html_nodes(xpath = &quot;//div[@id = &#39;dirTitName&#39;]/ul&quot;) %&gt;% 
                  html_text()
                race_result$colour[race_result$horse_name==horse_name] &lt;- as.character(str_extract_all(horse,&quot;毛色：.+&quot;)) 
                race_result$owner[race_result$horse_name==horse_name] &lt;- as.character(str_extract_all(horse,&quot;馬主：.+&quot;))
                race_result$farm[race_result$horse_name==horse_name] &lt;- as.character(str_extract_all(horse,&quot;生産者：.+&quot;))
                race_result$locality[race_result$horse_name==horse_name] &lt;- as.character(str_extract_all(horse,&quot;産地：.+&quot;))
                race_result$horse_birthday[race_result$horse_name==horse_name] &lt;- as.character(str_extract_all(horse,&quot;\\d+年\\d+月\\d+日&quot;))
                race_result$father[race_result$horse_name==horse_name] &lt;- horse1 %&gt;% html_nodes(xpath = &quot;//td[@class = &#39;bloodM&#39;][@rowspan = &#39;4&#39;]&quot;) %&gt;% html_text()
                race_result$mother[race_result$horse_name==horse_name] &lt;- horse1 %&gt;% html_nodes(xpath = &quot;//td[@class = &#39;bloodF&#39;][@rowspan = &#39;4&#39;]&quot;) %&gt;% html_text()
              }
              , error = function(e){
                race_result$colour[race_result$horse_name==horse_name] &lt;- NA 
                race_result$owner[race_result$horse_name==horse_name] &lt;- NA
                race_result$farm[race_result$horse_name==horse_name] &lt;- NA
                race_result$locality[race_result$horse_name==horse_name] &lt;- NA
                race_result$horse_birthday[race_result$horse_name==horse_name] &lt;- NA
                race_result$father[race_result$horse_name==horse_name] &lt;- NA
                race_result$mother[race_result$horse_name==horse_name] &lt;- NA
                }
            )
          }
          
          race_result$colour &lt;- str_replace_all(race_result$colour,&quot;毛色：&quot;,&quot;&quot;)
          race_result$owner &lt;- str_replace_all(race_result$owner,&quot;馬主：&quot;,&quot;&quot;)
          race_result$farm &lt;- str_replace_all(race_result$farm,&quot;生産者：&quot;,&quot;&quot;)
          race_result$locality &lt;- str_replace_all(race_result$locality,&quot;産地：&quot;,&quot;&quot;)
          #race_result$horse_birthday &lt;- str_replace_all(race_result$horse_birthday,&quot;年&quot;,&quot;/&quot;)
          #race_result$horse_birthday &lt;- str_replace_all(race_result$horse_birthday,&quot;月&quot;,&quot;/&quot;)
          #race_result$horse_birthday &lt;- as.Date(race_result$horse_birthday)
          
          race_result &lt;- dplyr::arrange(race_result,horse_number) # arrange in order of precedence</code></pre>
<p>The next step is to go and drop the amount of money you have won up to that race. You can access this by following the link marked [Runoffs] (<a href="https://keiba.yahoo.co.jp/race/denma/1802010601/" class="uri">https://keiba.yahoo.co.jp/race/denma/1802010601/</a>) on the race results page. This is where you will find the prize money and you will get it.</p>
<pre class="r"><code>          yosou_url &lt;- race1 %&gt;% html_nodes(&quot;a&quot;) %&gt;% html_attr(&quot;href&quot;) 
          yosou_url &lt;- yosou_url[str_detect(yosou_url, pattern=&quot;denma&quot;)==1]
          
          if (length(yosou_url)==1){
          yosou1 &lt;-  read_html(str_c(&quot;https://keiba.yahoo.co.jp&quot;,yosou_url)) 
          Sys.sleep(2)
          yosou &lt;- yosou1 %&gt;% html_nodes(xpath = &quot;//td[@class = &#39;txC&#39;]&quot;) %&gt;% as.character()
          prize &lt;- yosou[grepl(&quot;万&quot;,yosou)==TRUE] %&gt;% str_extract_all(&quot;\\d+万&quot;)
          prize &lt;- t(do.call(&quot;data.frame&quot;,prize)) %&gt;% as.character()
          race_result$prize &lt;- prize
          race_result$prize &lt;- str_replace_all(race_result$prize,&quot;万&quot;,&quot;&quot;) %&gt;% as.numeric()
          } else race_result$prize &lt;- NA</code></pre>
<p>We create a data frame called dataset to store the results of each race and store the data.</p>
<pre class="r"><code>          ## file storage
          if (k == 1 &amp;&amp; i == 1 &amp;&amp; j == 1){
            dataset &lt;- race_result
          } else {
            dataset &lt;- rbind(dataset,race_result)
          }
        }else
        {
          print(&quot;We couldn&#39;t save it.&quot;) 
        }
      }
    }
  }
  beep(3)
  write.csv(dataset,&quot;race_result2.csv&quot;, row.names = FALSE)
  
  if (year == 1994){
    dbWriteTable(con, &quot;race_result&quot;, dataset)
  } else {
    dbWriteTable(con, &quot;temp&quot;, dataset)
    dbSendQuery(con, &quot;INSERT INTO race_result select * from temp&quot;)
    dbSendQuery(con, &quot;DROP TABLE temp&quot;)
  }
}
end.time &lt;- Sys.time()
print(str_c(&quot;処理時間は&quot;,end.time-start.time,&quot;です。&quot;))
beep(5)

options(warn = 1)

dbDisconnect(con)</code></pre>
<p>That’s all. The data taken is as follows</p>
<pre class="r"><code>head(race_result)</code></pre>
<pre><code>##   order frame_number horse_number   trainer passing_rank last_3F   time
## 1    10            1            1   田中 剛        09-09    39.0 1.14.3
## 2    16            1            2 天間 昭一        11-11    40.3 1.15.7
## 3    15            2            3 田中 清隆        14-14    39.4 1.15.1
## 4     9            2            4 中舘 英二        08-08    39.1 1.14.3
## 5    12            3            5 根本 康広        11-11    39.0 1.14.4
## 6     4            3            6 杉浦 宏昭        04-04    38.4 1.13.2
##      margin         horse_name horse_age horse_sex horse_weight
## 1    アタマ     サトノジョニー         3        牡          512
## 2 3 1/2馬身       ツギノイッテ         3        牡          464
## 3     3馬身           ギュウホ         3        牡          444
## 4 2 1/2馬身 セイウンメラビリア         3        牝          466
## 5      クビ サバイバルトリック         3        牝          450
## 6    アタマ       ステイホット         3        牝          474
##   horse_weight_change brinker      jockey jockey_weight jockey_weight_change
## 1                 +30       N   松岡 正海            56                    0
## 2                  +8       N 西田 雄一郎            56                    0
## 3                  +8       N   杉原 誠人            56                    0
## 4                 +10       N   村田 一誠            54                    0
## 5                  -2       N 野中 悠太郎            51                    0
## 6                  -2       N   大野 拓弥            54                    0
##    odds popularity  race_date race_course       race_name race_distance   type
## 1  40.3         9  2019-01-05        中山 サラ系3歳未勝利         1200m ダート
## 2 340.9        16  2019-01-05        中山 サラ系3歳未勝利         1200m ダート
## 3 283.1        14  2019-01-05        中山 サラ系3歳未勝利         1200m ダート
## 4 299.7        15  2019-01-05        中山 サラ系3歳未勝利         1200m ダート
## 5  26.7         8  2019-01-05        中山 サラ系3歳未勝利         1200m ダート
## 6   2.4         1  2019-01-05        中山 サラ系3歳未勝利         1200m ダート
##   race_turn race_condition race_weather colour                           owner
## 1        右             良         晴れ   栗毛 株式会社 サトミホースカンパニー
## 2        右             良         晴れ 黒鹿毛                     西村 新一郎
## 3        右             良         晴れ   鹿毛           有限会社 ミルファーム
## 4        右             良         晴れ 青鹿毛                       西山 茂行
## 5        右             良         晴れ 黒鹿毛                       福田 光博
## 6        右             良         晴れ   栗毛                       小林 善一
##           farm   locality horse_birthday                 father
## 1   千代田牧場 新ひだか町  2016年1月29日         オルフェーヴル
## 2    織笠 時男     青森県  2016年4月17日 スクワートルスクワート
## 3    神垣 道弘 新ひだか町  2016年4月19日     ジャングルポケット
## 4  石郷岡 雅樹     新冠町  2016年4月21日     キンシャサノキセキ
## 5     原田牧場     日高町  2016年4月30日       リーチザクラウン
## 6 社台ファーム     千歳市  2016年3月13日     キャプテントゥーレ
##               mother prize
## 1 スパークルジュエル     0
## 2   エプソムアイリス     0
## 3     デライトシーン     0
## 4     ドリームシップ     0
## 5   フリーダムガール   180
## 6     ステイアライヴ   455</code></pre>
</div>

    </div>

    






<div class="article-tags">
  
  <a class="badge badge-light" href="../../../en/tag/r/">R</a>
  
  <a class="badge badge-light" href="../../../en/tag/web_scraping/">Web_scraping</a>
  
  <a class="badge badge-light" href="../../../en/tag/preprocessing/">preprocessing</a>
  
  <a class="badge badge-light" href="../../../en/tag/sql/">SQL</a>
  
</div>



<div class="share-box" aria-hidden="true">
  <ul class="share">
    
      
      
      
        
      
      
      
      <li>
        <a href="https://twitter.com/intent/tweet?url=../../../en/post/post11/&amp;text=Scraping%20past%20race%20results%20on%20yahoo%20horse%20racing%20on%20rvest%20%28for%20the%20second%20time%29" target="_blank" rel="noopener" class="share-btn-twitter">
          <i class="fab fa-twitter"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://www.facebook.com/sharer.php?u=/en/post/post11/&amp;t=Scraping%20past%20race%20results%20on%20yahoo%20horse%20racing%20on%20rvest%20%28for%20the%20second%20time%29" target="_blank" rel="noopener" class="share-btn-facebook">
          <i class="fab fa-facebook"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="mailto:?subject=Scraping%20past%20race%20results%20on%20yahoo%20horse%20racing%20on%20rvest%20%28for%20the%20second%20time%29&amp;body=/en/post/post11/" target="_blank" rel="noopener" class="share-btn-email">
          <i class="fas fa-envelope"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://www.linkedin.com/shareArticle?url=../../../en/post/post11/&amp;title=Scraping%20past%20race%20results%20on%20yahoo%20horse%20racing%20on%20rvest%20%28for%20the%20second%20time%29" target="_blank" rel="noopener" class="share-btn-linkedin">
          <i class="fab fa-linkedin-in"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="whatsapp://send?text=Scraping%20past%20race%20results%20on%20yahoo%20horse%20racing%20on%20rvest%20%28for%20the%20second%20time%29%20/en/post/post11/" target="_blank" rel="noopener" class="share-btn-whatsapp">
          <i class="fab fa-whatsapp"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://service.weibo.com/share/share.php?url=../../../en/post/post11/&amp;title=Scraping%20past%20race%20results%20on%20yahoo%20horse%20racing%20on%20rvest%20%28for%20the%20second%20time%29" target="_blank" rel="noopener" class="share-btn-weibo">
          <i class="fab fa-weibo"></i>
        </a>
      </li>
    
  </ul>
</div>











  
  



  
  
  
    
  
  
  
  <div class="media author-card content-widget-hr">
    
      
      <a href="../../../"><img class="avatar mr-3 avatar-circle" src="../../../en/author/ayato-ashihara/avatar_hu77c0c0affdebd3b9cbda9c39412092b5_245163_270x270_fill_q90_lanczos_center.jpg" alt="Ayato Ashihara"></a>
    

    <div class="media-body">
      <h5 class="card-title"><a href="../../../">Ayato Ashihara</a></h5>
      <h6 class="card-subtitle">company employee</h6>
      <p class="card-text">This blog is a nightly update by a man who is working in his third year since completing graduate school. The content of this blog has nothing to do with the official position of the author&rsquo;s organization.</p>
      <ul class="network-icon" aria-hidden="true">
  
    
    
    
      
    
    
    
    
    
      
    
    <li>
      <a href="../../../en/#contact" >
        <i class="fas fa-envelope"></i>
      </a>
    </li>
  
    
    
    
      
    
    
    
    
    
      
    
    <li>
      <a href="https://www.facebook.com/ASSIY" target="_blank" rel="noopener">
        <i class="fab fa-facebook"></i>
      </a>
    </li>
  
    
    
    
      
    
    
    
    
    
      
    
    <li>
      <a href="https://github.com/AyatoAshihara/myblog_jp" target="_blank" rel="noopener">
        <i class="fab fa-github"></i>
      </a>
    </li>
  
    
    
    
      
    
    
    
    
    
      
    
    <li>
      <a href="https://www.linkedin.com/in/%E5%BD%A9%E4%BA%BA-%E8%91%A6%E5%8E%9F-9391b7143/" target="_blank" rel="noopener">
        <i class="fab fa-linkedin"></i>
      </a>
    </li>
  
</ul>

    </div>
  </div>







<section id="comments">
  
    
<div id="disqus_thread"></div>
<script>
  let disqus_config = function () {
    
    
    
  };
  (function() {
    if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
      document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
      return;
    }
    var d = document, s = d.createElement('script'); s.async = true;
    s.src = 'https://' + "ayatoashihara-github-io-myblog-multi" + '.disqus.com/embed.js';
    s.setAttribute('data-timestamp', +new Date());
    (d.head || d.body).appendChild(s);
  })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>


  
</section>








  
  
  <div class="article-widget content-widget-hr">
    <h3>Related</h3>
    <ul>
      
      <li><a href="../../../en/post/post22/">Get macro panel data from OECD.org via API</a></li>
      
      <li><a href="../../../en/post/post21/">Rcpp to speed up data handling (using Tick data processing as an example)</a></li>
      
      <li><a href="../../../en/post/post20/">Automatically cropping the background of a horse body photo with Pytorch&#39;s Pre-trained model</a></li>
      
      <li><a href="../../../en/post/post18/">I predicted the standings based on horse photos using CNN.</a></li>
      
      <li><a href="../../../en/post/post16/">Predicting Horse Racing Results Using LightGBM</a></li>
      
    </ul>
  </div>
  





  </div>
</article>

      

    
    
    
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.imagesloaded/4.1.4/imagesloaded.pkgd.min.js" integrity="sha256-lqvxZrPLtfffUl2G/e7szqSvPBILGbwmsGE1MKlOi0Q=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.isotope/3.0.6/isotope.pkgd.min.js" integrity="sha256-CBrpuqrMhXwcLLUd5tvQ4euBHCdh7wGlDfNz8vbu/iI=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.js" integrity="sha256-yt2kYMy0w8AbtF89WXb2P1rfjcP/HTHLT7097U8Y5b8=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/instant.page/5.1.0/instantpage.min.js" integrity="sha512-1+qUtKoh9XZW7j+6LhRMAyOrgSQKenQ4mluTR+cvxXjP1Z54RxZuzstR/H9kgPXQsVB8IW7DMDFUJpzLjvhGSQ==" crossorigin="anonymous"></script>

      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mermaid/8.8.0/mermaid.min.js" integrity="sha512-ja+hSBi4JDtjSqc4LTBsSwuBT3tdZ3oKYKd07lTVYmCnTCor56AnRql00ssqnTOR9Ss4gOP/ROGB3SfcJnZkeg==" crossorigin="anonymous" title="mermaid"></script>
      

      
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.0/highlight.min.js" integrity="sha512-TDKKr+IvoqZnPzc3l35hdjpHD0m+b2EC2SrLEgKDRWpxf2rFCxemkgvJ5kfU48ip+Y+m2XVKyOCD85ybtlZDmw==" crossorigin="anonymous"></script>
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.0/languages/r.min.js"></script>
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.0/languages/latex.min.js"></script>
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.0/languages/python.min.js"></script>
        
      

    

    
    
      <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/leaflet.min.js" integrity="sha512-SeiQaaDh73yrb56sTW/RgVdi/mMqNeM2oBwubFHagc5BkixSpP1fvqF47mKzPGWYSSy4RwbBunrJBQ4Co8fRWA==" crossorigin="anonymous"></script>
    

    
    
    <script>const code_highlighting = true;</script>
    

    
    
    
    
    
    
    <script>
      const search_config = {"indexURI":"/en/index.json","minLength":1,"threshold":0.3};
      const i18n = {"no_results":"No results found","placeholder":"Search...","results":"results found"};
      const content_type = {
        'post': "Posts",
        'project': "Projects",
        'publication' : "Publications",
        'talk' : "Talks",
        'slides' : "Slides"
        };
    </script>
    

    
    

    
    
    <script id="search-hit-fuse-template" type="text/x-template">
      <div class="search-hit" id="summary-{{key}}">
      <div class="search-hit-content">
        <div class="search-hit-name">
          <a href="{{relpermalink}}">{{title}}</a>
          <div class="article-metadata search-hit-type">{{type}}</div>
          <p class="search-hit-description">{{snippet}}</p>
        </div>
      </div>
      </div>
    </script>
    

    
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/3.2.1/fuse.min.js" integrity="sha256-VzgmKYmhsGNNN4Ph1kMW+BjoYJM2jV5i4IlFoeZA9XI=" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script>
    

    
    

    
    

    
    

    
    
    <script id="dsq-count-scr" src="https://ayatoashihara-github-io-myblog-multi.disqus.com/count.js" async></script>
    

    
    
    
    
    
    
    
    
    
      
    
    
      
    
    
    
    <script src="../../../js/wowchemy.min.8139e5044a74e2e05dca886f99332759.js"></script>

    


  
  
  <div class="container">
    <footer class="site-footer">
  

  <p class="powered-by">
    
  </p>

  
  






  <p class="powered-by">
    
    Published with
    <a href="https://wowchemy.com" target="_blank" rel="noopener">Wowchemy</a>  —
    the free, <a href="https://github.com/wowchemy/wowchemy-hugo-modules" target="_blank" rel="noopener">
    open source</a> website builder that empowers creators.
    

    
    <span class="float-right" aria-hidden="true">
      <a href="#" class="back-to-top">
        <span class="button_icon">
          <i class="fas fa-chevron-up fa-2x"></i>
        </span>
      </a>
    </span>
    
  </p>
</footer>

  </div>
  

  
<div id="modal" class="modal fade" role="dialog">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Cite</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <pre><code class="tex hljs"></code></pre>
      </div>
      <div class="modal-footer">
        <a class="btn btn-outline-primary my-1 js-copy-cite" href="#" target="_blank">
          <i class="fas fa-copy"></i> Copy
        </a>
        <a class="btn btn-outline-primary my-1 js-download-cite" href="#" target="_blank">
          <i class="fas fa-download"></i> Download
        </a>
        <div id="modal-error"></div>
      </div>
    </div>
  </div>
</div>

</body>
</html>
